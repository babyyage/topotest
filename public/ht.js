!function(P,w,B){"use strict";function F(J,m){if("function"!=typeof m&&null!==m)throw new TypeError("Super expression must either be null or a function");J.prototype=w.create(m&&m.prototype,{constructor:{value:J,writable:!0,configurable:!0}}),m&&kc(J,m)}function o(c){var d=w.prototype.toString.call(c);return"Array]"===d.substring(d.length-6)}function t(m,d,w,r,I,F){d=d||[],w=w||[],r=r||[];try{d.push(m);var T=Function.apply(0,d);return w[w.length]="return "+T,Function.apply(0,w).apply(0,r)}catch(U){return F&&F(U),I}}function y(w){var N={};return{get:function(s){if(N[s]!==B)return N[s];var v;switch(s){case"WEBGL_depth_texture":v=w.getExtension("WEBGL_depth_texture")||w.getExtension("MOZ_WEBGL_depth_texture")||w.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":v=w.getExtension("EXT_texture_filter_anisotropic")||w.getExtension("MOZ_EXT_texture_filter_anisotropic")||w.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":v=w.getExtension("WEBGL_compressed_texture_s3tc")||w.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||w.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":v=w.getExtension("WEBGL_compressed_texture_pvrtc")||w.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":v=w.getExtension("WEBGL_compressed_texture_etc1");break;default:v=w.getExtension(s)}return N[s]=v,v}}}function K(F,v,f){function $(){if(M!==B)return M;var $=v.get("EXT_texture_filter_anisotropic");return M=null!==$?F.getParameter($.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function C(N){if("highp"===N){if(F.getShaderPrecisionFormat(F.VERTEX_SHADER,F.HIGH_FLOAT).precision>0&&F.getShaderPrecisionFormat(F.FRAGMENT_SHADER,F.HIGH_FLOAT).precision>0)return"highp";N="mediump"}return"mediump"===N&&F.getShaderPrecisionFormat(F.VERTEX_SHADER,F.MEDIUM_FLOAT).precision>0&&F.getShaderPrecisionFormat(F.FRAGMENT_SHADER,F.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var M;f=f||{};var Z="undefined"!=typeof WebGL2RenderingContext&&F instanceof WebGL2RenderingContext,P=f.precision!==B?f.precision:"highp",m=C(P);m!==P&&(console.warn("WebGL:",P,"not supported, using",m,"instead."),P=m);var U=f.logarithmicDepthBuffer===!0,t=F.getParameter(F.MAX_TEXTURE_IMAGE_UNITS),Q=F.getParameter(F.MAX_VERTEX_TEXTURE_IMAGE_UNITS),I=F.getParameter(F.MAX_TEXTURE_SIZE),V=F.getParameter(F.MAX_CUBE_MAP_TEXTURE_SIZE),i=F.getParameter(F.MAX_VERTEX_ATTRIBS),R=F.getParameter(F.MAX_VERTEX_UNIFORM_VECTORS),z=F.getParameter(F.MAX_VARYING_VECTORS),x=F.getParameter(F.MAX_FRAGMENT_UNIFORM_VECTORS),n=Q>0,H=Z||!!v.get("OES_texture_float"),u=(Z||!!v.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,A=n&&H,T=Z?F.getParameter(F.MAX_SAMPLES):0;return{getMaxAnisotropy:$,getMaxPrecision:C,precision:P,logarithmicDepthBuffer:U,maxTextures:t,maxVertexTextures:Q,maxTextureSize:I,maxCubemapSize:V,maxAttributes:i,maxVertexUniforms:R,maxVaryings:z,maxFragmentUniforms:x,vertexTextures:n,floatFragmentTextures:H,elementTypeUint:u,floatVertexTextures:A,maxSamples:T}}function L(d,T){return d.z!==T.z?T.z-d.z:d.id-T.id}var z="ht";if(!P[z]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),P.performance&&P.performance.now||function(){var g=Date.now();P.performance||(P.performance={}),P.performance.now=function(){return Date.now()-g}}();for(var N=Date.now(),g=16,T=["ms","moz","webkit","o"],I=0;I<T.length&&!P.requestAnimationFrame;++I)P.requestAnimationFrame=P[T[I]+"RequestAnimationFrame"],P.cancelAnimationFrame=P[T[I]+"CancelAnimationFrame"]||P[T[I]+"CancelRequestAnimationFrame"];P.requestAnimationFrame||(P.requestAnimationFrame=function(r){var q=Date.now(),L=g+N-q;return 0>L&&(L=0),N=q,P.setTimeout(function(){N=Date.now(),r(performance.now())},L)}),P.cancelAnimationFrame||(P.cancelAnimationFrame=function(o){return P.clearTimeout(o)}),w.assign===B&&(w.assign=function(k){if(k===B||null===k)throw new TypeError("Cannot convert undefined or null to object");for(var e=w(k),f=1;f<arguments.length;f++){var Y=arguments[f];if(Y!==B&&null!==Y)for(var Q in Y)w.prototype.hasOwnProperty.call(Y,Q)&&(e[Q]=Y[Q])}return e}),P.btoa===B&&(P.btoa=function(E){for(var P,l,i=String(E),Z=0,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f="";i.charAt(0|Z)||(a="=",Z%1);f+=a.charAt(63&P>>8-8*(Z%1))){if(l=i.charCodeAt(Z+=.75),l>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");P=P<<8|l}return f})}();var E,Z,n,C,M=P.location,N=M&&P.document,h=null,H=B,R=P[z]={},T=P[z+"config"],l=R.Default=T&&T.Default||{},D=R.Style=T&&T.Style||{},W=R.Attr=T&&T.Attr||{},U=function(){return!0},u=function(){return!1},X=function(b){return b},Y=function(I){return!I},V=R.Color=T&&T.Color||{},O=R.IsGetter=T&&T.IsGetter||{};!function(){var Y=!1;try{var L=w.defineProperty({},"passive",{get:function(){return Y=!0,B}});M&&(n=E=M)&&P.addEventListener("test",L,L),M&&(C=Z=M)&&P.removeEventListener("test",L,L)}catch(v){Y=!1}l.passiveSupported=Y}();var f,x,k,r,G=l.passiveSupported,i=l.eventListenerOptionsFalse=G?{passive:!1,capture:!1}:!1,_=l.eventListenerOptionsTrue=G?{passive:!1,capture:!0}:!0,e=function(Y,n,r,N){Y.addEventListener(n,r,N?_:i)},J=function(V,A,x,K){V.removeEventListener(A,x,K?_:i)},j=Math,A=j.round,c=j.floor,g=j.ceil,m=j.sqrt,I=j.max,v=j.min,$=j.abs,d=j.cos,s=j.acos,a=j.sin,q=j.pow,p=j.asin,b=j.exp,S=j.PI,Q=2*S,xr=S/2,qc=j.tan,Mj=j.atan2,Kn=j.random,Bk=j.log,Al=q(2,1),Hd=!1,Bn=P.parseInt||global.parseInt,up="2021-6-15",Db=M&&(P.navigator?P.navigator.platform.indexOf("Win")>-1:!1),sg=function(A){return A*A},kl=M&&P.setTimeout,vc=M&&P.clearTimeout,bf=M&&(P.navigator?P.navigator.userAgent.toLowerCase():""),Pf=function(S){return S.test(bf)},zp=Pf(/msie/),Sj=Pf(/msie/)||Pf(/trident/),ah=Pf(/msie 10/),So=Pf(/edge/),Br=Pf(/firefox/),Bs=Pf(/mac/),Kl=Pf(/mscAndroid/),An=l.isTouchable===B?Db?!1:N?"ontouchend"in N:!1:l.isTouchable,Gr="default",$o="single",Me="multiple",Lr="front",Sf="back",Se="left",_d="right",Pi="top",sp="bottom",Xf="center",Bl="eye",Dg="middle",Yp="east",og="west",To="north",mb="none",Ee="px",wk="absolute",Ri="border",ve="triangle",Kq="rect",ln="circle",gi="cylinder",Cq="shape",ec="items",Mr="normal",Sb="remove",Oe="clear",wf="width",Qd="height",Cl="ingroup",Hq="check",hn="uncheck",Ll="radio",Ub="radioOn",Ap="radioOff",ki="points",Uj="values",no="series",om="body",Cn="label",Xq="label2",Am="note",Um="note2",th="icons",Zh="labelFont",Cp="labelColor",Vb="labelSelectColor",np="note.expanded",Af="note2.expanded",kf="edge.expanded",gr="edge.points",Vd="edge.type",pi="rotation",Ce="hidden",$r="visible",Dp="tuv",Jq="no",Xr="draw",lm="select",Gb="currentSubGraph",Gp="selectBackground",_i="autoMakeVisible",cr="autoHideScrollBar",Cm="scrollBarColor",ue="scrollBarSize",rm="indent",ae="rowHeight",Go="columnLineColor",Wj="rowLineColor",ig="columnLineVisible",is="rowLineVisible",nk="visibleFunc",_m="expandIcon",lb="collapseIcon",yf="checkMode",Vm="sortFunc",Vg="editable",Bh="batchEditable",ci="tristate",jp="asc",Vn="desc",tq="position",ps="__",_b="elevation",Ci="children",Fo="translateX",Yf="translateY",br="dataModel",Jn="maxSize",Gg="enc",si="state",Mp=Gg+"o"+"de",pl="shape3d",dd="shape3d.resolution",je="shape3d.visible",Uh="shape3d.from.visible",kk="shape3d.to.visible",ul="shape3d.top.visible",Zo="shape3d.bottom.visible",Ni="repeat.uv.length",mf="serializeValue",fk="deserializeValue",vi="centerUniform",sj="uniform",sr="rgba(255,255,255,0)",or="style",rl="attr",cb="field",Eb="string",qg="boolean",xn="color",as="int",qr="number",yb="ew-resize",Lk="ns-resize",Oj="pointer",Cc="auto",Sn="mousedown",kr="mousemove",em="mouseup",gh="mouseout",bl="touchstart",le="touchmove",jk="touchend",dq="keydown",Or="keyup",mh=["DOMMouseScroll","mousewheel"],oi=Br?mh[0]:mh[1],li=ps+z+ps+Mp,Kr=[bl,le,jk],Oo=[Sn,kr,em,gh,oi,"wheel","mouseenter","mouseleave","mouseover"],pd=[dq,Or,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],nh=An?Kr.concat(pd):Oo.concat(pd),fm=h,Sk=h,Dm=h,In=h,Dq=!0,wc=em.length,Nn=function(){Dm&&(vc(Dm.timeout),Dm=h)},re=function(){Dm&&rg(Dm.e,Dm.info)};P.addEventListener&&(H=M)&&(An||(e(P,gh,function(){Nn()}),e(P,oi,function(){df()})),e(P,Or,function(M){91===M.keyCode?Mk={}:delete Mk[M.keyCode]},!0),e(P,dq,function(T){Mk[T.keyCode]=!0},!0),e(P,"blur",function(){Mk={}}));var Mi,Xd,uj,Aj=0,mk=h,qe=function(Z,k){var $=kl(function(){delete mk[$],Gi(mk)&&(mk=h),Z()},k);return $},$j=h,Tb=h,Ro={},Lc={},Ze={},Xm={},dm={},Mk={},fg={},Bm={},hh={},cd={},ri=/.json$/,yh=/\.(json|bin)$/,co=/^data:image\/svg\+xml/,mm={},Hj=[],vm={},xo=h,rf=h,an=function(){},zm=function(){throw"Oops!"},uf=[0,0,0],zn={x:0,y:0,width:0,height:0},Fr=h,Mo=h,Cb=h,rb=function(f,E){Lc[f]=E,E&&E.comps&&!E.uuid&&(E.uuid=R.Math.generateUUID()),pj[f]&&(E.cacheRule=pj[f],delete pj[f])},zg=function(z){Mo&&!z._72O&&(Cb||(Cb={}),Cb[z._72O=Jc()]=z),Mi!=h?td()<.05&&r&&!Xd&&(pm=Nn):pm=He},yk=function($,w,g,e){Mo||(Mo={});var L=Mo[$];if(L){if(L.url===w)return;L.image?(L.image.onload=an,L.image.onerror=an):L.request&&(L.request.onload=an,L.request.onerror=an)}if(ri.test(w)){var f=new Md;if(Mo[$]={request:f,url:w},w=l.beforeLoadURL(w,$),w.data){var T=l.parse(w.data);Bb($,T),l.handleImageLoaded($,T)}else{f.onload=function(){if(200===this.status||0===this.status){var U=l.parse(f.getResponseText());Bb($,U),l.handleImageLoaded($,U)}else Bb($,l.handleUnfoundImage($,w)||h)},f.onerror=function(){Bb($,l.handleUnfoundImage($,w)||h)};var b={};b.url=encodeURI(w),b.sync=!1,f.send(b)}}else{var T=new Image;Mo[$]={image:T,url:w},/^data:image/.test(w)||(w=l.beforeLoadURL(w,$),w=l.appendTimeStamp(w),w=encodeURI(w),T.crossOrigin=l.crossOrigin),l.convertImageSrc(w,function(L){Sj&&(w.toLowerCase().indexOf(".svg")>0||co.test(w))?(N.body.appendChild(T),T.style.visibility="hidden",T.onload=function(){kl(function(){if(g&&(T.width=g),e&&(T.height=e),!T.width||!T.height){var b=T.width||T.clientWidth,A=T.height||T.clientHeight;T.width=b,T.height=A}l.handleImageLoaded($,T),Bb($,T),N.body.removeChild(T),T.style.visibility=""},180)},T.onerror=function(){Bb($,l.handleUnfoundImage($,w)||h),N.body.removeChild(T),T.style.visibility=""}):(T.onload=function(){g&&(T.width=g),e&&(T.height=e),l.handleImageLoaded($,T),Bb($,T)},T.onerror=function(){Bb($,l.handleUnfoundImage($,w)||h)}),T.src=L})}},Bb=function(a,o){if(rb(a,o),delete Mo[a],Gi(Mo)&&(Mo=h,Cb)){for(var N in Cb){var U=Cb[N];U._2O&&U._2O[a]&&(U.deleteTexture(a),delete U._2O[a]),U.invalidateAll&&U.invalidateAll(B,"imageLoaded",a),U.redraw&&U.redraw(),U.iv(),o&&o.layoutAttach&&U.updateLayoutAttach&&U.updateLayoutAttach(a),delete U._72O}Cb=h}if(o&&Cb)for(var N in Cb){var U=Cb[N];U.invalidateAll&&U.invalidateAll(B,"imageLoading",a),U.redraw&&U.redraw(),U.iv(),o.layoutAttach&&U.updateLayoutAttach&&U.updateLayoutAttach(a)}},Yl=function(){return Bk=j&&Date,function(){return P.performance&&P.performance.now?P.performance.now():Date.now()}}(),dr=function(E,q,v){return{width:E,height:q,comps:Nl(v)?v:[v]}},Cf=function(V,w){return{type:ln,rect:[V,w,1.6,1.6],borderWidth:1,borderColor:te,gradient:ad,gradientColor:vb,background:te}},yl=function(k,E){return dr(16,16,{type:ve,rect:[4,4,10,8],background:k,rotation:E?1.57:3.14})},Hi=function(v,f){return dr(16,16,{type:ve,rect:[4,4,8,7],background:v,rotation:f?3.14:0})},Tm=function(Q){var u=Q._orientation;return"horizontal"===u||"h"===u},Tf=function(B,w){var Z=h||4,u=h||1,f=h||1;0>Z?Z=0:Z>.25&&(Z=.25);var k,m,R,_,J,s,M,E=.5,O=[],c=[],V=[],j=Q/f,Y=Q/u,b=E-Z;for(m=0;u>=m;m++)for(_=-S+m*Y,s=d(_),J=a(_),k=0;f>=k;k++)R=k*j,M=b+Z*s,O.push(d(R)*M,J*Z,-a(R)*M),(x=[B,w])&&c.push(k/f,1-m/u);for(m=0;u>m;m++){var v=m*(f+1),t=(m+1)*(f+1);for(k=0;f>k;k++)V.push(v+k,t+k+1,t+k,v+k,v+k+1,t+k+1),Jo.z=of.z=[B,w]}},qj=function(Z){var f=2,G=0;for(var y in Z)y.length===f&&Bn(y,32)===Bp&&(xo=rf=Z[y]),G++;return G},Qh=function(v,p,U,f){return U||(U=An?5:3,U/=f||1),{x:v-U,y:p-U,width:2*U,height:2*U}},xp=function($,b,O,s){var j=this;b||(b=An?5:3,O=20,s=20);var U={x:$,y:b,width:O,height:s};if(O)for(var l=0;O>l;l++)if(3===O)s=20;else for(var i=0;s>i;i++)j=P?P:O;var B={x:S,y:2*S};if(Ib(U,B)){var F=Qd[0]+Pi[0]+Oe[1]+jp.length,k=Ce[0]+ci[0]+Oe[1]+om.length;pq[Bl]=[j[F],j[k]],j[F]=gl[Bl],j[k]=gl[pl]}},Mm=function(I){return(/ble$/.test(I)||/ed$/.test(I)||O[I]?"is":"get")+I.charAt(0).toUpperCase()+I.slice(1)},gl=function(c){return"set"+c.charAt(0).toUpperCase()+c.slice(1)},Ek=function(O){return typeof O===Eb||O instanceof String},ih=function(T){return typeof T===qr},He=function(g){return typeof g===qg},xg=function(o){return o&&"object"==typeof o},bo=function(H){return"function"==typeof H},Nl=function(B){return B instanceof Array},so=function(k){return k instanceof bp},_o=function(Q){return Nl(Q)?new bp(Q):Q},Tn=function(t){return t instanceof Qp},Jr=function(Y){return Y instanceof Km},hq=function(X){return X instanceof zk},Yq=function(U,N){if(!(U instanceof R.Group))return!1;if(!N)return U.isExpanded();var S=N.getDataUI(U);return S&&S._88I?!0:!1},Ug=function(Z){return Z instanceof Ho},_q=function(X){return X&&"IFRAME"===X.tagName},ym=function(A){return A==h||l.numberDigits==h?A:parseFloat(A.toFixed(l.numberDigits))},Rg=function(M,L,y){var f,W=L.length;if(y)for(var Q=0;y>Q;Q++)if(3===W)M.push(L[0]),M.push(L[1]),M.push(L[2]);else for(f=0;W>f;f++)M.push(L[f]);else if(3===W)M.push(L[0]),M.push(L[1]),M.push(L[2]);else for(f=0;W>f;f++)M.push(L[f])},Mg=function(t){return t?xg(t)?t:{}:!1},sq=function(n,D,T){var c,O=xg(n)?n:n.prototype;for(c in D)T&&c in O?O[c]===B&&console.warn("class",O,"has own undefined property",c,", keep exist!"):O[c]=D[c];return n},bj=function(H,Y){if(!("wheelDelta"in Y)){var U=Y.deltaMode;Y.wheelDelta=U===Y.DOM_DELTA_PIXEL?-Y.deltaY:U===Y.DOM_DELTA_LINE?40*-Y.deltaY:120*-Y.deltaY}H.handle_mousewheel(Y)},Ij=function(B){return String.fromCharCode(B)},vh=function(f){for(var _,R=0,W="";R<f.length;R++)_=f[f.length-1-R],"%"===_?_="'":"a"===_?_='"':"]"===_&&(_="\\"),W+=Ij(_.charCodeAt(0)-1);return W},_l=function(c,q,u){c.superClass.constructor.apply(q,u)},Gi=function(i){for(var q in i)return!1;return!0},Oi=function(_){return _?0===_.length:!0},io=function(){var T="";return[hn[0],Wj[0],Cn[0]].forEach(function(R){T+=gl(R).slice(3)}),sj=N&&N[T]||vi,function(C,A){return C===A?!0:C.x===A.x&&C.y===A.y&&C.width===A.width&&C.height===A.height}}(),Pc=function(g,$,H){return $>g?$:g>H?H:g},Jp=function(b){return 0>b?-1:b>0?1:0},td=function(){var O=1e4*a(wc++);return O-c(O)},zh=function(I,J,o){return As(I.x,I.y,J.x,J.y,o.x,o.y,o.x+o.width,o.y,!0)||As(I.x,I.y,J.x,J.y,o.x+o.width,o.y,o.x+o.width,o.y+o.height,!0)||As(I.x,I.y,J.x,J.y,o.x+o.width,o.y+o.height,o.x,o.y+o.height,!0)||As(I.x,I.y,J.x,J.y,o.x,o.y+o.height,o.x,o.y,!0)},As=function(R,t,X,y,S,r,o,E,b){var g=(o-S)*(t-r)-(E-r)*(R-S),G=(E-r)*(X-R)-(o-S)*(y-t);if(0!==G){var $=g/G,n=R+$*(X-R),e=t+$*(y-t);return b&&(n+Ji<v(R,X)||n-Ji>I(R,X)||n+Ji<v(S,o)||n-Ji>I(S,o)||e+Ji<v(t,y)||e-Ji>I(t,y)||e+Ji<v(r,E)||e-Ji>I(r,E))?h:[n,e]}return h},lf=function(J,d,s){if(J&&s)if(d){if(d===or)return J.getStyle(s);if(d===rl)return J.getAttr(s);if(d===cb)return J[s]}else if(s=Mm(s),J[s])return J[s]();return B},uq=function(U,B,q,O){if(U&&q)if(B){if(B===or)U.s(q,O);else if(B===rl)U.a(q,O);else if(B===cb){var h=U[q];U[q]=O,U.fp("f:"+q,h,O)}}else q=gl(q),U[q]&&U[q](O)},Co=function(h,k){var d,s,c,Q=!1;return(lf(h,or,"shadow")||k&&"shadow"===lf(h,or,"select.type"))&&(d=lf(h,or,"shadow.offset.x")||0,s=lf(h,or,"shadow.offset.y")||0,c=lf(h,or,"shadow.blur")||0,Q=!0),!Q&&lf(h,or,"shadow2")&&(d=lf(h,or,"shadow2.offset.x")||0,s=lf(h,or,"shadow2.offset.y")||0,c=lf(h,or,"shadow2.blur")||0,Q=!0),Q?1.5*c+Math.max(d,s):0},gs=function(x,T,s,r){return r=0===s?0:r||0,T&&"top"!==T?"bottom"===T?{x:x.x-r,y:x.y-r,width:x.width+2*r,height:x.height*s+r}:"right"===T?{x:x.x-r,y:x.y-r,width:x.width*s+r,height:x.height+2*r}:"left"===T?{x:x.x+x.width*(1-s),y:x.y-r,width:x.width*s+r,height:x.height+2*r}:void 0:{x:x.x-r,y:x.y+x.height*(1-s),width:x.width+2*r,height:x.height*s+r}},xh=function(C,B,q,$,K){B&&Tj(C,q,$,1,K,B)},Ud=function(r,N,D,J){var T=1-r;return T*T*N+2*r*T*D+r*r*J},Jo=function(x,q,v,O,d){var n=1-x;return n*n*n*q+3*n*n*x*v+3*n*x*x*O+x*x*x*d},tg=function(N){var q,R,c,i,v=0;return N.forEach(function(B){if(q=B.length,q>0)for(R=B[0],i=1;q>i;i++)c=B[i],v+=Jf(R,c),R=c}),v},op=function(J,D,r){var G="__"+J,s=function(c){("mousedown"===J||"mouseup"===J||"touchstart"===J||"touchend"===J)&&xi(c),r.disabled||r["handle_"+J](c)};r[G]||(r[G]=s,e(D,J,s))},vn=function(a,$,f){var c="__"+a,V=f[c];V&&(J($,a,V),delete f[c])},bc=function(T,J){var s="_"+J;T[Mm(J)]=function(){return this[s]},T[gl(J)]=function(H){var p=this[s];this[s]=H,this.fp(J,p,H)}},fo=function(i){return w.create(i)},Op=function(Y){if(!Y.element){var S,N;(S=Y.textField)?N=ui(dt.TextField,S):(S=Y.textArea)?N=ui(dt.TextArea,S):(S=Y.button)?N=ui(dt.Button,S):(S=Y.comboBox)?N=ui(dt.ComboBox,S):(S=Y.checkBox)?N=ui(dt.CheckBox,S):(S=Y.radioButton)?N=ui(dt.RadioButton,S):(S=Y.slider)?N=ui(dt.Slider,S):(S=Y.colorPicker)?N=ui(dt.ColorPicker,S):(S=Y.image)&&(N=ui(dt.Image,S)),N&&(Y.element=N)}},fl=function(T,r){var j=Xl(T);return j._ht=r,j},oe=P.top===P?P.top:P||P.document,Xl=function(L,S){var b=N.createElement("div"),R=b.style;return b.tabIndex=-1,b.onkeydown=jr,R.msTouchAction=mb,_n(b,h,0),An&&R.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",h),L&&(R.overflow=Ce),S&&vk(S,b),b},Mb=function(U,A){var K=N.createElement("canvas"),Z=K.style;return Z.msTouchAction=mb,A||(Z.pointerEvents=mb),_n(K,h,0),U&&vk(U,K),K},_n=function(V,z,y){var i=V.style;i.border=z?z+" solid 1px":0,i.outline=0,i.padding=y?"0 "+y+Ee:0,Sh(V)},Sh=function(b){var u=b.style;u.position=wk,u.margin=0,u.setProperty("box-sizing","border-box",h),u.setProperty("-moz-box-sizing","border-box",h)},qh=function(K,V,F,x){x||(x=Tp),V!=h&&(K.width=V*x,K.style.width=V+Ee),F!=h&&(K.height=F*x,K.style.height=F+Ee)},vk=function(m,a,J){m.appendChild(a),J&&(a.style.position=wk)},ud=function(D,y){y.split||(y+="");for(var J,N=y.split("\n"),B=0,R=N.length,$=0;R>$;$++){var H=Jm(D.font,N[$]);H.width>B&&(B=H.width),J||(J=H.height)}return D.ss=N,{width:B,height:J*R}},Wl=function(v,V,W,$,S,Z){var X=V.length;if(1===X)Po(v,V[0],W,$,S);else for(var x=W.height/X,M={x:W.x,y:W.y,width:W.width,height:x},J=0;J<V.length;J++)Z?dn(v,V[J],$,S,M.x,M.y,M.width,M.height,Z):Po(v,V[J],M,$,S),M.y+=x},Po=function(P,N,L,q,l){P.font=q?q:Zr,P.fillStyle=l?l:Si,P.textAlign=Xf,P.textBaseline=Dg;var b,E;L?L.width===B?(b=L.x,E=L.y):(b=L.x+L.width/2,E=L.y+L.height/2):(b=0,E=0),P.fillText(N,A(b),A(E))},lo=function(z){z.getView&&(z=z.getView());var x=z.offsetWidth||z.scrollWidth;return!x&&z.style.width&&(x=Bn(z.style.width)),x},Rm=function(l){l.getView&&(l=l.getView());var G=l.offsetHeight||l.scrollHeight;return!G&&l.style.height&&(G=Bn(l.style.height)),G},dp=function(X,c,w){var G=c[0].toUpperCase()+c.substring(1,c.length);X["webkit"+G]=w,X["moz"+G]=w,X["ms"+G]=w,X["o"+G]=w,X[c]=w},Un=function(){var w=function(y){jr(y),y.stopPropagation()},q=function(q){jr(q)},T=[bl,dq,Sn];return function(j,H){var W=Xl(),Z=W.style;return Z.backgroundColor=l.disabledBackground,j&&(Z.backgroundImage="url("+j+")",Z.backgroundPosition="50% 50%",Z.backgroundRepeat="no-repeat no-repeat"),H===!1?T.forEach(function(D){e(W,D,q)}):T.forEach(function(M){e(W,M,w)}),W}}(),hb=function(u){var E=u.getContext("2d");return E.save(),E.lineCap=Ue,E.lineJoin=Wm,E},pm=function($,B,b,q){Df($,B*Tp,b*Tp),q*=Tp,1!==q&&$.scale(q,q)},Df=function(W,K,n){W.translate(K,n)},Cs=function(A,n){n&&A.rotate(n)},Vj=function(l,S,i){S===B&&(S=1),i===B&&(i=1),(1!==S||1!==i)&&l.scale(S,i)},fq=!1,b=oe[Hq[1]+Fo[0]],gc=function(W){var S=N.activeElement;if(N.activeElement!==W){S&&S.forceOnblur&&S.forceOnblur();for(var e=[],m=W.parentNode;m;)e.push([m,m.scrollLeft,m.scrollTop]),m=m.parentNode;if(!fq){var C=[],H=[];try{for(var X=P.parent,O=P;X!==O;)C.push([X,X.scrollX,X.scrollY]),O=X,X=P.parent;var s=P.frameElement;if(s)for(var $=s.parentNode;$;)H.push([$,$.scrollLeft,$.scrollTop]),$=$.parentNode}catch(j){fq=!0}}if(An)W.focus();else{var o=cq(),Y=o.target;W.focus(),Y.scrollLeft=o.left,Y.scrollTop=o.top}e.forEach(function(q){q[0].scrollLeft=q[1],q[0].scrollTop=q[2]}),fq||(C.forEach(function(o){o[0].scrollTo(o[1],o[2])}),H.forEach(function(t){t[0].scrollLeft=t[1],t[0].scrollTop=t[2]}))}},Sq=function(E){return E&&E.getView?E.getView():E},cn=function(w,F,S,T,J){if(2===arguments.length&&(S=F.y,T=F.width,J=F.height,F=F.x),w.isSelfViewEvent)w.setX(F),w.setY(S),w.setWidth(T),w.setHeight(J);else{var n=Sq(w),R=n.style;if((N.fullscreenElement||N.mozFullScreenElement||N.webkitFullscreenElement||N.msFullscreenElement)!==n)F!==B&&(R.left=F+Ee),S!==B&&(R.top=S+Ee),T!==B&&(R.width=T+Ee),J!==B&&(R.height=J+Ee);else{var E=l.getWindowInfo();R.left=(F=E.left)+Ee,R.top=(S=E.top)+Ee,R.width=(T=E.width)+Ee,R.height=(J=E.height)+Ee}w.endEditing&&!An&&w.endEditing(),w.redraw&&w.redraw(),w.invalidate&&w.invalidate(),w.onLayouted&&w.onLayouted(F,S,T,J),w.fireViewEvent&&w.fireViewEvent("layout")}},ef=function(D){if(!D.touches)return D;var W=D.touches[0];return W?W:D.changedTouches[0]},hg=function(W){return Le(W)?ef(W).target:W.target},Le=function(w){return w&&"object"==typeof w&&"touches"in w},ib=function(O){l.popup&&l.popup.close(),l.popup=O},dl=h,Fp=function(U){dl.handleWindowTouchMove(U)},pr=function(O){dl.handleWindowTouchEnd(O),J(P,le,Fp),J(P,jk,pr),dl=h},Eg=function(u){dl.handleWindowMouseMove(u)},Tk=function(F){dl.handleWindowMouseUp(F),J(P,kr,Eg),J(P,em,Tk),dl=h},nj=function(M){return 1===uh(M)},ks=function(E,d){return d?d.keyCode===E:Mk[E]},id=function(H){return Nq(H)&&ks(65,H)},Ej=function(r){return ks(46,r)||ks(8,r)},Pe=function(h){return function(g){return g?g.keyCode===h:Mk[h]}},Bp=573,Zc=[65,83,68,87,37,38,39,40,32,13,27],Lg=Pe(Zc[0]),Ep=Pe(Zc[1]),zl=Pe(Zc[2]),En=Pe(Zc[3]),bq=Pe(Zc[4]),Gh=Pe(Zc[5]),jh=Pe(Zc[6]),di=Pe(Zc[7]),fr=Pe(Zc[8]),er=Pe(Zc[9]),oo=Pe(Zc[10]),Tq={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},gf=[2,2,2,2,2,2,2,2,2,2,2,3,3,5,5,5,5,5,7,4027],nl=h,Er=h,ac=function(l,i){nl||(nl=Mb()),qh(nl,l,i,1);var G=hb(nl);return G.clearRect(0,0,l,i),G},pf=function(G,a,x){if(a&&G){if("override"===x)return a;if("override_rgb"===x){var V=vg(a);return G=gg(G),"rgba("+A(255*V[0])+","+A(255*V[1])+","+A(255*V[2])+","+G[3]/255+")"}if("override_a"===x){var V=vg(a);return G=gg(G),"rgba("+G[0]+","+G[1]+","+G[2]+","+V[3]+")"}if("multiply_destinationAtop"===x){var U=lg(vg(G)),L=U[3],j=lg(vg(a)),Z=j[3],k=lg(U),K=k[3],l=U.map(function(L,x){return L*j[x]}),q=1-L,o=1-Z,Y=o*L+Z;return U=U.map(function(f,c){return(Z*q*j[c]+Z*L*l[c]+o*L*f)/Y}),L=Y,q=1-L,U=U.map(function(e,p){return(K*k[p]*q+L*e*K)/K}),L=K,"rgba("+A(255*U[0])+","+A(255*U[1])+","+A(255*U[2])+","+L+")"}var V=vg(a);return G=gg(G),"rgba("+A(G[0]*V[0])+","+A(G[1]*V[1])+","+A(G[2]*V[2])+","+G[3]/255*V[3]+")"}return G},gg=function(){var W,z={};for(var A in P){var F=Me.length;if(A.length==F&&A[0]===Me[2]&&A[1]===mb[1]&&A[4]===Me[3]&&A[5]===Me[4]&&A.substr(F-2)===mb[1]+mb[2]){var w=P[A];for(var l in w)l.length===F&&l.substr(0,3)===_d[3]+Sb[3]+lm[0]&&l.substr(F-2)===Me[0]+Am[3]&&(mh=w[l])}}return function(J){var x,V=z[J];return V||(W||(W=Mb(),qh(W,1,1,1)),x=W.getContext("2d"),x.clearRect(0,0,1,1),Tj(x,0,0,1,1,J),V=x.getImageData(0,0,1,1).data,V=z[J]=[V[0],V[1],V[2],V[3]]),V}}(),vg=function(H){if(!Ek(H))return H;var d=gg(H);return d.CA||(d.CA=[d[0]/255,d[1]/255,d[2]/255,d[3]/255]),d.CA},Ng=function(g,$,O,n,J){var S=Mb();S.width=O,S.height=n;var Y=S.getContext("2d");Y.drawImage(g,0,0,O,n);try{for(var K=Y.getImageData(0,0,O,n),l=K.data,o=0,m=l.length;m>o;o+=4){var f=l[o+0],C=l[o+1],A=l[o+2],k=l[o+3];"override_a"===J?l[o+3]=255*$[3]:"override_rgb"===J?(l[o+0]=255*$[0],l[o+1]=255*$[1],l[o+2]=255*$[2]):"override"===J?(l[o+0]=255*$[0],l[o+1]=255*$[1],l[o+2]=255*$[2],l[o+3]=255*$[3]):(l[o+0]=$[0]*f,l[o+1]=$[1]*C,l[o+2]=$[2]*A,l[o+3]=$[3]*k)}Y.putImageData(K,0,0)}catch(h){return g}return S},pq=function(A,s,q){return s&&(s="miter"===q?8*s+20:s+1,A&&Lq(A,s)),s},Uq=function(s,f){if(f){var B=new uk(f),l=s.width/2,b=s.height/2,d=oj([B.tf(-l,-b),B.tf(l,-b),B.tf(l,b),B.tf(-l,b)]);return d.x+=s.x+l,d.y+=s.y+b,d}return s},Gm=function(K,i,w,J,c,z,S,G){J*=Math.PI/180;var p={x:Math.cos(J)*(K.x-S.x)/2+Math.sin(J)*(K.y-S.y)/2,y:-Math.sin(J)*(K.x-S.x)/2+Math.cos(J)*(K.y-S.y)/2},R=Math.pow(p.x,2)/Math.pow(i,2)+Math.pow(p.y,2)/Math.pow(w,2);R>1&&(i*=Math.sqrt(R),w*=Math.sqrt(R));var t=(c==z?-1:1)*Math.sqrt((Math.pow(i,2)*Math.pow(w,2)-Math.pow(i,2)*Math.pow(p.y,2)-Math.pow(w,2)*Math.pow(p.x,2))/(Math.pow(i,2)*Math.pow(p.y,2)+Math.pow(w,2)*Math.pow(p.x,2)));isNaN(t)&&(t=0);var O={x:t*i*p.y/w,y:t*-w*p.x/i},L={x:(K.x+S.x)/2+Math.cos(J)*O.x-Math.sin(J)*O.y,y:(K.y+S.y)/2+Math.sin(J)*O.x+Math.cos(J)*O.y},A=function(U){return Math.sqrt(Math.pow(U[0],2)+Math.pow(U[1],2))},y=function(x,G){return(x[0]*G[0]+x[1]*G[1])/(A(x)*A(G))},E=function(V,D){return(V[0]*D[1]<V[1]*D[0]?-1:1)*Math.acos(y(V,D))},j=E([1,0],[(p.x-O.x)/i,(p.y-O.y)/w]),U=[(p.x-O.x)/i,(p.y-O.y)/w],Q=[(-p.x-O.x)/i,(-p.y-O.y)/w],q=E(U,Q);y(U,Q)<=-1&&(q=Math.PI),y(U,Q)>=1&&(q=0);var y=i>w?i:w,P=i>w?1:i/w,M=i>w?w/i:1;if(null==G){var b={x:0,y:0,width:0,height:0};Lq(b,y),b.x*=P,b.width*=P,b.y*=M,b.height*=M;var k=new uk(J);return b=oj([k.tf(b.x,b.y),k.tf(b.x+b.width,b.y),k.tf(b.x+b.width,b.y+b.height),k.tf(b.x,b.y+b.height)]),b.x+=L.x,b.y+=L.y,[{x:b.x,y:b.y},{x:b.x+b.width,y:b.y},{x:b.x+b.width,y:b.y+b.height},{x:b.x,y:b.y+b.height}]}G.translate(L.x,L.y),G.rotate(J),G.scale(P,M),G.arc(0,0,y,j,j+q,1-z),G.scale(1/P,1/M),G.rotate(-J),G.translate(-L.x,-L.y)},kp=function(J,O){J&&J.beginPath();for(var e,a,W,v=[],$=function(Q){for(var h,z=/(\-{0,1}[\d\.]+)/gi,b=[];h=z.exec(Q);)b.push(parseFloat(h[0]));return b},r=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,x={x:0,y:0};e=r.exec(O);){var _=e[0],p=_.substr(0,1);if("M"===p||"m"===p){for(var T=$(_),F=0;F<T.length;F+=2){var K=T[F],c=T[F+1];"m"===p&&(K+=x.x,c+=x.y),J&&J.moveTo(K,c),v.push({x:K,y:c}),x.x=K,x.y=c}a=W=null}else if("H"===p||"h"===p){for(var T=$(_),F=0;F<T.length;F+=1){var K=T[F];"h"===p&&(K+=x.x),J&&J.lineTo(K,x.y),v.push({x:K,y:x.y}),x.x=K}a=W=null}else if("C"===p||"c"===p){for(var T=$(_),F=0;F<T.length;F+=6){var o=T[F],t=T[F+1],z=T[F+2],Y=T[F+3],K=T[F+4],c=T[F+5];"c"===p&&(o+=x.x,t+=x.y,z+=x.x,Y+=x.y,K+=x.x,c+=x.y),J&&J.bezierCurveTo(o,t,z,Y,K,c),v.push({x:o,y:t}),v.push({x:z,y:Y}),v.push({x:K,y:c}),x.x=K,x.y=c}a=[o,t,z,Y,K,c],W=null}else if("S"===p||"s"===p){for(var T=$(_),F=0;F<T.length;F+=4){var o,t;a?(o=2*a[4]-a[2],t=2*a[5]-a[3]):(o=x.x,t=x.y);var z=T[F],Y=T[F+1],K=T[F+2],c=T[F+3];"s"===p&&(z+=x.x,Y+=x.y,K+=x.x,c+=x.y),J&&J.bezierCurveTo(o,t,z,Y,K,c),v.push({x:o,y:t}),v.push({x:z,y:Y}),v.push({x:K,y:c}),x.x=K,x.y=c}a=[o,t,z,Y,K,c],W=null}else if("Q"===p||"q"===p){for(var T=$(_),F=0;F<T.length;F+=4){var o=T[F],t=T[F+1],K=T[F+2],c=T[F+3];"q"===p&&(o+=x.x,t+=x.y,K+=x.x,c+=x.y),J&&J.quadraticCurveTo(o,t,K,c),v.push({x:o,y:t}),v.push({x:K,y:c}),x.x=K,x.y=c}a=null,W=[o,t,K,c]}else if("T"===p||"t"===p){for(var T=$(_),F=0;F<T.length;F+=2){var o,t;W?(o=2*W[2]-W[0],t=2*W[3]-W[1]):(o=x.x,t=x.y);var K=T[F],c=T[F+1];"t"===p&&(K+=x.x,c+=x.y),J&&J.quadraticCurveTo(o,t,K,c),v.push({x:o,y:t}),v.push({x:K,y:c}),x.x=K,x.y=c}a=null,W=[o,t,K,c]}else if("V"===p||"v"===p){for(var T=$(_),F=0;F<T.length;F+=1){var c=T[F];"v"===p&&(c+=x.y),J&&J.lineTo(x.x,c),v.push({x:x.x,y:c}),x.y=c}a=W=null}else if("L"===p||"l"===p){for(var T=$(_),F=0;F<T.length;F+=2){var K=T[F],c=T[F+1];"l"===p&&(K+=x.x,c+=x.y),J&&J.lineTo(K,c),v.push({x:K,y:c}),x.x=K,x.y=c}a=W=null}else if("A"===p||"a"===p){for(var T=$(_),F=0;F<T.length;F+=7){var d=T[F],n=T[F+1],U=T[F+2],w=T[F+3],L=T[F+4],K=T[F+5],c=T[F+6];"a"===p&&(K+=x.x,c+=x.y);var f=Gm(x,d,n,U,w,L,{x:K,y:c},J);f&&(v=v.concat(f)),x.x=K,x.y=c}a=W=null}var h=_.substr(_.length-1);("z"===h||"Z"===h)&&J&&J.closePath()}return v},Hk=function(u,k,V){var g,J,o="L"===k[0],C=k.length;u.save(),o?(u.transform(k[5],k[6],k[7],k[8],k[9],k[10]),g=u.createLinearGradient(k[1],k[2],k[3],k[4]),J=11):(u.transform(k[7],k[8],k[9],k[10],k[11],k[12]),g=u.createRadialGradient(k[1],k[2],k[3],k[4],k[5],k[6]),J=13);for(var P=u.compGray;C>J;){var j=k[J+1];j=V(j),g.addColorStop(k[J],P?l.toGrayColor(j):j),J+=2}return u.fillStyle=g,g},of=function(o,y){var V=o.s("shape.gradient.pack");if(V){for(var m=V.length,r=new Array(m),I=0;m>I;I++)r[I]=V[I];var $,s,U,C,g,l,d,B,Y,t,W,z,F,R="L"===r[0];$=R?5:7,s=r[$],U=r[$+1],C=r[$+2],g=r[$+3],l=r[$+4],d=r[$+5],B=y[0],Y=y[1],t=y[2],W=y[3],z=y[4],F=y[5],r[$]=B*s+t*U,r[$+1]=Y*s+W*U,r[$+2]=B*C+t*g,r[$+3]=Y*C+W*g,r[$+4]=B*l+t*d+z,r[$+5]=Y*l+W*d+F,o.s("shape.gradient.pack",r)}},jj=function(f,P,m,N){var u=!1;if(f.beginPath?f.beginPath():u=!0,so(P)&&(P=P._as),so(m)&&(m=m._as),m&&m.length){for(var j,q,G,z,v=0,J=0,$=m.length;$>J;J++)j=m[J],1===j?(q=P[v++],f.moveTo(q.x,u?-q.y:q.y)):2===j?(q=P[v++],f.lineTo(q.x,u?-q.y:q.y)):3===j?(q=P[v++],G=P[v++],f.quadraticCurveTo(q.x,u?-q.y:q.y,G.x,u?-G.y:G.y)):4===j?(q=P[v++],G=P[v++],z=P[v++],f.bezierCurveTo(q.x,u?-q.y:q.y,G.x,u?-G.y:G.y,z.x,u?-z.y:z.y)):5===j&&f.closePath();N&&5!==j&&f.closePath()}else{var V,Q,l,U=P.length;if(U>0){for(V=P[0],f.moveTo(V.x,u?-V.y:V.y),Q=1;U>Q;Q++)l=P[Q],f.lineTo(l.x,u?-l.y:l.y);N&&f.closePath()}}},xk=function(Z,d,V,X){if(so(Z)&&(Z=Z._as),so(d)&&(d=d._as),d&&d.length){V=V||Bc;for(var D,z,a,u,m,p,c,C,$=[],k=h,y=0,n=0,t=d.length;t>n;n++)if(D=d[n],1===D)$.push(k=[]),k.push(Z[y++]);else if(2===D)k.push(Z[y++]);else if(3===D){for(z=k[k.length-1],a=Z[y++],u=Z[y++],p=1;V>p;p++)c=Ud(p/V,z.x,a.x,u.x),C=Ud(p/V,z.y,a.y,u.y),k.push({x:c,y:C,b:!0});k.push(u)}else if(4===D){for(z=k[k.length-1],a=Z[y++],u=Z[y++],m=Z[y++],p=1;V>p;p++)c=Jo(p/V,z.x,a.x,u.x,m.x),C=Jo(p/V,z.y,a.y,u.y,m.y),k.push({x:c,y:C,b:!0});k.push(m)}else 5===D&&k.push(k[0]);return X&&5!==D&&k&&k.length>2&&k.push(k[0]),$}return X&&Z.length>2&&(Z=Z.slice(),Z.push(Z[0])),Z?[Z]:[]},Wo=function(L,G,w,l,D,E){var z,K,I,n=gg(G),m=l,V=n[0],_=n[1],F=n[2];if(w){var C=gg(w);z=C[0]-V,K=C[1]-_,I=C[2]-F}else z=255-V,K=255-_,I=255-F;for(E||(E=l>10?1:.5,E=1>D?v(E/D,2):E),L.save(),L.shadowOffsetX=0,L.shadowOffsetY=0,L.shadowBlur=0,L.shadowColor=0;(l-=E)>0;){var o=1-l/m,J=V+z*o,b=_+K*o,j=F+I*o;J=v(g(J),255),b=v(g(b),255),j=v(g(j),255),L.strokeStyle="rgb("+J+","+b+","+j+")",L.lineWidth=l,L.stroke()}L.restore()},sd=function(){if(Dq&&H){var d=H+""||jp;Kl=d.indexOf(Ce.substr(0,2))>0&&d.indexOf(Pi+Pi.substr(1,1))>1?!0:!1}var D={};return function(m,x){var z=m+"-"+x,J=D[z];if(J)return J;var B,r,Z,w=gg(m);return 0>x?(x=(100+x)/100,B=g(w[0]*x),r=g(w[1]*x),Z=g(w[2]*x)):(x/=100,B=w[0],r=w[1],Z=w[2],B+=(255-B)*x,r+=(255-r)*x,Z+=(255-Z)*x,B=v(g(B),255),r=v(g(r),255),Z=v(g(Z),255)),D[z]="rgb("+B+","+r+","+Z+")"}}(),Tj=function(x,H,z,o,a,I){I&&(x.fillStyle=I),x.beginPath(),x.rect(H,z,o,a),x.fill()},yn=function(u,f,F,l,k,H,X){u.beginPath(),Ic[f](u,F.x,F.y,F.width,F.height,l,k,H,X)},Em=function(b,W,H,R,Z){var M=Ic[H];b.fillStyle=M?M(b,W,R?R:vb,Z.x,Z.y,Z.width,Z.height):W},ok=function(q,A,v,M,U,P){q.fillStyle=_e(q,A,v,M,U,P)},Rq=function(T,h,U,j,N,g){T.strokeStyle=_e(T,h,U,j,N,g)},_e=function(s,z,t,Z,X,c){var $;try{if(!z.tagName&&z.comps){z._cacheImage_||(z._cacheImage_={});var K;K="override"===Z?"colors_override":"override_rgb"===Z?"colors_override_rgb":"override_a"===Z?"colors_override_a":"colors",z._cacheImage_[K]||(z._cacheImage_[K]={__count__:0});var b=z._cacheImage_[K][t];b||(z._cacheImage_[K].__count__>l.imageCacheThreshold&&(z._cacheImage_[K]={__count__:0}),b=R.Default.toCanvas(z,sm(z),wq(z),null,X,c,t,null,Z),z._cacheImage_[K][t]=b,z._cacheImage_[K].__count__++),z=b}$=s.createPattern(z,"repeat")}catch(O){$="black"}return $},sl=function(R){var K,V,g=[],W=0,m=R.length;for(K=0;65>K;K++)g[K]=K;for(K=0;65>K;K++)W=(W+g[K]+R.charCodeAt(K%m))%65,V=g[K],g[K]=g[W],g[W]=V;for(K=0;65>K;K++)g[K]=kj[g[K]];return g.join("")},Hc=function(g){for(var t=8+Np.randomInt(8),k=kj[8*Np.randomInt(8)+(t-8)],F="",x=0;t>x;x++)F+=kj[Np.randomInt(64)];var s=sl(F+z+ps+Mp);return k+F+Zd.encode(g,s)},Fn=function(b){var W=b[0],Q=kj.indexOf(W);if(0>Q)return"";Q=8+(7&Q);var L=b.slice(1,1+Q),c=sl(L+z+ps+Mp);
return Zd.decode(b,c,1+Q)},_h=function(R,D,P,i,L,k,d){R.save(),R.translate(D,P),R.scale(1,d/k),R.arc(0,0,k,i,L),R.restore()},Je=function(V,f,O,b,X,r,n,W){var Q,R,N,T,w,L,Y,B,v,t,e;if($(X)>2*S&&(X=2*S),w=g($(X)/(S/4)),Q=X/w,R=-Q,N=-b,w>0){L=f+d(b)*r,Y=O+a(-b)*n,W?V.lineTo(L,Y):V.moveTo(L,Y);for(var l=0;w>l;l++)N+=R,T=N-R/2,B=f+d(N)*r,v=O+a(N)*n,t=f+d(T)*(r/d(R/2)),e=O+a(T)*(n/d(R/2)),V.quadraticCurveTo(t,e,B,v)}},Bf=function(f,T,o,S,Z,q,z,E,u){6===arguments.length&&(z=q,E=q,u=q);var d=T+S,k=o+Z,D=Z>S?2*S:2*Z;q=D>q?q:D,z=D>z?z:D,E=D>E?E:D,u=D>u?u:D;var r=.29*u,x=.58*u;f.moveTo(d,k-u),f.quadraticCurveTo(d,k-x,d-r,k-r),f.quadraticCurveTo(d-x,k,d-u,k),r=.29*E,x=.58*E,f.lineTo(T+E,k),f.quadraticCurveTo(T+x,k,T+r,k-r),f.quadraticCurveTo(T,k-x,T,k-E),r=.29*q,x=.58*q,f.lineTo(T,o+q),f.quadraticCurveTo(T,o+x,T+r,o+r),f.quadraticCurveTo(T+x,o,T+q,o),r=.29*z,x=.58*z,f.lineTo(d-z,o),f.quadraticCurveTo(d-x,o,d-r,o+r),f.quadraticCurveTo(d,o+x,d,o+z),f.lineTo(d,k-u)},ge=function(s,p,f,n,v,W,m){p&&(f=A(f),n=A(n),m||(m=1),s.fillStyle=p,s.beginPath(),s.rect(f,n,m,W),s.rect(f,n,v,m),W-m>0&&s.rect(f,n+W-m,v,m),v-m>0&&s.rect(f+v-m,n,m,W),s.fill())},tf=function(h,k,B,X){var F=X.x,M=X.y,m=X.width,L=X.height;if(!(!k||!B||0>=m||0>=L)){var K,H=wp(k),O=Qi(k),J=B>0;1===B||-1===B?(h.fillStyle=J?H:O,h.beginPath(),h.rect(F,M,1,L),h.rect(F,M,m,1),h.fill(),h.fillStyle=J?O:H,h.beginPath(),h.rect(F,M+L-1,m,1),h.rect(F+m-1,M,1,L),h.fill()):(B=v($(B),v(m/2,L/2)),K=h.createLinearGradient(F,M,F+B,M),K.addColorStop(0,J?H:O),K.addColorStop(1,k),h.fillStyle=K,h.beginPath(),h.moveTo(F,M),h.lineTo(F+B,M+B),h.lineTo(F+B,M+L-B),h.lineTo(F,M+L),h.lineTo(F,M),h.fill(),K=h.createLinearGradient(F,M,F,M+B),K.addColorStop(0,J?H:O),K.addColorStop(1,k),h.fillStyle=K,h.beginPath(),h.moveTo(F,M),h.lineTo(F+B,M+B),h.lineTo(F+m-B,M+B),h.lineTo(F+m,M),h.lineTo(F,M),h.fill(),K=h.createLinearGradient(F,M+L,F,M+L-B),K.addColorStop(0,J?O:H),K.addColorStop(1,k),h.fillStyle=K,h.beginPath(),h.moveTo(F,M+L),h.lineTo(F+B,M+L-B),h.lineTo(F+m-B,M+L-B),h.lineTo(F+m,M+L),h.lineTo(F,M+L),h.fill(),K=h.createLinearGradient(F+m,M,F+m-B,M),K.addColorStop(0,J?O:H),K.addColorStop(1,k),h.fillStyle=K,h.beginPath(),h.moveTo(F+m,M),h.lineTo(F+m-B,M+B),h.lineTo(F+m-B,M+L-B),h.lineTo(F+m,M+L),h.lineTo(F+m,M),h.fill())}},mp=function(Z,v,V,E,Q,B,q){var l=Z.createLinearGradient(E,Q,B,q);return l.addColorStop(0,V),l.addColorStop(1,v),l},De=function(X,j,y,l,K,W,L){var f=X.createLinearGradient(l,K,W,L);return f.addColorStop(0,j),f.addColorStop(.5,y),f.addColorStop(1,j),f},es=function(D,V,G,i,T,p,d){var I=D.createLinearGradient(i,T,p,d);return I.addColorStop(0,V),I.addColorStop(1/3,G),I.addColorStop(2/3,V),I.addColorStop(1,G),I},fh=function(H,a,d,b,O,C,t,Q,h){var T=H.createRadialGradient(b+C*Q,O+t*h,v(C,t)/24,b+C/2,O+t/2,I(C,t)/2);return T.addColorStop(0,d),T.addColorStop(1,a),T},Ok=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Ic={polygon:function(g,t,F,I,Z,R){(R==h||3>R)&&(R=6);for(var C,W,X=v(I,Z)/2,J=t+I/2,Q=F+Z/2,o=0,T=2*S/R,D=0;R>D;D++)C=J+d(o)*X,W=Q+a(o)*X,0===D?g.moveTo(C,W):g.lineTo(C,W),o+=T;g.closePath()},arc:function(j,o,E,y,p,H,V,t,O){H==h&&(H=S),V==h&&(V=Q),t==h&&(t=!0);var n=o+y/2,F=E+p/2;t&&j.moveTo(n,F),O?_h(j,n,F,H,V,y/2,p/2):j.arc(n,F,v(y,p)/2,H,V),t&&j.closePath()},rect:function(L,M,V,Y,B){L.rect(M,V,Y,B)},circle:function(a,K,d,H,R){a.arc(K+H/2,d+R/2,v(H,R)/2,0,Q,!0)},oval:function(l,b,q,P,M){_h(l,b+P/2,q+M/2,0,Q,P/2,M/2)},roundRect:function(F,q,x,e,C,W){W==h&&(W=v(v(e,C)/4,8)),Bf(F,q,x,e,C,W)},star:function(f,M,Z,_,k){var w=2*_,G=2*k,t=M+_/2,b=Z+k/2;f.moveTo(t-w/4,b-G/12),f.lineTo(M+.306*_,Z+.579*k),f.lineTo(t-w/6,b+G/4),f.lineTo(M+_/2,Z+.733*k),f.lineTo(t+w/6,b+G/4),f.lineTo(M+.693*_,Z+.579*k),f.lineTo(t+w/4,b-G/12),f.lineTo(M+.611*_,Z+.332*k),f.lineTo(t+0,b-G/4),f.lineTo(M+.388*_,Z+.332*k),f.closePath()},pentagram:function(e,f,D,_,N){var k=.5*N,b=f+.5*_,L=D+k,A=.5257311121191336*_;A>k&&(A=k);var M=Ok,G=0;for(e.moveTo(b+A*M[G++],L+A*M[G++]);20>G;)e.lineTo(b+A*M[G++],L+A*M[G++]);e.closePath()},triangle:function(N,O,_,K,r){N.moveTo(O+K/2,_),N.lineTo(O+K,_+r),N.lineTo(O,_+r),N.closePath()},hexagon:function(F,h,b,l,U){F.moveTo(h,b+U/2),F.lineTo(h+l/4,b+U),F.lineTo(h+3*l/4,+b+U),F.lineTo(h+l,b+U/2),F.lineTo(h+3*l/4,b),F.lineTo(h+l/4,b),F.closePath()},pentagon:function(E,I,A,N,s){var U=2*N,Z=2*s,d=I+N/2,z=A+s/2;E.moveTo(d-U/4,z-Z/12),E.lineTo(d-U/6,z+Z/4),E.lineTo(d+U/6,z+Z/4),E.lineTo(d+U/4,z-Z/12),E.lineTo(d+0,z-Z/4),E.closePath()},diamond:function(M,v,X,k,i){M.moveTo(v+k/2,X),M.lineTo(v,X+i/2),M.lineTo(v+k/2,X+i),M.lineTo(v+k,X+i/2),M.closePath()},rightTriangle:function(v,U,R,W,Q){v.moveTo(U,R),v.lineTo(U+W,R+Q),v.lineTo(U,R+Q),v.closePath()},parallelogram:function(j,O,g,h,o){var a=h/4;j.moveTo(O+a,g),j.lineTo(O+h,g),j.lineTo(O+h-a,g+o),j.lineTo(O,g+o),j.closePath()},trapezoid:function(H,S,W,L,P){var x=L/4;H.moveTo(S+x,W),H.lineTo(S+L-x,W),H.lineTo(S+L,W+P),H.lineTo(S,W+P),H.closePath()},"linear.southwest":function(I,d,v,F,T,P,H){return mp(I,d,v,F,T+H,F+P,T)},"linear.southeast":function(A,c,o,x,Y,M,Q){return mp(A,c,o,x+M,Y+Q,x,Y)},"linear.northwest":function(Q,g,S,V,C,w,m){return mp(Q,g,S,V,C,V+w,C+m)},"linear.northeast":function(l,Y,E,d,r,X,P){return mp(l,Y,E,d+X,r,d,r+P)},"linear.north":function(g,H,S,o,d,n,z){return mp(g,H,S,o,d,o,d+z)},"linear.south":function($,C,F,G,D,n,U){return mp($,C,F,G,D+U,G,D)},"linear.west":function(k,u,a,e,q,A){return mp(k,u,a,e,q,e+A,q)},"linear.east":function(i,j,t,Y,D,V){return mp(i,j,t,Y+V,D,Y,D)},"radial.center":function(h,s,W,u,P,d,l){return fh(h,s,W,u,P,d,l,.5,.5)},"radial.southwest":function(X,g,o,s,l,t,I){return fh(X,g,o,s,l,t,I,.25,.75)},"radial.southeast":function(A,v,G,M,p,U,j){return fh(A,v,G,M,p,U,j,.75,.75)},"radial.northwest":function(N,g,P,x,f,d,o){return fh(N,g,P,x,f,d,o,.25,.25)},"radial.northeast":function(c,P,Y,H,A,m,J){return fh(c,P,Y,H,A,m,J,.75,.25)},"radial.north":function(Y,W,w,U,J,o,D){return fh(Y,W,w,U,J,o,D,.5,.25)},"radial.south":function(O,N,H,i,o,q,w){return fh(O,N,H,i,o,q,w,.5,.75)},"radial.west":function(y,i,k,_,f,E,l){return fh(y,i,k,_,f,E,l,.25,.5)},"radial.east":function(W,m,d,u,G,i,f){return fh(W,m,d,u,G,i,f,.75,.5)},"spread.horizontal":function(o,m,k,a,j,i){return De(o,m,k,a,j,a+i,j)},"spread.vertical":function(L,Q,k,x,V,Z,M){return De(L,Q,k,x,V,x,V+M)},"spread.diagonal":function(H,b,x,l,t,X,u){return De(H,b,x,l+X,t,l,t+u)},"spread.antidiagonal":function(w,N,L,Y,$,m,z){return De(w,N,L,Y,$,Y+m,$+z)},"spread.north":function(D,Q,u,J,k,G,c){return es(D,Q,u,J,k-c/4,J,k+c+c/4)},"spread.south":function(M,D,P,b,R,O,E){return es(M,P,D,b,R-E/4,b,R+E+E/4)},"spread.west":function(D,z,R,I,q,x){return es(D,z,R,I-x/4,q,I+x+x/4,q)},"spread.east":function(M,u,t,o,s,L){return es(M,t,u,o-L/4,s,o+L+L/4,s)}},ai=function(O,G,h){return new uk(O).tf(G,h)},Mc=function(M){var g=M.touches[0],V=M.touches[1],P=g.clientX,Q=g.clientY,x=V.clientX,p=V.clientY;return m((P-x)*(P-x)+(Q-p)*(Q-p))},tb=function(Y){var i=Y.touches[0],q=Y.touches[1],F=i.clientX,y=i.clientY,N=q.clientX,X=q.clientY;return{x:(F+N)/2,y:(y+X)/2}},rh=(function(){for(var u=0,R=Vn.split(""),J=0;J<R.length;J++)u=10*Bn(R[J])+u;return Tf(P[Bp.toString(8*J)+Cn.substr(J)+3],P[Bp.toString(8*J)+Cn.substr(J)+4]),u}(),function(P,i,Z){for(var I=0;I<Z.size();I++){var j=Z.get(I);P.co(j)&&i.add(j)}for(I=0;I<Z.size();I++)j=Z.get(I),rh(P,i,j._children)}),sb=function(L,G,v){for(var K=0;K<v.size();K++){var S=v.get(v.size()-1-K);L.co(S)&&G.add(S)}for(K=0;K<v.size();K++)S=v.get(K),sb(L,G,S._children)},Qn=function(H,s,c){for(var d=!1,q=0;q<c.size();q++){var p=c.get(q);H.co(p)?d&&s.add(p):d=1}for(q=0;q<c.size();q++)p=c.get(q),Qn(H,s,p._children)},qn=function(w,F,D){for(var q=!1,u=0;u<D.size();u++){var P=D.get(D.size()-1-u);w.co(P)?q&&F.add(P):q=!0}for(u=0;u<D.size();u++)P=D.get(u),qn(w,F,P._children)},Wg=l.moveDatas=function($,i,m,x){var p=x==h;if(0!==i||0!==m||!p&&0!==x){var r=!0,O=[];if($.forEach(function(o){r&&(o._69O||hq(o)||Ug(o))&&(r=!1)}),r)O=$;else{var F={},R={};$.forEach(function(w){F[w._id]=!0});var K={},k=function(l){var V=l._id;return F[V]?(O.push(l),K[V]=!0):K[V]=!1},I=function(t){var C=t._id;if(R[C])return k(t);var d=K[C];if(d!==B)return d;var T=t._parent;if(T&&(Ug(T)||hq(T))&&I(T))return K[C]=!0;var Z=t._host;return Z&&(R[C]=C,d=I(Z),R[C]=B,d)?K[C]=!0:k(t)};$.forEach(function(y){I(y)})}O.forEach(function(J){if(Tn(J))p?J.translate(i,m):J.translate3d(i,m,x);else{var u=J.s(gr);if(!u||u.isEmpty())return;var N=new bp;u.each(function(a){a=lg(a),p?(a.x+=i,a.y+=m):(a.x+=i,a.y+=x,a.e==h?a.e=m:a.e+=m),N.add(a)}),J.s(gr,N)}})}},Rp=function(){function R(H,S){return S===H.substring(0,S.length)?!0:!1}function S(F){return parseFloat(F)||0}function o(N,C){if(C==B&&(C=new Jb),R(N,"matrix3d")){var T=N.substring(9,N.length-1).split(",");T=T.map(S),C.fromArray(T)}else if(R(N,"matrix")){var T=N.substring(7,N.length-1).split(",");T=T.map(S),C.el[0]=T[0],C.el[1]=T[1],C.el[2]=0,C.el[3]=0,C.el[4]=T[2],C.el[5]=T[3],C.el[6]=0,C.el[7]=0,C.el[8]=0,C.el[9]=0,C.el[10]=1,C.el[11]=0,C.el[12]=T[4],C.el[13]=T[5],C.el[14]=0,C.el[15]=1}return C}function O(A,H){H==B&&(H=new qp);var f=A.split(/\s+/);return f=f.map(S),H.set(f[0]||0,f[1]||0,f[2]||0),H}var h,T,K,E,e,X=function(f,C){h||(h=new Jb,T=new qp,K=new Jb,E=new Jb,e=new Jb),C==B&&(C=new Jb);var w=getComputedStyle(f);w.transform&&"none"!==w.transform&&(o(w.transform,h),O(w.transformOrigin,T),E.setPosition(T),T.negate(),e.setPosition(T),(Sj||"preserve-3d"!==w.transformStyle)&&(h.el[8]=0,h.el[9]=0,h.el[10]=1,h.el[11]=0),C.multiplyMatrices(e,C),C.multiplyMatrices(h,C),C.multiplyMatrices(E,C)),!Sj&&w.perspective&&"none"!==w.perspective&&(K.el[11]=-1/S(w.perspective),O(w.perspectiveOrigin,T),E.setPosition(T),T.negate(),e.setPosition(T),C.multiplyMatrices(e,C),C.multiplyMatrices(K,C),C.multiplyMatrices(E,C));for(var G=f.offsetParent,l=f.offsetLeft,u=f.offsetTop,j=f.parentElement;j&&j!==G;){var k=getComputedStyle(j);if("none"!==k.transform||"none"!==k.perspective)break;j=j.parentElement}return j==B&&f!==f.ownerDocument.documentElement&&"fixed"!==w.position&&(j=f.ownerDocument.documentElement),G!=B&&G!==j&&(l-=j.offsetLeft,u-=j.offsetTop),T.set(l,u,0),E.setPosition(T),C.multiplyMatrices(E,C),j&&X(j,C),C};return function(F,L){var u=F.parentElement;if(u){var r=u.updateAppendMatrix;if(r){delete u.updateAppendMatrix;var O=new Jb;X(u,O);var S=new Jb;S.getInverse(O),u._matrixAppend=S,u._maxrixPreAppend=O}return L?u._matrixAppend:u._maxrixPreAppend}}}(),sf=function(b,S){for(;b&&!b.hasOwnProperty(S);)b=w.getPrototypeOf(b);return b&&w.getOwnPropertyDescriptor(b,S)},Zq=w.getPrototypeOf?function(O,l,n){var o=sf(l,n);o&&w.defineProperty(O,n,o)}:function(S,L,s){S[s]=L[s]},Dh={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Fj=function(){var N={1:function(q,C){return{x:q.x-C.width/2,y:q.y-C.height/2}},2:function(c,f){return{x:c.x+f.width/2,y:c.y-f.height/2}},3:function(Q,p){return{x:Q.x+Q.width/2,y:Q.y-p.height/2}},4:function(w,T){return{x:w.x+w.width-T.width/2,y:w.y-T.height/2}},5:function(y,i){return{x:y.x+y.width+i.width/2,y:y.y-i.height/2}},6:function(u){return{x:u.x,y:u.y}},7:function(t){return{x:t.x+t.width/2,y:t.y}},8:function(D){return{x:D.x+D.width,y:D.y}},9:function(y,Y){return{x:y.x-Y.width/2,y:y.y+Y.height/2}},10:function(j,i){return{x:j.x+i.width/2,y:j.y+i.height/2}},11:function(n,A){return{x:n.x+n.width/2,y:n.y+A.height/2}},12:function(d,c){return{x:d.x-c.width/2+d.width,y:d.y+c.height/2}},13:function(O,U){return{x:O.x+O.width+U.width/2,y:O.y+U.height/2}},14:function(b,J){return{x:b.x-J.width/2,y:b.y+b.height/2}},15:function(r){return{x:r.x,y:r.y+r.height/2}},16:function(W,t){return{x:W.x+t.width/2,y:W.y+W.height/2}},17:function(z){return{x:z.x+z.width/2,y:z.y+z.height/2}},18:function(Q,T){return{x:Q.x+Q.width-T.width/2,y:Q.y+Q.height/2}},19:function(s){return{x:s.x+s.width,y:s.y+s.height/2}},20:function(x,s){return{x:x.x+x.width+s.width/2,y:x.y+x.height/2}},21:function(g,q){return{x:g.x-q.width/2,y:g.y+g.height-q.height/2}},22:function(X,W){return{x:X.x+W.width/2,y:X.y+X.height-W.height/2}},23:function(J,F){return{x:J.x+J.width/2,y:J.y+J.height-F.height/2}},24:function(J,l){return{x:J.x+J.width-l.width/2,y:J.y+J.height-l.height/2}},25:function(Q,S){return{x:Q.x+Q.width+S.width/2,y:Q.y+Q.height-S.height/2}},26:function(v){return{x:v.x,y:v.y+v.height}},27:function(B){return{x:B.x+B.width/2,y:B.y+B.height}},28:function(A){return{x:A.x+A.width,y:A.y+A.height}},29:function(b,F){return{x:b.x-F.width/2,y:b.y+b.height+F.height/2}},30:function(C,e){return{x:C.x+e.width/2,y:C.y+C.height+e.height/2}},31:function(P,V){return{x:P.x+P.width/2,y:P.y+P.height+V.height/2}},32:function(f,M){return{x:f.x+f.width-M.width/2,y:f.y+f.height+M.height/2}},33:function(I,w){return{x:I.x+I.width+w.width/2,y:I.y+I.height+w.height/2}},34:function(R,u){return{x:R.x,y:R.y-u.height/2}},35:function(l,V){return{x:l.x+l.width,y:l.y-V.height/2}},36:function(C,h){return{x:C.x,y:C.y+C.height+h.height/2}},37:function(v,D){return{x:v.x+v.width,y:v.y+v.height+D.height/2}},38:function(P,S){return{x:P.x+P.width/4,y:P.y-S.height/2}},39:function(e,U){return{x:e.x+3*e.width/4,y:e.y-U.height/2}},40:function(F){return{x:F.x+F.width/4,y:F.y}},41:function(z){return{x:z.x+3*z.width/4,y:z.y}},42:function(j,_){return{x:j.x+j.width/4,y:j.y+_.height/2}},43:function(i,S){return{x:i.x+3*i.width/4,y:i.y+S.height/2}},44:function(m,_){return{x:m.x+m.width/2,y:m.y+m.height/2-_.height/2}},45:function(y){return{x:y.x+y.width/4,y:y.y+y.height/2}},46:function(K,w){return{x:K.x+K.width/2-w.width/2,y:K.y+K.height/2}},47:function(N,b){return{x:N.x+N.width/2+b.width/2,y:N.y+N.height/2}},48:function(t){return{x:t.x+3*t.width/4,y:t.y+t.height/2}},49:function(H,d){return{x:H.x+H.width/2,y:H.y+H.height/2+d.height/2}},50:function(q,k){return{x:q.x+q.width/4,y:q.y+q.height-k.height/2}},51:function(M,R){return{x:M.x+3*M.width/4,y:M.y+M.height-R.height/2}},52:function(W){return{x:W.x+W.width/4,y:W.y+W.height}},53:function(o){return{x:o.x+3*o.width/4,y:o.y+o.height}},54:function(H,u){return{x:H.x+H.width/4,y:H.y+H.height+u.height/2}},55:function(N,v){return{x:N.x+3*N.width/4,y:N.y+N.height+v.height/2}}};return qj(P)?function(Y,o,C){return N[Y](o,C?C:zn)}:void 0}();sq(V,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var he=V.reverse,xl=V.transparent,rs=V.rectSelectBackground,Rl=V.dash,bd=V.titleBackground,Vr=V.titleIconBackground,Ed=V.headerBackground,fp=V.headerIconBackground,Ik=V.headerSeparator,qk=V.headerLine,Wh=V.contentIconBackground,gq=V.contentLine,hm=(V.widgetIconHighlight,V.widgetIconBorder),te=(V.widgetIconGradient,V.imageBackground),vb=V.imageGradient,ag=V.highlight,wm=V.label,Rj=V.labelSelect;if(up&&!P.shutAlert1){var Ui=new Date,wi=up.split("-"),Xg=new Date(Ui.getFullYear(),Ui.getMonth(),Ui.getDate()),up=new Date(Bn(wi[0],10),Bn(wi[1],10)-1,Bn(wi[2],10)),Ao=Xg.getTime(),nq=up.getTime(),lc=z+"_try",Ym=P.alert;try{var zc=P.localStorage;if(zc&&Ym)if(nq>Ao&&1728e6>nq-Ao){var Td=(nq-Ao)/864e5;zc&&zc[lc]!=Td&&(zc[lc]=Td,P.htWillExpire?Ym(P.htWillExpire.replace("{{day}}",Td)):Ym("HT for Web free trial license will expire in "+Td+" days, please apply for a new license!"))}else Ao>=nq&&(P.htExpired?Ym(P.htExpired):Ym("Your free trial of HT for Web has expired!")),zc&&delete zc[lc]}catch(Bq){}}Math.sign===B&&(Math.sign=function(l){return 0>l?-1:l>0?1:+l});var kj="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Zd={encode:function(X,p){var Q,P,K,T,B,F,u,d="",o=0;for(X=unescape(encodeURIComponent(X));o<X.length;)Q=X.charCodeAt(o++),P=X.charCodeAt(o++),K=X.charCodeAt(o++),T=Q>>2,B=(3&Q)<<4|P>>4,F=(15&P)<<2|K>>6,u=63&K,isNaN(P)?F=u=64:isNaN(K)&&(u=64),d=d+p.charAt(T)+p.charAt(B)+p.charAt(F)+p.charAt(u);return d},decode:function(b,h,O){for(var w,i,R,G,F,D,U,o="",k=O||0;k<b.length;)G=h.indexOf(b.charAt(k++)),F=h.indexOf(b.charAt(k++)),D=h.indexOf(b.charAt(k++)),U=h.indexOf(b.charAt(k++)),w=G<<2|F>>4,i=(15&F)<<4|D>>2,R=(3&D)<<6|U,o+=String.fromCharCode(w),64!=D&&(o+=String.fromCharCode(i)),64!=U&&(o+=String.fromCharCode(R));return o=decodeURIComponent(escape(o))},_utf8_encode:function(b){b=b.replace(/\r\n/g,"\n");for(var f="",B=0;B<b.length;B++){var u=b.charCodeAt(B);128>u?f+=String.fromCharCode(u):u>127&&2048>u?(f+=String.fromCharCode(192|u>>6),f+=String.fromCharCode(128|63&u)):(f+=String.fromCharCode(224|u>>12),f+=String.fromCharCode(128|63&u>>6),f+=String.fromCharCode(128|63&u))}return f},_utf8_decode:function(y){for(var x="",a=0,W=0,J=0,T=0;a<y.length;)W=y.charCodeAt(a),128>W?(x+=String.fromCharCode(W),a++):W>191&&224>W?(J=y.charCodeAt(a+1),x+=String.fromCharCode((31&W)<<6|63&J),a+=2):(J=y.charCodeAt(a+1),T=y.charCodeAt(a+2),x+=String.fromCharCode((15&W)<<12|(63&J)<<6|63&T),a+=3);return x}},$g=[],Zi=[],Np=R.Math={generateUUID:function(){for(var S=[],y=0;256>y;y++)S[y]=(16>y?"0":"")+y.toString(16).toUpperCase();return function(){var h=0|4294967295*Math.random(),l=0|4294967295*Math.random(),U=0|4294967295*Math.random(),n=0|4294967295*Math.random();return S[255&h]+S[255&h>>8]+S[255&h>>16]+S[255&h>>24]+"-"+S[255&l]+S[255&l>>8]+"-"+S[64|15&l>>16]+S[255&l>>24]+"-"+S[128|63&U]+S[255&U>>8]+"-"+S[255&U>>16]+S[255&U>>24]+S[255&n]+S[255&n>>8]+S[255&n>>16]+S[255&n>>24]}}(),clamp:function(p,b,a){return Math.max(b,Math.min(a,p))},generateIncreasingID:function(){var n=0;return function(){return++n}}(),encodeBase64:function(O,V){return Zd.encode(O,V||kj)},decodeBase64:function(c,b){return Zd.decode(c,b||kj)},randomArray:function(R,E){E=E||R.length;for(var I=E-1;I>0;I--){var A=Math.floor(Math.random()*(I+1)),N=R[I];R[I]=R[A],R[A]=N}return R},randomInt:function(l,r){return r===B&&(r=l,l=0),l+Math.floor(Math.random()*(r-l))},isPOT:function(z){return z>0&&0===(z-1&z)},nearestPOT:function(T){if(!T)return 1;var M=T;M--,M|=M>>1,M|=M>>2,M|=M>>4,M|=M>>8,M|=M>>16,M++;var s=M>>1;return T-s>M-T?M:s},requestMatrix4:function(){return $g.length>0?$g.pop():new Np.Matrix4},releaseMatrix4:function(t){$g.push(t)},requestVector3:function(){return Zi.length>0?Zi.pop():new Np.Vector3},releaseVector3:function(J){Zi.push(J)}},lj=R.Matrix=R.Math.Matrix2d=function(r,F,b,H,I){this.setFromTransform(r,F,b,H,I)},uk=lj;lj.prototype={},lj.prototype.constructor=lj,lj.prototype.set=function(h,u,m,F,L,e){return this.a=h,this.b=u,this.c=m,this.d=F,this.tx=L,this.ty=e,this},lj.prototype.setFromTransform=function(n,V,L,N,m){var Q=this;if(n===B)return Q.a=1,Q.b=0,Q.c=0,Q.d=1,Q.tx=0,Q.ty=0,void 0;var O,r;return n?(O=a(n),r=d(n)):(O=0,r=1),N=N||1,m=m||1,Q.a=r*N,Q.b=O*N,Q.c=-O*m,Q.d=r*m,Q.tx=V||0,Q.ty=L||0,Q},lj.prototype.apply=function(m,S){S=S||new ph;var J=m.x,V=m.y;return S.x=this.a*J+this.c*V+this.tx,S.y=this.b*J+this.d*V+this.ty,S},lj.prototype.applyInverse=function(S,k){k=k||new ph;var $=1/(this.a*this.d+this.c*-this.b),E=S.x,c=S.y;return k.x=this.d*$*E+-this.c*$*c+(this.ty*this.c-this.tx*this.d)*$,k.y=this.a*$*c+-this.b*$*E+(-this.ty*this.a+this.tx*this.b)*$,k},lj.prototype.translate=function(n,Z){return this.tx+=n,this.ty+=Z,this},lj.prototype.scale=function(m,f){return this.a*=m,this.d*=f,this.c*=m,this.b*=f,this.tx*=m,this.ty*=f,this},lj.prototype.rotate=function(P){var G=Math.cos(P),M=Math.sin(P),e=this.a,b=this.c,l=this.tx;return this.a=e*G-this.b*M,this.b=e*M+this.b*G,this.c=b*G-this.d*M,this.d=b*M+this.d*G,this.tx=l*G-this.ty*M,this.ty=l*M+this.ty*G,this},lj.prototype.appendTranslate=function(l,m){return this.tx+=this.a*l+this.c*m,this.ty+=this.b*l+this.d*m,this},lj.prototype.appendScale=function(x,N){return this.a*=x,this.d*=N,this.c*=N,this.b*=x,this},lj.prototype.appendRotate=function(m){if(!m)return this;var u=Math.cos(m),g=Math.sin(m),k=this.a,$=this.b;return this.a=k*u+this.c*g,this.b=$*u+this.d*g,this.c=-k*g+this.c*u,this.d=-$*g+this.d*u,this},lj.prototype.append=function(p){var P=this.a,O=this.b,e=this.c,s=this.d;return this.a=p.a*P+p.b*e,this.b=p.a*O+p.b*s,this.c=p.c*P+p.d*e,this.d=p.c*O+p.d*s,this.tx=p.tx*P+p.ty*e+this.tx,this.ty=p.tx*O+p.ty*s+this.ty,this},lj.prototype.setTransform=function(h,S,Z,J,O,x,q,Y,g){var G,e,I,m,D,n,k,f,A,b;return D=Math.sin(q),n=Math.cos(q),k=Math.cos(g),f=Math.sin(g),A=-Math.sin(Y),b=Math.cos(Y),G=n*O,e=D*O,I=-D*x,m=n*x,this.a=k*G+f*I,this.b=k*e+f*m,this.c=A*G+b*I,this.d=A*e+b*m,this.tx=h+(Z*G+J*I),this.ty=S+(Z*e+J*m),this},lj.prototype.prepend=function(Y){var i=this.tx;if(1!==Y.a||0!==Y.b||0!==Y.c||1!==Y.d){var S=this.a,h=this.c;this.a=S*Y.a+this.b*Y.c,this.b=S*Y.b+this.b*Y.d,this.c=h*Y.a+this.d*Y.c,this.d=h*Y.b+this.d*Y.d}return this.tx=i*Y.a+this.ty*Y.c+Y.tx,this.ty=i*Y.b+this.ty*Y.d+Y.ty,this},lj.prototype.transform=lj.prototype.prepend,lj.prototype.invert=function(){var m=this.a,X=this.b,B=this.c,G=this.d,E=this.tx,y=m*G-X*B;return this.a=G/y,this.b=-X/y,this.c=-B/y,this.d=m/y,this.tx=(B*this.ty-G*E)/y,this.ty=-(m*this.ty-X*E)/y,this},lj.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},lj.prototype.clone=function(){var K=new lj;return K.a=this.a,K.b=this.b,K.c=this.c,K.d=this.d,K.tx=this.tx,K.ty=this.ty,K},lj.prototype.copy=function(M){return M.a=this.a,M.b=this.b,M.c=this.c,M.d=this.d,M.tx=this.tx,M.ty=this.ty,M},lj.prototype.tf=function(K,J){1===arguments.length&&(J=K.y,K=K.x);var f=this;return{x:f.a*K+f.c*J+f.tx,y:f.b*K+f.d*J+f.ty}},lj.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},lj.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},lj.prototype.tfi=function(g,Q){1===arguments.length&&(Q=g.y,g=g.x);var c=this,o=1/(c.a*c.d+c.c*-c.b);return{x:c.d*o*g+-c.c*o*Q+(c.ty*c.c-c.tx*c.d)*o,y:c.a*o*Q+-c.b*o*g+(-c.ty*c.a+c.tx*c.b)*o}},lj.IDENTITY=new lj,lj.TEMP_MATRIX=new lj;var wh=R.Math.Quaternion=function(C,R,J,D){this.set(C,R,J,D)};w.assign(wh.prototype,{set:function(b,y,M,e){var g=this;return g._x=b||0,g._y=y||0,g._z=M||0,g._w=e!==B?e:1,g},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(I){var B=this;return B._x=I._x,B._y=I._y,B._z=I._z,B._w=I._w,B},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(g){return this._x*g._x+this._y*g._y+this._z*g._z+this._w*g._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var n=this.length();return 0===n?(this._x=0,this._y=0,this._z=0,this._w=1):(n=1/n,this._x=this._x*n,this._y=this._y*n,this._z=this._z*n,this._w=this._w*n),this},fromArray:function(Y,Z){Z===B&&(Z=0);var q=this;return q._x=Y[Z],q._y=Y[Z+1],q._z=Y[Z+2],q._w=Y[Z+3],this},slerp:function(N,T){if(0===T)return this;if(1===T)return this.copy(N);var k=this._x,t=this._y,P=this._z,V=this._w,X=V*N._w+k*N._x+t*N._y+P*N._z;if(0>X?(this._w=-N._w,this._x=-N._x,this._y=-N._y,this._z=-N._z,X=-X):this.copy(N),X>=1)return this._w=V,this._x=k,this._y=t,this._z=P,this;var i=Math.sqrt(1-X*X);if(Math.abs(i)<.001)return this._w=.5*(V+this._w),this._x=.5*(k+this._x),this._y=.5*(t+this._y),this._z=.5*(P+this._z),this;var G=Math.atan2(i,X),p=Math.sin((1-T)*G)/i,o=Math.sin(T*G)/i;return this._w=V*p+this._w*o,this._x=k*p+this._x*o,this._y=t*p+this._y*o,this._z=P*p+this._z*o,this},setFromAxisAngle:function(b,S){var F=S/2,V=Math.sin(F);return this._x=b.x*V,this._y=b.y*V,this._z=b.z*V,this._w=Math.cos(F),this},setFromEuler:function(c){var i=c._x,B=c._y,m=c._z,H=c._order,F=Math.cos,v=Math.sin,q=F(i/2),j=F(B/2),o=F(m/2),t=v(i/2),f=v(B/2),D=v(m/2);return"XYZ"===H?(this._x=t*j*o+q*f*D,this._y=q*f*o-t*j*D,this._z=q*j*D+t*f*o,this._w=q*j*o-t*f*D):"YXZ"===H?(this._x=t*j*o+q*f*D,this._y=q*f*o-t*j*D,this._z=q*j*D-t*f*o,this._w=q*j*o+t*f*D):"ZXY"===H?(this._x=t*j*o-q*f*D,this._y=q*f*o+t*j*D,this._z=q*j*D+t*f*o,this._w=q*j*o-t*f*D):"ZYX"===H?(this._x=t*j*o-q*f*D,this._y=q*f*o+t*j*D,this._z=q*j*D-t*f*o,this._w=q*j*o+t*f*D):"YZX"===H?(this._x=t*j*o+q*f*D,this._y=q*f*o+t*j*D,this._z=q*j*D-t*f*o,this._w=q*j*o-t*f*D):"XZY"===H&&(this._x=t*j*o-q*f*D,this._y=q*f*o-t*j*D,this._z=q*j*D+t*f*o,this._w=q*j*o+t*f*D),this},setFromRotationMatrix:function(N){var i,O=N.el,V=O[0],f=O[4],D=O[8],U=O[1],v=O[5],Q=O[9],_=O[2],K=O[6],F=O[10],p=V+v+F;return p>0?(i=.5/Math.sqrt(p+1),this._w=.25/i,this._x=(K-Q)*i,this._y=(D-_)*i,this._z=(U-f)*i):V>v&&V>F?(i=2*Math.sqrt(1+V-v-F),this._w=(K-Q)/i,this._x=.25*i,this._y=(f+U)/i,this._z=(D+_)/i):v>F?(i=2*Math.sqrt(1+v-V-F),this._w=(D-_)/i,this._x=(f+U)/i,this._y=.25*i,this._z=(Q+K)/i):(i=2*Math.sqrt(1+F-V-v),this._w=(U-f)/i,this._x=(D+_)/i,this._y=(Q+K)/i,this._z=.25*i),this},setFromToVectors:function(){var R,l;return function(r,e){return R===B&&(R=new qp),l=r.dot(e)+1,1e-7>l?(l=0,Math.abs(r.x)>Math.abs(r.z)?R.set(-r.y,r.x,0):R.set(0,-r.z,r.y)):R.crossVectors(r,e),this._x=R.x,this._y=R.y,this._z=R.z,this._w=l,this.normalize()}}(),setFromUnitVectors:function(){var S,R,o=1e-6;return function(W,I){return S===B&&(S=new qp),R=W.dot(I)+1,o>R?(R=0,Math.abs(W.x)>Math.abs(W.z)?S.set(-W.y,W.x,0):S.set(0,-W.z,W.y)):S.crossVectors(W,I),this._x=S.x,this._y=S.y,this._z=S.z,this._w=R,this.normalize()}}(),multiply:function(B){return this.multiplyQuaternions(this,B)},premultiply:function(C){return this.multiplyQuaternions(C,this)},multiplyQuaternions:function(X,f){var Y=X._x,C=X._y,V=X._z,b=X._w,J=f._x,S=f._y,M=f._z,m=f._w;return this._x=Y*m+b*J+C*M-V*S,this._y=C*m+b*S+V*J-Y*M,this._z=V*m+b*M+Y*S-C*J,this._w=b*m-Y*J-C*S-V*M,this},toArray:function(m,d){return m||(m=[]),d=d||0,m[d]=this._x,m[d+1]=this._y,m[d+2]=this._z,m[d+3]=this._w,m}});var bk=R.Math.Vector4=function(o,F,w,A){this.x=o||0,this.y=F||0,this.z=w||0,this.w=A!==B?A:1};w.assign(bk.prototype,{isVector4:!0,set:function(n,h,L,V){return this.x=n,this.y=h,this.z=L,this.w=V,this},setScalar:function(r){return this.x=r,this.y=r,this.z=r,this.w=r,this},setX:function(B){return this.x=B,this},setY:function($){return this.y=$,this},setZ:function(W){return this.z=W,this},setW:function(S){return this.w=S,this},setComponent:function(o,M){switch(o){case 0:this.x=M;break;case 1:this.y=M;break;case 2:this.z=M;break;case 3:this.w=M;break;default:throw new Error("index is out of range: "+o)}return this},getComponent:function(S){switch(S){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+S)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(Q){return this.x=Q.x,this.y=Q.y,this.z=Q.z,this.w=Q.w!==B?Q.w:1,this},add:function($,D){return D!==B?this.addVectors($,D):(this.x+=$.x,this.y+=$.y,this.z+=$.z,this.w+=$.w,this)},addScalar:function(U){return this.x+=U,this.y+=U,this.z+=U,this.w+=U,this},addVectors:function(j,l){return this.x=j.x+l.x,this.y=j.y+l.y,this.z=j.z+l.z,this.w=j.w+l.w,this},addScaledVector:function(q,Y){return this.x+=q.x*Y,this.y+=q.y*Y,this.z+=q.z*Y,this.w+=q.w*Y,this},sub:function(g,E){return E!==B?this.subVectors(g,E):(this.x-=g.x,this.y-=g.y,this.z-=g.z,this.w-=g.w,this)},subScalar:function(N){return this.x-=N,this.y-=N,this.z-=N,this.w-=N,this},subVectors:function(i,P){return this.x=i.x-P.x,this.y=i.y-P.y,this.z=i.z-P.z,this.w=i.w-P.w,this},multiplyScalar:function(F){return this.x*=F,this.y*=F,this.z*=F,this.w*=F,this},applyMatrix4:function(d){var V=this.x,v=this.y,n=this.z,A=this.w,T=d.el;return this.x=T[0]*V+T[4]*v+T[8]*n+T[12]*A,this.y=T[1]*V+T[5]*v+T[9]*n+T[13]*A,this.z=T[2]*V+T[6]*v+T[10]*n+T[14]*A,this.w=T[3]*V+T[7]*v+T[11]*n+T[15]*A,this},divideScalar:function(R){return this.multiplyScalar(1/R)},setAxisAngleFromQuaternion:function(z){this.w=2*Math.acos(z.w);var T=Math.sqrt(1-z.w*z.w);return 1e-4>T?(this.x=1,this.y=0,this.z=0):(this.x=z.x/T,this.y=z.y/T,this.z=z.z/T),this},setAxisAngleFromRotationMatrix:function(n){var Z,U,G,x,k=.01,w=.1,J=n.el,F=J[0],$=J[4],P=J[8],B=J[1],q=J[5],h=J[9],o=J[2],b=J[6],p=J[10];if(Math.abs($-B)<k&&Math.abs(P-o)<k&&Math.abs(h-b)<k){if(Math.abs($+B)<w&&Math.abs(P+o)<w&&Math.abs(h+b)<w&&Math.abs(F+q+p-3)<w)return this.set(1,0,0,0),this;Z=Math.PI;var H=(F+1)/2,I=(q+1)/2,O=(p+1)/2,e=($+B)/4,v=(P+o)/4,D=(h+b)/4;return H>I&&H>O?k>H?(U=0,G=.707106781,x=.707106781):(U=Math.sqrt(H),G=e/U,x=v/U):I>O?k>I?(U=.707106781,G=0,x=.707106781):(G=Math.sqrt(I),U=e/G,x=D/G):k>O?(U=.707106781,G=.707106781,x=0):(x=Math.sqrt(O),U=v/x,G=D/x),this.set(U,G,x,Z),this}var m=Math.sqrt((b-h)*(b-h)+(P-o)*(P-o)+(B-$)*(B-$));return Math.abs(m)<.001&&(m=1),this.x=(b-h)/m,this.y=(P-o)/m,this.z=(B-$)/m,this.w=Math.acos((F+q+p-1)/2),this},min:function(c){return this.x=Math.min(this.x,c.x),this.y=Math.min(this.y,c.y),this.z=Math.min(this.z,c.z),this.w=Math.min(this.w,c.w),this},max:function(K){return this.x=Math.max(this.x,K.x),this.y=Math.max(this.y,K.y),this.z=Math.max(this.z,K.z),this.w=Math.max(this.w,K.w),this},clamp:function(w,v){return this.x=Math.max(w.x,Math.min(v.x,this.x)),this.y=Math.max(w.y,Math.min(v.y,this.y)),this.z=Math.max(w.z,Math.min(v.z,this.z)),this.w=Math.max(w.w,Math.min(v.w,this.w)),this},clampScalar:function(){var r,d;return function(C,j){return r===B&&(r=new bk,d=new bk),r.set(C,C,C,C),d.set(j,j,j,j),this.clamp(r,d)}}(),clampLength:function(M,S){var m=this.length();return this.divideScalar(m||1).multiplyScalar(Math.max(M,Math.min(S,m)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(U){return this.x*U.x+this.y*U.y+this.z*U.z+this.w*U.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(F){return this.normalize().multiplyScalar(F)},lerp:function(r,h){return this.x+=(r.x-this.x)*h,this.y+=(r.y-this.y)*h,this.z+=(r.z-this.z)*h,this.w+=(r.w-this.w)*h,this},lerpVectors:function(U,j,b){return this.subVectors(j,U).multiplyScalar(b).add(U)},equals:function(v){return v.x===this.x&&v.y===this.y&&v.z===this.z&&v.w===this.w
},fromArray:function(H,g){return g===B&&(g=0),this.x=H[g],this.y=H[g+1],this.z=H[g+2],this.w=H[g+3],this},toArray:function(Q,r){return Q===B&&(Q=[]),r===B&&(r=0),Q[r]=this.x,Q[r+1]=this.y,Q[r+2]=this.z,Q[r+3]=this.w,Q},fromBufferAttribute:function(d,K){return this.x=d.getX(K),this.y=d.getY(K),this.z=d.getZ(K),this.w=d.getW(K),this}});var qp=R.Math.Vector3=function(b,A,O){b===B?(this.x=0,this.y=0,this.z=0):"object"==typeof b?this.copy(b):this.set(b,A==B?b:A,O==B?b:O)},Qb=R.Math.Vector3;w.assign(qp.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(B,Q,A){return this.x=B,this.y=Q,this.z=A,this},equals:function(g){return g&&this.x===g.x&&this.y===g.y&&this.z===g.z},setScalar:function(A){return this.x=A,this.y=A,this.z=A,this},setX:function(O){return this.x=O,this},setY:function($){return this.y=$,this},setZ:function(F){return this.z=F,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(P){return P.x===B?(this.x=P[0],this.y=P[1],this.z=P[2]):(this.x=P.x,this.y=P.y,this.z=P.z||0),this},add:function(M){return this.x+=M.x,this.y+=M.y,this.z+=M.z,this},addScalar:function(j){return this.x+=j,this.y+=j,this.z+=j,this},addVectors:function(m,P){return this.x=m.x+P.x,this.y=m.y+P.y,this.z=m.z+P.z,this},addScaledVector:function(k,D){return this.x+=k.x*D,this.y+=k.y*D,this.z+=k.z*D,this},sub:function(v){return this.x-=v.x,this.y-=v.y,this.z-=v.z,this},subScalar:function(g){return this.x-=g,this.y-=g,this.z-=g,this},subVectors:function(B,Y){return this.x=B.x-Y.x,this.y=B.y-Y.y,this.z=B.z-Y.z,this},divide:function(b){return this.x/=b.x,this.y/=b.y,this.z/=b.z,this},multiply:function(Y){return this.x*=Y.x,this.y*=Y.y,this.z*=Y.z,this},multiplyScalar:function(p){return this.x*=p,this.y*=p,this.z*=p,this},divideScalar:function(q){if(0!==q){var E=1/q;this.x*=E,this.y*=E,this.z*=E}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(D){return Math.sqrt(this.distanceToSquared(D))},distanceToSquared:function(y){var i=this.x-y.x,Z=this.y-y.y,G=this.z-y.z;return i*i+Z*Z+G*G},distanceToSquared2:function(V){var r=this.x-V[0],$=this.y-V[1],q=this.z-V[2];return r*r+$*$+q*q},divideVectors:function(S,j){return this.x=S.x/j.x,this.y=S.y/j.y,this.z=S.z/j.z,this},multiplyVectors:function(q,W){return this.x=q.x*W.x,this.y=q.y*W.y,this.z=q.z*W.z,this},transformDirection:function(x){var U=this.x,O=this.y,L=this.z,S=x.el;return this.x=S[0]*U+S[4]*O+S[8]*L,this.y=S[1]*U+S[5]*O+S[9]*L,this.z=S[2]*U+S[6]*O+S[10]*L,this.normalize()},applyAxisAngle:function(){var L=new wh;return function(F,s){return this.applyQuaternion(L.setFromAxisAngle(F,s))}}(),applyEuler:function(){var g=new wh;return function(R){return this.applyQuaternion(g.setFromEuler(R))}}(),applyQuaternion:function(k){var G=this.x,m=this.y,Y=this.z,v=k._x,s=k._y,I=k._z,d=k._w,N=d*G+s*Y-I*m,i=d*m+I*G-v*Y,J=d*Y+v*m-s*G,V=-v*G-s*m-I*Y;return this.x=N*d+V*-v+i*-I-J*-s,this.y=i*d+V*-s+J*-v-N*-I,this.z=J*d+V*-I+N*-s-i*-v,this},applyMatrix4:function(h){var p=this.x,E=this.y,L=this.z,$=h.el,Z=1/($[3]*p+$[7]*E+$[11]*L+$[15]);return this.x=($[0]*p+$[4]*E+$[8]*L+$[12])*Z,this.y=($[1]*p+$[5]*E+$[9]*L+$[13])*Z,this.z=($[2]*p+$[6]*E+$[10]*L+$[14])*Z,this},applyMatrix3:function($){var A=this.x,U=this.y,j=this.z,D=$.el;return this.x=D[0]*A+D[3]*U+D[6]*j,this.y=D[1]*A+D[4]*U+D[7]*j,this.z=D[2]*A+D[5]*U+D[8]*j,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var u=new qp;return function(O){return this.sub(u.copy(O).multiplyScalar(2*this.dot(O)))}}(),dot:function(Z){return this.x*Z.x+this.y*Z.y+this.z*Z.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var F=this.length();return F?this.multiplyScalar(1/F):this},setLength:function(W){return this.normalize().multiplyScalar(W)},fromArray:function(G,V){return V===B&&(V=0),this.x=G[V],this.y=G[V+1],this.z=G[V+2],this},toArray:function(d,v){return d===B&&(d=[0,0,0]),v===B&&(v=0),d[v]=this.x,d[v+1]=this.y,d[v+2]=this.z,d},cross:function(P){return this.crossVectors(this,P)},angleTo:function(x){var v=this.dot(x)/Math.sqrt(this.lengthSq()*x.lengthSq());return v>1||-1>v?0:Math.acos(v)},lerp:function(w,z){return this.x+=(w.x-this.x)*z,this.y+=(w.y-this.y)*z,this.z+=(w.z-this.z)*z,this},lerpVectors:function(R,g,$){return this.subVectors(g,R).multiplyScalar($).add(R)},crossVectors:function(I,N){var d=I.x,C=I.y,u=I.z,O=N.x,o=N.y,E=N.z;return this.x=C*E-u*o,this.y=u*O-d*E,this.z=d*o-C*O,this},min:function(F){return this.x=Math.min(this.x,F.x),this.y=Math.min(this.y,F.y),this.z=Math.min(this.z,F.z),this},max:function(U){return this.x=Math.max(this.x,U.x),this.y=Math.max(this.y,U.y),this.z=Math.max(this.z,U.z),this},setFromMatrixPosition:function(j){return this.setFromMatrixColumn(j,3)},setFromMatrixScale:function(Y){var f=this.setFromMatrixColumn(Y,0).length(),L=this.setFromMatrixColumn(Y,1).length(),I=this.setFromMatrixColumn(Y,2).length();return this.x=f,this.y=L,this.z=I,this},setFromMatrixColumn:function(E,i){return this.fromArray(E.el,4*i)}});var ph=R.Math.Vector2=function(c,f,i){"object"==typeof c&&(c.x!=B?(f=c.y,i=c.e,c=c.x):(i=c[2],f=c[1],c=c[0])),this.set(c||0,f||0,i)};ph.prototype={},ph.prototype.constructor=ph;var fc=ph;w.defineProperties(ph.prototype,{width:{get:function(){return this.x},set:function(o){this.x=o}},height:{get:function(){return this.y},set:function(m){this.y=m}}}),ph.prototype.clone=function(){return new ph(this.x,this.y,this.e)},ph.prototype.copy=function(D){return this.set(D.x,D.y,D.e),this},ph.prototype.equals=function(V){return V.x===this.x&&V.y===this.y&&V.e===this.e},ph.prototype.set=function(G,s,x){return this.x=G||0,this.y=s||(0!==s?this.x:0),x!=B&&(this.e=x),this},ph.prototype.setScalar=function(f){return this.x=f,this.y=f,this.e=f,this},ph.prototype.setX=function(B){return this.x=B||0,this},ph.prototype.setY=function($){return this.y=$||0,this},ph.prototype.setE=function(I){return this.e=I||0,this},ph.prototype.add=function(A){return this.x+=A.x,this.y+=A.y,this},ph.prototype.addVectors=function(K,g){return this.x=K.x+g.x,this.y=K.y+g.y,this},ph.prototype.addScalar=function(T){return this.x+=T,this.y+=T,this},ph.prototype.addScaledVector=function(j,d){return this.x+=j.x*d,this.y+=j.y*d,this},ph.prototype.sub=function(z){return this.x-=z.x,this.y-=z.y,this},ph.prototype.subScalar=function(D){return this.x-=D,this.y-=D,this},ph.prototype.subVectors=function(p,I){return this.x=p.x-I.x,this.y=p.y-I.y,this},ph.prototype.multiply=function(U){return this.x*=U.x,this.y*=U.y,this},ph.prototype.multiplyScalar=function(G){return this.x*=G,this.y*=G,this},ph.prototype.divide=function(G){return this.x/=G.x,this.y/=G.y,this},ph.prototype.divideScalar=function(X){return this.multiplyScalar(1/X)},ph.prototype.min=function(J){return this.x=Math.min(this.x,J.x),this.y=Math.min(this.y,J.y),this},ph.prototype.max=function(f){return this.x=Math.max(this.x,f.x),this.y=Math.max(this.y,f.y),this},ph.prototype.fromArray=function(N,n){return n===B&&(n=0),this.x=N[n],this.y=N[n+1],this},ph.prototype.clamp=function(M,Y){return this.x=Math.max(M.x,Math.min(Y.x,this.x)),this.y=Math.max(M.y,Math.min(Y.y,this.y)),this},ph.prototype.clampScalar=function(){var p,D;return function(X,I){return p===B&&(p=new ph,D=new ph),p.set(X,X),D.set(I,I),this.clamp(p,D)}}(),ph.prototype.clampLength=function(g,m){var e=this.length();return this.multiplyScalar(Math.max(g,Math.min(m,e))/e)},ph.prototype.dot=function(P){return this.x*P.x+this.y*P.y},ph.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},ph.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},ph.prototype.normalize=function(){return this.divideScalar(this.length())},ph.prototype.angle=function(){var P=Math.atan2(this.y,this.x);return 0>P&&(P+=2*Math.PI),P},ph.prototype.distanceTo=function(F){return Math.sqrt(this.distanceToSquared(F))},ph.prototype.distanceToSquared=function(j){var E=this.x-j.x,T=this.y-j.y;return E*E+T*T},ph.prototype.isNearEnough=function(F){return this.distanceToSquared(F)<1e-8},ph.prototype.setLength=function(S){var F=this.length();return F?this.multiplyScalar(S/F):this},ph.prototype.lerp=function(E,J){return this.x+=(E.x-this.x)*J,this.y+=(E.y-this.y)*J,"number"==typeof E.e&&"number"==typeof this.e&&(this.e+=(E.e-this.e)*J),this},ph.prototype.lerpVectors=function(d,E,e){return this.subVectors(E,d).multiplyScalar(e).add(d)},ph.prototype.rotateAround=function(F,D){var X=F?F.x:0,S=F?F.y:0,B=Math.cos(D),h=Math.sin(D),$=this.x-X,i=this.y-S;return this.x=$*B-i*h+X,this.y=$*h+i*B+S,this};var Hn=R.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};w.assign(Hn.prototype,{isMatrix3:!0,set:function(j,B,a,y,n,F,S,H,A){var g=this.el;return g[0]=j,g[1]=y,g[2]=S,g[3]=B,g[4]=n,g[5]=H,g[6]=a,g[7]=F,g[8]=A,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(d){var F=this.el,k=d.el;return F[0]=k[0],F[1]=k[1],F[2]=k[2],F[3]=k[3],F[4]=k[4],F[5]=k[5],F[6]=k[6],F[7]=k[7],F[8]=k[8],this},setFromMatrix4:function($){var J=$.el;return this.set(J[0],J[4],J[8],J[1],J[5],J[9],J[2],J[6],J[10]),this},applyToBufferAttribute:function(){var R=new qp;return function(T){for(var c=0,M=T.count;M>c;c++)R.x=T.getX(c),R.y=T.getY(c),R.z=T.getZ(c),R.applyMatrix3(this),T.setXYZ(c,R.x,R.y,R.z);return T}}(),multiply:function(U){return this.multiplyMatrices(this,U)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(B,u){var L=B.el,g=u.el,y=this.el,M=L[0],f=L[3],W=L[6],P=L[1],q=L[4],t=L[7],R=L[2],N=L[5],o=L[8],E=g[0],T=g[3],n=g[6],K=g[1],J=g[4],U=g[7],e=g[2],l=g[5],V=g[8];return y[0]=M*E+f*K+W*e,y[3]=M*T+f*J+W*l,y[6]=M*n+f*U+W*V,y[1]=P*E+q*K+t*e,y[4]=P*T+q*J+t*l,y[7]=P*n+q*U+t*V,y[2]=R*E+N*K+o*e,y[5]=R*T+N*J+o*l,y[8]=R*n+N*U+o*V,this},multiplyScalar:function(E){var P=this.el;return P[0]*=E,P[3]*=E,P[6]*=E,P[1]*=E,P[4]*=E,P[7]*=E,P[2]*=E,P[5]*=E,P[8]*=E,this},determinant:function(){var D=this.el,R=D[0],t=D[1],H=D[2],l=D[3],W=D[4],d=D[5],p=D[6],G=D[7],n=D[8];return R*W*n-R*d*G-t*l*n+t*d*p+H*l*G-H*W*p},getInverse:function(t){var S=t.el,I=this.el,F=S[0],m=S[1],U=S[2],r=S[3],f=S[4],i=S[5],n=S[6],k=S[7],Y=S[8],g=Y*f-i*k,O=i*n-Y*r,J=k*r-f*n,v=F*g+m*O+U*J;if(0===v)return this.identity();var C=1/v;return I[0]=g*C,I[1]=(U*k-Y*m)*C,I[2]=(i*m-U*f)*C,I[3]=O*C,I[4]=(Y*F-U*n)*C,I[5]=(U*r-i*F)*C,I[6]=J*C,I[7]=(m*n-k*F)*C,I[8]=(f*F-m*r)*C,this},transpose:function(){var e,q=this.el;return e=q[1],q[1]=q[3],q[3]=e,e=q[2],q[2]=q[6],q[6]=e,e=q[5],q[5]=q[7],q[7]=e,this},getNormalMatrix:function(T){return this.setFromMatrix4(T).getInverse(this).transpose()},transposeIntoArray:function(C){var Z=this.el;return C[0]=Z[0],C[1]=Z[3],C[2]=Z[6],C[3]=Z[1],C[4]=Z[4],C[5]=Z[7],C[6]=Z[2],C[7]=Z[5],C[8]=Z[8],this},setUvTransform:function(h,z,v,K,$,T,o){var F=Math.cos($),Y=Math.sin($);this.set(v*F,v*Y,-v*(F*T+Y*o)+T+h,-K*Y,K*F,-K*(-Y*T+F*o)+o+z,0,0,1)},scale:function(B,u){var x=this.el;return x[0]*=B,x[3]*=B,x[6]*=B,x[1]*=u,x[4]*=u,x[7]*=u,this},rotate:function(m){var W=Math.cos(m),Q=Math.sin(m),d=this.el,s=d[0],i=d[3],A=d[6],w=d[1],p=d[4],u=d[7];return d[0]=W*s+Q*w,d[3]=W*i+Q*p,d[6]=W*A+Q*u,d[1]=-Q*s+W*w,d[4]=-Q*i+W*p,d[7]=-Q*A+W*u,this},translate:function(e,n){var u=this.el;return u[0]+=e*u[2],u[3]+=e*u[5],u[6]+=e*u[8],u[1]+=n*u[2],u[4]+=n*u[5],u[7]+=n*u[8],this},equals:function(b){for(var E=this.el,i=b.el,I=0;9>I;I++)if(E[I]!==i[I])return!1;return!0},fromArray:function(Y,K){K===B&&(K=0);for(var a=0;9>a;a++)this.el[a]=Y[a+K];return this},toArray:function(a,x){a===B&&(a=[]),x===B&&(x=0);var Z=this.el;return a[x]=Z[0],a[x+1]=Z[1],a[x+2]=Z[2],a[x+3]=Z[3],a[x+4]=Z[4],a[x+5]=Z[5],a[x+6]=Z[6],a[x+7]=Z[7],a[x+8]=Z[8],a}});var ob=R.Math.Plane=function(A,w){this.normal=A!==B?A:new qp(1,0,0),this.constant=w!==B?w:0};w.assign(ob.prototype,{set:function(F,L){return this.normal.copy(F),this.constant=L,this},setComponents:function(I,b,w,e){return this.normal.set(I,b,w),this.constant=e,this},setFromNormalAndCoplanarPoint:function(k,t){return this.normal.copy(k),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var c=new qp,A=new qp;return function(H,r,Q){var T=c.subVectors(Q,r).cross(A.subVectors(H,r)).normalize();return this.setFromNormalAndCoplanarPoint(T,H),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(B){return this.normal.copy(B.normal),this.constant=B.constant,this},normalize:function(){var m=1/this.normal.length();return this.normal.multiplyScalar(m),this.constant*=m,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(K){return this.normal.dot(K)+this.constant},distanceToSphere:function(C){return this.distanceToPoint(C.center)-C.radius},projectPoint:function(R,j){return j===B&&(j=new qp),j.copy(this.normal).multiplyScalar(-this.distanceToPoint(R)).add(R)},intersectLine:function(){var z=new qp;return function(Z,O){O===B&&(O=new qp);var W=Z.delta(z),G=this.normal.dot(W);if(0===G)return 0===this.distanceToPoint(Z.start)?O.copy(Z.start):B;var M=-(Z.start.dot(this.normal)+this.constant)/G;return 0>M||M>1?B:O.copy(W).multiplyScalar(M).add(Z.start)}}(),intersectsLine:function(i){var Z=this.distanceToPoint(i.start),$=this.distanceToPoint(i.end);return 0>Z&&$>0||0>$&&Z>0},intersectsBox:function(O){return O.intersectsPlane(this)},intersectsSphere:function(D){return D.intersectsPlane(this)},coplanarPoint:function(j){return j===B&&(j=new qp),j.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var T=new qp,o=new Hn;return function(Z,X){var Y=X||o.getNormalMatrix(Z),d=this.coplanarPoint(T).applyMatrix4(Z),j=this.normal.applyMatrix3(Y).normalize();return this.constant=-d.dot(j),this}}(),translate:function(s){return this.constant-=s.dot(this.normal),this},equals:function(F){return F.normal.equals(this.normal)&&F.constant===this.constant}});var tl=R.Math.Ray=function(C,G){this.origin=C!==B?C.clone():new qp,this.direction=G!==B?G.clone():new qp};w.assign(tl.prototype,{set:function(W,H){return this.origin.copy(W),this.direction.copy(H),this},clone:function(){return(new this.constructor).copy(this)},copy:function(s){return this.origin.copy(s.origin),this.direction.copy(s.direction),this.maxHitLen=s.maxHitLen,this},at:function(v,u){var $=u||new qp;return $.copy(this.direction).multiplyScalar(v).add(this.origin)},setMaxHitLength:function(u){this.maxHitLen=u},lookAt:function(R){return this.direction.copy(R).sub(this.origin).normalize(),this},applyMatrix4:function(O){var g=this.maxHitLen;if(g){var f=this.direction.clone().multiplyScalar(g).add(this.origin);f.applyMatrix4(O)}return this.origin.applyMatrix4(O),this.direction.transformDirection(O),g&&(this.maxHitLen=this.origin.distanceTo(f)),this},distanceToPlane:function(I){var b=I.normal.dot(this.direction);if(0===b)return 0===I.distanceToPoint(this.origin)?0:null;var M=-(this.origin.dot(I.normal)+I.constant)/b;return M>=0?M:null},intersectPlane:function(j,W){var y=this.distanceToPlane(j);return null===y?null:this.at(y,W)},intersectSphere:function(){var O=new qp;return function($,K){O.subVectors($.center,this.origin);var h=O.dot(this.direction),A=O.dot(O)-h*h,b=$.radius*$.radius;if(A>b)return null;var B=Math.sqrt(b-A),r=h-B,l=h+B;return 0>r&&0>l?null:0>r?this.at(l,K):this.at(r,K)}}(),intersectEllipsoid:function(){var w=new qp,h=new qp;return function(F,K){w.subVectors(F.center,this.origin),w.divide(F.radius),h.divideVectors(this.direction,F.radius);var j=h.lengthSq(),N=w.dot(h),c=w.dot(w)*j-N*N;if(c>j)return null;var n=Math.sqrt(j-c),M=(N-n)/j,S=(N+n)/j;return 0>M&&0>S?null:0>M?this.at(S,K):this.at(M,K)}}(),intersectBox:function(B,T){var j,Z,Y,i,w,W,H=1/this.direction.x,X=1/this.direction.y,s=1/this.direction.z,G=this.origin;if(H>=0?(j=(B.min.x-G.x)*H,Z=(B.max.x-G.x)*H):(j=(B.max.x-G.x)*H,Z=(B.min.x-G.x)*H),X>=0?(Y=(B.min.y-G.y)*X,i=(B.max.y-G.y)*X):(Y=(B.max.y-G.y)*X,i=(B.min.y-G.y)*X),j>i||Y>Z)return null;if((Y>j||j!==j)&&(j=Y),(Z>i||Z!==Z)&&(Z=i),s>=0?(w=(B.min.z-G.z)*s,W=(B.max.z-G.z)*s):(w=(B.max.z-G.z)*s,W=(B.min.z-G.z)*s),j>W||w>Z)return null;if((w>j||j!==j)&&(j=w),(Z>W||Z!==Z)&&(Z=W),0>Z)return null;var M=j>=0?j:Z,l=this.maxHitLen;return l&&M>l?null:this.at(M,T)},intersectTriangle:function(){var X=new qp,A=new qp,e=new qp,q=new qp;return function(H,E,P,l,k){A.subVectors(E,H),e.subVectors(P,H),q.crossVectors(A,e);var N,t=this.direction.dot(q);if(t>0){if(l)return null;N=1}else{if(!(0>t))return null;N=-1,t=-t}X.subVectors(this.origin,H);var B=N*this.direction.dot(e.crossVectors(X,e));if(0>B)return null;var d=N*this.direction.dot(A.cross(X));if(0>d||B+d>t)return null;var J=-N*X.dot(q);if(0>J)return null;var n=J/t,j=this.maxHitLen;return j&&n>j?null:this.at(n,k)}}()});var Lb=R.Math.Box3=function(y,n){this.min=y!==B?y:new qp(1/0,1/0,1/0),this.max=n!==B?n:new qp(-1/0,-1/0,-1/0)};w.assign(Lb.prototype,{set:function(O,i){return this.min.copy(O),this.max.copy(i),this},setFromArray:function(k){for(var Z=1/0,F=1/0,P=1/0,g=-1/0,x=-1/0,d=-1/0,Y=0,q=k.length;q>Y;Y+=3){var I=k[Y],b=k[Y+1],f=k[Y+2];Z>I&&(Z=I),F>b&&(F=b),P>f&&(P=f),I>g&&(g=I),b>x&&(x=b),f>d&&(d=f)}return this.min.set(Z,F,P),this.max.set(g,x,d),this},setFromPoints:function(N){this.makeEmpty();for(var $=0,g=N.length;g>$;$++)this.expandByPoint(N[$]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(u){return u.max.x<this.min.x||u.min.x>this.max.x||u.max.y<this.min.y||u.min.y>this.max.y||u.max.z<this.min.z||u.min.z>this.max.z?!1:!0},copy:function(q){return this.min.copy(q.min),this.max.copy(q.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(w){return this.min.min(w),this.max.max(w),this},expandByBox:function(i){return this.min.min(i.min),this.max.max(i.max),this},applyMatrix4:function(){var v=[new qp,new qp,new qp,new qp,new qp,new qp,new qp,new qp];return function(T){return this.isEmpty()?this:(v[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(T),v[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(T),v[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(T),v[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(T),v[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(T),v[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(T),v[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(T),v[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(T),this.setFromPoints(v),this)}}()});var $c=R.Math.Sphere=function(Z,G){this.center=Z!==B?Z:new qp,this.radius=G!==B?G:0};w.assign($c.prototype,{set:function(K,r){return this.center.copy(K),this.radius=r,this},setFromPoints:function(){var a=new Lb;return function(g,m){var w=this.center;m!==B?w.copy(m):a.setFromPoints(g).getCenter(w);for(var e=0,x=0,$=g.length;$>x;x++)e=Math.max(e,w.distanceToSquared(g[x]));return this.radius=Math.sqrt(e),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(o){return o.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(j){return j.distanceTo(this.center)-this.radius},intersectsSphere:function(n){var l=this.radius+n.radius;return n.center.distanceToSquared(this.center)<=l*l},intersectsBox:function(H){return H.intersectsSphere(this)},intersectsPlane:function(n){return Math.abs(n.distanceToPoint(this.center))<=this.radius},clampPoint:function(C,j){var h=this.center.distanceToSquared(C);return j===B&&(j=new qp),j.copy(C),h>this.radius*this.radius&&(j.sub(this.center).normalize(),j.multiplyScalar(this.radius).add(this.center)),j},getBoundingBox:function(v){return v===B&&(v=new Lb),v.set(this.center,this.center),v.expandByScalar(this.radius),v},applyMatrix4:function(O){return this.center.applyMatrix4(O),this.radius=this.radius*O.getMaxScaleOnAxis(),this},translate:function(J){return this.center.add(J),this},equals:function(S){return S.center.equals(this.center)&&S.radius===this.radius}});var Ck=R.Math.Frustum=function(v,k,g,O,T,f){this.planes=[v!==B?v:new ob,k!==B?k:new ob,g!==B?g:new ob,O!==B?O:new ob,T!==B?T:new ob,f!==B?f:new ob]};w.assign(Ck.prototype,{set:function(t,b,m,C,r,J){var s=this.planes;return s[0].copy(t),s[1].copy(b),s[2].copy(m),s[3].copy(C),s[4].copy(r),s[5].copy(J),this},clone:function(){return(new this.constructor).copy(this)},copy:function(S){for(var O=this.planes,G=0;6>G;G++)O[G].copy(S.planes[G]);return this},setFromMatrix:function($){var w=this.planes,I=$.el,x=I[0],F=I[1],t=I[2],J=I[3],B=I[4],C=I[5],N=I[6],P=I[7],D=I[8],V=I[9],b=I[10],K=I[11],q=I[12],d=I[13],o=I[14],m=I[15];return w[0].setComponents(J-x,P-B,K-D,m-q).normalize(),w[1].setComponents(J+x,P+B,K+D,m+q).normalize(),w[2].setComponents(J+F,P+C,K+V,m+d).normalize(),w[3].setComponents(J-F,P-C,K-V,m-d).normalize(),w[4].setComponents(J-t,P-N,K-b,m-o).normalize(),w[5].setComponents(J+t,P+N,K+b,m+o).normalize(),this},intersectsObject:function(){var H=new $c;return function(i){var F=i.geometry;return null===F.boundingSphere&&F.computeBoundingSphere(),H.copy(F.boundingSphere).applyMatrix4(i.matrixWorld),this.intersectsSphere(H)}}(),intersectsSprite:function(){var Y=new $c;return function(r){return Y.center.set(0,0,0),Y.radius=.7071067811865476,Y.applyMatrix4(r.matrixWorld),this.intersectsSphere(Y)}}(),intersectsSphere:function(F){for(var f=this.planes,j=F.center,o=-F.radius,B=0;6>B;B++){var G=f[B].distanceToPoint(j);if(o>G)return!1}return!0},intersectsBox:function(){var o=new qp;return function(x){for(var y=this.planes,U=0;6>U;U++){var m=y[U];if(o.x=m.normal.x>0?x.max.x:x.min.x,o.y=m.normal.y>0?x.max.y:x.min.y,o.z=m.normal.z>0?x.max.z:x.min.z,m.distanceToPoint(o)<0)return!1}return!0}}(),containsPoint:function(z){for(var n=this.planes,s=0;6>s;s++)if(n[s].distanceToPoint(z)<0)return!1;return!0}});var Jb=R.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};w.assign(Jb.prototype,{set:function(J,d,I,t,o,A,U,L,k,C,g,N,E,B,s,x){var R=this.el;return R[0]=J,R[4]=d,R[8]=I,R[12]=t,R[1]=o,R[5]=A,R[9]=U,R[13]=L,R[2]=k,R[6]=C,R[10]=g,R[14]=N,R[3]=E,R[7]=B,R[11]=s,R[15]=x,this},clone:function(){return(new Jb).fromArray(this.el)},fromArray:function(M,p){p===B&&(p=0);for(var S=this.el,E=0;16>E;E++)S[E]=M[E+p];return this},getElements:function(){return this.el},scale:function(y){var g=this.el,X=y.x,W=y.y,O=y.z;return g[0]*=X,g[4]*=W,g[8]*=O,g[1]*=X,g[5]*=W,g[9]*=O,g[2]*=X,g[6]*=W,g[10]*=O,g[3]*=X,g[7]*=W,g[11]*=O,this},makeRotationFromEuler:function(m){var p=this.el,q=m._x,x=m._y,M=m._z,Z=m._order,A=Math.cos(q),N=Math.sin(q),W=Math.cos(x),R=Math.sin(x),k=Math.cos(M),a=Math.sin(M);if("XYZ"===Z){var $=A*k,o=A*a,t=N*k,Q=N*a;p[0]=W*k,p[4]=-W*a,p[8]=R,p[1]=o+t*R,p[5]=$-Q*R,p[9]=-N*W,p[2]=Q-$*R,p[6]=t+o*R,p[10]=A*W}else if("YXZ"===Z){var G=W*k,h=W*a,n=R*k,J=R*a;p[0]=G+J*N,p[4]=n*N-h,p[8]=A*R,p[1]=A*a,p[5]=A*k,p[9]=-N,p[2]=h*N-n,p[6]=J+G*N,p[10]=A*W}else if("ZXY"===Z){var G=W*k,h=W*a,n=R*k,J=R*a;p[0]=G-J*N,p[4]=-A*a,p[8]=n+h*N,p[1]=h+n*N,p[5]=A*k,p[9]=J-G*N,p[2]=-A*R,p[6]=N,p[10]=A*W}else if("ZYX"===Z){var $=A*k,o=A*a,t=N*k,Q=N*a;p[0]=W*k,p[4]=t*R-o,p[8]=$*R+Q,p[1]=W*a,p[5]=Q*R+$,p[9]=o*R-t,p[2]=-R,p[6]=N*W,p[10]=A*W}else if("YZX"===Z){var e=A*W,B=A*R,i=N*W,f=N*R;p[0]=W*k,p[4]=f-e*a,p[8]=i*a+B,p[1]=a,p[5]=A*k,p[9]=-N*k,p[2]=-R*k,p[6]=B*a+i,p[10]=e-f*a}else if("XZY"===Z){var e=A*W,B=A*R,i=N*W,f=N*R;p[0]=W*k,p[4]=-a,p[8]=R*k,p[1]=e*a+f,p[5]=A*k,p[9]=B*a-i,p[2]=i*a-B,p[6]=N*k,p[10]=f*a+e}return p[3]=0,p[7]=0,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,this},makeRotationFromQuaternion:function(D){var K=this.el,z=D._x,j=D._y,N=D._z,a=D._w,_=z+z,p=j+j,n=N+N,l=z*_,k=z*p,m=z*n,S=j*p,L=j*n,M=N*n,E=a*_,w=a*p,W=a*n;return K[0]=1-(S+M),K[4]=k-W,K[8]=m+w,K[1]=k+W,K[5]=1-(l+M),K[9]=L-E,K[2]=m-w,K[6]=L+E,K[10]=1-(l+S),K[3]=0,K[7]=0,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(l){var i=this.el,v=l.el,t=v[0],Z=v[1],_=v[2],I=v[3],u=v[4],e=v[5],M=v[6],W=v[7],y=v[8],R=v[9],n=v[10],p=v[11],P=v[12],U=v[13],z=v[14],L=v[15],S=R*z*W-U*n*W+U*M*p-e*z*p-R*M*L+e*n*L,N=P*n*W-y*z*W-P*M*p+u*z*p+y*M*L-u*n*L,Q=y*U*W-P*R*W+P*e*p-u*U*p-y*e*L+u*R*L,w=P*R*M-y*U*M-P*e*n+u*U*n+y*e*z-u*R*z,A=t*S+Z*N+_*Q+I*w;if(0===A)return this.identity();var j=1/A;return i[0]=S*j,i[1]=(U*n*I-R*z*I-U*_*p+Z*z*p+R*_*L-Z*n*L)*j,i[2]=(e*z*I-U*M*I+U*_*W-Z*z*W-e*_*L+Z*M*L)*j,i[3]=(R*M*I-e*n*I-R*_*W+Z*n*W+e*_*p-Z*M*p)*j,i[4]=N*j,i[5]=(y*z*I-P*n*I+P*_*p-t*z*p-y*_*L+t*n*L)*j,i[6]=(P*M*I-u*z*I-P*_*W+t*z*W+u*_*L-t*M*L)*j,i[7]=(u*n*I-y*M*I+y*_*W-t*n*W-u*_*p+t*M*p)*j,i[8]=Q*j,i[9]=(P*R*I-y*U*I-P*Z*p+t*U*p+y*Z*L-t*R*L)*j,i[10]=(u*U*I-P*e*I+P*Z*W-t*U*W-u*Z*L+t*e*L)*j,i[11]=(y*e*I-u*R*I-y*Z*W+t*R*W+u*Z*p-t*e*p)*j,i[12]=w*j,i[13]=(y*U*_-P*R*_+P*Z*n-t*U*n-y*Z*z+t*R*z)*j,i[14]=(P*e*_-u*U*_-P*Z*M+t*U*M+u*Z*z-t*e*z)*j,i[15]=(u*R*_-y*e*_+y*Z*M-t*R*M-u*Z*n+t*e*n)*j,this},makeRotationAxis:function(q,N){var G=Math.cos(N),t=Math.sin(N),M=1-G,D=q.x,L=q.y,w=q.z,k=M*D,K=M*L;return this.set(k*D+G,k*L-t*w,k*w+t*L,0,k*L+t*w,K*L+G,K*w-t*D,0,k*w-t*L,K*w+t*D,M*w*w+G,0,0,0,0,1),this},multiply:function(P){return this.multiplyMatrices(this,P)},premultiply:function(C){return this.multiplyMatrices(C,this)},multiplyMatrices:function(q,o){var R=q.el,Q=o.el,j=this.el,G=R[0],A=R[4],z=R[8],I=R[12],L=R[1],k=R[5],a=R[9],l=R[13],r=R[2],p=R[6],O=R[10],M=R[14],y=R[3],c=R[7],f=R[11],m=R[15],Y=Q[0],i=Q[4],U=Q[8],e=Q[12],C=Q[1],u=Q[5],N=Q[9],h=Q[13],H=Q[2],w=Q[6],K=Q[10],T=Q[14],V=Q[3],B=Q[7],P=Q[11],b=Q[15];return j[0]=G*Y+A*C+z*H+I*V,j[4]=G*i+A*u+z*w+I*B,j[8]=G*U+A*N+z*K+I*P,j[12]=G*e+A*h+z*T+I*b,j[1]=L*Y+k*C+a*H+l*V,j[5]=L*i+k*u+a*w+l*B,j[9]=L*U+k*N+a*K+l*P,j[13]=L*e+k*h+a*T+l*b,j[2]=r*Y+p*C+O*H+M*V,j[6]=r*i+p*u+O*w+M*B,j[10]=r*U+p*N+O*K+M*P,j[14]=r*e+p*h+O*T+M*b,j[3]=y*Y+c*C+f*H+m*V,j[7]=y*i+c*u+f*w+m*B,j[11]=y*U+c*N+f*K+m*P,j[15]=y*e+c*h+f*T+m*b,this},lookAt:function(){var G=new qp;return function(Z,h,i){return G.subVectors(Z,h),this.lookAtDirection(G,i)}}(),lookAtDirection:function(){var F=new qp,N=new qp,a=new qp;return function(K,g){var w=this.el;return a.copy(K),0===a.lengthSq()&&(a.z=1),a.normalize(),F.crossVectors(g,a),0===F.lengthSq()&&(1===Math.abs(g.z)?a.x+=1e-4:a.z+=1e-4,a.normalize(),F.crossVectors(g,a)),F.normalize(),N.crossVectors(a,F),w[0]=F.x,w[4]=N.x,w[8]=a.x,w[1]=F.y,w[5]=N.y,w[9]=a.y,w[2]=F.z,w[6]=N.z,w[10]=a.z,this}}(),extractScale:function(){var $;return function(e){$===B&&($=new qp),e===B&&(e=new qp);var _=$.setFromMatrixColumn(this,0).length(),P=$.setFromMatrixColumn(this,1).length(),R=$.setFromMatrixColumn(this,2).length();return e.set(_,P,R),e}}(),extractRotation:function(){var X;return function(g){X===B&&(X=new qp),g===B&&(g=new Jb);var k=this.el,$=g.el,y=1/X.setFromMatrixColumn(g,0).length(),m=1/X.setFromMatrixColumn(g,1).length(),q=1/X.setFromMatrixColumn(g,2).length();return k[0]=$[0]*y,k[1]=$[1]*y,k[2]=$[2]*y,k[4]=$[4]*m,k[5]=$[5]*m,k[6]=$[6]*m,k[8]=$[8]*q,k[9]=$[9]*q,k[10]=$[10]*q,this}}(),multiplyScalar:function(H){var s=this.el;return s[0]*=H,s[4]*=H,s[8]*=H,s[12]*=H,s[1]*=H,s[5]*=H,s[9]*=H,s[13]*=H,s[2]*=H,s[6]*=H,s[10]*=H,s[14]*=H,s[3]*=H,s[7]*=H,s[11]*=H,s[15]*=H,this},getPosition:function(D){return D===B&&(D=new qp),D.setFromMatrixColumn(this,3)},setPosition:function(k){var b=this.el;return b[12]=k.x,b[13]=k.y,b[14]=k.z,this},toArray:function(c,P){c===B&&(c=[]),P===B&&(P=0);var R=this.el;return c[P]=R[0],c[P+1]=R[1],c[P+2]=R[2],c[P+3]=R[3],c[P+4]=R[4],c[P+5]=R[5],c[P+6]=R[6],c[P+7]=R[7],c[P+8]=R[8],c[P+9]=R[9],c[P+10]=R[10],c[P+11]=R[11],c[P+12]=R[12],c[P+13]=R[13],c[P+14]=R[14],c[P+15]=R[15],c},determinant:function(){var N=this.el,C=N[0],E=N[4],p=N[8],I=N[12],v=N[1],V=N[5],e=N[9],O=N[13],Y=N[2],S=N[6],F=N[10],j=N[14],D=N[3],g=N[7],i=N[11],c=N[15];return D*(+I*e*S-p*O*S-I*V*F+E*O*F+p*V*j-E*e*j)+g*(+C*e*j-C*O*F+I*v*F-p*v*j+p*O*Y-I*e*Y)+i*(+C*O*S-C*V*j-I*v*S+E*v*j+I*V*Y-E*O*Y)+c*(-p*V*Y-C*e*S+C*V*F+p*v*S-E*v*F+E*e*Y)},copy:function(Q){var Y=this.el,B=Q.el;return Y[0]=B[0],Y[1]=B[1],Y[2]=B[2],Y[3]=B[3],Y[4]=B[4],Y[5]=B[5],Y[6]=B[6],Y[7]=B[7],Y[8]=B[8],Y[9]=B[9],Y[10]=B[10],Y[11]=B[11],Y[12]=B[12],Y[13]=B[13],Y[14]=B[14],Y[15]=B[15],this},compose:function(k,I,G){var q=this.el,A=I._x,m=I._y,i=I._z,f=I._w,R=A+A,s=m+m,r=i+i,F=A*R,n=A*s,_=A*r,x=m*s,o=m*r,M=i*r,p=f*R,V=f*s,O=f*r,P=G.x,U=G.y,h=G.z;return q[0]=(1-(x+M))*P,q[1]=(n+O)*P,q[2]=(_-V)*P,q[3]=0,q[4]=(n-O)*U,q[5]=(1-(F+M))*U,q[6]=(o+p)*U,q[7]=0,q[8]=(_+V)*h,q[9]=(o-p)*h,q[10]=(1-(F+x))*h,q[11]=0,q[12]=k.x,q[13]=k.y,q[14]=k.z,q[15]=1,this},decompose:function(){var Y=new qp,x=new Jb;return function(J,f,X){var N=this.el,T=Y.set(N[0],N[1],N[2]).length(),l=Y.set(N[4],N[5],N[6]).length(),r=Y.set(N[8],N[9],N[10]).length(),m=this.determinant();0>m&&(T=-T),J.x=N[12],J.y=N[13],J.z=N[14],x.copy(this);var i=1/T,L=1/l,W=1/r;return x.el[0]*=i,x.el[1]*=i,x.el[2]*=i,x.el[4]*=L,x.el[5]*=L,x.el[6]*=L,x.el[8]*=W,x.el[9]*=W,x.el[10]*=W,f.setFromRotationMatrix(x),X.x=T,X.y=l,X.z=r,this}}()});var aq=R.Math.Triangle=function(X,m,Z){this.a=X!==B?X:new qp,this.b=m!==B?m:new qp,this.c=Z!==B?Z:new qp};w.assign(aq,{barycoordFromPoint:function(){var s=new qp,w=new qp,p=new qp;return function(c,$,N,m,R){s.subVectors(m,$),w.subVectors(N,$),p.subVectors(c,$);var S=s.dot(s),M=s.dot(w),C=s.dot(p),B=w.dot(w),O=w.dot(p),a=S*B-M*M,n=R||new qp;if(0===a)return n.set(-2,-1,-1);var e=1/a,v=(B*C-M*O)*e,A=(S*O-M*C)*e;return n.set(1-v-A,A,v)}}()});var Lo=R.Math.Euler=function(r,C,x,i,N){this.set(r,C,x,i,N)};Lo.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Lo.DefaultOrder="XYZ",Lo.ReverseOrder=function(){var m={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"};return function(z){return m[z]}}(),w.defineProperties(Lo.prototype,{x:{get:function(){return this._x},set:function(G){this._x=G,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(w){this._y=w,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(Q){this._z=Q,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(m){this._order=m,this.onChangeCallback()}}}),w.assign(Lo.prototype,{set:function(k,W,Y,c,V){return Nl(k)&&(V=Y,c=W,Y=k[2],W=k[1],k=k[0]),c?V&&(c=Lo.ReverseOrder(c)):c="ZYX",this._x=k||0,this._y=W||0,this._z=Y||0,this._order=c||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(X){return this._x=X._x,this._y=X._y,this._z=X._z,this._order=X._order,this.onChangeCallback(),this},setFromRotationMatrix:function(L,n,m){var i=R.Math.clamp,K=L.el||L,F=K[0],N=K[4],Y=K[8],P=K[1],D=K[5],g=K[9],B=K[2],H=K[6],c=K[10];return n=n||this._order,"XYZ"===n?(this._y=Math.asin(i(Y,-1,1)),Math.abs(Y)<.99999?(this._x=Math.atan2(-g,c),this._z=Math.atan2(-N,F)):(this._x=Math.atan2(H,D),this._z=0)):"YXZ"===n?(this._x=Math.asin(-i(g,-1,1)),Math.abs(g)<.99999?(this._y=Math.atan2(Y,c),this._z=Math.atan2(P,D)):(this._y=Math.atan2(-B,F),this._z=0)):"ZXY"===n?(this._x=Math.asin(i(H,-1,1)),Math.abs(H)<.99999?(this._y=Math.atan2(-B,c),this._z=Math.atan2(-N,D)):(this._y=0,this._z=Math.atan2(P,F))):"ZYX"===n?(this._y=Math.asin(-i(B,-1,1)),Math.abs(B)<.99999?(this._x=Math.atan2(H,c),this._z=Math.atan2(P,F)):(this._x=0,this._z=Math.atan2(-N,D))):"YZX"===n?(this._z=Math.asin(i(P,-1,1)),Math.abs(P)<.99999?(this._x=Math.atan2(-g,D),this._y=Math.atan2(-B,F)):(this._x=0,this._y=Math.atan2(Y,c))):"XZY"===n?(this._z=Math.asin(-i(N,-1,1)),Math.abs(N)<.99999?(this._x=Math.atan2(H,D),this._y=Math.atan2(Y,F)):(this._x=Math.atan2(-g,c),this._y=0)):console.warn("unsupported order: "+n),this._order=n,m!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var k=new Jb;return function(Q,u,W){return k.makeRotationFromQuaternion(Q),this.setFromRotationMatrix(k,u,W)}}(),setFromVector3:function(w,L){return this.set(w.x,w.y,w.z,L||this._order)
},reorder:function(){var a=new wh;return function(u){return a.setFromEuler(this),this.setFromQuaternion(a,u)}}(),equals:function(j){return j._x===this._x&&j._y===this._y&&j._z===this._z&&j._order===this._order},fromArray:function(R){return this._x=R[0],this._y=R[1],this._z=R[2],R[3]!==B&&(this._order=R[3]),this.onChangeCallback(),this},toArray:function(W,L){return W===B&&(W=[]),L===B&&(L=0),W[L]=this._x,W[L+1]=this._y,W[L+2]=this._z,W[L+3]=this._order,W},toVector3:function(Q){return Q?Q.set(this._x,this._y,this._z):new qp(this._x,this._y,this._z)},onChange:function(M){return this.onChangeCallback=M,this},onChangeCallback:function(){}});var jl={ms_ac:function(B,H){for(var X=H.ms_ac,w=0;w<X.length;w++)bc(B,X[w])},ms_listener:function(p){p.addListeners=function(){var F=this,W=nh;l.mockTouch&&(W=Kr.concat(Oo).concat(pd)),F.__events__=W;for(var h=0,u=W.length;u>h;h++){var X=W[h];"wheel"===X&&!F.handle_wheel&&F.handle_mousewheel&&(F.handle_wheel=function(P){bj(F,P)}),F["handle_"+X]&&op(X,F.getView(),F)}},p.removeListeners=function(){var U=this,h=U.__events__;if(h){U.__events__=B;for(var M=0,T=h.length;T>M;M++)U["handle_"+h[M]]&&vn(h[M],U.getView(),U)}}},ms_fire:function(P){P.mp=function(w,o,P){this.addPropertyChangeListener(w,o,P)},P.ump=function(w,Z){this.removePropertyChangeListener(w,Z)},P.fp=function(F,R,z,$,e){return this.firePropertyChange(F,R,z,$,e)},P.addPropertyChangeListener=function(Z,H,O){var B=this;B._62I||(B._62I=new $m),B._62I.add(Z,H,O)},P.removePropertyChangeListener=function(G,U){this._62I&&this._62I.remove(G,U)},P.firePropertyChange=function(k,j,N,f,q){if(f){if(f(j,N))return!1}else if(j===N)return!1;var Q=this,E=q||{};return E.property=k,E.oldValue=j,E.newValue=N,E.source=Q,E.data=Q,Q._62I&&Q._62I.fire(E),Q.onPropertyChanged&&Q.onPropertyChanged(E),!0}},ms_attr:function(g){g.a=function(F,u){var M=this;if(2===arguments.length)M.setAttr(F,u);else{if(!xg(F))return M.getAttr(F);for(var J in F)M.setAttr(J,F[J])}return M},g.getAttr=function(Y,D){if(D===B&&(D=1),this._attrObject&&Y in this._attrObject)return this._attrObject[Y];if(this.getImage){var $=this.getImage();if(Ek($)&&($=Lc[$]),xg($)&&"dataBindings"in $)for(var E=$.dataBindings,t=E.length-1;t>=0;t--){var N=E[t];if(N.attr===Y){if("defaultValue"in N)return N.defaultValue;break}}}return D?W[Y]:B},g.setAttr=function($,A){var b=this;b._attrObject||(b._attrObject={});var i=b._attrObject[$];A===B?delete b._attrObject[$]:b._attrObject[$]=A,b.fp&&b.fp("a:"+$,i,A)&&b.onAttrChanged&&b.onAttrChanged($,i,A)},g.getSerializableAttrs=function(){var S,X={};for(S in this._attrObject)X[S]=1;return X}},ms_bnb:function(X){X.getBodyColor=function(r){return r.s("body.color")},X.getBorderColor=function(U){return U.s("border.color")}},_51o:function(l){l.mi=function(i,X,l){this.addInteractorListener(i,X,l)},l.umi=function(f,I){this.removeInteractorListener(f,I)},l.fi=function(Y){this.fireInteractorEvent(Y)},l.addInteractorListener=function(H,i,l){var K=this;K._63I||(K._63I=new $m),K._63I.add(H,i,l)},l.removeInteractorListener=function(o,G){this._63I&&this._63I.remove(o,G)},l.fireInteractorEvent=function(S){this._63I&&this._63I.fire(S)},l.setInteractors=function($){var o=this,j=o._interactors;j&&j.each(function(s){s.tearDown()}),Nl($)&&($=new bp($)),o._interactors=$,$&&$.each(function(L){L.setUp()}),o.fp("interactors",j,$),o.invalidateSelection()},l.getInteractors=function(){return this._interactors}},_49o:function(F){F._44O=h,F._45O=h,F.getTopPainters=function(){return this._44O},F.getBottomPainters=function(){return this._45O},F.addTopPainter=function(y){var U=this;U._44O||(U._44O=new bp),U._44O.contains(y)||(U._44O.add(y),U.redraw&&U.redraw())},F.removeTopPainter=function(G){var u=this;u._44O&&(u._44O.remove(G),u.redraw&&u.redraw())},F.addBottomPainter=function(h){var z=this;z._45O||(z._45O=new bp),z._45O.contains(h)||(z._45O.add(h),z.redraw&&z.redraw())},F.removeBottomPainter=function(A){var d=this;d._45O&&(d._45O.remove(A),d.redraw&&d.redraw())},F._93db=function(r,M){var U=this;U._45O&&U._45O.each(function(N){N.draw?N.draw(r,M):N.call(U,r,M)})},F._92db=function(N,C){var n=this;n._44O&&n._44O.each(function(O){O.draw?O.draw(N,C):O.call(n,N,C)})}},ms_sm:function(f){f.sm=function(){return this.getSelectionModel()},f.setSelectableFunc=function(n){this.sm().setFilterFunc(n)},f.getSelectableFunc=function(){return this.sm().getFilterFunc()},f.getSelectionModel=function(){var E=this;return E._selectionModel?E._selectionModel:E.dm().sm()},f.isSelectionModelShared=function(){return!this._selectionModel},f.setSelectionModelShared=function(q){var Q=this,U=!Q._selectionModel,w=Q.handleSelectionChange,M=Q.dm();U!==q&&(Q.invalidateSelection&&Q.invalidateSelection(),q?(M.sm().ms(w,Q),Q._selectionModel.ums(w,Q),Q._selectionModel.dispose(),Q._selectionModel=h):(M.sm().ums(w,Q),Q._selectionModel=new Xc(M),Q._selectionModel.ms(w,Q)),Q.onSelectionModelSharedChanged(),Q.fp("selectionModelShared",U,q))},f.onSelectionModelSharedChanged=function(){var U=this;U.redraw(),U.invalidateSelection&&U.invalidateSelection()},f.removeSelection=function(){var j=this.dm();j.beginTransaction(),this.sm().toSelection().each(j.remove,j),j.endTransaction()},f.selectAll=function(){var k=this;k.sm().ss(k.dm().toDatas(function(I){return k.isVisible(I)&&k.isSelectable(I)}))},f.isSelected=function(S){return this.sm().co(S)},f.isSelectedById=function(P){var _=this.dm().getDataById(P);return _?this.isSelected(_):!1},f.isSelectable=function(o){return this.sm().isSelectable(o)}},ms_tx:function(O){O._64I=0,O._65O=0,O.isScrollable=function(){return this.getWidth()<this._64I},O._40o=function(){return this.isScrollable()},O.getLogicalPoint=function(d){return ug(d,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},O.tx=function(i){return i===B?this.getTranslateX():(this.setTranslateX(i),void 0)},O.getTranslateX=function(){return this._65O},O.setTranslateX=function(T){var j=this,b=j.getWidth()-j._64I;b>T&&(T=b),T>0&&(T=0),T=A(T);var h=j._65O;j._65O=T,j.fp(Fo,h,T)}},ms_ty:function(E){E._23Q=0,E._66O=0,E._41o=function(){return this.getHeight()<this._23Q},E.getLogicalPoint=function(m){return ug(m,this._canvas||this._view,this.tx?this.tx():0,this.ty())},E.ty=function(S){return S===B?this.getTranslateY():(this.setTranslateY(S),void 0)},E.getTranslateY=function(){return this._66O},E.setTranslateY=function(z){var x=this,M=x.getHeight()-x._23Q;M>z&&(z=M),z>0&&(z=0),z=A(z);var b=x._66O;x._66O=z,x.fp(Yf,b,z)}},ms_txy:function(u){u._65O=0,u._66O=0,u.tx=function(W){return W===B?this.getTranslateX():(this.setTranslateX(W),void 0)},u.ty=function(F){return F===B?this.getTranslateY():(this.setTranslateY(F),void 0)},u.onTranslateEnded=function(){},u.setTranslate=function(v,B,T){var P=this;if(T=Mg(T)){P._65I&&P._65I.stop(!0);var x=P.tx(),_=P.ty();T.action=function(g){P.setTranslate(x+(v-x)*g,_+(B-_)*g)},T._37o=function(){delete P._66I,delete P._65I,P.onTranslateEnded()},P._66I=1,P._65I=ll(T)}else P.tx(v),P.ty(B)},u.getTranslateX=function(){return this._65O},u.setTranslateX=function(J){var i=this;J=i.adjustTranslateX(J);var t=i._65O;i._65O=J,i.fp(Fo,t,J)},u.getTranslateY=function(){return this._66O},u.setTranslateY=function(y){var q=this;y=q.adjustTranslateY(y);var x=q._66O;q._66O=y,q.fp(Yf,x,y)},u.adjustTranslateX=function(q){return A(q)},u.adjustTranslateY=function(b){return A(b)},u.translate=function(o,n,q){this.setTranslate(this.tx()+o,this.ty()+n,q)},u.getLogicalPoint=function(U){var R=this;return ug(U,this._canvas||R._view,R.tx(),R.ty())}},ms_dm:function(m){m.dm=function(K){return K?(this.setDataModel(K),void 0):this.getDataModel()},m.getDataModel=function(){return this._dataModel}},ms_lp:function(q){q.lp=function(B){return this.getLogicalPoint(B)}},ms_v:function(y){y._disabled=!1,y.setDisabled=function(k,d){var N=this,x=N._disabled;x!==k&&(x&&(sn(N._63O),delete N._63O),k&&(vk(N._view,N._63O=Un(d)),N.iv()),N._disabled=k,N.fp("disabled",x,k))},y.isDisabled=function(){return this._disabled},y.getDisabledDiv=function(){return this._63O},y.getView=function(){return this._view},y.addToDOM=function(J){var Z=this,m=Z.getView(),q=m.style;J=J||N.body,J.appendChild(m),q.left="0",q.right="0",q.top="0",q.bottom="0",e(P,"resize",function(){Z.iv()}),Z.iv()},y.getWidth=function(){return this._view.clientWidth},y.getHeight=function(){return this._view.clientHeight},y.setWidth=function(X){var d=this;d._view.style.width=X+Ee,d.iv(),d.fp&&d.fp(wf,h,X)},y.setHeight=function(G){var D=this;D._view.style.height=G+Ee,D.iv(),D.fp&&D.fp(Qd,h,G)},y.setFocus=function(d){var K=this,r=K._currentEditor;return d&&r&&(r.getView&&(r=r.getView()),r.contains(d.target))?!1:(gc(K._view),K.endEditing&&K.endEditing(),K.fireViewEvent("focus"),!0)},y.iv=function(L){this.invalidate(L)},y.invalidate=function(I){var c=this;c._68I||(c._68I=1,Qe(c.validate,c,h,I),c.onInvalidated&&c.onInvalidated(),c.fireViewEvent("invalidate"))},y.validate=function(){var c=this,F=c._view;if(c._68I&&(delete c._68I,F.parentNode))if(0===F.offsetWidth&&0===F.offsetHeight&&c._67I!==h)c._67I===B&&(c._67I=l.reinvalidateCount),c._67I>0?c._67I--:c._67I=h,c.iv();else{c.fireViewEvent("beginValidate"),c.validateImpl(),c.onValidated&&c.onValidated(),c.fireViewEvent("validate");var S=c._63O;S&&(F.lastChild!==S&&(sn(S),vk(F,S)),cn(S,0,0,c.getWidth(),c.getHeight())),zg(c),Rb(c),ts(c)}},y.layout=function(i,B,X,J){1===arguments.length?cn(this,i):cn(this,i,B,X,J)},y.addViewListener=function(X,w,S){var W=this;W._67O||(W._67O=new $m),W._67O.add(X,w,S)},y.removeViewListener=function(s,P){this._67O.remove(s,P)},y.fireViewEvent=function(H){var D=this;D._67O&&(Ek(H)&&(H={kind:H}),D._67O.fire(H)),l.viewListener&&l.viewListener(D,H)}},ms_tip:function(y){y.setToolTipEnabled=function(P){var p=this;P?An||p._13o||(p.enableToolTip(),p.fp("toolTipEnabled",!1,!0)):p._13o&&(p.disableToolTip(),p.fp("toolTipEnabled",!0,!1))},y.isToolTipEnabled=function(){return!!this._13o},y.enableToolTip=function(){var B=this;if(!An&&!B._13o){B._13o=function(U){var p=B.getToolTip(U);p!=h?(l.toolTipContinual&&l.isToolTipShowing()?rg(U,p):(df(),Dm={timeout:kl(re,Ii),e:U,info:p}),In={e:U,view:B}):df()};var J=B.getView();e(J,kr,B._13o),e(J,"mouseleave",l.hideToolTip)}},y.disableToolTip=function(){var z=this;if(z._13o){var Q=z.getView();J(Q,kr,z._13o),J(Q,"mouseleave",l.hideToolTip),delete z._13o}},y.getToolTip=function(r){var J=this;if(J.getDataAt){var E=J.getDataAt(r);return E?E.getToolTip():h}return J.getValue?J.getValue():void 0}},_52o:function(D){D._zoom=1,D._29I=zn,D.zoomIn=function(z,J){this.setZoom(this._zoom*rq,z,J)},D.zoomOut=function(u,M){this.setZoom(this._zoom/rq,u,M)},D.zoomReset=function(z,d){this.setZoom(1,z,d)},D.scrollZoomIn=function(z){this.setZoom(this._zoom*im,h,z)},D.scrollZoomOut=function(b){this.setZoom(this._zoom/im,h,b)},D.pinchZoomIn=function(P){this.setZoom(this._zoom*jg,h,P)},D.pinchZoomOut=function($){this.setZoom(this._zoom/jg,h,$)},D.adjustZoom=function(P){return Be>P?Be:P>_r?_r:P},D.getZoom=function(){return this._zoom},D.setZoom=function(Q,n,l){var K=this;if(n=Mg(n)){K._14o&&K._14o.stop(!0);var r=K._zoom;n.action=function(X){K._96O(r+(Q-r)*X,l)},n._37o=function(){delete K._zooming,delete K._14o,K.onZoomEnded()},K._zooming=1,K._14o=ll(n)}else K._96O(Q,l)},D._96O=function(F,v){var o=this;if(F=o.adjustZoom(F),F!==o._zoom){o.validate();var R=o._29I,W=o._zoom;0!==R.width&&0!==R.height&&(v=v?v:{x:R.x+R.width/2,y:R.y+R.height/2},o.tx((v.x-R.x)*W-v.x*F),o.ty((v.y-R.y)*W-v.y*F)),o._zoom=F,o.fp("zoom",W,F)}}},ms_edge:function(g){g._2I=function(x){var z=this;z._44I||(z._44I=new bp),z._42I||(z._42I=new bp),z._44I.add(x),z._42I.add(x),z._20I()},g._4I=function(F){var b=this;b._44I||(b._44I=new bp),b._43I||(b._43I=new bp),b._44I.add(F),b._43I.add(F),b._20I()},g._16I=function(k){var z=this;z._44I.remove(k),z._42I.remove(k),z._44I.isEmpty()&&delete z._44I,z._42I.isEmpty()&&delete z._42I,z._20I()},g._18I=function(n){var H=this;H._44I.remove(n),H._43I.remove(n),H._44I.isEmpty()&&delete H._44I,H._43I.isEmpty()&&delete H._43I,H._20I()},g._20I=function(){var F=this;if(delete F._45I,!F._44I||F._44I.isEmpty())return delete F._70O,void 0;var Q;F._44I.each(function(x){x.isLooped()&&(Q||(Q={}),Q[x._id]||(F._45I||(F._45I=new bp),F._45I.add(x),Q[x._id]=x))}),Q?(F._70O=new bp,F._44I.each(function(H){Q[H._id]?"A"===Q[H._id]||(Q[H._id]="A",F._70O.add(H)):F._70O.add(H)})):F._70O=F._44I},g.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},g.getSourceAgentEdges=function(){return this._46I},g.getTargetAgentEdges=function(){return this._47I},g._1I=function(Q){var m=this;m._46I||(m._46I=new bp),m._48I||(m._48I=new bp),m._46I.add(Q),m._48I.add(Q),m._19I()},g._3I=function(r){var y=this;y._47I||(y._47I=new bp),y._48I||(y._48I=new bp),y._47I.add(r),y._48I.add(r),y._19I()},g._15I=function(N){var u=this;u._46I.remove(N),u._48I.remove(N),u._46I.isEmpty()&&delete u._46I,u._48I.isEmpty()&&delete u._48I,u._19I()},g._17I=function(g){var t=this;t._47I.remove(g),t._48I.remove(g),t._47I.isEmpty()&&delete t._47I,t._48I.isEmpty()&&delete t._48I,t._19I()},g._19I=function(){var F=this;delete F._49I;var H=F._48I;if(H&&!H.isEmpty()){var w={};H.each(function(C){w[C._id]?F._49I||(F._49I=new bp):w[C._id]=C}),F._49I?H.each(function(m){w[m._id]&&(F._49I.add(m),delete w[m._id])}):F._49I=H}},g.getLoopedEdges=function(){return this._45I},g.getEdges=function(){return this._70O},g.getAgentEdges=function(){return this._49I},g.getSourceEdges=function(){return this._42I},g.getTargetEdges=function(){return this._43I},g._8I=function(){this._70O&&this._70O.each(function(y){y._7I()})}},ms_shadow:function(J){Kj.PARAMS.forEach(function(m){var P=m.replace(/(^|\.)[a-z]/g,function(f){return f[f.length-1].toUpperCase()}),U=P.charAt(0).toLowerCase()+P.substr(1);J["getShadow"+P]=function(){return this._getShadowParam(U)},J["setShadow"+P]=function($){this._setShadowParam(U,$)}}),J.enableShadow=function(L){this.shadowMap.setShadow(!0,L)},J.disableShadow=function(){this.shadowMap.setShadow(!1)},J._getShadowParam=function(K){return this.shadowMap.getShadow()[K]},J._setShadowParam=function(D,B){var W=this._getShadowParam(D),z={};z[D]=B;var y=this.shadowMap;y.setShadow(y.enable,z),this.firePropertyChange("shadow"+D.charAt(0).toUpperCase()+D.substr(1),W,B)}}};sq(l,{getVersion:function(){return"7.2.3"}},!0),sq(l,{numberDigits:5,crossOrigin:"",baseZIndex:B,isTouchable:An,mockTouch:!0,devicePixelRatio:P.devicePixelRatio?P.devicePixelRatio:P.screen?P.screen.deviceXDPI/P.screen.logicalXDPI:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:V.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return dl},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(A){return A*A},labelColor:wm,labelSelectColor:Rj,labelFont:"12px arial, sans-serif",widgetIndent:An?30:20,widgetRowHeight:An?30:20,widgetHeaderHeight:An?32:22,widgetTitleHeight:An?34:24,scrollBarColor:xl,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:An?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:zh,intersectionLineLine:As,isEnter:er,isEsc:oo,isDelete:Ej,isSpace:fr,isLeft:bq,isUp:Gh,isRight:jh,isDown:di,isTouchEvent:Le,getTarget:hg,isString:Ek,isNumber:ih,isBoolean:He,isArray:Nl,isSelectAll:id,isFunction:bo,isObject:xg,getPropertyValue:lf,setPropertyValue:uq,addMethod:sq,createGradient:function(n,t,U,E,k,D,u,r){var Z=Ic[t];return Z(n,U,E,k,D,u,r)},appendToScreen:function(Z){Z=Z.getView?Z.getView():Z,(N.fullscreenElement||N.mozFullScreenElement||N.webkitFullscreenElement||N.msFullscreenElement||N.body).appendChild(Z)},encodeString:function(n){return R.Math.encodeBase64(n,l.encodeStringKey)},decodeString:function(p){return R.Math.decodeBase64(p,l.encodeStringKey)},findView:function(p){var j=function(s,G){var T=G._ht;T&&s.push(T);var W=G.children,h=W.length;if(h)for(var N=0;h>N;N++)j(s,W[N])},D=[];j(D,N.body);var n=function(P,W){for(var F="2d"===W?hi.GraphView:jq.Graph3dView,m=0,l=P.length;l>m;m++)if(P[m]instanceof F)return D[m];return null};return"all"===p?D:"2d"===p?n(D,"2d"):"3d"===p?n(D,"3d"):n(D,"3d")||n(D,"2d")},toggleFullscreen:function(W){var c=W.getView();if(N.fullscreenElement||N.mozFullScreenElement||N.webkitFullscreenElement||N.msFullscreenElement)N.exitFullscreen?N.exitFullscreen():N.msExitFullscreen?N.msExitFullscreen():N.mozCancelFullScreen?N.mozCancelFullScreen():N.webkitExitFullscreen&&N.webkitExitFullscreen();else{var o=!0;if(W.isSelfViewEvent){var h=W.getX(),i=W.getY(),A=W.getWidth(),q=W.getHeight(),u=c.style.background,I=c.style.backgroundColor;u||I||(c.style.backgroundColor="white"),c.requestFullscreen?c.requestFullscreen():c.msRequestFullscreen?c.msRequestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.webkitRequestFullscreen&&c.webkitRequestFullscreen();var $=setInterval(function(){if(c!==(N.fullscreenElement||N.mozFullScreenElement||N.webkitFullscreenElement||N.msFullscreenElement))clearInterval($),W.setX(h),W.setY(i),W.setWidth(A),W.setHeight(q),W._fullscreen=!1,c.style.oldBackgroundColor=I,W.iv();else{var O=R.Default.getWindowInfo();(o||O.width!==W.getWidth()||O.height!==W.getHeight())&&(W.setX(O.left),W.setY(O.top),W.setWidth(O.width),W.setHeight(O.height),W._fullscreen=!0,W.iv(),o=!1)}},500)}else{var a=c.style.left,g=c.style.top,A=c.style.width,q=c.style.height,u=c.style.background,I=c.style.backgroundColor;u||I||(c.style.backgroundColor="white"),c.requestFullscreen?c.requestFullscreen():c.msRequestFullscreen?c.msRequestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.webkitRequestFullscreen&&c.webkitRequestFullscreen();var $=setInterval(function(){if(c!==(N.fullscreenElement||N.mozFullScreenElement||N.webkitFullscreenElement||N.msFullscreenElement))clearInterval($),c.style.left=a,c.style.top=g,c.style.width=A,c.style.height=q,c.style.oldBackgroundColor=I,W.iv();else{var L=R.Default.getWindowInfo();(o||L.width!==W.getWidth()||L.height!==W.getHeight())&&(cn(W),o=!1)}},500)}}},appendTimeStamp:function(g){return g},setCompType:function(Z,g){Ek(g)&&g.substr(0,12)==li&&(g=l.parse(g)),bo(g)||xg(g)?fg[Z]=g:Vq(Z)},getCompType:function(E){var u=fg[E];return u===B&&ri.test(E)&&Vq(E),u},getCompTypeMap:function(){return fg},drawCompType:function(v,x,u,J,W,d){v(x,u,J,W,d)},numberListener:function(){var N={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(F){var E=F.keyCode;N[E]||65===E&&l.isCtrlDown(F)||86===E&&l.isCtrlDown(F)||67===E&&l.isCtrlDown(F)||88===E&&l.isCtrlDown(F)||E>=35&&40>=E||(F.shiftKey||48>E||E>57)&&(96>E||E>105)&&F.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(Q){var v=Q.target.tagName;("DIV"===v||"CANVAS"===v)&&!(l.ignoreKeyCodes.indexOf(Q.keyCode)>=0)&&("keydown"!==Q.type||bq(Q)||jh(Q)||Gh(Q)||di(Q)||Ej(Q)||65===Q.keyCode&&(Q.metaKey||Q.ctrlKey))&&Q.cancelable===!0&&(Q.preventDefault(),Q.preventManipulation&&Q.preventManipulation())},getWindowInfo:function(){var g=N.documentElement,Z=g&&(g.scrollLeft||g.scrollTop)?g:N.body;return{target:Z,left:Z.scrollLeft,top:Z.scrollTop,width:P.innerWidth||Z.clientWidth,height:P.innerHeight||Z.clientHeight}},isDragging:function(){return!!dl},isLeftButton:function(K){return Le(K)?!0:0===K.button},isMiddleButton:function(v){return Le(v)?!1:v&&(1===v.button||4&(v.buttons||0))},isRightButton:function(F){return Le(F)?!1:F&&(2===F.button||2&(F.buttons||0))},isInput:function(S){if(!S)return!1;var Z=S.tagName;return"INPUT"===Z||"TEXTAREA"===Z||"SELECT"===Z},getTouchCount:function(E){return Le(E)?E.touches.length:1},isDoubleClick:function(){function Y(q){q.details=0,q.timeout=null,q.lastPoint=null}var Z={};return $j=new Bk,Tb=$j.getTime(),function(r){if(uh(r)>1)return!1;var b=r.button==h?"":r.button,z=r.type+b,F=z+"_isDoubleClick",T=Z[z];if(T||(T=Z[z]={details:0,timeout:null,lastPoint:null}),r[F]===B){r[F]=!0;var j=Cd(r);T.timeout&&(vc(T.timeout),T.timeout=null);var S=Le(r)?l.doubleTouchRange:l.doubleClickRange;T.lastPoint&&Jf(T.lastPoint,j)>S&&Y(T),T.lastPoint=j,T.details++,T.timeout=kl(function(){Y(this)}.bind(T),l.doubleClickSpeed)}return 2===T.details}}(),isShiftDown:function(x){return x?x.shiftKey:Mk["16"]},isCtrlDown:function(q){return q?Bs?q.metaKey:q.ctrlKey:Bs?Mk["91"]:Mk["17"]},getClientPoint:function(o){return Le(o)&&(o=ef(o)),{x:o.clientX,y:o.clientY}},isMouseEvent:function(X){return X instanceof MouseEvent||0===X.type.indexOf("mouse")},getTargetElement:function(F){var Q,X=Oh(F);if(Q=l.isMouseEvent(F)||!N.elementFromPoint?F.target:N.elementFromPoint(X.x,X.y),Sj&&N.elementFromPoint){for(var K=[],$=[];"none"===Q.style.pointerEvents;)K.push(Q),$.push(Q.style.display||""),Q.style.display="none",Q=N.elementFromPoint(X.x,X.y);K.forEach(function(d,E){d.style.display=$[E]})}return Q},getPagePoint:function(d){return Le(d)&&(d=ef(d)),{x:d.pageX,y:d.pageY}},createObject:function(N,J){var b=new N;for(var z in J){var s=J[z];if(bo(s))b[z]=s;else if(0===z.indexOf("s:"))b.s(z.substr(2),J[z]);else if(0===z.indexOf("a:"))b.a(z.substr(2),J[z]);else{var Z=gl(z),s=J[z];b[Z]?(b[Z](s),"setToolTip"===Z&&b.enableToolTip&&b.enableToolTip()):b[z]=s}}return b},setImage:function(c,z,x,D){var U=arguments.length;4===U?yk(c,D,z,x):2===U?Ek(z)?z.substr(0,12)==li?rb(c,l.parse(z)):yk(c,z):rb(c,z):1===U&&yk(c,c)},getImage:function(D,x,i){var e;if(D==h)return h;if(xg(D)?e=D:(e=Lc[D],D&&e===B&&(Mo&&Mo[D]||yk(D,D))),x&&e&&e.tagName){var g;g="override"===i?"colors_override":"override_rgb"===i?"colors_override_rgb":"override_a"===i?"colors_override_a":"colors",e[g]||(e[g]={__count__:0});var b=e[g][x];return b||(e[g].__count__>l.imageCacheThreshold&&(e[g]={__count__:0}),b=Ng(e,vg(x),e.width,e.height,i),e[g][x]=b,e[g].__count__++),b}return e},isImageComplete:function(X,i,D){var u=vo(X);if(!u)return!1;if(u.tagName)return u.complete;for(var s,X,M,G=u.comps,b=!0,$=0,e=G.length;e>$;$++)if(s=G[$],M=s.type,"image"===s.type){X=s.name,X&&X.func&&(X=pk(X,i));var q=On(X,i,D);if(!q){b=!1;break}}else if(ri.test(M)&&l.getCompType(M)===B){b=!1,Vq(M);break}return b},getId:function(){var r=1;return function(){return++r}}(),callLater:function(Y,C,K,Q){var T=function(){Y.apply(C,K)};return Q?kl(T,Q):P.requestAnimationFrame(T)},cancelLater:function(U,A){A?vc(U):P.cancelAnimationFrame(U)},clone:function(l){if(null==l||"object"!=typeof l)return l;if(l instanceof Date){var U=new Date;return U.setTime(l.getTime()),U}if(l instanceof Array){for(var U=[],O=0,V=l.length;V>O;O++)U[O]=lg(l[O]);return U}if(l instanceof bp){for(var U=new bp,O=0,V=l.length;V>O;O++)U.set(O,lg(l.get(O)));return U}if(l instanceof Dr)return l;if(l instanceof Ge){var U=new Ge;return U.deserialize(l.serialize()),U}if(l instanceof w){var U={};for(var J in l)l.hasOwnProperty(J)&&(U[J]=lg(l[J]));return U}return l},callWhenLoaded:function(V,x){x=x||100;var n=qe(V,x);mk||(mk={}),mk[n]={tick:n,cb:V,delay:x}},beforeLoadURL:function(x,t){if(mk){var e={};for(var t in mk){var P=mk[t];vc(P.tick);var $=qe(P.cb,P.delay);e[$]={tick:$,delay:P.delay,cb:P.cb}}mk=e}return l.convertURL?l.convertURL(x,t):x},convertURL:function(r){return r},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return l.getImage("default_blank")},resizeImagePOT:function(k,t){if(!k||!k.tagName)return k;var p=k.width,s=k.height;if(!p||!s)return k;if(Np.isPOT(p)&&Np.isPOT(s)&&(!t||p===s))return k;var Y,m;t?m=Y=Np.nearestPOT(Math.min(p,s)):(Y=Np.nearestPOT(p),m=Np.nearestPOT(s));var H=Mb(),l=H.getContext("2d");return qh(H,Y,m,1),l.drawImage(k,0,0,p,s,0,0,Y,m),H},sortFunc:function(o,G){if(o===G)return 0;if(o==h&&G!=h)return 1;if(o!=h&&G==h)return-1;if(o==h&&G==h)return 0;var P,y=typeof o,e=typeof G;return y===Eb&&e===Eb?P=o.localeCompare(G):y===qr&&e===qr&&(P=o-G),P===B&&(P=(""+o).localeCompare(""+G)),P>0?1:0>P?-1:0},getClassMap:function(){return Ro},getClass:function(v){if(Ek(v)){var A,u=Ro[v];if(!u){A=v.split("."),u=P;for(var N=0;N<A.length;N++)u=u[A[N]];Ro[v]=u}return u}return v},def:function(w,A,_){var P,X,U,K=function(){};if(K.prototype=A.prototype,P=new K,Ek(w)){if(Ro[w])throw"'"+w+"' already defined";U=zq(w),P.getClassName=function(){return w}}else U=w;if(P.constructor=U,P.getClass=function(){return U},P.getSuperClass=function(){return A},_)for(X in _)jl[X]&&jl.hasOwnProperty(X)?jl[X](P,_):Zq(P,_,X);U.prototype=P,U.superClass=A.prototype},startAnim:function(){var Z=function(D){D.duration&&(D.startTime=Yl()),D.timeId=Qe(D.tick,h,h,D.interval)};return function(R){return R=lg(R),R.easing=R.easing||l.animEasing,R.duration||R.frames||(R.duration=l.animDuration),R.t=0,R.duration?R.interval=0:(R.frame=0,R.interval=R.interval||10),R.tick=function(){if(R.duration){var Y=(Yl()-R.startTime)/R.duration;if(Y>1&&(Y=1),R.t=Y,R.action(R.easing(Y),Y),!R.isRunning())return;1===Y?R.stop():R._isPaused||(R.timeId=Qe(R.tick))}else{if(R.frame++,Y=R.t=R.frame/R.frames,R.action(R.easing(Y),Y),!R.isRunning())return;R.frame<R.frames?R._isPaused||(R.timeId=Qe(R.tick,h,h,R.interval)):R.stop()}},R.resume=function(){R._isPaused&&(delete R._isPaused,R.duration?R.t<1&&(R.startTime=Yl()-R.duration*R.t,R.timeId=Qe(R.tick)):R.frame<R.frames&&(R.timeId=Qe(R.tick,h,h,R.interval)))},R.pause=function(){rj(R.timeId,!R.duration),R._isPaused=!0},R.isPaused=function(){return this._isPaused},R.stop=function(g){R.isRunning()&&(rj(R.timeId,!R.duration),delete R.timeId,R.duration?R.t<1&&g&&(R.t=1,R.action(R.easing(1),1)):R.frame<R.frames&&g&&(R.frame=R.frames,R.action(R.easing(1),1)),R._37o&&R._37o(),R.finishFunc&&R.finishFunc())},R.isRunning=function(){return R.timeId!=h},R.delay?Qe(Z,h,[R],R.delay):Z(R),R}}(),getTextSize:function(){var s={},Z=N?Mb().getContext("2d"):h;return function(p,a){Z.font=p?p:Zr;var u=s[Z.font];return u||(u=2*Z.measureText("e").width+4,s[Z.font]=u),{width:Z.measureText(a).width+4,height:u}}}(),drawText:function(F,X,v,M,e,n,i,Z,N,H){if(X!=h){var o=Jm(v,X),t={};t.y=H&&H!==Dg?H===Pi?n+o.height/2:n+Z-o.height/2:n+Z/2,t.x=N&&N!==Se?N===_d?e+i-o.width/2:e+i/2:e+o.width/2,Po(F,X,t,v,M)}},getDistance:function($,_){var d=$.length;return _?3===d?m(sg($[0]-_[0])+sg($[1]-_[1])+sg($[2]-_[2])):2===d?m(sg($[0]-_[0])+sg($[1]-_[1])):$.z===B?m(sg(_.x-$.x)+sg(_.y-$.y)):m(sg(_.x-$.x)+sg(_.y-$.y)+sg(_.z-$.z)):3===d?m(sg($[0])+sg($[1])+sg($[2])):2===d?m(sg($[0])+sg($[1])):void 0},brighter:function(r,n){return 0>n&&(n=-n),sd(r,n?n:40)},darker:function(r,q){return q>0&&(q=-q),sd(r,q?q:-40)},unionPoint:function(y,D){if(!y)return h;if(2===arguments.length)return y&&D?{x:v(y.x,D.x),y:v(y.y,D.y),width:$(y.x-D.x),height:$(y.y-D.y)}:h;var Q=y;if(Q._as&&(Q=Q._as),Q.length===B)return h;var z=Q.length;if(0>=z)return h;for(var u=1,_=Q[0],E={x:_.x,y:_.y,width:0,height:0};z>u;u++){_=Q[u];var W=v(E.x,_.x),r=I(E.x+E.width,_.x),K=v(E.y,_.y),q=I(E.y+E.height,_.y);E.x=W,E.y=K,E.width=r-W,E.height=q-K}return E},unionRect:function(Y,G){if(Y&&!G)return lg(Y);if(!Y&&G)return lg(G);if(Y&&G){var W={x:v(Y.x,G.x),y:v(Y.y,G.y)};return W.width=I(Y.x+Y.width,G.x+G.width)-W.x,W.height=I(Y.y+Y.height,G.y+G.height)-W.y,W}return h},containsPoint:function(P,g,s,e){if(e!=h&&1!==e){var R=P.x+P.width/2,w=P.y+P.height/2;P={x:R-P.width/2*e,y:w-P.height/2*e,width:P.width*e,height:P.height*e}}if(s){var G=P.width/2,U=P.height/2,n=a(-s),O=d(-s),t=g.x-P.x-G,m=g.y-P.y-U;return g={x:O*t-n*m,y:n*t+O*m},Ib({x:-G,y:-U,width:P.width,height:P.height},g)}return!(!P||g.x<P.x||g.y<P.y||g.x>P.x+P.width||g.y>P.y+P.height)},containsRect:function(o,E){if(!o||!E)return!1;var i=E.x,W=E.y,n=E.width,B=E.height,L=o.width,a=o.height;if(0>(L|a|n|B))return!1;var u=o.x,r=o.y;if(u>i||r>W)return!1;if(L+=u,n+=i,i>=n){if(L>=u||n>L)return!1}else if(L>=u&&n>L)return!1;if(a+=r,B+=W,W>=B){if(a>=r||B>a)return!1}else if(a>=r&&B>a)return!1;return!0},intersectsRect:function(j,v){if(!j||!v)return!1;var L=v.width,y=v.height,U=j.width,h=j.height;if(0>=U||0>=h||0>=L||0>=y)return!1;var z=v.x,P=v.y,K=j.x,c=j.y;return U+=K,h+=c,L+=z,y+=P,U>z&&h>P&&L>K&&y>c},intersection:function(O,R){if(!O||!R)return h;var Q=R.x,d=R.y,b=O.x,J=O.y,t=Q,y=d,X=b,e=J;return t+=R.width,y+=R.height,X+=O.width,e+=O.height,b>Q&&(Q=b),J>d&&(d=J),t>X&&(t=X),y>e&&(y=e),t-=Q,y-=d,0>=t||0>=y?h:{x:Q,y:d,width:t,height:y}},grow:function(j,k,F){F===B&&(F=k),j.x-=k,j.y-=F,j.width=j.width+2*k,j.height=j.height+2*F},getScreenPoint:function(f,i,s,W,A,e,O){var Q=s.getBoundingClientRect(),h=f*(e||1)-s.scrollLeft+(W||0),y=i*(O||1)-s.scrollTop+(A||0),V=Rp(s,!1);if(V){var n=new qp(h,y,0);return n.applyMatrix4(V),console.log(n),{x:n.x,y:n.y}}return{x:h+Q.left,y:y+Q.top}},getLogicalPoint:function(S,V,g,N,W,l){var r,F,I=V.getBoundingClientRect();S.target?(Nq(S)?Bs?Mk["91"]=!0:Mk["17"]=!0:Bs?Mk["91"]=!1:Mk["17"]=!1,Mk["16"]=sh(S)?!0:!1,S=Le(S)?ef(S):S,r=S.clientX,F=S.clientY):(r=S.x,F=S.y);var n=Rp(V,!0);if(n){var L=new qp(r,F,0);L.applyMatrix4(n);do{if(Math.abs(L.z)<=1e-6)break;var H=new qp(r,F,1);if(H.applyMatrix4(matrix),Math.abs(H.z)<=1e-6){L=H;break}if(H.sub(L),Math.abs(H.z)<=1e-6)break;L.addScaledVector(H,-L.z/H.z)}while(!1);return{x:(L.x+V.scrollLeft-(g||0))/(W||1),y:(L.y+V.scrollTop-(N||0))/(l||1)}}return{x:(r-I.left+V.scrollLeft-(g||0))/(W||1),y:(F-I.top+V.scrollTop-(N||0))/(l||1)}},removeHTML:function(){var W;return function(C){return C&&C.getView&&(C=C.getView()),C&&C.parentNode?W===C?!0:(W=C,C.parentNode.removeChild(C),W=h,!0):!1}}(),getToolTipDiv:function(){if(!fm){fm=Xl(),Sk=Xl();var e=fm.style;l.baseZIndex!=h&&(e.zIndex=Bn(l.baseZIndex)+3+""),e.whiteSpace="nowrap",e.color=l.toolTipLabelColor,e.background=l.toolTipBackground,e.font=l.toolTipLabelFont,e.padding="5px",e.boxShadow="0px 0px 3px "+l.toolTipShadowColor}return fm},isToolTipShowing:function(){return fm&&fm.parentNode?!0:Sk&&Sk.parentNode?!0:!1},updateToolTipContent:function(k,$){if(l.isToolTipShowing()&&($||($=In&&In.view),k===B&&$&&In.e&&(k=$.getToolTip(In.e)),k!=h)){var p;k.html?(k=k.html,p=Sk):p=fm,p.innerHTML=k}},hideToolTip:function(){if(l.isToolTipShowing()){sn(fm),sn(Sk),Nn();var A=In&&In.view;A&&A.onHideToolTip&&A.onHideToolTip(),In=h}},showToolTip:function(o,D,m){if(!o||D==h)return df(),void 0;l.getToolTipDiv();var C,K;if(D.html?(D=D.html,C=Sk,sn(fm)):(C=fm,sn(Sk)),K=C.style,C.innerHTML=D,C.parentNode||R.Default.appendToScreen(C),o.target){o=Oh(o);var W=cq(),p=o.x,N=o.y,Z=An?60:12;if(An){var f=C.getBoundingClientRect();K.left=p-f.width/2+Ee,K.top=N-f.height-Z<W.top?N+Z+Ee:N-f.height-Z+Ee}else{K.left=p+Z+Ee,K.top=N+Z+Ee;var f=C.getBoundingClientRect();f.left+f.width>W.width&&(K.left=p-Z-f.width+Ee),f.top+f.height>W.height&&(K.top=N-Z-f.height+Ee),f.left<0&&(K.left=p+Z+Ee),f.top<0&&(K.top=N+Z+Ee)}}else K.left=o.x+Ee,K.top=o.y+Ee;Nn(),m===B?m=In&&In.view:In={e:o,view:m},m&&m.onShowToolTip&&m.onShowToolTip()},startDragging:function(Q,Z,i){i==B&&(i=!0),Q!==dl&&(dl?i&&(Le(Z)?dl.handleWindowTouchEnd(Z):dl.handleWindowMouseUp(Z)):Le(Z)?(e(P,le,Fp),e(P,jk,pr)):(e(P,kr,Eg),e(P,em,Tk)),dl=Q)},getImageMap:function(){return Lc},toBoundaries:function(e,W,v,V){var f=[];return xk(e,W,v,V).forEach(function(Y){var O=[];Y.forEach(function(Z){O.push(Z.x,Z.y)}),f.push(O)}),f},getCurrentKeyCodeMap:function(){return Mk},drawCenterImage:function(L,t,i,p,X,k,M,E){!X&&k&&k.isSelfViewEvent&&(X=k);var F=sm(t,X,k),U=wq(t,X,k);If(L,t,A(i-F/2),A(p-U/2),F,U,X,k,M,E)},drawStretchImage:function(J,F,q,x,H,W,d,Q,u,g,E,l){!Q&&u&&u.isSelfViewEvent&&(Q=u);var D,Y=sm(F,Q,u,W),S=wq(F,Q,u,d);"uniform"===q?(D=v(W/Y,d/S),Y*=D,S*=D,x+=A((W-Y)/2),H+=A((d-S)/2),W=Y,d=S):"centerUniform"===q&&((Y>W||S>d)&&(D=v(W/Y,d/S),Y*=D,S*=D),x+=A((W-Y)/2),H+=A((d-S)/2),W=Y,d=S);var j=J.interactiveInfo;if(j){var w;if(w="center"===q?{x:x+W/2-Y/2,y:H+d/2-S/2,width:Y,height:S}:{x:x,y:H,width:W,height:d},j.rect){var L=j.compInfos,p=L.length;p&&(L[p-1].rect.image=F)}else j.rect=w}if("center"===q){var K=E!==!1&&(Y>W||S>d);K&&(J.save(),J.beginPath(),J.rect(x,H,W,d),J.clip()),If(J,F,x+W/2-Y/2,H+d/2-S/2,Y,S,Q,u,g,l),K&&J.restore()
}else If(J,F,x,H,W,d,Q,u,g,l)},toCanvas:function(S,Z,W,J,$,H,d,L,P){S=vo(S,d),Z=Z||sm(S,$),W=W||wq(S,$);var h=Mb(),s=hb(h);return L?(qh(h,Z,W,L),s.scale(L,L)):qh(h,Z,W,1),eq(s,S,J,0,0,Z,W,$,H,d,P),S&&S.clampToEdge&&(h.clampToEdge=S.clampToEdge),s.restore(),h},toGrayColor:function(w){if(!w)return w;var P=gg(w),y=A(.299*P[0]+.587*P[1]+.114*P[2]);return"rgba("+y+","+y+","+y+","+P[3]/255+")"},createGradientImage:function(B,w,x,P){for(var W=["L",0,0,B,0,1,0,0,1,0,0],O=0,m=Math.min(w.length,x.length);m>O;O++)W.push(x[O],w[O]);var J=R.Default.toCanvas({width:B,height:B,clampToEdge:!0,comps:[{type:"shape",rotation:P||0,points:[0,0,B,0,B,B,0,B],background:"#ffffff",gradientPack:W}]});return J},createElement:function(D,Z,J,f){var G=N.createElement(D);return _n(G,Z||V.widgetBorder,2),G.style.font=J?J:Zr,f!=h&&(G.value=f),l.onElementCreated&&l.onElementCreated(G),G},containedInView:function(r,z){var j=Sq(z).getBoundingClientRect();return Ib({x:j.left,y:j.top,width:j.width,height:j.height},Cd(r))},isIsolating:function(){return Aj>0},setIsolating:function(z){z?Aj++:Aj--},getMSMap:function(){return jl},stringify:function(c,E,Q){var F=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var $=Ge.prototype.toJSON;Ge.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},E=Q?0:E==h?2:E;var K=JSON.stringify(c,function(L,w){return"function"==typeof w?"__ht__"+(w.__ht__||w.toString()):ih(w)?ym(w):w instanceof R.List?"__ht__list"+(w.__ht__list||l.stringify(w._as)):w},E);return Date.prototype.toJSON=F,Ge.prototype.toJSON=$,Q&&(K=li+Hc(K)),K},parse:function(G,E){return Ek(G)?G.substr(0,12)!=li||(G=Fn(G.substr(12)),Ek(G))?(E=E||{},JSON.parse(G,function(D,z){if(Ek(z))if(E.ignoreFunction||"__ht__function"!=z.substr(0,14)){if(!E.ignoreDate&&"__ht__date"==z.substr(0,10))return new Date(Bn(z.substr(10)));if("__ht__list"===z.substr(0,10))return new bp(l.parse(z.substr(10)));if(!E.ignoreDataModel&&"__ht__dataModel"===z.substr(0,15)){var S=new Ge;return S.deserialize(l.parse(z.substr(15))),S}}else{var i=z.indexOf("{")+1,Z=z.lastIndexOf("}"),v=z.indexOf("(")+1,s=z.indexOf(")");if(i&&Z&&v&&s)try{var p=new Function(z.substring(v,s),z.substring(i,Z));return p.__ht__=z.substr(6),p}catch(t){throw console.info("=== SyntaxError ===\n",z),t}}return z})):G:G},loadJS:function(O,c){c&&O.push(c);var M=O.shift();if(Nl(M))O=M.contact(O),l.loadJS(O);else if(bo(M))M(),l.loadJS(O);else if(Ek(M)){var q=N.createElement("script");q.onload=function(){l.loadJS(O)},q.setAttribute("src",M),N.getElementsByTagName("head")[0].appendChild(q)}else O.length&&l.loadJS(O)},extendClass:function(O,s){var W=O.prototype;for(var e in s)jl[e]&&jl.hasOwnProperty(e)?jl[e](W,s):W[e]=s[e]},toRoundedCorner:function(){function I(K,g,s){K.x=g.x,K.y=g.e||s,K.z=g.y}var o=new qp,C=new qp,O=new qp,D=new qp;return function(n,x){var u,Q=0;n.getPoints&&(Q=n.getElevation(),n=n.getPoints()),u=n instanceof bp?n:new bp(n);var F=u.size();if(0>=x)return{points:u};var q=new bp,b=new bp,S=u.get(0);I(o,S,Q),q.add(S),b.add(1);for(var t=1;F>t;t++)if(F>t+1){var Z=u.get(t),V=u.get(t+1);I(C,Z,Q),I(O,V,Q),D.subVectors(o,C).setLength(Math.min(.99*D.length(),x)).add(C),Z.e!==B||S.e!==B?q.add({x:D.x,y:D.z,e:D.y}):q.add({x:D.x,y:D.z}),q.add(Z),D.subVectors(O,C).setLength(Math.min(.99*D.length(),x)).add(C),Z.e!==B||V.e!==B?q.add(S={x:D.x,y:D.z,e:D.y}):q.add(S={x:D.x,y:D.z}),o.copy(D),b.addAll([2,3])}else q.add(u.get(t)),b.add(2);return{points:q,segments:b}}}(),toColorData:gg,setCanvas:qh,createDiv:Xl,createDisabledDiv:Un,createView:fl,createCanvas:Mb,appendChild:vk,initContext:hb,checkLoadingImage:zg,translateAndScale:pm,layout:cn,getPosition:Fj,drawPoints:jj,drawRoundRect:Bf,drawBorder:ge,setFocus:gc,getter:Mm,setter:gl,isEmptyObject:Gi,cameraPriority:function(){var J={skybox:0,main:1e4,top:1e7,infinity:1/0};return w.seal(w.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return J.skybox},set:function(A){if(A>=J.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");J.skybox=Number(A)}},main:{configurable:!1,enumerable:!1,get:function(){return J.main},set:function(T){if(T<=J.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(T>=J.top)throw new RangeError("Main camera must have lower priority than the top camera.");J.main=Number(T)}},top:{configurable:!1,enumerable:!1,get:function(){return J.top},set:function(b){if(b<=J.main)throw new RangeError("Top camera must have higher priority than the main camera.");J.top=Number(b)}}}))}()},!0),sq(O,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Fq=l.disabledOpacity,Ii=l.toolTipDelay,Tp=l.devicePixelRatio,ws=l.autoMakeVisible,Qg=l.autoHideScrollBar,ad=l.imageGradient,rg=l.showToolTip,df=l.hideToolTip,Xh=l.dashPattern,Ue=l.lineCap,Wm=l.lineJoin,Si=l.labelColor,zo=l.labelSelectColor,Zr=l.labelFont,xs=l.widgetIndent,Hb=l.widgetRowHeight,yi=l.widgetHeaderHeight,_c=l.widgetTitleHeight,Wd=l.scrollBarColor,ol=l.scrollBarSize,fj=l.scrollBarTimeout,Gl=l.scrollBarMinLength,yq=l.scrollBarInteractiveSize,rq=l.zoomIncrement,im=l.scrollZoomIncrement,jg=l.pinchZoomIncrement,_r=l.zoomMax,Be=l.zoomMin,ui=l.createObject,jr=l.preventDefault,vf=l.setImage,vo=l.getImage,On=l.isImageComplete,Do=l.drawCenterImage,eq=l.drawStretchImage,Jc=l.getId,Qe=l.callLater,rj=l.cancelLater,zd=l.sortFunc,lg=l.clone,zq=l.getClass,ll=l.startAnim,wp=l.brighter,Qi=l.darker,dn=l.drawText,Jm=l.getTextSize,Pd=l.isLeftButton,$q=l.isMiddleButton,db=l.isRightButton,uh=l.getTouchCount,xi=l.isDoubleClick,sh=l.isShiftDown,Nq=l.isCtrlDown,Cd=l.getClientPoint,Oh=l.getPagePoint,Jf=l.getDistance,oj=l.unionPoint,Th=l.unionRect,Ib=l.containsPoint,Yk=l.containsRect,kb=l.intersectsRect,Wf=l.intersection,cq=l.getWindowInfo,Lq=l.grow,ug=l.getLogicalPoint,wo=l.getScreenPoint,Vc=l.startDragging,sn=l.removeHTML,Ol=l.createElement,Bc=l.segmentResolution,jd=l.shapeResolution,dh=l.shapeSide,tr=l.def,Dj=function($,b,F){tr(z+"."+$,b,F)},Kg=function(F,u){F.childNodes.forEach(function(J){u(J),Kg(J,u)})};sq(l,{toolTipLabelColor:Si,toolTipLabelFont:Zr,toolTipBackground:V.toolTipBackground,toolTipShadowColor:xl,debugTipLabelFont:Zr,debugTipLabelColor:Si,debugTipBackground:V.toolTipBackground,drawBreakableText:Wl,setDevicePixelRatio:function(A){Tp=l.devicePixelRatio="number"==typeof A?A:P.screen?P.screen.deviceXDPI/P.screen.logicalXDPI:1,Kg(N.body,function(V){var O=V._ht;O&&O._canvas&&(qh(O._canvas,O.getWidth(),O.getHeight()),O.redraw?O.redraw():O.iv())})}},!0);var Ji=1e-6,Yr="undefined"!=typeof Uint16Array?Uint16Array:Array,_p="undefined"!=typeof Float32Array?Float32Array:Array,il=function(G,t,W){var s=[G[0]-t[0],G[1]-t[1],G[2]-t[2]];if(W){var f=Jf(s);f>0&&(s[0]/=f,s[1]/=f,s[2]/=f)}return s},kd=function(){var T="charCodeAt",X=2*(2*wk.length+1);for(var u in P)if(u===z+Se[0]+(Ee.length+2)){var g=P[u];if(!g)break;for(var Q=g.length,L=0;Q>L;L++)if(g[L][T](0)===X&&g[L+1]!=h&&g[L+1]===Ee[0]&&g[L+2]!=h&&g[L+2][T](0)===X){for(var Z=L+3;Q>Z;Z++)if(g[Z][T](0)===X){if(0==g[Z+1])for(var E,W=Z+2;Q>W;W++){if(g[W][T](0)===X){0==g[W-1]&&E&&(zp=E.substr(0,E.length-1));break}E==h?E=g[W]:E+=g[W]}break}break}break}return function(b){return[-b[0],-b[1],-b[2]]}}(),fe=function(e,w){return 3===e.length?e[0]*w[0]+e[1]*w[1]+e[2]*w[2]:e[0]*w[0]+e[1]*w[1]},yo=function(){var z=new Array(16);return z[0]=1,z[1]=0,z[2]=0,z[3]=0,z[4]=0,z[5]=1,z[6]=0,z[7]=0,z[8]=0,z[9]=0,z[10]=1,z[11]=0,z[12]=0,z[13]=0,z[14]=0,z[15]=1,z},Fc=yo(),Dl=function(p){var L=new Array(16);return L[0]=p[0],L[1]=p[1],L[2]=p[2],L[3]=p[3],L[4]=p[4],L[5]=p[5],L[6]=p[6],L[7]=p[7],L[8]=p[8],L[9]=p[9],L[10]=p[10],L[11]=p[11],L[12]=p[12],L[13]=p[13],L[14]=p[14],L[15]=p[15],L},hd=function(C,i){return C[0]=i[0],C[1]=i[1],C[2]=i[2],C[3]=i[3],C[4]=i[4],C[5]=i[5],C[6]=i[6],C[7]=i[7],C[8]=i[8],C[9]=i[9],C[10]=i[10],C[11]=i[11],C[12]=i[12],C[13]=i[13],C[14]=i[14],C[15]=i[15],C},Om=function(R){return R[0]=1,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=1,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=1,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},$e=function(H,c){var y=H[0],v=H[1],b=H[2];return H[0]=c[0]*y+c[4]*v+c[8]*b+c[12],H[1]=c[1]*y+c[5]*v+c[9]*b+c[13],H[2]=c[2]*y+c[6]*v+c[10]*b+c[14],H},Qq=function(K,j){var W=K[0],w=K[1],m=K[2],H=K[3];return K[0]=j[0]*W+j[4]*w+j[8]*m+j[12]*H,K[1]=j[1]*W+j[5]*w+j[9]*m+j[13]*H,K[2]=j[2]*W+j[6]*w+j[10]*m+j[14]*H,K[3]=j[3]*W+j[7]*w+j[11]*m+j[15]*H,K},tj=function(){var v,w,c,n,Q=Ij(Zc[1]+Zc[7]),J=Ij(Zc[0]+Zc[3]-Zc[10]),O=Ij(Zc[8]+2),R=function(){return w=c.charAt(v),v+=1,w},k=function(){var X="";if(w===O)for(;R();){if(w===O)return R(),X;X+=w}else R()},g=function(){for(;w&&" ">=w;)R()},a=function(){var G,x={};if(w===Q){if(R(),g(),w===J)return R(),x;for(;w;){if(G=k(),g(),R(),x[G]=n(),g(),w===J)return R(),x;R(),g()}}};return n=function(){switch(g(),w){case Q:return a();default:return k()}},function(b){if(r={},b){var m;if(c=b,v=0,w=" ",m=n(),g(),!w)return m}}}(),vp=function(I,g){if(g){var A=a(g),T=d(g),r=I[4],c=I[5],K=I[6],M=I[7],U=I[8],Z=I[9],E=I[10],F=I[11];I[4]=r*T+U*A,I[5]=c*T+Z*A,I[6]=K*T+E*A,I[7]=M*T+F*A,I[8]=U*T-r*A,I[9]=Z*T-c*A,I[10]=E*T-K*A,I[11]=F*T-M*A}},jm=function(m,H){if(H){var w=a(H),v=d(H),F=m[0],O=m[1],W=m[2],I=m[3],u=m[8],U=m[9],e=m[10],z=m[11];m[0]=F*v-u*w,m[1]=O*v-U*w,m[2]=W*v-e*w,m[3]=I*v-z*w,m[8]=F*w+u*v,m[9]=O*w+U*v,m[10]=W*w+e*v,m[11]=I*w+z*v}},Dn=function(m,V){if(V){var n=a(V),X=d(V),w=m[0],$=m[1],l=m[2],i=m[3],e=m[4],r=m[5],q=m[6],D=m[7];m[0]=w*X+e*n,m[1]=$*X+r*n,m[2]=l*X+q*n,m[3]=i*X+D*n,m[4]=e*X-w*n,m[5]=r*X-$*n,m[6]=q*X-l*n,m[7]=D*X-i*n}},Vl=function(B,Z,i){return nm(h,i===!1?h:B.getFinalScale3d(),B.getFinalRotation3d(),B.getRotationMode(),B.p3(),h,Z)},nm=function(L,p,S,y,X,z,d){return z||(z=yo()),X&&ej(z,X),bb(z,S,y),d&&Mh(z,z,d),p&&Cg(z,p),L&&Mh(z,z,L),z},Yg=function(t,$,N){$=Bn($),N=Bn(N);var h=this;h.g=t,h._84O=$,h._85O=N,h._70I=!0,h.F=0,h._83O=$+N,h.pen={x:0,y:0}},nn="lineDashOffset",bs="setLineDash",Ak=function(W){for(var Y in W)1===Y.length&&(nn=W[Y]);return Y?1:0},gm=function(t,P,C){return Oi(P)?t:t[bs]?(t[bs](P),C&&(t.lineDashOffset=C),t):new Yg(t,P[0],P.length>1?P[1]:P[0])},Zb=function(w,d){!Oi(d)&&w[bs]&&(w[bs](Hj),w.lineDashOffset=0)};tr(Yg,w,{_69I:6,moveTo:function(y,t){var $=this,Y=$.pen;Y.x=y,Y.y=t,$.g.moveTo(y,t),$.start||($.start={x:y,y:t})},lineTo:function(U,X){var e=this,N=e.pen,x=U-N.x,h=X-N.y,f=Mj(h,x),F=d(f),L=a(f),n=e._23O(N.x,N.y,U,X),r=e._85O,p=e._84O,B=e._83O;if(e.F){if(e.F>n)return e._70I?e._72I(U,X):e.moveTo(U,X),e.F-=n,void 0;if(e._70I?e._72I(N.x+F*e.F,N.y+L*e.F):e.moveTo(N.x+F*e.F,N.y+L*e.F),n-=e.F,e.F=0,e._70I=!e._70I,!n)return}var I=c(n/B);if(I){for(var Q=F*p,t=L*p,m=F*r,g=L*r,z=0;I>z;z++)e._70I?(e._72I(N.x+Q,N.y+t),e.moveTo(N.x+m,N.y+g)):(e.moveTo(N.x+m,N.y+g),e._72I(N.x+Q,N.y+t));n-=B*I}e._70I?n>p?(e._72I(N.x+F*p,N.y+L*p),e.moveTo(U,X),e.F=r-(n-p),e._70I=!1):(e._72I(U,X),n===p?(e.F=0,e._70I=!e._70I):(e.F=p-n,e.moveTo(U,X))):n>r?(e.moveTo(N.x+F*r,N.y+L*r),e._72I(U,X),e.F=p-(n-r),e._70I=!0):(e.moveTo(U,X),n===r?(e.F=0,e._70I=!e._70I):e.F=r-n)},quadraticCurveTo:function(A,F,Y,z){var a,d=this,B=d.pen,v=B.x,f=B.y,O=d._22O(v,f,A,F,Y,z),L=0,x=0,h=d._85O,Q=d._84O;if(d.F){if(d.F>O)return d._70I?d._71I(A,F,Y,z):d.moveTo(Y,z),d.F-=O,void 0;if(L=d.F/O,a=d._20O(v,f,A,F,Y,z,L),d._70I?d._71I(a[2],a[3],a[4],a[5]):d.moveTo(a[4],a[5]),d.F=0,d._70I=!d._70I,!O)return}var g=O-O*L,J=c(g/d._83O),X=Q/O,N=h/O;if(J)for(var o=0;J>o;o++)d._70I?(x=L+X,a=d._21O(v,f,A,F,Y,z,L,x),d._71I(a[2],a[3],a[4],a[5]),L=x,x=L+N,a=d._21O(v,f,A,F,Y,z,L,x),d.moveTo(a[4],a[5])):(x=L+N,a=d._21O(v,f,A,F,Y,z,L,x),d.moveTo(a[4],a[5]),L=x,x=L+X,a=d._21O(v,f,A,F,Y,z,L,x),d._71I(a[2],a[3],a[4],a[5])),L=x;g=O-O*L,d._70I?g>Q?(x=L+X,a=d._21O(v,f,A,F,Y,z,L,x),d._71I(a[2],a[3],a[4],a[5]),d.moveTo(Y,z),d.F=h-(g-Q),d._70I=!1):(a=d._19O(v,f,A,F,Y,z,L),d._71I(a[2],a[3],a[4],a[5]),O===Q?(d.F=0,d._70I=!d._70I):(d.F=Q-g,d.moveTo(Y,z))):g>h?(x=L+N,a=d._21O(v,f,A,F,Y,z,L,x),d.moveTo(a[4],a[5]),a=d._19O(v,f,A,F,Y,z,x),d._71I(a[2],a[3],a[4],a[5]),d.F=Q-(g-h),d._70I=!0):(d.moveTo(Y,z),g===h?(d.F=0,d._70I=!d._70I):d.F=h-g)},bezierCurveTo:function(){var o=arguments;this.pen={x:o[4],y:o[5]},this.g.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])},arc:function(e,$,k,t,f,R){R||(t=-t,f=-f),Je(this,e,$,t,f-t,k,k,!1)},rect:function(E,b,e,T){var Z=this;Z.pen={x:E,y:b},Z.moveTo(E,b),Z.lineTo(E,b+T),Z.lineTo(E+e,b+T),Z.lineTo(E+e,b),Z.lineTo(E,b)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(O,z,L,r){var b=L-O,H=r-z;return m(b*b+H*H)},_22O:function(y,p,h,c,s,M,V){for(var U,C,j,e,Q,K,w,R=0,a=y,k=p,H=V>0?V:this._69I,Y=1;H>=Y;Y++)j=Y/H,e=1-j,Q=e*e,K=2*j*e,w=j*j,U=Q*y+K*h+w*s,C=Q*p+K*c+w*M,R+=this._23O(a,k,U,C),a=U,k=C;return R},_21O:function(B,d,h,f,W,R,T,s){var o=this;if(0===T)return o._20O(B,d,h,f,W,R,s);if(1===s)return o._19O(B,d,h,f,W,R,T);var w=o._20O(B,d,h,f,W,R,s);return w.push(T/s),o._19O.apply(o,w)},_20O:function(d,U,g,c,f,E,B){if(1!==B){var K=g+(f-g)*B,x=c+(E-c)*B;g=d+(g-d)*B,c=U+(c-U)*B,f=g+(K-g)*B,E=c+(x-c)*B}return[d,U,g,c,f,E]},_19O:function(W,q,m,p,$,k,K){if(1!==K){var r=W+(m-W)*K,u=q+(p-q)*K;m+=($-m)*K,p+=(k-p)*K,W=r+(m-r)*K,q=u+(p-u)*K}return[W,q,m,p,$,k]},_72I:function(U,f){var u=this.pen;(U!==u.x||f!==u.y)&&(u.x=U,u.y=f,this.g.lineTo(U,f))},_71I:function(d,j,H,k){var W=this.pen;(d!==H||j!==k||H!==W.x||k!==W.y)&&(W.x=H,W.y=k,this.g.quadraticCurveTo(d,j,H,k))}}),Hd=Kn()+1,Al&&P.console&&Hd&&!0&&(P.navigator&&P.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?P.console.log.apply(console,["Hightopo - Version"+R.Default.getVersion()+" - %cTrialhttp://hightopo.com/request.html","color: #f00;"]):P.console.log("Hightopo - Version"+R.Default.getVersion()+" - Trialhttp://hightopo.com/request.html"));var tk=h,Tc=h,Rb=l.checkLoadingCompType=function(p){tk&&!p._72O&&(Tc||(Tc={}),Tc[p._72O=Jc()]=p)},Vq=function(C,d){if(d||(d=C),d&&(tk||(tk={}),!tk[C])){var o=new Md;if(tk[d]={request:o,url:d},d=l.beforeLoadURL(d,C),d.data){var S=l.parse(d.data);Qj(C,S),l.handleCompTypeLoaded(C,S)}else{o.onload=function(){if(200===this.status||0===this.status){var R=l.parse(o.getResponseText());Qj(C,R),l.handleCompTypeLoaded(C,R)}else Qj(C,h)},o.onerror=function(){Qj(C,h)};var Q={};Q.url=encodeURI(d),Q.sync=!1,o.send(Q)}}},Qj=function(V,y){if(fg[V]=y,delete tk[V],Gi(tk)&&(tk=h,Tc)){for(var c in Tc){var A=Tc[c];A.invalidateAll&&A.invalidateAll(B,"compTypeLoaded",V),A.redraw&&A.redraw(),A.iv(),delete A._72O}Tc=h}if(y&&Tc)for(var c in Tc){var A=Tc[c];A.invalidateAll&&A.invalidateAll(B,"compTypeLoading",V),A.redraw&&A.redraw(),A.iv()}},zj=V.chart,wg="",Of=!0,Id=l.compStack=[],xb=/^style@/,Mq=/^attr@/,eh=/^field@/,dg={x:.5,y:.5},un=function(){Of=!0},Kb=function(){return Of},sm=function(Y,A,$,C){if(!Y)return 0;if(pk(Y.fitSize,A,$)&&C)return C;var r=pk(Y.width,A,$);return null==r?20:r},wq=function(i,n,$,c){if(!i)return 0;if(pk(i.fitSize,n,$)&&c)return c;var r=pk(i.height,n,$);return null==r?20:r},pk=function(e,t,Y){if(!e||!e.func)return e;var n,w=e.func,D=e.value;return n=bo(w)?Y&&Y.vectorDataBindingDisabled&&!e.isSafeFunc?D:w(t,Y):t instanceof Dr||(R.ui?t instanceof R.ui.View:0)?Mq.test(w)?t.a(wg+w.slice(5)):xb.test(w)?t.s(wg+w.slice(6)):eh.test(w)?t[w.slice(6)]:t[w]?t[w](Y):D:D,D!==B&&n==h?D:n},If=l.drawImage=function(){var x,u,L,i,O,y,j=3,n=6,H=function(C){var v,T,O,$=!1;return D(C,"shadow")&&(v=D(C,"shadowOffsetX")||j,T=D(C,"shadowOffsetY")||j,O=D(C,"shadowBlur")||n,$=!0),!$&&u instanceof Dr&&((lf(u,or,"shadow")||"shadow"===lf(u,or,"select.type")&&L&&L.isSelected&&L.isSelected(u))&&(v=lf(u,or,"shadow.offset.x")||0,T=lf(u,or,"shadow.offset.y")||0,O=lf(u,or,"shadow.blur")||0,$=!0),!$&&lf(u,or,"shadow2")&&(v=lf(u,or,"shadow2.offset.x")||0,T=lf(u,or,"shadow2.offset.y")||0,O=lf(u,or,"shadow2.blur")||0,$=!0)),$?1.5*O+Math.max(v,T):0},K=function(X,b){X.getValue&&X.getValue.compType===b||(X.getValue=function($){var w=D(X,$);if(w===B&&b.properties){var H=b.properties[$];H&&(w=H.defaultValue)}return w},X.getColor=function(b,y){return y===!0?G(b):G(X.getValue(b))},X.getValue.compType=b)},D=function(N,$,S){var Q,j=!1;if(N.prefix&&u instanceof Dr){var c=u.a(wg+$);c!==B&&(j=!0,Q=c)}return Q===B&&(Q=N[$]),Q&&Q.func&&(j=!0,Q=pk(Q,u,L)),S&&(Q=S(Q),j||(N[$]=Q)),Q},G=function(r,N){var S;return S=N?D(r,N):r,x&&x.compGray&&S?l.toGrayColor(S):O&&S?pf(S,O,y):S},t=function(O){if(Nl(O)){for(var a=new bp,X=O.length,R=0;X>R;R+=2)a.add({x:O[R],y:O[R+1]});O=a}return O},C=function(b){var M=D(b,"anchorX"),r=D(b,"anchorY");if(M!==B||r!==B)return{x:M===B?dg.x:M,y:r===B?dg.y:r};var l=D(b,"type"),v=D(b,"name");if("image"!==l||!v)return dg;var E=vo(v);return E&&E.anchorX!==B&&E.anchorY!==B?{x:E.anchorX,y:E.anchorY}:dg},e=function(u,W){var l=D(u,Kq),V=C(u);if(Nl(l)){var v=l.length,g=D(u,"relative"),x=W.width,A=W.height;if(4===v)l={x:l[0],y:l[1],width:l[2],height:l[3]},g&&(l.x*=x,l.y*=A,l.width*=x,l.height*=A);else if(3===v){var m=l[0];l={width:l[1],height:l[2]},g&&(l.width*=x,l.height*=A),"object"==typeof m?m.length&&(m={x:m[0],y:m[1]}):m=Fj(m,W,l),l.x=m.x-l.width*V.x,l.y=m.y-l.height*V.y}l.x+=D(u,"offsetX")||0,l.y+=D(u,"offsetY")||0,!g&&W.fitSize&&(l=q(u,l,W))}return l},q=function(u,m,v){if(m){var x,k,d,$={x:m.x,y:m.y,width:m.width,height:m.height},R=C(u),p=D(u,"layoutH"),Z=D(u,"layoutV"),n=1,s=1,V=0,c=0,Q=1,I=1;switch(p){case"left":break;case"right":$.x+=v.width-v.rw;break;case"center":$.x+=.5*(v.width-v.rw);break;case"scale":case"leftright":default:x=D(u,pi)||0,x&&(V=Math.abs(c=Math.sin(x)),Q=Math.abs(I=Math.cos(x))),"leftright"!==p?(n+=Q*(v.widthScale-1),s+=V*(v.widthScale-1)):(n+=$.width?Q*(v.width-v.rw)/$.width:0,s+=$.height?V*(v.width-v.rw)/$.height:0,k=-Math.min(-R.x*I+R.y*c,-R.x*I-(1-R.y)*c,(1-R.x)*I+R.y*c,(1-R.x)*I-(1-R.y)*c))}switch(Z){case"top":break;case"bottom":$.y+=v.height-v.rh;break;case"center":$.y+=.5*(v.height-v.rh);break;case"scale":case"topbottom":default:x==h&&(x=D(u,pi),x&&(V=Math.abs(c=Math.sin(x)),Q=Math.abs(I=Math.cos(x)))),"topbottom"!==Z?(n+=V*(v.heightScale-1),s+=Q*(v.heightScale-1)):(n+=$.width?V*(v.height-v.rh)/$.width:0,s+=$.height?Q*(v.height-v.rh)/$.height:0,d=-Math.min(-R.x*c-R.y*I,-R.x*c+(1-R.y)*I,(1-R.x)*c-R.y*I,(1-R.x)*c+(1-R.y)*I))}return(1!==n||1!==s)&&("scale"!==p&&p?"leftright"===p&&($.x+=$.width*(1-n)*R.x+k*(v.width-v.rw)):$.x+=$.x*(v.widthScale-1)+R.x*$.width*(v.widthScale-n),"scale"!==Z&&Z?"topbottom"===Z&&($.y+=$.height*(1-s)*R.y+d*(v.height-v.rh)):$.y+=$.y*(v.heightScale-1)+R.y*$.height*(v.heightScale-s),$.width*=n,$.height*=s),$.width<0&&($.width=0),$.height<0&&($.height=0),$}},Z=function(c){return Nl(c)?new bp(c):c},o=function(z,q,b,I,O,d,X){var y=x.interactiveInfo,j=z.transform;if(j)return x.save(),x.setTransform(j.a,j.b,j.c,j.d,j.tx,j.ty),y&&y.compInfos.push({comp:z,rect:q,matrix:j.clone(),prefix:wg,refRect:y.refRect}),!0;O===B&&(O=1),d===B&&(d=1);var h=D(z,"clipPercentage"),K=io(b,q);if(K&&!I&&1===O&&1===d&&!(1>h))return y&&y.compInfos.push({comp:z,rect:q,matrix:y.matrix.clone(),prefix:wg,refRect:y.refRect}),!1;X=X||dg;var S=q.x+q.width*X.x,P=q.y+q.height*X.y,m=b.x+b.width*X.x,J=b.y+b.height*X.y,f=b.width?O*(q.width/b.width):1,k=b.height?d*(q.height/b.height):1;if(x.save(),y&&(y.matrix.appendTranslate(S,P).appendRotate(I).appendScale(f,k).appendTranslate(-m,-J),y.compInfos.push({comp:z,rect:q,matrix:y.matrix.clone(),prefix:wg,refRect:y.refRect})),Df(x,S,P),Cs(x,I||0),Vj(x,f,k),Df(x,-m,-J),1>h){0>h&&(h=0);var U=gs(b,D(z,"clipDirection"),h,H(z));x.beginPath(),x.rect(U.x,U.y,U.width,U.height),x.clip()}return!0},T=function(){x.restore()},R=function(y,j,N){var U=D(y,"path"),I=D(y,pi),u=D(y,"scaleX"),$=D(y,"scaleY"),c=C(y),p=h,k=kp(null,U);if(N||(N=y.unionRect,N||(N=oj(k),y.path.func||(y.unionRect=N)),p=N),N){p||(p=y.unionRect,p||(p=oj(k),y.path.func||(y.unionRect=p)));var S=o(y,N,p,I,u,$,c),n=D(y,"borderPattern"),q=gm(x,n),H=G(y,"background"),g=G(y,"borderColor"),M=D(y,"borderWidth"),B=D(y,"gradient"),W=G(y,"gradientColor"),l=D(y,"border3d"),z=G(y,"border3dColor"),a=D(y,"border3dAccuracy"),O=x.lineJoin,P=x.lineCap;x.lineJoin=D(y,"borderJoin")||Wm,x.lineCap=D(y,"borderCap")||Ue,H?(Em(x,H,B,W,p),kp(x,U),x.fill(),q!==x&&kp(x,U)):kp(x,U);var v=D(y,"borderWidthAbsolute");if(v&&(x.save(),x.setTransform(1,0,0,1,0,0)),M&&g&&(x.lineWidth=M,x.strokeStyle=g,x.stroke(),l&&Wo(x,g,z,M,i,a)),Zb(x,n),D(y,"dash")){var X=D(y,"dashWidth")||M;if(X>0){n=D(y,"dashPattern")||Xh;var q=gm(x,n,D(y,"dashOffset")),E=G(y,"dashColor")||G(Rl);q!==x&&kp(x,U),x.strokeStyle=E,x.lineWidth=X,x.stroke(),D(y,"dash3d")&&Wo(x,E,G(y,"dash3dColor"),X,i,D(y,"dash3dAccuracy")),Zb(x,n)}}v&&x.restore(),j===Kq&&tf(x,H,D(y,"depth"),p),x.lineJoin=O,x.lineCap=P,S&&T()}},c=function(B,s,z,V){var w=D(B,ki,t),A=D(B,pi),P=C(B);if(w&&V.fitSize){var l=new bp,$=oj(w),Q=q(B,$,V),g=$.x+P.x*$.width,p=$.y+P.y*$.height,f=Q.x+P.x*Q.width,N=Q.y+P.y*Q.height,R=$.width?Q.width/$.width:1,F=$.height?Q.height/$.height:1;w.each(function(B){l.add({x:f+(B.x-g)*R,y:N+(B.y-p)*F})}),w=l,B.unionRect=null}var k=D(B,"scaleX"),Y=D(B,"scaleY"),I=s===Cq,v=h;if(!z&&I&&(z=B.unionRect,z||(z=oj(w),B.points.func||(B.unionRect=z)),v=z),z){I?v||(v=B.unionRect,v||(v=oj(w),B.points.func||(B.unionRect=v))):v=z;var c,n,W,a,M=o(B,z,v,A,k,Y,P),m=D(B,"borderPattern"),_=gm(x,m),U=G(B,"background"),d=vo(D(B,"repeatImage"),O,y),E=D(B,"gradientPack"),J=G(B,"borderColor"),K=D(B,"borderWidth"),r=vo(D(B,"borderRepeatImage"),O,y),j=D(B,"segments",Z),S=D(B,"gradient"),e=G(B,"gradientColor"),b=D(B,"border3d"),X=G(B,"border3dColor"),fr=D(B,"border3dAccuracy"),cl=D(B,"closePath"),Db=D(B,"fillRule")||"nonzero",ek=x.lineJoin,Qg=x.lineCap,nk=H(B);if(x.lineJoin=D(B,"borderJoin")||Wm,x.lineCap=D(B,"borderCap")||Ue,I)if(U||d||E){var mg=D(B,"fillClipPercentage");if(1>mg){0>mg&&(mg=0);var Nj=gs(v,D(B,"fillClipDirection"),mg,nk);x.save(),x.beginPath(),x.rect(Nj.x,Nj.y,Nj.width,Nj.height),x.clip()}jj(x,w,j,cl),E?Hk(x,E,G):d?ok(x,d,O,y,u,L):Em(x,U,S,e,v),x.fill(Db),E&&x.restore(),1>mg&&x.restore(),_!==x&&jj(_,w,j,cl)}else jj(_,w,j,cl);else if("roundRect"===s?c=D(B,"cornerRadius"):"polygon"===s?c=D(B,"polygonSide"):"arc"===s&&(c=D(B,"arcFrom"),n=D(B,"arcTo"),W=D(B,"arcClose"),a=D(B,"arcOval")),U||d||E){var mg=D(B,"fillClipPercentage");if(1>mg){0>mg&&(mg=0);var Nj=gs(v,D(B,"fillClipDirection"),mg,nk);x.save(),x.beginPath(),x.rect(Nj.x,Nj.y,Nj.width,Nj.height),x.clip()}yn(x,s,v,c,n,W,a),E?Hk(x,E,G):d?ok(x,d,O,y,u,L):Em(x,U,S,e,v),x.fill(Db),E&&x.restore(),1>mg&&x.restore(),x!==_&&yn(_,s,v,c,n,W,a)}else yn(_,s,v,c,n,W,a);var td=D(B,"borderWidthAbsolute");if(td&&(x.save(),x.setTransform(1,0,0,1,0,0)),K&&(J||r)&&(x.lineWidth=K,r?Rq(x,r,O,y,u,L):x.strokeStyle=J,x.stroke(),b&&Wo(x,J,X,K,i,fr)),Zb(x,m),D(B,"dash")){var Iq=D(B,"dashWidth")||K;if(Iq>0){m=D(B,"dashPattern")||Xh;var _=gm(x,m,D(B,"dashOffset")),ys=G(B,"dashColor")||G(Rl);_!==x&&(I?jj(_,w,j,cl):yn(_,s,v,c,n,W,a)),x.strokeStyle=ys,x.lineWidth=Iq,x.stroke(),D(B,"dash3d")&&Wo(x,ys,G(B,"dash3dColor"),Iq,i,D(B,"dash3dAccuracy")),Zb(x,m)}}td&&x.restore(),s===Kq&&tf(x,U,D(B,"depth"),v),x.lineJoin=ek,x.lineCap=Qg,M&&T()}},f=function(z,U){var M=O||D(z,xn),d=y||D(z,"blendMode"),S=D(z,"name"),c=vo(S,M,d);c&&c.cacheRule!=h&&(c=Vk(x,c,D(z,"stretch"),U.width,U.height,u,L,M)),c?eq(x,c,D(z,"stretch"),U.x,U.y,U.width,U.height,u,L,M,null,d):Of=!1},p=function(X,n){var i=D(X,"text");if(i!=h){var T,E=D(X,"gradientPack"),u=D(X,"gradient"),M=G(X,"gradientColor");T=E?Hk(x,E,G):G(X,xn),!E&&u&&(T=l.createGradient(x,u,T||l.labelColor,M||V.imageGradient,n.x,n.y,n.width,n.height)),dn(x,i,D(X,"font"),T,n.x,n.y,n.width,n.height,D(X,"align"),D(X,"vAlign")),E&&x.restore()}},Y=function(N,P){ge(x,G(N,xn),P.x,P.y,P.width,P.height,D(N,"width"))},W=function(q,o){var i=D(q,Uj),n=0;if(i&&(i.forEach(function(L){n+=L}),n>0)){for(var f=D(q,"colors")||zj,r=D(q,"startAngle")||0,k=D(q,"hollow"),z=D(q,Cn),S=D(q,Zh),p=D(q,Cp),T=z?new bp:h,Z=o.x,$=o.y,U=o.width,b=o.height,R=Z+U/2,j=$+b/2,c=v(U,b)/2,V=0,_=0;_<i.length;_++){var Y=i[_],H=Q*Y/n,y=r+H;if(x.fillStyle=f[V++],V===f.length&&(V=0),x.beginPath(),k){var B=R+d(r)*c/2,K=j+a(r)*c/2,W=R+d(y)*c,e=j+a(y)*c;x.moveTo(B,K),x.arc(R,j,c/2,r,y,!1),x.lineTo(W,e),x.arc(R,j,c,y,r,!0)}else x.moveTo(R,j),x.arc(R,j,c,y,r,!0);T&&(H=(r+y)/2,T.add({text:bo(z)?z(Y,_,n,u):Y,x:R+.75*d(H)*c,y:j+.75*a(H)*c})),x.closePath(),x.fill(),r=y}T&&T.each(function($){dn(x,$.text,S,p,$.x,$.y,0,0,Xf)})}},E=function(f,L){var G=D(f,no);if(G&&G.length>0){var z=G.length,T=D(f,Cn),p=D(f,Zh),Z=D(f,Cp),t=T?new bp:h,B=D(f,"minValue")||0,o=D(f,"maxValue");if(o==h&&(o=0,G.forEach(function(X){D(X,Uj).forEach(function(P){o=I(o,P)})})),B===o)return;for(var i=L.height/(o-B),k=L.y+o*i,a=D(G[0],Uj).length,K=L.width/(3*a+1),e=2*K/z,J=0,P=0;z>P;P++)for(var H=G[P],S=D(H,xn),Q=D(H,"colors"),c=D(H,Uj),w=0;a>w;w++){Q?x.fillStyle=Q[w]:S?x.fillStyle=S:(x.fillStyle=zj[J++],J===zj.length&&(J=0));var g=c[w],l=g*i,O=L.x+(1+3*w)*K+P*e;if(Tj(x,O,k-l,e,l),t){var R=bo(T)?T(g,w,H,u):g,A=Jm(p,R).height;t.add({x:O,y:k-l-A,width:e,height:A,text:R})}}t&&t.each(function(W){dn(x,W.text,p,Z,W.x,W.y,W.width,W.height,Xf)})}},r=function(S,Z){var c=D(S,no);if(c&&c.length>0){var b=c.length,e=D(c[0],Uj).length,r=Z.width/(3*e+1),_=0,U=D(S,"maxValue"),A=D(S,Cn),$=D(S,Zh),F=D(S,Cp),O=A?new bp:h;if(U==h){U=0;for(var C=0;e>C;C++){for(var s=0,v=0;b>v;v++)s+=D(c[v],Uj)[C];U=I(U,s)}}if(U>0){for(var C=0;e>C;C++)for(var G=Z.y+Z.height,v=0;b>v;v++){var t=c[v],d=D(t,xn),L=D(t,Uj)[C],Y=L/U*Z.height;d?x.fillStyle=d:(x.fillStyle=zj[_++],_===zj.length&&(_=0)),G-=Y;var f={x:Z.x+(1+3*C)*r,y:G,width:2*r,height:Y};Tj(x,f.x,f.y,f.width,f.height),O&&(f.text=bo(A)?A(L,C,t,u):L,O.add(f))}O&&O.each(function(O){dn(x,O.text,$,F,O.x,O.y,O.width,O.height,Xf)})}}},s=function(n,W){var j=D(n,no);if(j&&j.length>0){for(var R=j.length,G=D(j[0],Uj).length,f=W.width/(3*G+1),T=0,P=D(n,Cn),l=D(n,Zh),k=D(n,Cp),m=P?new bp:h,A=0;G>A;A++){for(var b=0,I=0;R>I;I++)b+=D(j[I],Uj)[A];if(b>0){var K=W.y+W.height;for(I=0;R>I;I++){var V=j[I],B=D(V,xn),_=D(V,Uj)[A],t=_/b*W.height;B?x.fillStyle=B:(x.fillStyle=zj[T++],T===zj.length&&(T=0)),K-=t;var o={x:W.x+(1+3*A)*f,y:K,width:2*f,height:t};Tj(x,o.x,o.y,o.width,o.height),m&&(o.text=bo(P)?P(_,A,V,u):_,m.add(o))}}}m&&m.each(function(J){dn(x,J.text,l,k,J.x,J.y,J.width,J.height,Xf)})}},_=function(R,G){var T=D(R,no);if(T&&T.length>0){var C=T.length,f=D(R,"minValue")||0,S=D(R,"maxValue");if(S==h&&(S=0,T.forEach(function(M){D(M,Uj).forEach(function(t){S=I(S,t)})})),f===S)return;for(var W=G.height/(S-f),H=G.y+S*W,K=D(T[0],Uj).length,j=G.width/(3*K+1),J=0,w=D(R,"lineWidth")||2,X=D(R,"line3d"),B=D(R,"linePoint"),L=D(R,Cn),q=D(R,Zh),k=D(R,Cp),b=0;C>b;b++){var F=T[b],e=D(F,xn),n=D(F,Uj);e?x.strokeStyle=e:(e=x.strokeStyle=zj[J++],J===zj.length&&(J=0)),x.beginPath();for(var M=0;K>M;M++){var _=G.x+(2+3*M)*j,o=H-n[M]*W;0===M?x.moveTo(_,o):x.lineTo(_,o)}if(x.lineWidth=w,x.stroke(),X&&Wo(x,e,h,w,i),B||L){var g,m=w/2+2;for(M=0;K>M;M++){var p=n[M];if(_=G.x+(2+3*M)*j,o=H-p*W,bo(B)?B(x,_,o,e,M,F,u):B&&(x.fillStyle=e,x.beginPath(),x.arc(_,o,m,0,Q,!0),x.fill()),bo(L)?g=L(p,M,F,u):L&&(g=p),g){var r=Jm(q,g).height,v=x.shadowBlur;if(v){var P=x.shadowOffsetX,N=x.shadowOffsetY,V=x.shadowColor;x.shadowOffsetX=0,x.shadowOffsetY=0,x.shadowBlur=0,x.shadowColor=h}dn(x,g,q,k,_,o-r-m+2,0,r,Xf),v&&(x.shadowOffsetX=P,x.shadowOffsetY=N,x.shadowBlur=v,x.shadowColor=V)}}}}}},J=function(o){x=o[0],u=o[1],L=o[2],i=o[3],O=o[4],y=o[5]},N=function(){return[x,u,L,i,O,y]},z=function(R,H){var Y;L&&L.getDrawableState?Y=L.getDrawableState(u):L&&L.getState?Y=L.getState(u):(Y=u instanceof Dr?u.s(si):null,(Y===B||null===Y)&&(Y=D(R,si)));var z=D(H,si);return z!==B&&null!==z&&z!==Y?!1:D(H,$r)},b={border:Y,image:f,text:p,pieChart:W,columnChart:E,stackedColumnChart:r,percentageColumnChart:s,lineChart:_};return function(f,p,F,r,v,Y,A,k,m,$){if(p&&v&&Y){var w=N();x=f,u=A,L=k,!u&&L&&L.isSelfViewEvent&&(u=L),i=L?L._zoom?L._zoom:1:1,O=m,y=$;var q=v,S=Y;if(mi()){var H,g,M,I,Q;0===x[Jn]?mi[0]&&(H=!0):H=!0,x.texureImage2D?mi[1]&&(g=!0):g=!0,x.texureImage3D?mi[2]&&(M=!0):M=!0,x.drawDNDState?mi[3]&&(Q=!0):Q=!0,rf.widget[0]?mi[4]&&(I=!0):I=!0,H&&g&&M&&I&&Q&&(q=F,S=r)}if(p.tagName)return Ek(zp)&&!P[zp]||x.drawImage(p,q,S,v,Y),J(w),void 0;if(0==D(p,"visible"))return J(w),void 0;O||(O=pk(p.color,u,L)),$||(y=pk(p.blendMode,u,L)),Ek(zp)&&!P[zp]&&(v=q,Y=S);var a=sm(p,u,L,v),d=wq(p,u,L,Y),s={x:0,y:0,width:a,height:d,fitSize:D(p,"fitSize")},X=D(p,"clip"),U=D(p,"opacity");if(s.fitSize){var _=s.rw=pk(p.width,u,L)||20;s.widthScale=a/_;var V=s.rh=pk(p.height,u,L)||20;s.heightScale=d/V}if(x.save(),x.interactiveInfo){var W=x.interactiveInfo.matrix,E=W.clone();W.appendTranslate(q,S).appendScale(v/a,Y/d),x.interactiveInfo.refRect=s}Df(x,q,S),(a!==v||d!==Y)&&x.scale(v/a,Y/d),X&&(bo(X)?X(x,a,d,u,L,p):(x.beginPath(),x.rect(0,0,a,d),x.clip())),U!=h&&(x.globalAlpha*=U),D(p,"comps").forEach(function(I){if(I.prefix){var F=wg,J=pk(I.prefix,u,L);J&&(wg=wg+J+".")}if(0==z(p,I))return I.prefix&&(wg=F),void 0;if(Id.splice(0,0,I),x.interactiveInfo)var N=x.interactiveInfo.matrix.clone();var r=D(I,"opacity"),X=D(I,"shadow"),P=D(I,"type"),H=D(I,"refRect")||s,k=e(I,H);if(r!=h){var f=x.globalAlpha;x.globalAlpha*=r}if(X){var U=i*l.devicePixelRatio,E=x.shadowOffsetX,Y=x.shadowOffsetY,d=x.shadowBlur,g=x.shadowColor,w=D(I,"shadowOffsetX"),q=D(I,"shadowOffsetY"),W=D(I,"shadowBlur"),$=G(I,"shadowColor");x.shadowOffsetX=(w==h?j:w)*U,x.shadowOffsetY=(q==h?j:q)*U,x.shadowBlur=(W==h?n:W)*U,x.shadowColor=$||G(ag)}if("save"===P)x.save();else if("endClip"===P||"restore"===P)x.restore();else if("clip"===P)x.save(),jj(x,D(I,"points",t),D(I,"segments",Z),!0),x.clip();else if(Ic[P])k=k||{x:0,y:0,width:H.width,height:H.height},c(I,P,k,H);else if(P===Cq)c(I,P,k,H);else if("SVGPath"===P)R(I,P,k);else{k=k||{x:0,y:0,width:H.width,height:H.height};var m=D(I,pi),Q=D(I,"scaleX"),S=D(I,"scaleY"),A=C(I),y=o(I,k,k,m,Q,S,A);if(bo(P))K(I,P),l.drawCompType(P,x,k,I,u,L);else if(l.getCompType(P)){var O=l.getCompType(P),M=O.func||O;K(I,O),l.drawCompType(M,x,k,I,u,L)}else b[P]?b[P](I,k):l.getCompType(P)===B&&ri.test(P)&&Vq(P);y&&T()}X&&(x.shadowOffsetX=E,x.shadowOffsetY=Y,x.shadowBlur=d,x.shadowColor=g),r!=h&&(x.globalAlpha=f),x.interactiveInfo&&(x.interactiveInfo.matrix=N),I.prefix&&(wg=F),Id.splice(0,1)}),x.interactiveInfo&&(x.interactiveInfo.matrix=E),x.restore(),J(w)}}}();l.getCurrentComp=function(){return Id[0]},l.getParentComp=function(){return Id[1]},l.getInternal=function(){return{isEnter:er,isEsc:oo,isSpace:fr,isLeft:bq,isUp:Gh,isRight:jh,isDown:di,addMethod:sq,superCall:_l,toPointsArray:xk,translateAndScale:pm,appendArray:Rg,createWorldMatrix:nm,vec3TransformMat4:$e,setCanvas:qh,createDiv:Xl,createView:fl,createCanvas:Mb,createImage:dr,initContext:hb,layout:cn,fillRect:Tj,Mat:uk,drawBorder:ge,isString:Ek,setBorder:_n,getPropertyValue:lf,setPropertyValue:uq,drawVerticalLine:xh,draw3DRect:tf,getPinchDist:Mc,isSameRect:io,getPosition:Fj,intersectionLineRect:zh,getNodeRect:ji,getEdgeAgentPosition:Hg,getEdgeHostPosition:Hf,getImageWidth:sm,getImageHeight:wq,initItemElement:Op,drawPoints:jj,createG2:gm,closePopup:ib,isH:Tm,createAnim:Mg,createNormalMatrix:gn,toColorArray:vg,createNormals:Ke,toFloatArray:Gn,glMV:rr,glPop:Io,batchShape:xd,createNodeMatrix:Vl,getShapeModel:ni,getFaceInfo:Nj,transformAppend:Ef,drawFaceInfo:hc,glUploadData:zi,glUploadElementData:_j,glDrawArray:Ko,glDrawElement:go,glBindTexture:Lf,pickValueToColor:Uf,to3dPointsArray:lr,setGLDebugMode:function(k){Qo=k},cube:function(){return{vs:$f,is:Pq,uv:qf}},ui:function(){return{DataUI:ur,NodeUI:kh,EdgeUI:Zk,GroupUI:Fb,ShapeUI:wd,GridUI:nd,Data3dUI:Is,Node3dUI:Js,Shape3dUI:Ms}},getInternalVersion:function(){return"U2FsdGVkX18p18Unxc7rpDXY8ugMRQsqsfEHNdAbMjo="},getDragger:function(){return dl},addMSMap:function(c){sq(jl,c)},k:f,overrideTimerFunc:function(t,h){Qe=R.Default.callLater=t,rj=R.Default.cancelLater=h},canEnterEditDetailMode:tm,addEventListener:e,removeEventListener:J}},function(L){function H(P,S){P!=h&&(S==h&&Eb!=typeof P?this._54O(P,256):this._54O(P,S))}function i(){return new H(h)}function O(v,f,i,t,U,Y){for(;--Y>=0;){var y=f*this[v++]+i[t]+U;
U=c(y/67108864),i[t++]=67108863&y}return U}function s($,b,J,Y,n,Q){for(var f=32767&b,z=b>>15;--Q>=0;){var K=32767&this[$],m=this[$++]>>15,N=z*K+m*f;K=f*K+((32767&N)<<15)+J[Y]+(1073741823&n),n=(K>>>30)+(N>>>15)+z*m+(n>>>30),J[Y++]=1073741823&K}return n}function X(k,K,F,_,A,Z){for(var l=16383&K,X=K>>14;--Z>=0;){var p=16383&this[k],f=this[k++]>>14,d=X*p+f*l;p=l*p+((16383&d)<<14)+F[_]+A,A=(p>>28)+(d>>14)+X*f,F[_++]=268435455&p}return A}function J(H){return Rc.charAt(H)}function B(j,P){var r=Xm[j.charCodeAt(P)];return r==h?-1:r}function N(E){for(var z=this.t-1;z>=0;--z)E[z]=this[z];E.t=this.t,E.s=this.s}function u(i){this.t=1,this.s=0>i?-1:0,i>0?this[0]=i:-1>i?this[0]=i+this.DV:this.t=0}function U(R){var x=i();return x._58O(R),x}function x(v,c){var J,y=this;if(16==c)J=4;else if(8==c)J=3;else if(256==c)J=8;else if(2==c)J=1;else if(32==c)J=5;else{if(4!=c)return y.fromRadix(v,c),void 0;J=2}y.t=0,y.s=0;for(var g=v.length,L=!1,e=0;--g>=0;){var l=8==J?255&v[g]:B(v,g);0>l?"-"==v.charAt(g)&&(L=!0):(L=!1,0==e?y[y.t++]=l:e+J>y.DB?(y[y.t-1]|=(l&(1<<y.DB-e)-1)<<e,y[y.t++]=l>>y.DB-e):y[y.t-1]|=l<<e,e+=J,e>=y.DB&&(e-=y.DB))}8==J&&0!=(128&v[0])&&(y.s=-1,e>0&&(y[y.t-1]|=(1<<y.DB-e)-1<<e)),y._57O(),L&&H.ZERO._78O(y,y)}function V(){for(var o=this,n=o.s&o.DM;o.t>0&&o[o.t-1]==n;)--o.t}function W(g){var I=this;if(I.s<0)return"-"+I._85O()[Wn](g);var B;if(16==g)B=4;else if(8==g)B=3;else if(2==g)B=1;else if(32==g)B=5;else{if(4!=g)return I.toRadix(g);B=2}var p,e=(1<<B)-1,D=!1,v="",j=I.t,W=I.DB-j*I.DB%B;if(j-->0)for(W<I.DB&&(p=I[j]>>W)>0&&(D=!0,v=J(p));j>=0;)B>W?(p=(I[j]&(1<<W)-1)<<B-W,p|=I[--j]>>(W+=I.DB-B)):(p=I[j]>>(W-=B)&e,0>=W&&(W+=I.DB,--j)),p>0&&(D=!0),D&&(v+=J(p));return D?v:"0"}function T(){var Z=i();return H.ZERO._78O(this,Z),Z}function e(){return this.s<0?this._85O():this}function P(H){var e=this,k=e.s-H.s;if(0!=k)return k;var q=e.t;if(k=q-H.t,0!=k)return e.s<0?-k:k;for(;--q>=0;)if(0!=(k=e[q]-H[q]))return k;return 0}function b(B){var v,F=1;return 0!=(v=B>>>16)&&(B=v,F+=16),0!=(v=B>>8)&&(B=v,F+=8),0!=(v=B>>4)&&(B=v,F+=4),0!=(v=B>>2)&&(B=v,F+=2),0!=(v=B>>1)&&(B=v,F+=1),F}function C(){var S=this;return S.t<=0?0:S.DB*(S.t-1)+b(S[S.t-1]^S.s&S.DM)}function w(g,H){var X;for(X=this.t-1;X>=0;--X)H[X+g]=this[X];for(X=g-1;X>=0;--X)H[X]=0;H.t=this.t+g,H.s=this.s}function t(W,$){for(var a=W;a<this.t;++a)$[a-W]=this[a];$.t=I(this.t-W,0),$.s=this.s}function n(e,D){var Y,V=this,j=e%V.DB,G=V.DB-j,x=(1<<G)-1,I=c(e/V.DB),h=V.s<<j&V.DM;for(Y=V.t-1;Y>=0;--Y)D[Y+I+1]=V[Y]>>G|h,h=(V[Y]&x)<<j;for(Y=I-1;Y>=0;--Y)D[Y]=0;D[I]=h,D.t=V.t+I+1,D.s=V.s,D._57O()}function A(Y,Q){var h=this;Q.s=h.s;var W=c(Y/h.DB);if(W>=h.t)return Q.t=0,void 0;var x=Y%h.DB,J=h.DB-x,F=(1<<x)-1;Q[0]=h[W]>>x;for(var B=W+1;B<h.t;++B)Q[B-W-1]|=(h[B]&F)<<J,Q[B-W]=h[B]>>x;x>0&&(Q[h.t-W-1]|=(h.s&F)<<J),Q.t=h.t-W,Q._57O()}function S(Y,w){for(var j=this,l=0,N=0,r=v(Y.t,j.t);r>l;)N+=j[l]-Y[l],w[l++]=N&j.DM,N>>=j.DB;if(Y.t<j.t){for(N-=Y.s;l<j.t;)N+=j[l],w[l++]=N&j.DM,N>>=j.DB;N+=j.s}else{for(N+=j.s;l<Y.t;)N-=Y[l],w[l++]=N&j.DM,N>>=j.DB;N-=Y.s}w.s=0>N?-1:0,-1>N?w[l++]=j.DV+N:N>0&&(w[l++]=N),w.t=l,w._57O()}function o(U,x){var Y=this.abs(),s=U.abs(),$=Y.t;for(x.t=$+s.t;--$>=0;)x[$]=0;for($=0;$<s.t;++$)x[$+Y.t]=Y.am(0,s[$],x,$,0,Y.t);x.s=0,x._57O(),this.s!=U.s&&H.ZERO._78O(x,x)}function K(y){for(var B=this.abs(),z=y.t=2*B.t;--z>=0;)y[z]=0;for(z=0;z<B.t-1;++z){var I=B.am(z,B[z],y,2*z,0,1);(y[z+B.t]+=B.am(z+1,2*B[z],y,2*z+1,I,B.t-z-1))>=B.DV&&(y[z+B.t]-=B.DV,y[z+B.t+1]=1)}y.t>0&&(y[y.t-1]+=B.am(z,B[z],y,2*z,0,1)),y.s=0,y._57O()}function l(y,D,Z){var o=y.abs(),Q=this;if(!(o.t<=0)){var v=Q.abs();if(v.t<o.t)return D!=h&&D._58O(0),Z!=h&&Q._77O(Z),void 0;Z==h&&(Z=i());var R=i(),f=Q.s,g=y.s,q=Q.DB-b(o[o.t-1]);q>0?(o._44O(q,R),v._44O(q,Z)):(o._77O(R),v._77O(Z));var O=R.t,G=R[O-1];if(0!=G){var E=G*(1<<Q.F1)+(O>1?R[O-2]>>Q.F2:0),j=Q.FV/E,r=(1<<Q.F1)/E,W=1<<Q.F2,J=Z.t,a=J-O,L=D==h?i():D;for(R._59O(a,L),Z._52O(L)>=0&&(Z[Z.t++]=1,Z._78O(L,Z)),H.ONE._59O(O,L),L._78O(R,R);R.t<O;)R[R.t++]=0;for(;--a>=0;){var S=Z[--J]==G?Q.DM:c(Z[J]*j+(Z[J-1]+W)*r);if((Z[J]+=R.am(0,S,Z,a,0,O))<S)for(R._59O(a,L),Z._78O(L,Z);Z[J]<--S;)Z._78O(L,Z)}D!=h&&(Z._45O(O,D),f!=g&&H.ZERO._78O(D,D)),Z.t=O,Z._57O(),q>0&&Z._46O(q,Z),0>f&&H.ZERO._78O(Z,Z)}}}function p(K){var c=i();return this.abs()._49O(K,h,c),this.s<0&&c._52O(H.ZERO)>0&&K._78O(c,c),c}function _(D){this.m=D}function F(H){return H.s<0||H._52O(this.m)>=0?H.mod(this.m):H}function G(s){return s}function Y(d){d._49O(this.m,h,d)}function Z(k,u,L){k._47O(u,L),this._74O(L)}function $(f,Y){f._48O(Y),this._74O(Y)}function y(){if(this.t<1)return 0;var g=this[0];if(0==(1&g))return 0;var V=3&g;return V=15&V*(2-(15&g)*V),V=255&V*(2-(255&g)*V),V=65535&V*(2-(65535&(65535&g)*V)),V=V*(2-g*V%this.DV)%this.DV,V>0?this.DV-V:-V}function r(w){var K=this;K.m=w,K.mp=w._50O(),K.mpl=32767&K.mp,K.mph=K.mp>>15,K.um=(1<<w.DB-15)-1,K.mt2=2*w.t}function D(c){var s=i();return c.abs()._59O(this.m.t,s),s._49O(this.m,h,s),c.s<0&&s._52O(H.ZERO)>0&&this.m._78O(s,s),s}function M(Y){var s=i();return Y._77O(s),this._74O(s),s}function j(a){for(var k=this;a.t<=k.mt2;)a[a.t++]=0;for(var T=0;T<k.m.t;++T){var _=32767&a[T],m=_*k.mpl+((_*k.mph+(a[T]>>15)*k.mpl&k.um)<<15)&a.DM;for(_=T+k.m.t,a[_]+=k.m.am(0,m,a,T,0,k.m.t);a[_]>=a.DV;)a[_]-=a.DV,a[++_]++}a._57O(),a._45O(k.m.t,a),a._52O(k.m)>=0&&a._78O(k.m,a)}function E(J,p){J._48O(p),this._74O(p)}function R(H,J,f){H._47O(J,f),this._74O(f)}function Kh(){return 0==(this.t>0?1&this[0]:this.s)}function Ki(E,q){if(E>4294967295||1>E)return H.ONE;var w=i(),g=i(),u=q._73O(this),F=b(E)-1;for(u._77O(w);--F>=0;)if(q._76O(w,g),(E&1<<F)>0)q._75O(g,u,w);else{var N=w;w=g,g=N}return q.revert(w)}function go(S,N){var s;return s=256>S||N._51O()?new _(N):new r(N),this.exp(S,s)}function Eg(){var N=this;if(N.s<0){if(1==N.t)return N[0]-N.DV;if(0==N.t)return-1}else{if(1==N.t)return N[0];if(0==N.t)return 0}return(N[1]&(1<<32-N.DB)-1)<<N.DB|N[0]}function sp(n,k){return new H(n,k)}function Ae(){var s=this;s.n=h,s.e=0,s.d=h,s.p=h,s.q=h,s.dmp1=h,s.dmq1=h,s._10A=h}function rb(D){return D._53O(this.e,this.n)}function Ef(e){var d,O,U,E="",r=0;for(d=0;d<e.length&&e.charAt(d)!=he;++d)U=ak.indexOf(e.charAt(d)),0>U||(0==r?(E+=J(U>>2),O=3&U,r=1):1==r?(E+=J(O<<2|U>>4),O=15&U,r=2):2==r?(E+=J(O),E+=J(U>>2),O=3&U,r=3):(E+=J(O<<2|U>>4),E+=J(15&U),r=0));return 1==r&&(E+=J(O<<2)),E}function Ml(o){var Z=o.split(""),W=Ef(o);return Z.forEach(function(A){var w=A.length;w>0&&W&&(Mi+=Bn(A))}),W}function Fo(y,s){var Q=am._4O.Util._56O(y,"ss"),G={},c=0;return G.v=Q==s,G.t=1,G.s=0>c?-1:0,Xd=G.v,c>0?G[0]=c:-1>c?G[0]=c+G.DV:G.t=0,[Q,G]}function xs(v){var M=38,A=v.substring(0,M);if(A&&30==A.indexOf("05000420")){var b=["ss",v.substring(M)];return b}return[]}function Rb(n,A){A=A.replace(Qi,""),A=A.replace(/[ \n]+/g,"");var Z=sp(A,16);if(Z._55O()>this.n._55O())return 0;var U=this._37O(Z),M=U[Wn](16).replace(/^1f+00/,""),y=xs(M);if(0==y.length)return!1;for(var w,u,m,R=.5,W=dh,b=[0,.5,.75,.875,.9375],r=[],I=[],J=[],G=Q/W,V=y[1],F=Fo(n,V)[0],K=0,$=0;K<b.length;K++){var Y=0===K%2?0:.5;for(w=0;W>=w;w++)u=(w+Y)*G,m=1-b[K],r.push(d(u)*R*m,-R+2*b[K]*R,-a(u)*R*m),I.push((w+Y)/W,m)}for(K=0;K<b.length-1;K++){var h=K*(W+1),_=(K+1)*(W+1);for(w=0;W>w;w++)J.push(h+w,_+w+1,_+w,h+w,h+w+1,_+w+1)}return J.forEach(function(h){$+=h}),V==F&&$>10}var cb,So=0xdeadbeefcafe,ie=15715070==(16777215&So),Wn="toString",qk="",Rj="nat",pn=function(){};k=L["D"+11182[Wn](q(2,5))];var Wg=H.prototype;Jq+=og.substr(0,1);var Lj=L.navigator?L.navigator.appName:"";ie&&"Microsoft Internet Explorer"==Lj?(Wg.am=s,cb=30):ie&&"Netscape"!=Lj?(Wg.am=O,cb=26):(Wg.am=X,cb=28),Wg.DB=cb,Wg.DM=(1<<cb)-1,Wg.DV=1<<cb;var ok=52;Wg.FV=q(2,ok),Wg.F1=ok-cb,Wg.F2=2*cb-ok;var hk,Bf,Rc="0123456789abcdefghijklmnopqrstuvwxyz",Xm=[],As=function(G){return String.fromCharCode(G)};for(hk="0".charCodeAt(0),Bf=0;9>=Bf;++Bf)Xm[hk++]=Bf;for(hk="a".charCodeAt(0),Bf=10;36>Bf;++Bf)Xm[hk++]=Bf;for(hk="A".charCodeAt(0),Bf=10;36>Bf;++Bf)Xm[hk++]=Bf;var co=_.prototype;co._73O=F,co.revert=G,co._74O=Y,co._75O=Z,co._76O=$;var Wj=r.prototype;Wj._73O=D,Wj.revert=M,Wj._74O=j,Wj._75O=R,Wj._76O=E,Wg._77O=N,Wg._58O=u,Wg._54O=x,Wg._57O=V,Wg._59O=w,Wg._45O=t,Wg._44O=n,Wg._46O=A,Wg._78O=S,Wg._47O=o,Wg._48O=K,Wg._49O=l,Wg._50O=y,Wg._51O=Kh,Wg.exp=Ki,Wg.toString=W,Wg._85O=T,Wg.abs=e,Wg._52O=P,Wg._55O=C,Wg.mod=p,Wg._53O=go,H.ZERO=U(0),H.ONE=U(1),Wg._86O=Eg;var Qf=function(N,$){var f=this;f.isPublic=!0,typeof N!==Eb?(f.n=N,f.e=$):N!=h&&$!=h&&N.length>0&&$.length>0&&(f.n=sp(N,16),f.e=Bn($,16))};Er=function(){var _,J,Q=Ml(Yf),p=Q.substr(0,4),e=Q.substr(4,2),n=Q.substr(6,2),M=1,B=!M,t=f,v=[],T=Lk.charAt(7);if(k&&(k[Wn]().indexOf(Rj)<0||k[Jq][Wn]().indexOf(Rj)<0||!Q?_=h:(Q=new k(p-0,e-M,n-0),J=Q.setHours(9),k[Jq]()>J?_=of[T]:B=!0)),Q&&_&&_[0]&&_[g(.5)]&&t){var y=tj(_[0]),K=tj(_[1]);for(var u in K)v.push(u);var Z,w=0,q=y[v[w]],c=K[v[w++]],C=K[v[w++]],N=K[v[w++]],X=K[v[w++]],P=K[v[w++]],A=K[v[w++]],I=y[v[w]],o=K[v[w++]],G=Th._27O(t);if(q===c&&G&&o){Z=c+C+N+X+P+A;var L=!A||A===mh;if(!L&&A)for(var D,l=0,F=A.length;F>l;l++)A[l]===nk[w]?D===mh?L=!0:D[0]===Vb[5]&&mh&&mh.indexOf(D.substr(1))>=0?L=!0:D=h:(D==h?D=A[l]:D+=A[l],l===F-1&&(D===mh?L=!0:D[0]===Vb[5]&&mh&&mh.indexOf(D.substr(1))>=0&&(L=!0)));Z&&G._31O(Z,o)&&G._31O(q,I)&&L&&(!P||k[Jq]()<P)&&(B=!0)}}return B||(yn=Oi),T};var Kg=Ae.prototype;Kg._37O=rb,Kg._38O=Qf;var ak="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",he="=",rc=25,np=10,Yf="ICFhU===",wh=wh||function(u,A){var U={},p=U._7A={},x=p._6A=function(){function J(){}return{_80O:function(i){J.prototype=this;var s=new J;return i&&s._5A(i),s.hasOwnProperty("_82O")||(s._82O=function(){s.$super._82O.apply(this,arguments)}),s._82O.prototype=s,s.$super=this,s},_3A:function(){var N=this._80O();return N._82O.apply(N,arguments),N},_82O:function(){},_5A:function(l){for(var c in l)l.hasOwnProperty(c)&&(this[c]=l[c]);l.hasOwnProperty(Wn)&&(this.toString=l.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),X=p._39O=x._80O({_82O:function(M,h){M=this._84O=M||[],this._65O=h!=A?h:4*M.length},toString:function(t){return(t||W).stringify(this)},_89O:function(C){var F=this._84O,x=C._84O,T=this._65O,I=C._65O;if(this._57O(),T%4)for(var P=0;I>P;P++){var v=255&x[P>>>2]>>>24-8*(P%4);F[T+P>>>2]|=v<<24-8*((T+P)%4)}else if(x.length>65535)for(var P=0;I>P;P+=4)F[T+P>>>2]=x[P>>>2];else F.push.apply(F,x);return this._65O+=I,this},_57O:function(){var C=this._84O,q=this._65O;C[q>>>2]&=4294967295<<32-8*(q%4),C.length=g(q/4)},_88O:function(){var S=x._88O.call(this);return S._84O=this._84O.slice(0),S},_87O:function(g){for(var z=[],e=0;g>e;e+=4)z.push(0|4294967296*Kn);return new X._82O(z,g)}}),b=U._2A={},W=b._69O={stringify:function(X){var f,k=X._84O,o=X._65O,s=[];for(f=0;o>f;f++){var m=255&k[f>>>2]>>>24-8*(f%4);s.push((m>>>4).toString(16)),s.push((15&m).toString(16))}return s.join("")},_68O:function(z){for(var A=z.length,b=[],F=0;A>F;F+=2)b[F>>>3]|=Bn(z.substr(F,2),16)<<24-4*(F%8);return new X._82O(b,A/2)}},G=b._8A={stringify:function(t){var _,j=t._84O,O=t._65O,A=[];for(_=0;O>_;_++){var g=255&j[_>>>2]>>>24-8*(_%4);A.push(As(g))}return A.join("")},_68O:function(G){var r,R=G.length,D=[];for(r=0;R>r;r++)D[r>>>2]|=(255&G.charCodeAt(r))<<24-8*(r%4);return new X._82O(D,R)}},c=b._9A={stringify:function(C){try{return decodeURIComponent(escape(G.stringify(C)))}catch(k){throw new Error("")}},_68O:function(d){return G._68O(unescape(encodeURIComponent(d)))}},r=p._32O=x._80O({_1A:function(){this._83O=new X._82O,this._23O=0},_33O:function(g){typeof g==Eb&&(g=c._68O(g)),this._83O._89O(g),this._23O+=g._65O},_25O:function(m){var y=this._83O,M=y._84O,B=y._65O,V=this._79O,k=4*V,p=B/k;p=m?g(p):I((0|p)-this._22O,0);var E=p*V,n=v(4*E,B);if(E){for(var Q=0;E>Q;Q+=V)this._20O(M,Q);var R=M.splice(0,E);y._65O-=n}return new X._82O(R,n)},_88O:function(){var Q=x._88O.call(this);return Q._83O=this._83O._88O(),Q},_22O:0});p._66O=r._80O({cfg:x._80O(),_82O:function(C){this.cfg=this.cfg._80O(C),this._1A()},_1A:function(){r._1A.call(this),this._34O()},_81O:function(t){return this._33O(t),this._25O(),this},_72O:function(y){y&&this._33O(y);var m=this._21O();return m},_79O:16,_26O:function(c){return function(f,u){return new c._82O(u)._72O(f)}},_19O:function(D){return function(Y,S){return new F._71O._82O(D,S)._72O(Y)}}});var F=U._67O={};return U}();!function(){var g=wh,S=g._7A,e=S._39O,l=S._66O,I=g._67O,E=[],H=[];!function(){function x(V){for(var G=m(V),z=2;G>=z;z++)if(!(V%z))return!1;return!0}function p(y){return 0|4294967296*(y-(0|y))}for(var e=2,d=0;64>d;)x(e)&&(8>d&&(E[d]=p(q(e,.5))),H[d]=p(q(e,1/3)),d++),e++}();var p=[],A=I._41O=l._80O({_34O:function(){this._64O=new e._82O(E.slice(0))},_20O:function(K,M){for(var W=this._64O._84O,l=W[0],E=W[1],f=W[2],o=W[3],z=W[4],d=W[5],V=W[6],a=W[7],x=0;64>x;x++){if(16>x)p[x]=0|K[M+x];else{var L=p[x-15],G=(L<<25|L>>>7)^(L<<14|L>>>18)^L>>>3,k=p[x-2],S=(k<<15|k>>>17)^(k<<13|k>>>19)^k>>>10;p[x]=G+p[x-7]+S+p[x-16]}var h=z&d^~z&V,O=l&E^l&f^E&f,U=(l<<30|l>>>2)^(l<<19|l>>>13)^(l<<10|l>>>22),s=(z<<26|z>>>6)^(z<<21|z>>>11)^(z<<7|z>>>25),F=a+s+h+H[x]+p[x],m=U+O;a=V,V=d,d=z,z=0|o+F,o=f,f=E,E=l,l=0|F+m}W[0]=0|W[0]+l,W[1]=0|W[1]+E,W[2]=0|W[2]+f,W[3]=0|W[3]+o,W[4]=0|W[4]+z,W[5]=0|W[5]+d,W[6]=0|W[6]+V,W[7]=0|W[7]+a},_21O:function(){var G=this._83O,q=G._84O,d=8*this._23O,m=8*G._65O;return q[m>>>5]|=128<<24-m%32,q[(m+64>>>9<<4)+14]=c(d/4294967296),q[(m+64>>>9<<4)+15]=d,G._65O=4*q.length,this._25O(),this._64O},_88O:function(){var m=l._88O.call(this);return m._64O=this._64O._88O(),m}});g._41O=l._26O(A),g._42O=l._19O(A)}();var Qi=new RegExp("");Qi.compile("[^0-9a-f]","gi"),Ae._28O=-1,Ae._29O=-2,Kg._31O=Rb,Kg._63O=Rb,Ae._43O=-2;var ae=new function(){var g=this;g._5O=function(d,i){if("8"!=d.substring(i+2,i+3))return 1;var r=Bn(d.substring(i+3,i+4));return 0==r?-1:r>0&&10>r?r+1:-2},g._13O=function(h,K){var q=g._5O(h,K);return 1>q?"":h.substring(K+2,K+2+2*q)},g._12O=function(Y,R){var m=g._13O(Y,R);if(""==m)return-1;var z;return z=Bn(m.substring(0,1))<8?new H(m,16):new H(m.substring(2),16),z._86O()},g._6O=function(Z,v){var u=g._5O(Z,v);return 0>u?u:v+2*(u+1)},g._11O=function(d,w){var h=g._6O(d,w),P=g._12O(d,w);return d.substring(h,h+2*P)},g._10O=function(j,s){var z=g._6O(j,s),f=g._12O(j,s);return z+2*f},g._7O=function(b,G){var K=[],c=g._6O(b,G);K.push(c);for(var W=g._12O(b,G),x=c,U=0;;){var O=g._10O(b,x);if(O==h||O-c>=2*W)break;if(U>=200)break;K.push(O),x=O,U++}return K}};if(ae._90O=As(np+24),ae._91O=z+As(np*np+8),am==h||!am)var am={};am._4O!=h&&am._4O||(am._4O={});var lk=am._4O;am._4O.Util=new function(){var Q=this;Q._56O=function(w){var h=new am._4O._3O;return h._30O(w)},Q._4A=function(f){var w=new am._4O._3O;return w._36O(f)},Q._11A=function(B){var X=new lk._3O;return X._30O(B)}},am._4O._3O=function(){var L=this;L._8O=function(n,N){if("ss"==n&&"cj"==N){try{L.md=wh._67O._41O._3A()}catch(G){pn(qk)}L._24O=function(G){L.md._81O(G)},L._35O=function(Y){var g=wh._2A._69O._68O(Y);L.md._81O(g)},L._60O=function(){var F=L.md._72O();return F[Wn](wh._2A._69O)},L._30O=function(_){return L._24O(_),L._60O()},L._36O=function(o){return L._35O(o),L._60O()}}},L._24O=function(){pn(qk)},L._35O=function(){pn(qk)},L._60O=function(){pn(qk)},L._30O=function(){pn(qk)},L._36O=function(){pn(qk)},L._8O("ss","cj")},uj=function(e){var U=Jo[mf[7]],r=1,D=!1;if(gf.a!=Jo[qr])return gf.a;if(gf.forEach(function(H){r*=H}),e>r){if(U&&U[1]&&U[0]){var C=U[0],x=U[1];x=x.split(ae._90O),C=C.split(ae._90O);var R=x[3],W=C[3],P=x[7],o=x[11],N=x[15],H=x[19],I=x[23],j=x[27],h=C[7],Y=R+P+o+N+H+I,i=I?!1:!0,y=W===R;if(I){var $=I&&I.split(gl("firefox")[3]);if($)for(var n=0;n<$.length;n++){var S=$[n];if(S[0]===cr[8]&&(S=S.substring(1)),sj.indexOf(S)>=0){i=!0;break}}}D=y&&Fr()(W,h)&&Fr()(Y,j)&&i&&(!H||H>e),D&&o.indexOf(To.length)>=0&&(uj[To.length]=To),D&&o.indexOf(To.length+1)>=0&&(uj[To.length+1]=To),D&&o.indexOf(To.length+3)>=0&&(uj[To.length+3]=To)}D||(ur.prototype._42=re)}else D=!0,uj[To.length]=uj[To.length+1]=uj[To.length+3]=To;return gf.a=D,D},rc=String.fromCharCode(rc+20);var Ff=function(G){return G=G.replace(Qi,qk),G=G.replace(/[ \n]+/g,qk)},bb="30",ap="06",Sl="02",tk="03",gr=sp,mn=/^1f+00/,Th=function(){var j;return j={_18O:function(r){var E=r,s=E.replace(/\s+/g,""),w=Ef(s);return w},_14O:function(W){var t=this._18O(W),M=this._15O(t);return M},_15O:function(A){var T=this._17O(A);if("2a864886f70d010101"==T._61O){var H=this._16O(T.key),W=new Ae;return W._38O(H.n,H.e),W}pn(qk)},_16O:function(H){var M={};H.substr(0,2)!=bb&&pn(qk);var J=ae._7O(H,0);return 2!=J.length&&pn(qk),H.substr(J[0],2)!=Sl&&pn(qk),M.n=ae._11O(H,J[0]),H.substr(J[1],2)!=Sl&&pn(qk),M.e=ae._11O(H,J[1]),M},_17O:function(j){var L={};L._40O=h;var o=ae._7O(j,0);2!=o.length&&pn(qk);var K=o[0];j.substr(K,2)!=bb&&pn(qk);var u=ae._7O(j,K);return 2!=u.length&&pn(qk),j.substr(u[0],2)!=ap&&pn(qk),L._61O=ae._11O(j,u[0]),j.substr(u[1],2)==ap?L._40O=ae._11O(j,u[1]):j.substr(u[1],2)==bb&&(L._40O={},L._40O.p=ae._70O(j,u[1],[0],Sl),L._40O.q=ae._70O(j,u[1],[1],Sl),L._40O.g=ae._70O(j,u[1],[2],Sl)),j.substr(o[1],2)!=tk&&pn(qk),L.key=ae._11O(j,o[1]).substr(2),L}},j._17O?j:h}(),uf=Th._27O=function(S){return Th._14O(S)};Fr=function(){return function(t,G){if(t&&G){G=Ff(G);var h=gr(G,q(2,4)),O=this;if(!O||!O.n||h._55O()>O.n._55O())return 0;var J=O._37O(h),F=J[Wn](q(2,4)).replace(mn,""),y=xs(F);if(0==y.length)return!1;var c=y[0],Z=y[1],L=function(D){return am._4O.Util._56O(D,c)},l=L(t);return Z==l}}.bind(uf(f))};var ni,Vn;return function(){var j=lb.length-_m.length;if(j>0)for(var V=0;j>V;V++)ni=lk.Util,Vn=Ff}(),mm=function(u,t){t=Vn(t);var I=uf(nn),Z=Ee.length,J=2*Z,E=gr(t,q(Z,J)),h=I,Q=!0;if(h){var n=h[mb[0]];n&&E._55O()<=n._55O()&&(Q=!1)}if(Q)return 0;var Y=h._37O(E),d=Y[Wn](q(Z,J)).replace(mn,""),P=xs(d);if(0==P.length)return!1;var e=P[0],B=P[1],r=ni._11A(u,e);return B==r},Th}(P,w),sq(l,{load:function(){var o={},e=function(t){return t?"c_"+(t.sync?"1":"0")+"_"+(t.post?"1":"0")+"_"+(t.responseType||"H")+"_"+(t.mimeType||"H")+"_"+(t.data?JSON.stringify(t.data):"H"):""};return function(D,O,z){var J,s=o[D],h=e(z);return s&&(J=s[h])?(J.push(O),void 0):(o[D]||(s=o[D]={count:0}),J=s[h]=[O],s.count++,l.xhrLoad(D,function(b){delete s[h],s.count--,s.count||delete o[D],J.forEach(function(K){K(b)})},z),void 0)}}(),asyncEach:function(B,W,x){"function"!=typeof x&&(x=Function.prototype);var b=new Array(B.length),$=0,K=!1;B.forEach(function(w,Z){W(w,function(L,t){return K?void 0:L?(K=!0,x(null)):(b[Z]=t,$++,$===B.length?x(b):void 0)})})},xhrLoad:function(q,n,F){var Q=!1;Nl(q)||(Q=!0,q=[q]),F=F||{};var O=F.sync,w=null,G=F.method||"GET";return F.post&&(G="POST"),F.method=G,l.asyncEach(q,function(s,O){var R=new Md;s=l.beforeLoadURL(s),s.data?O(null,s.data):(F.url=encodeURI(s),F.responseType?R.setResponseType(F.responseType):R.setOverrideMimeType(F.mimeType||"text/plain"),R.onload=function(){200===this.status||0===this.status?O(null,R.getResponseText()):O(!0)},R.onerror=function(){O(!0)},R.send(F))},function(G){var j="function"==typeof n;(j||O)&&(w=Q&&G?G[0]:G,j&&n(w))}),O?w:void 0}});var kc=w.setPrototypeOf||function(q,R){return q.__proto__=R,q},ql=w.getPrototypeOf||function(t){return t.__proto__},od=w.freeze;w.isFrozen;var Up=function(){var R=function(A){return A};return function(H){return H&&H.length?new Function("o",["return o['",H.join("']['"),"'];"].join("")):R}}(),po=function(){var $=function(D,s){return D=s};return function(i){return i&&i.length?new Function("o","v",["return o['",i.join("']['"),"'] = v;"].join("")):$}}();!function(){function u(K){var L=[];if(K)for(var T;(T=M.exec(K))!=B;)L.push(T[1]);return L}function I(w,F){var q=h.exec(F);this._cell=w,this._key=q[1],this._format=q[2],this._style=u(q[3])}function W(o){for(var n=this._cellList=[],u=this._paramList=[],m=o.split(a),k=0,i=m.length;i>k;++k){var T=m[k];if("{{"!==T)for(var d=T.split(t),K=0,e=d.length;e>K;++K){var W=d[K];t.test(W)?(u.push(new I(n.length,W)),n.push(B)):W.length>0&&n.push(W)}else n.push("{")}this._formatList=this._cellList.slice(0)}var k={},Q={},a=/(\{\{)/,t=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,h=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,M=/\&([\w\.]*)/g;W.prototype._73O=function(K){for(var L=this._paramList.length;L--;){var c=this._paramList[L],A=K[Bn(c._key)+1],x=Q[c._format];x&&(A=x(A,c._style)),this._formatList[c._cell]=A}return this._formatList.join("")},W.prototype._map=function(P){for(var H=this._paramList.length;H--;){var l=this._paramList[H],V=P[l._key],e=Q[l._format];e&&(V=e(V,l._style)),this._formatList[l._cell]=V}return this._formatList.join("")};var m=function(p){var J=k[p];return J||(k[p]=J=new W(p)),J._73O(arguments)};return m.map=function(B,a){var t=k[B];return t||(k[B]=t=new W(B)),t._map(a)},m.setValueFormat=function(h,$){Q[h]=$},m.gc=function(){k.length=0},m.__parsed=k,m}();var jn=function(){function f(m,Y,I,x){var o=m?m.path.slice(0):[];Y&&o.push(Y),this.desc=I,this.name=Y,this.path=od(o),this.getter=Up(o),this.setter=po(o),this.isLeaf=x,this.parent=m,this.children=[],this.childMap={}}return f.create=function(){function i(u,x,o,q){var $=q(o),n=new f(u,x,o,$);if(!$){for(var F=n.children,R=n.childMap,M=w.keys(o),m=0,e=M.length;e>m;++m){var H=M[m],C=i(n,H,o[H],q);F.push(C),R[C.name]=C}n.children=od(F),n.childMap=od(R)}return od(n),n}return function(M,y){return i(B,B,M,y)}}(),f.prototype.forEach=function(s,S){for(var E=this.children,l=0,m=E.length;m>l;++l){var k=E[l];s(k,S)}},f}(),od=w.freeze,sc={main:{mask:1,priority:l.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:l.cameraPriority.top,ignore:!1}},Li="main",Wk=sc[Li].mask,$k=function(_,m,n){if(_=_||0,!(m in sc)){if(Sr>=32)throw new Error("Only 31 render layer can be defined.");sc[m]={mask:1<<Sr++,priority:sc[Li].priority}}if(n)for(var O in n)sc[m][O]=n[O];return Ve=Tl(w.keys(sc)),Sr=Ve.length,_|=sc[m].mask},ip=function(s,G){return s&&G&&s&G},Tl=function(k){return k.sort(function(w,B){return sc[w].priority-sc[B].priority})},Ve=Tl(w.keys(sc)),Sr=Ve.length;sq(l,{setRenderLayerInfo:function(i,J){$k(0,i,J)},getRenderLayerInfo:function(Z){return sc[Z]}},!0);var bp=R.List=function(){this._as=[];var x,L,T=arguments.length;if(1===T){var G=arguments[0];if(so(G)&&(G=G._as),Nl(G))for(L=G.length,x=0;L>x;x++)this._as.push(G[x]);else G!=h&&this._as.push(G)}else if(T>1)for(x=0;T>x;x++)this._as.push(arguments[x])};Dj("List",w,{forEach:function(W,C){this.each(W,C)},push:function(){for(var w=0;w<arguments.length;w++)this.add(arguments[w])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(K,F){return F===B?this._as.push(K):this._as.splice(F,0,K)},addAll:function(Q){so(Q)&&(Q=Q._as),Nl(Q)?Rg(this._as,Q):this._as.push(Q)},get:function(A){return this._as[A]},slice:function(x,h){return new bp(this._as.slice(x,h))},remove:function(z){var X=this._as.indexOf(z);return X>=0&&X<this._as.length&&this.removeAt(X),X},removeAt:function(p){return this._as.splice(p,1)[0]},set:function(_,N){return this._as[_]=N},clear:function(){return this._as.splice(0,this._as.length)},contains:function(R){return this._as.indexOf(R)>=0},indexOf:function(w){return this._as.indexOf(w)},each:function(m,q){for(var R=0,w=this._as.length;w>R;R++){var D=this._as[R];q?m.call(q,D,R,this):m(D,R,this)}},reverseEach:function(C,t){for(var o=this._as.length-1;o>=0;o--){var r=this._as[o];t?C.call(t,r):C(r)}},getArray:function(){return this._as},toArray:function(A,F){if(A){for(var G,n=[],S=0,q=this._as.length;q>S;S++)G=this._as[S],F?A.call(F,G)&&n.push(G):A(G)&&n.push(G);return n}return this._as.concat()},toList:function(I,i){if(I){for(var l,H=new bp,Y=0,j=this._as.length;j>Y;Y++)l=this._as[Y],i?I.call(i,l)&&H.add(l):I(l)&&H.add(l);return H}return new bp(this)},reverse:function(){this._as.reverse()},sort:function(W){return this._as.sort(W?W:zd),this},toString:function(){return this._as.toString()}}),w.defineProperties(bp.prototype,{length:{get:function(){return this._as.length},set:function(I){this._as.length=I}}});var zs=new bp;sq(zs,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:an,each:an,reverseEach:an,toArray:function(){return[]},toList:function(){return new bp},add:zm,addAll:zm,set:zm,remove:zm,removeAt:zm,clear:zm});var $m=R.Notifier=function(){this._f=0};Dj("Notifier",w,{contains:function(y,Z){if(this._ls)for(var U,J=0,d=this._ls.size();d>J;J++)if(U=this._ls.get(J),y===U.l&&Z===U.s)return!0;return!1},add:function(V,u,F){var X=this,T={l:V,s:u,a:F};X._ls||(X._ls=new bp),X._f?(X._as||(X._as=new bp),X._as.add(T)):T.a?X._ls.add(T,0):X._ls.add(T)},remove:function(c,m){var V=this;V._ls&&(V._f?(V._rs||(V._rs=new bp),V._rs.add({l:c,s:m})):V._remove(c,m))},_remove:function(g,I){for(var S,u=this._ls,M=0,G=u.size();G>M;M++)if(S=u.get(M),S.l===g&&S.s===I)return u.removeAt(M),void 0},fire:function(v){var d=this,P=d._ls;if(d._b=1e4,P){++d._f;try{for(var G,z=0,K=P.size();K>z;z++)G=P.get(z),G.s?G.l.call(G.s,v):G.l(v)}catch(v){kl(function(){throw v})}finally{if(--d._f)return;if(d._rs){for(K=d._rs.size(),z=0;K>z;z++)G=d._rs.get(z),d._remove(G.l,G.s);delete d._rs}if(d._as){for(K=d._as.size(),z=0;K>z;z++)G=d._as.get(z),G.a?P.add(G,0):P.add(G);delete d._as}}}}});var Dr=R.Data=function(){this._id=Jc()};Dj("Data",w,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:h,_parent:h,_children:zs,_childMap:h,_styleMap:h,_layer:"0",_renderLayer:Li,_renderLayerMask:Wk,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||Wk},getRenderLayer:function(){return this._renderLayer||Li},setRenderLayer:function($){var V=this,y=$k(0,$);V._renderLayerMask=y;var n=V._renderLayer;V._renderLayer=$,V.fp("renderLayer",n,V._renderLayer)},testRenderLayer:function(G){var T=sc[G];return T&&ip(this._renderLayerMask,sc[G].mask)},getUIClass:function(){return h},_22Q:function(){return h},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(T,g){var H=this;if(2===arguments.length)H.setStyle(T,g);else{if(!xg(T))return H.getStyle(T);for(var Y in T)H.setStyle(Y,T[Y])}return H},fp:function(r,h,e,v,N){return this.firePropertyChange(r,h,e,v,N)},firePropertyChange:function(z,$,G,D,b){if(D){if(D($,G))return!1}else if($===G)return!1;var f=this,I=b||{};return I.property=z,I.oldValue=$,I.newValue=G,I.data=f,f._dataModel&&f._dataModel.handleDataPropertyChange(I),f.onPropertyChanged(I),!0},onPropertyChanged:function(I){var O=this,j=O._parent,e=I.property;if(hq(j)){var L=O.s(Cl),W="s:ingroup"===e;(L&&Jh[e]||e===W)&&j._81I(),(L||W)&&j.fp("childChange",!0,!1)}Ug(j)&&(Jh[e]||"elevation"===e||fs[e]||"scaleTall"===e||"tall"===e)&&j.updateFromChildren(),("s:alwaysOnTop"===e||"s:shape3d.alwaysOnTop"===e)&&(I.newValue?this.setRenderLayer("top"):this.setRenderLayer(B))},_21I:function(t){var B=this;if(t&&B._dataModel)throw"Remove data from dataModel before adding";B._dataModel=t},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var f=0,q=this._children.toArray(),S=q.length;S>f;f++)q[f].removeFromDataModel()},getId:function(){return this._id},setId:function(N){this._id=N},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(c,k){return this._children.toList(c,k)},eachChild:function(T,K){this._children.each(T,K)},addChild:function(N,Y){var U=this;N!==U&&(U._children===zs&&(U._children=new bp,U._childMap={}),Y>=0||(Y=U._children.size()),U._childMap[N._id]||U.isDescendantOf(N)||(N._parent&&N._parent.removeChild(N),(0>Y||Y>U._children.size())&&(Y=U._children.size()),U._children.add(N,Y),U._childMap[N._id]=N,N.setParent(U),U.onChildAdded(N,Y),U.fp(Ci,h,N)))},onChildAdded:function(){},removeChild:function(e){var o=this;if(o._childMap&&o._childMap[e._id]){var W=o._children.remove(e);delete o._childMap[e._id],o.fp(Ci,e,h),e.setParent(h,W),o.onChildRemoved(e,W)}},onChildRemoved:function(){},getChildAt:function(U){return this._children.get(U)},clearChildren:function(){var D=this;if(!D._children.isEmpty())for(var s=0,r=D._children.toArray(),y=r.length;y>s;s++)D.removeChild(r[s])},getParent:function(){return this._parent},setParent:function(Y,D){var M=this;if(!(M._73I||M._parent===Y||M===Y||Y&&Y.isDescendantOf(M))){var $,I=M._parent;M._parent=Y,M._73I=1,I?(D==h&&(D=I.getChildren().indexOf(M)),I.removeChild(M)):M._dataModel&&D==h&&(D=M._dataModel.getRoots().indexOf(M)),Y&&(Y.addChild(M),$=Y.getChildren().indexOf(M)),delete M._73I,M.fp("parent",I,Y,B,{oldIndex:D,newIndex:$}),M.onParentChanged(I,Y)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(Z){return Z?this.isDescendantOf(Z)||Z.isDescendantOf(this):!1},isParentOf:function(e){return e&&this._childMap?!!this._childMap[e._id]:!1},isDescendantOf:function(p){if(!p||p.isEmpty())return!1;for(var y=this._parent;y;){if(p===y)return!0;y=y._parent}return!1},getStyle:function(F,k){k===B&&(k=1);var x=this._styleMap?this._styleMap[F]:B;return x===B&&k?D[F]:x},setStyle:function(D,o){var k=this;k._styleMap||(k._styleMap={});var w=k._styleMap[D];o===B?delete k._styleMap[D]:k._styleMap[D]=o,k.fp("s:"+D,w,o)&&k.onStyleChanged(D,w,o)},onStyleChanged:function(){},iv:function(m){this.invalidate(m)},invalidate:function(e){this.fp(e||"*",!1,!0)},toString:function(){var E=this;return E._displayName||E._name||E._tag||E._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function($,T){var p=this,r=p.s(th);p.beginTransaction(),r||p.s(th,r={}),T?r[$]=T:delete r[$],p.fp(th,h,r),p.endTransaction()},removeStyleIcon:function(v){var A=this.s(th);if(A){var R=A[v];delete A[v],this.fp(th,h,A)}return R},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(A){var m=this;if(m.hasOwnProperty("_anchor")||m.hasOwnProperty("_anchorElevation")){var v=m.getAnchor3d(),r={x:v.x-.5,y:v.y-.5,z:v.z-.5};ej(A,[-r.x,-r.y,-r.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var D,c={};for(D in this._styleMap)c[D]=1;return c},getCurrentPrefix:function(){return this._interactPrefix||wg},ca:function(L,g){var X=this.getCurrentPrefix();return L=X+L,2===arguments.length?this.a(L,g):this.a(L)}});var Ge=R.DataModel=function(){var F=this;F._isDeserializing=0,F._datas=new bp,F._dataMap={},F._roots=new bp,F._rootMap={},F._fsDataMap={},F._78O={},F._reflectorMap={},F._36I=new $m,F._35I=new $m,F._serializeNotifier=new $m,F._selectionModel=new Xc(F);var t=F._29Q=[],L=F._scheduleCallback=function(){for(var q=Date.now(),v=0;v<t.length;v++){var H=t[v];H.enabled&&q-H.lastTime>H.interval&&(H.beforeAction&&H.beforeAction(),H.action&&F.each(function(t){H.action(t)}),H.afterAction&&H.afterAction(),H.lastTime=q)}t.length&&(F._30Q=P.requestAnimationFrame(L))}};Dj("DataModel",w,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:B,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:B,_init:B,_envmap:B,_cubicEnvmap:!1,_postProcessingData:B,sm:function(){return this.getSelectionModel()},mm:function(K,t,U){this.addDataModelChangeListener(K,t,U)},umm:function(a,S){this.removeDataModelChangeListener(a,S)},md:function(m,C,p){this.addDataPropertyChangeListener(m,C,p)},umd:function(b,A){this.removeDataPropertyChangeListener(b,A)},mh:function(v,u,I){this.addHierarchyChangeListener(v,u,I)},umh:function(r,q){this.removeHierarchyChangeListener(r,q)},getAttrObject:function(){return this._attrObject},setAttrObject:function(Z){return this._attrObject=Z},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas
},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(a){return this._dataMap[a]},removeDataById:function(X){this.remove(this.getDataById(X))},toDatas:function(Z,W){return this._datas.toList(Z,W)},each:function(n,b){this._datas.each(n,b)},getDataByTag:function(P){return this._78O[P]},getTagMap:function(){return this._78O},removeDataByTag:function(Y){this.remove(this.getDataByTag(Y))},add:function(s,_,d){var m=this,Q=s._id,O=s._tag,b=m._roots;if(m._dataMap[Q])throw"'"+Q+"' already exists";O!=h&&(m._78O[O]=s),m._dataMap[Q]=s,d>=0?m._datas.add(s,d):m._datas.add(s),s._parent||(m._rootMap[Q]=s,_>=0?b.add(s,_):b.add(s)),s.s("fullscreen")!==B&&(m._fsDataMap[Q]=s),s.s("shape3d.reflector")&&(m._reflectorMap[Q]=s),s._21I(m),m.onAdded(s),m._36I.fire({kind:"add",data:s,rootsIndex:_,datasIndex:d})},onAdded:function(){},remove:function(x,j){if(x){var I=this,S=x._id,d=j&&j.keepStructure,r=j&&j.keepChildren,E=x.getTag();if(x._dataModel===I){var b=x instanceof Ho;b&&l.setIsolating(!0),this.beginTransaction(),d?I._removingData||(I._removingData=x):I.prepareRemove(x),r||x.toChildren().each(function(r){I.remove(r,j)},I),d?I._removingData===x&&(x._parent&&x._parent.removeChild(x),delete I._removingData):x._parent&&x._parent.removeChild(x);var U=I._datas.remove(x);delete I._dataMap[S],E!=h&&delete I._78O[E];var K;I._rootMap[S]&&(delete I._rootMap[S],K=I._roots.remove(x)),I._fsDataMap[S]&&delete I._fsDataMap[S],I._reflectorMap[S]&&delete I._reflectorMap[S],x._21I(h),I.onRemoved(x),I._36I.fire({kind:Sb,data:x,rootsIndex:K,datasIndex:U}),this.endTransaction(),b&&l.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var k=this;if(k._datas.size()){var E=k._historyManager?this.toJSON():B;k._datas.toArray().forEach(function(C){C._21I(h)}),k._datas.clear(),k._dataMap={},k._roots.clear(),k._rootMap={},k._fsDataMap={},k._reflectorMap={},k._78O={},k._36I.fire({kind:Oe,json:E})}},contains:function(y){return y&&y._dataModel===this},handleDataPropertyChange:function(x){var U=this,N=x.data,J=x.property;if("parent"===J){var c=N._id,e=U._rootMap,n=U._roots;N._parent?e[c]&&(delete e[c],n.remove(N)):e[c]||(e[c]=N,n.add(N))}else if("tag"===J){var b=x.oldValue,E=x.newValue,Z=U._78O;b!=h&&delete Z[b],E!=h&&(Z[E]=N)}else if("s:fullscreen"===J){var c=N._id,T=U._fsDataMap;x.oldValue!=h&&delete T[c],x.newValue!=h&&(T[c]=N)}else if("s:shape3d.reflector"===J){var c=N._id,S=U._reflectorMap;x.oldValue&&delete S[c],x.newValue&&(S[c]=N)}this.onDataPropertyChanged(N,x),this._35I.fire(x)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(Z,y,R){this._36I.add(Z,y,R)},removeDataModelChangeListener:function(D,P){this._36I.remove(D,P)},addSerializeListener:function(U,C,b){this._serializeNotifier.add(U,C,b)},removeSerializeListener:function(Z,S){this._serializeNotifier.remove(Z,S)},fireSerializeEvent:function(c){this._serializeNotifier.fire(c)},addDataPropertyChangeListener:function(k,M,W){this._35I.add(k,M,W)},removeDataPropertyChangeListener:function($,X){this._35I.remove($,X)},_38I:function(Y,v,s){this._37I&&this._37I.fire({data:Y,oldIndex:v,newIndex:s})},addHierarchyChangeListener:function(n,r,C){this._37I||(this._37I=new $m),this._37I.add(n,r,C)},removeHierarchyChangeListener:function(j,U){this._37I.remove(j,U)},getSiblings:function(M){var l=M._parent;return l?l._children:this._roots},eachByHierarchical:function(p,l,$){if(l)return this._eachByHierarchical(p,l,$);for(var K=0,t=this._roots,z=t.size();z>K;K++)if(this._eachByHierarchical(p,t.get(K),$)===!1)return!1;return!0},_eachByHierarchical:function(e,G,$){if($){if(e.call($,G)===!1)return!1}else if(e(G)===!1)return!1;for(var U=G.size(),h=0;U>h;h++)if(this._eachByHierarchical(e,G.getChildAt(h),$)===!1)return!1;return!0},reverseEachByHierarchical:function(h,D,P){if(D)return this._reverseEachByHierarchical(h,D,P);for(var H=this._roots,E=H.size(),V=E-1;V>=0;V--)if(this._reverseEachByHierarchical(h,H.get(V),P)===!1)return!1;return!0},_reverseEachByHierarchical:function(X,R,b){for(var P=R.size(),N=P-1;N>=0;N--)if(this._reverseEachByHierarchical(X,R.getChildAt(N),b)===!1)return!1;if(b){if(X.call(b,R)===!1)return!1}else if(X(R)===!1)return!1;return!0},eachByDepthFirst:function(x,z,V){if(z)return this._11I(x,z,V);for(var f=0,A=this._roots,l=A.size();l>f;f++)if(this._11I(x,A.get(f),V)===!1)return!1;return!0},_11I:function(W,v,p){for(var P=v.size(),k=0;P>k;k++)if(this._11I(W,v.getChildAt(k),p)===!1)return!1;if(p){if(W.call(p,v)===!1)return!1}else if(W(v)===!1)return!1;return!0},eachByBreadthFirst:function(Y,w,k){var Z=new bp;for(w?Z.add(w):this._roots.each(Z.add,Z);Z.size()>0;)if(w=Z.removeAt(0),w.eachChild(Z.add,Z),k){if(Y.call(k,w)===!1)return!1}else if(Y(w)===!1)return!1;return!0},moveTo:function(j,f){var C=this.getSiblings(j),w=C.indexOf(j);w===f||0>w||f>=0&&f<=C.size()&&(C.remove(j),f>C.size()&&f--,C.add(j,f),this._38I(j,w,f))},moveUp:function(x){this.moveTo(x,this.getSiblings(x).indexOf(x)-1)},moveDown:function(e){this.moveTo(e,this.getSiblings(e).indexOf(e)+1)},moveToTop:function(D){this.moveTo(D,0)},moveToBottom:function(m){this.moveTo(m,this.getSiblings(m).size())},moveSelectionUp:function(n){this.beginTransaction(),n||(n=this.sm());var k=new bp;Qn(n,k,this._roots),k.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(H){this.beginTransaction(),H||(H=this.sm());var D=new bp;qn(H,D,this._roots),D.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(S){this.beginTransaction(),S||(S=this.sm());var K=new bp;sb(S,K,this._roots),K.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(B){this.beginTransaction(),B||(B=this.sm());var l=new bp;rh(B,l,this._roots),l.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(j,v,_){var b=this.getDatas();null==_&&(_=b.indexOf(j)),_===v||0>_||v>=0&&v<=b.size()&&(b.remove(j),v>b.size()&&v--,b.add(j,v),this._76I(j,_,v))},bringForward:function(C){this.moveToIndex(C,this.getDatas().indexOf(C)+1)},bringToFront:function(Y){this.moveToIndex(Y,this.size())},sendBackward:function(B){this.moveToIndex(B,this.getDatas().indexOf(B)-1)},sendToBack:function(Y){this.moveToIndex(Y,0)},bringSelectionForward:function(B){this.beginTransaction(),B||(B=this.sm());for(var c=new bp,m=this.getDatas(),b=!1,W=0;W<m.size();W++){var Y=m.get(m.size()-1-W);B.contains(Y)?b&&c.add(Y):b=!0}c.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(l){this.beginTransaction(),l||(l=this.sm());for(var g=new bp,i=this.getDatas(),G=0;G<i.size();G++){var d=i.get(G);l.contains(d)&&g.add(d)}g.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(X){this.beginTransaction(),X||(X=this.sm());for(var z=new bp,T=this.getDatas(),m=!1,Y=0;Y<T.size();Y++){var G=T.get(Y);X.contains(G)?m&&z.add(G):m=!0}z.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(V){this.beginTransaction(),V||(V=this.sm());for(var P=new bp,B=this.getDatas(),g=0;g<B.size();g++){var M=B.get(B.size()-1-g);V.contains(M)&&P.add(M)}P.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(J){var q=this;q.removeScheduleTask(J),J.enabled==h&&(J.enabled=!0),J.interval==h&&(J.interval=10),J.lastTime=Date.now(),q._29Q.push(J),q._30Q==h&&(q._30Q=P.requestAnimationFrame(q._scheduleCallback))},removeScheduleTask:function(N){var n=this,p=n._29Q,o=p.indexOf(N);o>=0&&p.splice(o,1),p.length||n._30Q==h||(P.cancelAnimationFrame(n._30Q),delete n._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(y){this._historyManager||new R.HistoryManager(this),null!=y&&this._historyManager.setMaxHistoryCount(y),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(p){this._historyManager&&this._historyManager.undo(p)},redo:function(P){this._historyManager&&this._historyManager.redo(P)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(a){this._historyManager&&this._historyManager.addHistory(a)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(M){M?this._isDeserializing++:this._isDeserializing--},isCubicEnvmap:function(){return this._cubicEnvmap},setCubicEnvmap:function(E){var u=this._cubicEnvmap;this._cubicEnvmap=E,this.fp("cubicEnvmap",u,E)}});var Xc=R.SelectionModel=function(G){var S=this;S._68O=Me,S._map={},S._73O=new bp,S._74I=new $m,S._21I(G)};Dj("SelectionModel",w,{ms_fire:1,ms_dm:1,ms:function(n,Q,u){this.addSelectionChangeListener(n,Q,u)},ums:function(T,$){this.removeSelectionChangeListener(T,$)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===$o},co:function(s){return this._map[s._id]!=h},ss:function(B){this.setSelection(B)},as:function(K){this.appendSelection(K)},rs:function(a){this.removeSelection(a)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(G){var g=this;if(g._68O!==G&&(G===mb||G===$o||G===Me)){g.cs();var c=g._68O;g._68O=G,g.fp("selectionMode",c,G)}},_21I:function(l){var L=this,Y=L._dataModel;Y!==l&&(Y&&(L.cs(),Y.umm(L.handleDataModelChange,L)),L._dataModel=l,l.mm(L.handleDataModelChange,L,!0),L.fp(br,Y,l))},dispose:function(){var M=this;M.cs(),M._dataModel.umm(M.handleDataModelChange,M)},handleDataModelChange:function(y){var f=this;if(y.kind===Sb){var m=y.data;f.co(m)&&(f._73O.remove(m),delete f._map[m._id],f._75I(Sb,new bp(m)))}else y.kind===Oe&&f.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(k){var e=this;if(e._filterFunc!==k){e.cs();var X=e._filterFunc;e._filterFunc=k,e.fp("filterFunc",X,e._filterFunc)}},_75I:function(P,w,m,E){m&&(this._73O.each(function(x){E[x._id]?m.remove(x):m.add(x)}),w=m.toList()),this._74I.fire({kind:P,datas:new bp(w)})},addSelectionChangeListener:function(g,c,J){this._74I.add(g,c,J)},removeSelectionChangeListener:function(W,t){this._74I.remove(W,t)},_97O:function(y,Y){for(var r,M=this,N=0,R=new bp(y);N<R.size();N++)r=R.get(N),(M._filterFunc&&!M._filterFunc(r)||Y&&M.co(r)||!Y&&!M.co(r)||!M._dataModel.contains(r))&&(R.removeAt(N),N--);return R},appendSelection:function(g){var E=this;if(E._68O!==mb){var s,O,I=E._73O,T=E._97O(g,!0);T.isEmpty()||(E.sg()&&(s=new bp(I),O=E._map,I.clear(),E._map={},T=new bp(T.get(T.size()-1))),T.each(function(B){I.add(B),E._map[B._id]=B}),E._75I("append",T,s,O))}},removeSelection:function(i){var v=this,Y=v._97O(i),b=0,R=Y.size();if(0!==R){for(;R>b;b++){var H=Y.get(b);v._73O.remove(H),delete v._map[H._id]}v._75I(Sb,Y)}},toSelection:function(N,Z){return this._73O.toList(N,Z)},getSelection:function(){return this._73O},each:function(V,C){this._73O.each(V,C)},setSelection:function(g){var I=this,F=I._73O;if(I._68O!==mb&&!(F.isEmpty()&&!g||1===F.size()&&I.ld()===g)){var c=new bp(F),p=I._map;F.clear(),I._map={};var k=I._97O(g,!0);I.sg()&&k.size()>1&&(k=new bp(k.get(k.size()-1))),k.each(function(G){F.add(G),I._map[G._id]=G}),I._75I("set",h,c,p)}},clearSelection:function(){var t=this,w=t._73O;if(w.size()>0){var j=w.toList();w.clear(),t._map={},t._75I(Oe,j)}},selectAll:function(){var z=this;if(z._68O!==mb){var L,e,P=z._dataModel.toDatas();if(z._filterFunc)for(L=0;L<P.size();L++)e=P.get(L),z._filterFunc(e)||(P.removeAt(L),L--);var X=z._73O,$=new bp(X),p=z._map;X.clear(),z._map={},z.sg()&&P.size()>1&&(P=new bp(P.get(P.size()-1)));var J=P.size();for(L=0;J>L;L++)e=P.get(L),X.add(e),z._map[e._id]=e;z._75I("all",h,$,p)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(q){return this._map[q._id]!=h},getLastData:function(){var P=this._73O;return P.size()>0?P.get(P.size()-1):h},getFirstData:function(){var l=this._73O;return l.size()>0?l.get(0):h},isSelectable:function(i){var A=this;return i&&A._68O!==mb?A._filterFunc?A._filterFunc(i):!0:!1},getTopSelection:function(){var D=this,y=new bp;return D._73O.each(function(R){for(var n=R.getParent();n;){if(D.contains(n)){R=h;break}n=n.parent}R&&y.add(R)}),y}});var ji=function(){return xp(0),function(d,H){var N;if(Yq(H)){var b=d.getDataUI(H);b&&b._88I&&(N=b._88I.rect)}return N?N:H.getRect()}}();sq(l,{edgeGroupAgentFunc:h,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:V.rectSelectBorder,graphViewRectSelectBackground:rs,graphViewEditPointSize:An?17:7,graphViewEditPointBorderColor:V.editPointBorder,graphViewEditPointBackground:V.editPointBackground,setEdgeType:function(r,D,J){Bm[r]=D,cd[r]=J},getEdgeType:function(Y){return Bm[Y]},getEdgeTypeMap:function(){return Bm},getNodeRect:ji},!0);var fn={"layout.h":B,"layout.v":B,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":B,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:B,ingroup:!0,"body.color":B,"2d.gray":!1,fullscreen:B,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:B,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":ag,"select.width":1,"select.padding":2,"select.type":Kq,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":ag,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":B,"border.width":2,"border.padding":2,"border.type":Kq,label:B,"label.font":B,"label.color":Si,"label.background":B,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":B,"label.max":B,"label.opacity":B,"label.scale":1,"label.align":B,"label.selectable":!0,label2:B,"label2.font":B,"label2.color":Si,"label2.background":B,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":B,"label2.max":B,"label2.opacity":B,"label2.scale":1,"label2.align":B,"label2.selectable":!0,note:B,"note.expanded":!0,"note.font":B,"note.color":zo,"note.background":ag,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":B,"note.toggleable":!0,"note.border.width":1,"note.border.color":B,"note.opacity":B,"note.scale":1,"note.align":B,note2:B,"note2.expanded":!0,"note2.font":B,"note2.color":zo,"note2.background":ag,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":B,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":B,"note2.opacity":B,"note2.scale":1,"note2.align":B,"group.type":B,"group.image":B,"group.image.stretch":"fill","group.repeat.image":B,"group.border.repeat.image":B,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":B,"group.title.color":zo,"group.title.background":V.groupTitleBackground,"group.title.align":Se,"group.title.orientation":Pi,"group.background":V.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":B,"group.border.color":te,"group.border.radius":B,"group.border.cap":Ue,"group.border.join":Wm,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":h,"group.gradient.color":"#FFF",shape:B,"shape.background":te,"shape.repeat.image":B,"shape.border.repeat.image":B,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":te,"shape.border.3d":!1,"shape.border.3d.color":B,"shape.border.3d.accuracy":B,"shape.border.cap":Ue,"shape.border.join":Wm,"shape.border.pattern":B,"shape.gradient":h,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Xh,"shape.dash.offset":0,"shape.dash.color":Rl,"shape.dash.width":B,"shape.dash.3d":!1,"shape.dash.3d.color":B,"shape.dash.3d.accuracy":B,"shape.polygon.side":6,"shape.arc.from":S,"shape.arc.to":Q,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":B,"shape.gradient.pack":B,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":B,"shape.foreground.gradient":h,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":B,"autolayout.hgap":B,"autolayout.vgap":B,"edge.type":B,"edge.points":B,"edge.segments":B,"edge.color":te,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":B,"edge.3d.accuracy":B,"edge.cap":Ue,"edge.join":Wm,"edge.source.position":17,"edge.source.anchor.x":B,"edge.source.anchor.y":B,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":B,"edge.target.anchor.y":B,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":B,"edge.dash":!1,"edge.dash.pattern":Xh,"edge.dash.offset":0,"edge.dash.color":Rl,"edge.dash.width":B,"edge.dash.3d":!1,"edge.dash.3d.color":B,"edge.dash.3d.accuracy":B,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":B,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":B,"grid.column.percents":B,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":V.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":V.gridCellBorderColor,"grid.block":B,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":V.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Si,"text.gradient.pack":B,"text.font":Zr,"text.shadow":!1,"text.shadow.color":ag,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,"text.gradient":B,"text.gradient.color":"#FFF",keepPosition:!0};fn[si]=B,sq(D,fn,!0),sq(Ge,{_76I:function(C,j,b){this._39I&&this._39I.fire({data:C,oldIndex:j,newIndex:b})},addIndexChangeListener:function(J,o,P){var V=this;V._39I||(V._39I=new $m),V._39I.add(J,o,P)},removeIndexChangeListener:function(T,e){this._39I.remove(T,e)},prepareRemove:function(T){Jr(T)&&(T.setSource(h),T.setTarget(h)),T._70O&&T._70O.toList().each(this.remove,this),T._69O&&T._69O.toList().each(function(D){D.setHost(h)}),T._host&&T.setHost(h)},onAdded:function(N){this.isAutoAdjustIndex()&&this.adjustIndex(N)},onDataPropertyChanged:function(t,X){Eo[X.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(t)},isAdjustable:function(N){return Tn(N)||Jr(N)},isAdjustedToBottom:function(r){return hq(r)?r.isExpanded()&&hs(r):!1},adjustIndex:function(F){var o=this;this.isHierarchicalRendering()||(o.isAdjustedToBottom(F)?(o.sendToBottom(F),F.eachChild(o.adjustIndex,o)):o.sendToTop(F))},sendToTop:function(e){var y=this;if(y.contains(e)&&y.isAdjustable(e)){var j=y._datas;if(e!==j.get(y.size()-1)){var x=j.indexOf(e);j.removeAt(x),j.add(e),y._76I(e,x,y.size()-1)}if(Jr(e)){var R=e._40I;R&&!y.isAdjustedToBottom(R)&&y.sendToTop(R),R=e._41I,R&&!y.isAdjustedToBottom(R)&&y.sendToTop(R)}e._69O&&e._69O.each(function(i){i.isRelatedTo(e)||Tn(e)&&i.isLoopedHostOn(e)||y.sendToTop(i)}),e.ISubGraph||(!hq(e)||e.isExpanded())&&e._adjustChildrenToTop&&e.eachChild(function(R){Jr(R)||y.sendToTop(R)})}},sendToBottom:function(E,g){var w=this;if(E!==g&&w.contains(E)&&w.isAdjustable(E)&&(!g||w.contains(g))){var h=w._datas,l=h.remove(E),R=g?w._datas.indexOf(g):0;if(h.add(E,R),l!==R){w._76I(E,l,R);var r=E._parent;!r||r.ISubGraph||Jr(r)||w.sendToBottom(E._parent,E)}}}}),sq(jl,{ms_edit:function(w){w._46O=function(N){var f=this,R=f.gv.dm(),b=f._index,V=f._89I,G=f._node,w=f._shape,P=f._edge,H=f._77I;G&&V?(this.fi({kind:"endEditRect",event:N,data:G,direction:V}),R.endTransaction()):w&&b>=0?(f.fi({kind:"endEditPoint",event:N,data:w,index:b}),R.endTransaction()):P&&b>=0?(f.fi({kind:"endEditPoint",event:N,data:P,index:b}),R.endTransaction()):H&&(f.fi({kind:"endEditRotation",event:N,data:H}),R.endTransaction())},w._78I=function(Q){var A=this;A.autoScroll(Q);var u=A.gv.lp(Q),m=A._index,E=A._89I,v=A._node,_=A._shape,I=A._edge,Y=A._77I;if(v&&E)A._80O(u),A.fi({kind:"betweenEditRect",event:Q,data:v,direction:E});else if(_&&m>=0)u.e=_.getPoints().get(m).e,_.setPoint(m,u),A.fi({kind:"betweenEditPoint",event:Q,data:_,index:m});else if(I&&m>=0){var T=I.s(gr);u.e=T.get(m).e,T.set(m,u),I.fp(gr,h,T),A.fi({kind:"betweenEditPoint",event:Q,data:I,index:m})}else if(Y){var D=Y.p(),t=Y.getScale(),X=xr+Mj(u.y-D.y,u.x-D.x);t.y<0&&(X+=S),$(X)<.04&&(X=0),Y.setRotation(X),A.fi({kind:"betweenEditRotation",event:Q,data:Y})}},w._80O=function(R){var b=this,y=b._node,m=b._rect,E=m.x,B=m.y,u=m.width,h=m.height,U=b._89I,g=b._anchor,o=b._matrix,R=o.tfi(R);"northwest"===U?m=oj(R,{x:E+u,y:B+h}):U===To?m=oj({x:E,y:R.y},{x:E+u,y:B+h}):"northeast"===U?m=oj({x:E,y:R.y},{x:R.x,y:B+h}):U===og?m=oj({x:R.x,y:B},{x:E+u,y:B+h}):U===Yp?m=oj({x:E,y:B},{x:R.x,y:B+h}):"southwest"===U?m=oj({x:R.x,y:B},{x:E+u,y:R.y}):"south"===U?m=oj({x:E,y:B},{x:E+u,y:R.y}):"southeast"===U&&(m=oj({x:E,y:B},R)),y.setPosition(o.tf(m.x+m.width*g.x,m.y+m.height*g.y)),y.setWidth(m.width),y.setHeight(m.height)},w._80I=function(q,D,g,e){var j=this,$=j.gv._zoom,U=(j.gv.getEditPointSize()+2)/$;return Ib({x:D-U/2,y:g-U/2,width:U,height:U},q)?(j._89I!==e&&(j._89I=e),!0):!1},w._79I=function(B,p,W){var Y=this,T=Y.gv,E=p?T.getDataUI(p):h,H=E?E._55O:h;if(H){var k,$,U,i,G=T._zoom,S=(T.getEditPointSize()+2)/G,P=T.lp(B);if(Tn(p)){if(H._56O&&Tn(p)&&($=H._98o,Ib({x:$.x-S/2,y:$.y-S/2,width:S,height:S},P)))return Y._77I=p,W&&Y.fi({kind:"beginEditRotation",event:B,data:p}),Y.setCursor("crosshair"),!0;if(H._43O&&p instanceof Gf)for(U=p.getPoints(),k=U.size()-1;k>=0;k--)if($=U.get(k),Ib({x:$.x-S/2,y:$.y-S/2,width:S,height:S},P))return Y._index=k,Y._shape=p,W&&Y.fi({kind:"beginEditPoint",event:B,data:p,index:k}),Y.setCursor("crosshair"),!0;if(H._42O)for(var J=p.getEditControlPoints(),R=["northwest",-1,-1,og,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Yp,1,0,"northeast",1,-1,To,0,-1],k=0,i=J.length;i>k;k++){var Z=R[3*k],N=J[k];if(Y._80I(P,N.x,N.y,Z)){Y._node=p;var C=p.getWidth(),r=p.getHeight(),v=p.getAnchor();Y._rect={x:-C*v.x,y:-r*v.y,width:C,height:r},Y._anchor=v,Y._matrix=p.getMatrix();var I=p.getRotation(),t=d(I),q=a(I),x=R[3*k+1]*Jp(p.getScale().x),_=R[3*k+2]*Jp(p.getScale().y),w=Math.atan2(-q*x-t*_,t*x-q*_),o=(Math.round(w/(Math.PI/4))+8)%8,L=[yb,"nesw-resize",Lk,"nwse-resize",yb,"nesw-resize",Lk,"nwse-resize"][o];return Y.setCursor(L),W&&Y.fi({kind:"beginEditRect",event:B,data:p,direction:Y._89I}),!0}}}if(H._43O&&Jr(p)&&p.s(Vd)===ki&&(U=p.s(gr)))for(k=U.size()-1;k>=0;k--)if($=U.get(k),Ib({x:$.x-S/2,y:$.y-S/2,width:S,height:S},P))return Y._index=k,Y._edge=p,W&&Y.fi({kind:"beginEditPoint",event:B,data:p,index:k}),Y.setCursor("crosshair"),!0}return!1}},ms_gv:function($){$._currentSubGraph=h,$._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},$.upSubGraph=function(){this.setCurrentSubGraph(qm(this._currentSubGraph))},$.isVisible=function(Y){var Q=this;if(qm(Y)!==Q._currentSubGraph)return!1;if(Jr(Y)){var j=Y._40I,O=Y._41I;if(!j||!O)return!1;if(!(Y.s("edge.independent")||Q.isVisible(j)&&Q.isVisible(O)))return!1;if(Y.isEdgeGroupHidden())return!1}else for(var u=Y._parent;u&&!u.ISubGraph;){if(hq(u)&&(!u.isExpanded()||!Q.isVisible(u)))return!1;u=u._parent}if(Y._parent instanceof Ho&&!Q.isVisible(Y._parent))return!1;if(Y._refGraph instanceof Qk&&!Q.isVisible(Y._refGraph))return!1;if(Q instanceof ti){if(!Y.s("3d.visible"))return!1}else{var n=Q.getLayersInfo();if(n){var t=n[Y._layer];if(t&&t.visible===!1)return!1}if(!Y.s("2d.visible"))return!1}return Q._visibleFunc?Q._visibleFunc(Y):!0},$.handleSelectionChange=function(z){var v=this;z.datas.each(function(t){v.invalidateData(t);var M=t._parent;hq(M)&&Tn(t)&&t.s(Cl)&&(v.invalidateData(M),M._49I&&M._49I.each(function(S){v.invalidateData(S)}))}),v.onSelectionChanged(z)},$.onSelectionChanged=function(q){var V=this,G=V.sm();if(1===G.size()&&("set"===q.kind||"append"===q.kind)){var l=G.ld();V.isAutoMakeVisible()&&V.makeVisible(l),V.adjustIndex&&V._dataModel.isAutoAdjustIndex()&&V.adjustIndex(l)}},$.makeVisible=function(S){if(S){var Y=this,j=Y.getDataUI?Y.getDataUI(S):Y.getData3dUI(S);if(j){var R=S,z=qm(S);for(z!==Y._currentSubGraph&&Y.setCurrentSubGraph(z);(R=R._parent)&&R!==z;)hq(R)&&R.setExpanded(!0);Y._23I=S,Y.iv()}}},$.getLabel=function(L){var U=L.getStyle(Cn);return U===B?L.getName():U},$.getLabelBackground=function(D){return D.getStyle("label.background")},$.getLabelColor=function(M){return M.getStyle("label.color")},$.getLabel2=function(d){return d.getStyle("label2")},$.getLabel2Background=function(r){return r.getStyle("label2.background")},$.getLabel2Color=function(F){return F.getStyle("label2.color")},$.getNote=function(w){return w.getStyle(Am)},$.getNoteBackground=function(H){return H.getStyle("note.background")},$.getNote2=function(i){return i.getStyle(Um)},$.getNote2Background=function(l){return l.getStyle("note2.background")},$.handleClick=function(F,f,r){var G=this;f?(G.fi({kind:"clickData",event:F,data:f,part:r}),G.onDataClicked(f,F)):(G.fi({kind:"clickBackground",event:F}),G.onBackgroundClicked(F))},$.handleDoubleClick=function(U,W,a){var $=this;Pd(U)&&(W?($.fi({kind:"doubleClickData",event:U,data:W,part:a}),$.onDataDoubleClicked(W,U,a),$.checkDoubleClickOnNote(U,W,a)||$.checkDoubleClickOnRotation&&$.checkDoubleClickOnRotation(U,W,a)||(Jr(W)?$.onEdgeDoubleClicked(W,U,a):W.ISubGraph?$.onSubGraphDoubleClicked(W,U,a):hq(W)?$.onGroupDoubleClicked(W,U,a):W.IDoorWindow?$.onDoorWindowDoubleClicked(W,U,a):W.ICSGBox&&$.onCSGBoxDoubleClicked(W,U,a))):($.fi({kind:"doubleClickBackground",event:U}),$.onBackgroundDoubleClicked(U)))},$.onSubGraphDoubleClicked=function(k){this.setCurrentSubGraph(k)},$.onEdgeDoubleClicked=function(a,Q){this.isEditable(a)||(a.ISubGraph&&!Nq(Q)?this.setCurrentSubGraph(a):a.s("edge.toggleable")&&a.toggle())},$._39Q=function(U){return this.isInteractive(U)?this.preventDefaultWhenInteractive(U):!1},$.preventDefaultWhenInteractive=function(U){return U.s("preventDefaultWhenInteractive")},$.onGroupDoubleClicked=function(W){W.s("group.toggleable")&&W.toggle()},$.onDoorWindowDoubleClicked=function(s){s.s("dw.toggleable")&&s.toggle(!0)},$.onCSGBoxDoubleClicked=function(W,Q){var P=this;if(P instanceof ti){var X=P.intersectObject(Q,W);X&&W.s(X.part+".toggleable")&&W.toggleFace(X.part,!0)}},$.onBackgroundClicked=function(){},$.onBackgroundDoubleClicked=function(){this.upSubGraph()},$.onDataClicked=function(){},$.onDataDoubleClicked=function(){},$.onAutoLayoutEnded=function(){},$.onMoveEnded=function(){},$.onPanEnded=function(){},$.onPinchEnded=function(){},$.onRectSelectEnded=function(){},$.onZoomEnded=function(){},$.serialize=function(W){return this.dm().serialize(W)},$.toJSON=function(){return this.dm().toJSON()},$.deserialize=function(F,j){var m=this;j=j instanceof Dr?{rootParent:j}:He(j)?{setId:j}:bo(j)?{finishFunc:j}:j||{},j.view=m;var K=m.dm();return j.__innerHandler__=function(r){if(He(K.a("toolTipEnable"))&&(K.a("toolTipEnable")?m.enableToolTip():m.disableToolTip()),m instanceof R.graph.GraphView&&(He(K.a("zoomable"))&&m.setZoomable&&m.setZoomable(K.a("zoomable")),He(K.a("pannable"))&&m.setPannable&&m.setPannable(K.a("pannable")),He(K.a("rectSelectable"))&&m.setRectSelectable&&m.setRectSelectable(K.a("rectSelectable")),K.a("fitContent")===!0&&m.fitContent&&m.fitContent(!0,0)),m instanceof R.graph3d.Graph3dView){var Q=r.scene;Q&&Q.shadow!=h&&m.shadowMap.setShadow(Q.shadow,Q.shadowParams);var d=K.a("sceneContext");d?(d.eye&&m.setEye(d.eye),d.center&&m.setCenter(d.center),ih(d.far)&&m.setFar(d.far),ih(d.near)&&m.setNear(d.near)):(ih(K.a("sceneNear"))&&m.setNear(K.a("sceneNear")),ih(K.a("sceneFar"))&&m.setFar(K.a("sceneFar")),Q&&(Q.eye&&m.setEye(Q.eye),Q.center&&m.setCenter(Q.center))),He(K.a("sceneShadowEnabled"))&&(K.a("sceneShadowEnabled")?m.enableShadow():m.disableShadow()),ih(K.a("sceneShadowDegreeX"))&&m.setShadowDegreeX(K.a("sceneShadowDegreeX")),ih(K.a("sceneShadowDegreeZ"))&&m.setShadowDegreeZ(K.a("sceneShadowDegreeZ")),ih(K.a("sceneShadowIntensity"))&&m.setShadowIntensity(K.a("sceneShadowIntensity")),K.a("sceneShadowQuality")!=h&&m.setShadowQuality(K.a("sceneShadowQuality")),K.a("sceneShadowType")&&m.setShadowType(K.a("sceneShadowType")),ih(K.a("sceneShadowRadius"))&&m.setShadowRadius(K.a("sceneShadowRadius")),ih(K.a("sceneShadowBias"))&&m.setShadowBias(K.a("sceneShadowBias")),He(K.a("sceneDashEnable"))&&m.setDashDisabled(!K.a("sceneDashEnable")),Ek(K.a("sceneHighlightMode"))&&m.setHighlightMode(K.a("sceneHighlightMode")),ih(K.a("sceneHighlightWidth"))&&m.setHighlightWidth(K.a("sceneHighlightWidth")),K.a("sceneHighlightColor")&&m.setHighlightColor(K.a("sceneHighlightColor")),He(K.a("sceneHeadlightEnable"))&&m.setHeadlightDisabled(!K.a("sceneHeadlightEnable")),ih(K.a("sceneHeadlightRange"))&&m.setHeadlightRange(K.a("sceneHeadlightRange")),K.a("sceneHeadlightColor")&&m.setHeadlightColor(K.a("sceneHeadlightColor")),ih(K.a("sceneHeadlightIntensity"))&&m.setHeadlightIntensity(K.a("sceneHeadlightIntensity")),ih(K.a("sceneHeadlightAmbientIntensity"))&&m.setHeadlightAmbientIntensity(K.a("sceneHeadlightAmbientIntensity")),He(K.a("sceneFogEnable"))&&m.setFogDisabled(!K.a("sceneFogEnable")),K.a("sceneFogMode")&&m.setFogMode(K.a("sceneFogMode")),He(K.a("sceneFogDensity"))&&m.setFogDensity(!K.a("sceneFogDensity")),K.a("sceneFogColor")&&m.setFogColor(K.a("sceneFogColor")),ih(K.a("sceneFogNear"))&&m.setFogNear(K.a("sceneFogNear")),ih(K.a("sceneFogFar"))&&m.setFogFar(K.a("sceneFogFar")),He(K.a("sceneBatchBrightnessDisabled"))&&m.setBatchBrightnessDisabled(K.a("sceneBatchBrightnessDisabled")),He(K.a("sceneBatchBlendDisabled"))&&m.setBatchBlendDisabled(K.a("sceneBatchBlendDisabled")),He(K.a("sceneBatchColorDisabled"))&&m.setBatchColorDisabled(K.a("sceneBatchColorDisabled")),K.a("sceneBatchInfoMap")&&m.setBatchInfoMap(K.a("sceneBatchInfoMap")),ih(K.a("sceneMoveStep"))&&m.setMoveStep(K.a("sceneMoveStep")),ih(K.a("sceneRotateStep"))&&m.setRotateStep(K.a("sceneRotateStep")),He(K.a("sceneSortable"))&&m.setSortable(K.a("sceneSortable")),bo(K.a("sceneSortFunc"))&&m.setSortFunc(K.a("sceneSortFunc"));var t=K.a("sceneSkyboxType")||"sphere";if(t!=h){var O={},L=!1;if("sphere"===t){O.shape3d=t;var I=K.a("sceneSkyboxImage");I&&(O["shape3d.image"]=I,L=!0)}else O.shape3d=B,["front","back","left","right","top","bottom"].forEach(function(l){var j=l+".image",z=l.charAt(0).toUpperCase()+l.slice(1),q=K.a("sceneSkybox"+z+"Image");q&&(O[j]=q,L=!0)});if(L){var n=new Qp,T=K.a("sceneSkyboxDiameter");ih(T)?n.s3(T,T,T):n.s3(20,20,20),O["body.color"]=K.a("sceneSkyboxBodyColor"),O.envmap=K.a("sceneSkyboxEnvmap"),O.light=!1,O["texture.wrap"]="clampToEdge",n.s(O),["X","Y","Z"].forEach(function(J){var k=K.a("sceneSkyboxRotation"+J);ih(k)&&n["setRotation"+J](k)}),m.setSkybox(n)}}}},K.deserialize(F,j.rootParent,j)},$.isDebugTipShowing=function(){return!!this._debugDiv},$.showDebugTip=function(){var o=this,k=o._debugDiv;if(!k){k=o._debugDiv=N.createElement("div"),k.style.position="absolute",k.style.overflow="hidden",k.style.font=l.debugTipLabelFont,k.style.padding="6px",k.style.backgroundColor=l.debugTipBackground,k.style.color=l.debugTipLabelColor;var H=o.getView();o._79O?H.insertBefore(k,o._79O):H.appendChild(k);var S=function(){o.redraw();var X=o._canvas,E="FPS: "+o._fpsInfo.fps+"<br/>"+"Datas: "+o.dm().getDatas().length+(X?"<br/>Size: "+X.width+" * "+X.height:""),l=o.dm()._historyManager;
l&&(E+="<br/>Undoes: "+l.getHistories().length+" index: "+l.getHistoryIndex());var L=o.getDebugTip();L&&(E+="<hr>"+L),k.innerHTML=E,o._isDebugging&&requestAnimationFrame(S)};requestAnimationFrame(S),o._isDebugging=!0}},$.hideDebugTip=function(){var C=this,j=C._debugDiv;j&&(delete C._debugDiv,C.getView().removeChild(j),C._isDebugging=!1)},$.updateDOMAppendMatrix=function(){var e=this.getView();e&&(e.updateAppendMatrix=!0)},$.countFrame=function(){if(this._isDebugging){var x=Date.now(),j=this._fpsInfo;x-j.time>1e3?(j.fps=Math.round(1e5*(j.frames+1)/(x-j.time))/100,j.time=x,j.frames=0):j.frames++}}},ms_icons:function(T){T.getRotation=function(M){return M==h?0:M},T._15O=function(){var r=this,Y=r.s(th);if(Y){var K=r,c=r.data||r._data,E=r._38o={icons:Y,rects:{}};for(var A in Y){var e=Y[A],R=pk(e.shape3d,c,K);if(!(pk(e.visible,c,K)===!1||pk(e.for3d,c,K)&&!r.I3d||R&&!r.I3d)){var i=R?[R]:pk(e.names,c,K),N=i?i.length:0,m=pk(e.position,c,K)||3,W=pk(e.offsetX,c,K)||0,Q=pk(e.offsetY,c,K)||0,n=pk(e.direction,c,K)||Yp,_=pk(e.gap,c,K),v=_!=h?_:1,j=pk(e.rotation,c,K),O=pk(e.keepOrien,c,K),g=pk(e.rotationFixed,c,K)?j:r.getRotation(j,O,m),a=h,I=E.rects[A]=new Array(N);I.rotation=g;for(var F=0;N>F;F++){var V,o,X,z,S=i[F];if(R)X=0,z=0;else{var J=vo(S);X=pk(e.width,c,K),z=pk(e.height,c,K),X==h&&(X=sm(J,c)),z==h&&(z=wq(J,c))}if(a?n===Yp?W+=X/2:n===og?W-=X/2:n===To?Q-=z/2:Q+=z/2:a={width:X,height:z},r.I3d){var s=-X/2,p=-z/2;o={width:X,height:z,mat:r._16O(pk(e.autorotate,c,K),m,a,pk(e.face,c,K)||Lr,pk(e.t3,c,K),pk(e.r3,c,K),pk(e.rotationMode,c,K),W,Q),vs:new _p([s,-p,0,s,-p-z,0,s+X,-p-z,0,s+X,-p,0])}}else V=r.getPosition(m,W,Q,a,pk(e.positionFixed,c,K)),o={x:V.x-X/2,y:V.y-z/2,width:X,height:z},r._68o(o,g);I[F]=o,n===Yp?W+=X/2+v:n===og?W-=X/2+v:n===To?Q-=z/2+v:Q+=z/2+v}}}}}}});var pb={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Ql={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Dd={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Eo={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Jh={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Pm={"edge.type":1,"edge.group":1},fs={rotation:1,rotationX:1,rotationZ:1},Yn={rotation:1,position:1,width:1,height:1,anchor:1,scale:1,host:1},bi={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Wp={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},ss={shape:1,thickness:1,position:1,anchor:1,scale:1},qm=function(g){if(!g)return h;if(Jr(g)){var M=g._40I,J=g._41I;if(!M||!J)return h;var V=qm(M),Y=qm(J);return V===Y?V:h}for(var O=g._parent;Jr(O)&&!O.ISubGraph;)O=O._parent;return O?O.ISubGraph?O:qm(O):h},Ul=function(Z,w,a,v){var g=w.getStyle(a)*v;g&&Lq(Z,g),g=w.getStyle(a+".left")*v,g&&(Z.x-=g,Z.width+=g),g=w.getStyle(a+".right")*v,g&&(Z.width+=g),g=w.getStyle(a+".top")*v,g&&(Z.y-=g,Z.height+=g),g=w.getStyle(a+".bottom")*v,g&&(Z.height+=g),Z.width<0&&(Z.width=-Z.width,Z.x-=Z.width),Z.height<0&&(Z.height=-Z.height,Z.y-=Z.height)},hs=function(w){for(var Y,Q=0,X=w.size();X>Q;Q++)if(Y=w.getChildAt(Q),Tn(Y)&&hs(Y))return!0;return w.hasAgentEdges()},Ye=function(G){if(!G)return h;for(var Q=G._parent;hq(Q);){if(!hq(Q._parent))return Q.isExpanded()?G:Q;Q.isExpanded()||(G=Q),Q=Q._parent}return G},bh=function(n,v){if(!n||!v)return h;var g,k,$,F=qm(n),A=qm(v);if(F!==A){for(;A&&F!==A;)A=qm(A);if(F===A)return n;g=new bp,g.add(n,0);for(var J=n._parent;Tn(J)&&!v.isDescendantOf(J);)g.add(J,0),J=J._parent;for($=g.size(),k=0;$>k;k++){var L=g.get(k);if(hq(L)&&!L.isExpanded())return L;if(L.ISubGraph)return L}return n}return n},xq=function(c){if(c.isLooped())return c._source;var V=Ye(c._source),y=Ye(c._target);return V===y?c._source:bh(V,y)},Xp=function(A){if(A.isLooped())return A._target;var K=Ye(A._source),M=Ye(A._target);return K===M?A._target:bh(M,K)},Hf=function(x,D,O){"target"!==O&&(O="source");var h="target"===O?D.getTargetAgent():D.getSourceAgent(),a="edge."+O+".";if(Jr(h)){var y=x.getDataUI(h);y._79o();var T=D.s(a+"index");if(T>=0){var _=Kp(y);return _[Math.max(0,Math.min(T,_.length-1))]}var Z=D.s(a+"percent")||0;Z=Math.max(0,Math.min(Z,1));var L=Wc(y);return xe(L,100*Z)}return Hg(x,h,D.s(a+"position"),D.s(a+"offset.x"),D.s(a+"offset.y"),D.s(a+"anchor.x"),D.s(a+"anchor.y"))},Hg=function(b,v,H,Q,N,p,o){if(!v)return h;var s,O=v.getRotation?v.getRotation():0;if(p!==B||o!==B){p=p===B?.5:p,o=o===B?.5:o;var w=v.getScale();if(O&&!Yq(v,b)||w.x<0||w.y<0){var U=v.getPosition(),R=v.getWidth(),q=v.getHeight(),m=v.getAnchor(),Y=new uk(O,U.x,U.y,w.x,w.y);H=Y.tf((p-m.x)*R,(o-m.y)*q)}else s=ji(b,v),H={x:s.x+p*s.width,y:s.y+o*s.height}}else H=Fj(H,ji(b,v));if(O){var T=d(O),A=a(O),L=Q*T-N*A;N=Q*A+N*T,Q=L}return H.x+=Q,H.y+=N,H},bn=function(Q,Y){if(!Q||!Y)return h;var L,E,w,T,s,n;if(Q===Y){if(T=Q.getLoopedEdges(),!T)return h;T=new bp(T)}else{if(s=Q.getAgentEdges(),n=Y.getAgentEdges(),!s||!n)return h;for(E=s.size(),L=0;E>L;L++)w=s.get(L),n.contains(w)&&(T||(T=new bp),T.add(w))}if(T)for(L=0;L<T.size();L++)w=T.get(L),w.getStyle(Vd)===ki&&(w._22I(h),T.removeAt(L),L--);return T},Vf=function(B,Y){var M=bn(B,Y);if(M&&!M.isEmpty()){if(1===M.size())return M.get(0)._22I(h),void 0;var H=new bp,r=new bp;M.each(function(j){var y=j.s("edge.group");H.contains(y)||H.add(y)}),H.sort(),H.each(function(a){r.add(new R.EdgeGroup(M.toList(function(d){return a===d.s("edge.group")}),r))}),r.each(function(v){v.each(function(s){s._22I(v)})})}},cm=function(h,N,s){var x=h._canvas;h._zoom;var w=ug(N,x),m=ug(s,x);return{x:w.x-m.x,y:w.y-m.y}},$n=function(m,D){if(D){var Y=D.rect,l=D.color,w=D.rotation,Z=D.labelWidth,V=D.background,W=D.opacity,O=D.scale,v=O!=h&&1!==O;if(W!=h){var c=m.globalAlpha;m.globalAlpha*=W}if(w||v){m.save();var J=Y.x+Y.width/2,p=Y.y+Y.height/2;Df(m,J,p),w&&Cs(m,w),v&&m.scale(O,O),Df(m,-J,-p)}if(V&&Tj(m,Y.x,Y.y,Y.width,Y.height,V),Z){var F=Y.width,I=m.createLinearGradient(Y.x,Y.y,Y.x+F,Y.y);I.addColorStop(0,l),I.addColorStop(.9,l),I.addColorStop(1,sr),l=I,Y.width=Z}Wl(m,D.ss,Y,D.font,l,D.align),Z&&(Y.width=F),(w||v)&&m.restore(),W!=h&&(m.globalAlpha=c)}},Ah=function(t,R){if(R){var M=R.rect,d=M.x,$=M.y,o=M.width,p=M.height,i=R.background,u=R.backgroundImage,f=R.borderWidth,X=R.borderColor,Y=R.labelWidth,a=R.opacity,c=R.scale,s=c!=h&&1!==c;if(a!=h){var L=t.globalAlpha;t.globalAlpha*=a}if(s){t.save();var E=M.x+M.width/2,y=M.y+M.height/2;Df(t,E,y),t.scale(c,c),Df(t,-E,-y)}if(R.expanded){var I=v(8,o/4),n=$+p-8;if(t.fillStyle=i,t.beginPath(),t.moveTo(d,$),t.lineTo(d,n),t.lineTo(d+o/2,n),t.lineTo(d+o/2,$+p),t.lineTo(d+o/2+I,n),t.lineTo(d+o,n),t.lineTo(d+o,$),t.closePath(),t.fill(),f&&(t.lineWidth=f,t.lineJoin="round",t.lineCap="round",X?(t.strokeStyle=X,t.stroke()):(t.strokeStyle=Qi(i),t.beginPath(),t.moveTo(d+o,$),t.lineTo(d+o,n),t.lineTo(d+o/2+I,n),t.lineTo(d+o/2,$+p),t.stroke(),t.strokeStyle=wp(i),t.beginPath(),t.moveTo(d+o,$),t.lineTo(d,$),t.lineTo(d,n),t.lineTo(d+o/2,n),t.lineTo(d+o/2,$+p),t.stroke())),u)eq(t,vo(u),vi,M.x,M.y,M.width,M.height-8,R.data,R.view);else{if(M.height-=8,i=R.color,Y){var q=o,K=t.createLinearGradient(d,$,d+q,$);K.addColorStop(0,i),K.addColorStop(.9,i),K.addColorStop(1,sr),i=K,M.width=Y}Wl(t,R.ss,M,R.font,i,R.align),Y&&(M.width=q),M.height+=8}}else if(R.icon)If(t,vo(R.icon),d,$,o,p,R.data,R.view);else{var F=o/2;f&&(t.lineWidth=f,t.lineJoin="round",t.lineCap="round",t.strokeStyle=X?X:Qi(i),t.beginPath(),t.arc(d+F,$+F,F,xr,1.6*S,!0),t.moveTo(d+F,$+p),t.lineTo(d+o-F/5,$+F),t.stroke(),t.strokeStyle=X?X:wp(i),t.beginPath(),t.arc(d+F,$+F,F,1.6*S,xr,!0),t.moveTo(d+F,$+p),t.lineTo(d+F/5,$+F),t.stroke()),t.fillStyle=i,t.beginPath(),t.arc(d+F,$+F,F,0,Q,!0),t.moveTo(d+F,$+p),t.lineTo(d+o-F/5,$+F),t.lineTo(d+F/5,$+F),t.closePath(),t.fill(),t.fillStyle=R.color,t.beginPath(),t.arc(d+F,$+F,F/3,0,Q,!0),t.fill()}s&&t.restore(),a!=h&&(t.globalAlpha=L)}},en=function(H,u){return u>2*H?H:u/2},Ih=function(L,s,m,i){if(!L||!s)return 0;var G=Mj(s.y-L.y,s.x-L.x);return m||(G=s.x<L.x?G+S:G),G+i},Fk=function(F,Z,n,i,k,T,H){H&&(F.x>Z.x||F.x===Z.x&&F.y>Z.y)&&(n=Dh[n],k=-k);var a=Fj(n,{x:0,y:0,width:Jf(F,Z),height:0},T);return a.x+=i,a.y+=k,a=new uk(Mj(Z.y-F.y,Z.x-F.x)).tf(a),a.x+=F.x,a.y+=F.y,a},zr=function(E,x,C,s,p){if(E._19Q=!0,!C.getEdgeGroup())return s?C.s("edge.gap"):0;if(Jr(C.getSourceAgent())||Jr(C.getTargetAgent()))return 0;var U,h=0,w=0,X=0;if(C.getEdgeGroup().getSiblings().each(function(l){l.each(function(v){if(x.isVisible(v)&&v.s(Vd)==p){var Y=v.s("edge.gap");U?(w+=X/2+Y/2,X=Y):(U=v,X=Y),v===C&&(h=w)}})}),s)return w-h+X;var L=h-w/2;return U&&C._40I!==U._40I&&(E._19Q=!1),L},tm=function(e){var K=e._getValidSelection();if(1===K.length){var _=K[0],j=_ instanceof R.Edge;if(_ instanceof R.Shape||j){if(j){var l=_.s("edge.type");if(l&&"points"!==l)return}var x=e.gv;if((!x.isPointEditable||x.isPointEditable(_))&&x.isEditable(_))return _}}},Uc=function(){var f=function(p){var t=[];return p.forEach(function(Y){t.push({x:Y.x,y:Y.y}),t.push({x:Y.x+Y.width,y:Y.y+Y.height}),t.push({x:Y.x+Y.width,y:Y.y}),t.push({x:Y.x,y:Y.y+Y.height})}),t};return function(h,z,Y){if("oval"===h){var j=0,H=Y.height/Y.width,X=H*H,u=Y.x+Y.width/2,k=Y.y+Y.height/2,M=f(z);M.forEach(function(w){var q=w.x-u,G=w.y-k,e=q*q+G*G/X;e>j&&(j=e)}),j=m(j);var K=H*j;return{x:u-j,y:k-K,width:2*j,height:2*K}}if("circle"===h){var y=0,u=Y.x+Y.width/2,k=Y.y+Y.height/2,M=f(z);return M.forEach(function(m){var U=m.x-u,C=m.y-k,G=U*U+C*C;G>y&&(y=G)}),y=m(y),{x:u-y,y:k-y,width:2*y,height:2*y}}return"roundRect"===h?(Lq(Y,v(Y.width,Y.height)/16),Y):Y}}(),hi=R.graph={},af=function(u,F,M){tr(z+".graph."+u,F,M)};R.layout={};var pj={},Vk=function(f,T,O,B,U,g,Q,M){var e=Q._zoom;if(e!==Q._cacheZoom&&(Q._cacheZoom=e,Q._cacheImage={}),e*=Tp,B=Math.ceil(B*e),U=Math.ceil(U*e),B>2048||U>2048)return T;var m=[T.uuid,B,U,O].join("_");T.cacheRule&&(m+="_"+pk(T.cacheRule,g,Q));var z=Q._cacheImage[m];return z||(un(),z=R.Default.toCanvas(T,B,U,O,g,Q,M),Kb()&&(Q._cacheImage[m]=z)),z};sq(l,{setImageCacheRule:function(y,x){var w;x||"object"!=typeof y?(w={},w[y]=x):w=y;for(var h in w){var v=w[h];Ek(h)?(tr=vo(h),tr?tr.cacheRule=v:pj[h]=v):h.cacheRule=v}}});var Zg={comps:[{type:Cq,points:[85,50,70,115,100,71,86,107,88,49,57,90,86,55,112,66,43,57,90,88,87,65,115,83,77,121,85,117,106,85,97,73,79,43,67,80,80,79,103,118,83,97,56,61],borderWidth:1,borderColor:h}]};if(Zg[wf]=Zg[Qd]=160,P.Image){var Nc=new P.Image;Nc.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",vf("default_blank",Nc)}vf("node_image",dr(30,30,[{type:Kq,rect:[4,5,22,16],gradient:ad,gradientColor:vb,background:te},{type:Kq,rect:[2,3,26,20],borderWidth:1,borderColor:te},{type:Kq,rect:[11,23,8,4],background:te},{type:Kq,rect:[6,27,18,2],background:te}])),vf("node_icon",dr(16,16,[{type:Kq,rect:[2,2,12,10],gradient:ad,gradientColor:vb,background:te},{type:Ri,rect:[2,2,12,10],width:1,color:te},{type:Kq,rect:[6,12,4,2],background:te},{type:Kq,rect:[4,14,8,1],background:te}])),vf("block_icon",dr(16,16,[{type:Ri,rect:[1,1,14,14],width:1,color:te}])),vf("group_image",dr(66,39,[{type:Kq,rect:[44.3,18,18.1,12.8],gradient:ad,gradientColor:vb,background:te},{type:Kq,rect:[3.3,17.8,18.1,12.8],gradient:ad,gradientColor:vb,background:te},{type:Kq,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:te,gradient:ad,gradientColor:vb,background:te},{type:Kq,rect:[26.2,29.4,12.8,4.2],background:te},{type:Kq,rect:[21.3,33.5,22.5,2.3],background:te},{type:Kq,rect:[5.3,32.7,14.1,2.1],background:te},{type:Kq,rect:[9,30.4,6.7,2.4],background:te},{type:Kq,rect:[50,30.7,6.7,2.4],background:te},{type:Kq,rect:[46.3,33,14.1,2.1],background:te}])),vf("group_icon",dr(16,16,[{type:Kq,rect:[4,12,4,2],background:te},{type:Kq,rect:[2,13,8,1],background:te},{type:Kq,rect:[12,12,2,1],background:te},{type:Kq,rect:[11,13,4,1],background:te},{type:Kq,rect:[10,7,6,5],gradient:ad,gradientColor:vb,background:te},{type:Kq,rect:[1,2,10,10],gradient:ad,gradientColor:vb,background:te},{type:Ri,rect:[1,2,10,10],width:1,color:te}])),vf("refGraph_icon",dr(16,16,[{type:"shape",borderWidth:1,borderColor:te,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:te,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),vf("edge_icon",dr(16,16,[{type:Kq,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:ad,gradientColor:vb,background:te},{type:Kq,rect:[10.8,1,4,4],background:te},{type:Kq,rect:[1,11,4,4],background:te}])),vf("subGraph_image",dr(72,45,[{type:Cq,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:ad,gradientColor:vb,background:te},{type:Kq,rect:[29.6,30.7,3.6,1.8],background:te},{type:Kq,rect:[28.4,32.3,6,1.2],background:te},{type:Kq,rect:[37.3,32,10.8,1.8],background:te},{type:Kq,rect:[39.1,29.9,7.2,2.3],background:te},{type:Kq,rect:[26.6,23.7,9.6,7.2],gradient:ad,gradientColor:vb,background:te},{type:Kq,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:te,gradient:ad,gradientColor:vb,background:te}])),vf("subGraph_icon",dr(17,17,[{type:Cq,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:ad,gradientColor:vb,background:te}])),vf("shape_icon",dr(16,16,[{type:Cq,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:te}])),vf("polyline_icon",dr(16,16,[{type:Cq,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:te},Cf(7.5,.4),Cf(7.5,6.3),Cf(13.6,6.3),Cf(13.6,14),Cf(.7,13.9),Cf(.7,.3)])),vf("grid_icon",dr(16,16,[{type:Kq,rect:[1,1,4,4],background:te,gradient:ad,gradientColor:vb},{type:Kq,rect:[6,1,4,4],background:te,gradient:ad,gradientColor:vb},{type:Kq,rect:[11,1,4,4],background:te,gradient:ad,gradientColor:vb},{type:Kq,rect:[11,6,4,4],background:te,gradient:ad,gradientColor:vb},{type:Kq,rect:[6,6,4,4],background:te,gradient:ad,gradientColor:vb},{type:Kq,rect:[1,6,4,4],background:te,gradient:ad,gradientColor:vb},{type:Kq,rect:[11,11,4,4],background:te,gradient:ad,gradientColor:vb},{type:Kq,rect:[6,11,4,4],background:te,gradient:ad,gradientColor:vb},{type:Kq,rect:[1,11,4,4],background:te,gradient:ad,gradientColor:vb}])),vf("light_icon",dr(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:te},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:te,gradient:ad,gradientColor:vb,background:{func:function(l){var L=l?l.s(nf):h;return Nl(L)?"rgb("+Bn(255*L[0])+","+Bn(255*L[1])+","+Bn(255*L[2])+")":L||te}}}])),vf("text_icon",dr(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:te}])),vf("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),vf("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),vf("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),vf("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var oc=function(n,x,u,q,p,X){var F,h,R,m,V,e,T,Z,U,c,K,t=[];if(Math.abs(q)>2*Math.PI&&(q=2*Math.PI),V=Math.ceil(Math.abs(q)/(Math.PI/4)),F=q/V,h=-F,R=-u,V>0){e=n+Math.cos(u)*p,T=x+Math.sin(-u)*X,t.push({x:e,y:T});for(var Y=0;V>Y;Y++)R+=h,m=R-h/2,Z=n+Math.cos(R)*p,U=x+Math.sin(R)*X,c=n+Math.cos(m)*(p/Math.cos(h/2)),K=x+Math.sin(m)*(X/Math.cos(h/2)),t.push({x:c,y:K}),t.push({x:Z,y:U})}return t},el=function(k){if(k){var $=k._data;if($ instanceof R.Shape)return{points:$.getPoints(),segments:$.getSegments()};var v;if($ instanceof R.Edge&&(v=k._78o)){var o,g,K=v.type,A=v.points,y=v.segments,l=v.edgeTypeInfo;if(!K||A){var L=v.sourcePoint,J=L.x,d=L.y,C=v.targetPoint,c=C.x,h=C.y;if(K)y?(o=new bp({x:J,y:d}),o.addAll(A),o.add({x:c,y:h}),g=new bp(y._as)):(o=new bp({x:J,y:d}),A.each(function(n){o.add(n)}),o.add({x:c,y:h}));else if(v.looped){o=new bp(oc(J,d,0,2*Math.PI,v.radius,v.radius)),g=new bp([1]);for(var p=0;p<(o.size()-1)/2;p++)g.add(3)}else o=new bp,v.center?(o.add({x:v.c1.x,y:v.c1.y}),o.add({x:J,y:d}),o.add({x:c,y:h}),o.add({x:v.c2.x,y:v.c2.y})):(o.add({x:J,y:d}),o.add({x:c,y:h}))}else l&&(o=new bp(l.points._as),l.segments&&(g=new bp(l.segments._as)));return{points:o,segments:g}}}},Wc=function(Q,G,L){if(null==G){var C=el(Q);if(!C)return;G=C.points,L=C.segments}if(G){if(Array.isArray(G)&&(G=new bp(G)),"number"==typeof G.get(0)){for(var y=new R.List,I=0;I<G.size();I+=2)y.add({x:G.get(I),y:G.get(I+1)});G=y}if(!L){L=[1];for(var x=G.length-1;x>0;x--)L.push(2)}Array.isArray(L)&&(L=new bp(L));for(var W=xk(G._as,L._as,50),a=W.length,r=[],I=0;a>I;I++){var b=W[I];b.length>1&&r.push(b)}return r}},Hp=function(c){for(var m=0,H=c.length-1,h=0;H>h;h++){var f=c[h],M=c[h+1],J=M.x-f.x,x=M.y-f.y;m+=Math.sqrt(J*J+x*x)}return m},Ln=function(x,P){for(var B=0,v=P.length,R=0;v>R;R++){var $=P[R];if(B+=$,B>x)return R}return Math.min(R,v-1)},cg=function(Y,N){for(var R=0,l=0,e=0,i=Y.length-1,D=0;i>D;D++){var H=Y[D],Q=Y[D+1],K=Q.x-H.x,U=Q.y-H.y;if(e=Math.sqrt(K*K+U*U),R+=e,R>N){R-=e,l=D;break}}var u=Y[l],f=Y[l+1],g=Math.atan2(f.y-u.y,f.x-u.x),r=N-R,U=Math.sin(g)*r,K=Math.cos(g)*r;return{x:u.x+K,y:u.y+U}},xe=function(C,L){if(C){var m;if(0===L)m=C[0][0];else if(100===L)C=C[C.length-1],m=C[C.length-1];else{for(var x=0,o=[],N=C.length,M=0;N>M;M++){var _=C[M],V=Hp(_);x+=V,o.push(V)}for(var F=x*L/100,j=Ln(F,o),f=0,v=0;j>v;v++)f+=o[v];F-=f,m=cg(C[j],F)}return m}},Kp=function(H){var o,r,D,U,Z=el(H),m=[],d=Z.points,p=Z.segments,s=-1;for(r=0,D=p?p.length:d.length;D>r;r++){if(o=p?p.get(r):1,3===o)U=2;else if(4===o)U=3;else{if(5===o)continue;U=1}s+=U,m.push(d.get(s))}return m},hp=function(y,X,R,u){function e(V){if(V>=0&&1>=V){n=X(V);var T=(y.x-n.x)*(y.x-n.x)+(y.y-n.y)*(y.y-n.y);return L>T?(L=T,N=V,!0):!1}}R=R||100,u=u||1e-5;for(var L=1/0,N=0,n=new ph,I=0;R>I;++I)e(I/R);for(var x=1/(2*R);x>u;)e(N-x)||e(N+x)||(x/=2);return N};sq(l,{_edgeProtectMethod:{getStraightLinePoints:Wc,calculateLineLength:Hp,calcSegmentIndexByDistance:Ln,calculatePointAlongLine:cg,getPercentPosition:xe,getRealPointsFromDataUI:Kp}});var um=function(l,o){for(var I=l.vertices,B=0;B<I.length;B++){var w=I[B],P=w.y;w.y=w.z,w.z=-P,o&&(w.y+=o)}},wn=function(k){for(var e,c,F,o,O,L,T=[],t=[],d=[],i=k.faces,x=0,R=0,w=0,m=i.length;m>x;x++,R+=6,w+=9){var K=i[x];1===K.i?(e||(e=[],c=[],F=[]),Qm(K,x,R,w,k,e,F,c)):2===K.i?(o||(o=[],O=[],L=[]),Qm(K,x,R,w,k,o,L,O)):Qm(K,x,R,w,k,T,d,t)}return{vs:T,uv:t,ns:d,top_vs:e,top_uv:c,top_ns:F,bottom_vs:o,bottom_uv:O,bottom_ns:L}},Qm=function(l,r,_,p,n,X,D,s){var j=n.vertices,L=n.faceVertexUvs,Q=j[l.a],P=j[l.b],R=j[l.c];X.push(Q.x,Q.y,Q.z,P.x,P.y,P.z,R.x,R.y,R.z);var e,Z,S,V=l.vertexNormals;3===V.length?(e=V[0],Z=V[1],S=V[2]):e=Z=S=l.normal,D.push(e.x,e.y,e.z,Z.x,Z.y,Z.z,S.x,S.y,S.z);var H=L[0][r][0],C=L[0][r][1],F=L[0][r][2];s.push(H.x,H.y,C.x,C.y,F.x,F.y)},qo=function(){function k(f,S){return f.dot(S)>0}function c(D,B,K,t,b,R,G){for(var h,Y,n=[B,K,t],J=[b,R,G],W=[],E=n.length,Z=!0;E--&&Z;){for(var x=n[E],i=J.length,l=!1;i--;)if(x.equals(J[i])){J.splice(i,1),W.push(x),l=!0;break}if(!l){if(h){Z=!1;break}h=x}}return Z&&2===W.length&&(Y=J[0],N.subVectors(h,W[0]),V.subVectors(Y,W[0]),r.subVectors(h,W[1]),N.x*r.y*V.z+r.x*V.y*N.z+V.x*N.y*r.z-V.x*r.y*N.z-V.y*r.z*N.x-V.z*r.x*N.y<1e-6&&(H.subVectors(Y,W[1]),I.subVectors(W[1],W[0]),k(I,N)&&k(I,V)&&(I.negate(),k(I,r)&&k(I,H))))?(D.push(W[1].x,W[1].y,W[1].z),D.push(h.x,h.y,h.z),D.push(h.x,h.y,h.z),D.push(W[0].x,W[0].y,W[0].z),D.push(W[0].x,W[0].y,W[0].z),D.push(Y.x,Y.y,Y.z),D.push(Y.x,Y.y,Y.z),D.push(W[1].x,W[1].y,W[1].z),2):(D.push(B.x,B.y,B.z),D.push(K.x,K.y,K.z),D.push(K.x,K.y,K.z),D.push(t.x,t.y,t.z),D.push(t.x,t.y,t.z),D.push(B.x,B.y,B.z),1)}function i(){this._vertexMap={},this._lineMap={},this._lineList=[]}function C(A,Q,l,D,N,m,J){var L=[l,N];A[0]===D&&L.reverse();var g=[L[0]._key,L[1]._key].join("|"),K=A._triangles[g];K||(A._triangles[g]=K={});var w=[m._key,J._key].join("|");K[w]||(K[w]=[m,J])}function M(h,C,F){var $=h._planes[F._key];if(!$)for(var s in h._planes){var S=h._planes[s];if(S._normal.angleTo(F)<.001){$=S;break}}return $?($._vertices.indexOf(C)<0&&$._vertices.push(C),void 0):(h._planes[F._key]={_normal:F,_vertices:[C]},void 0)}function u(T,b){return 0===b?"0|0|0":1/0===Math.abs(b)?[T.x,T.y,T.z].join("|"):[Math.round(A.angleTo(T)*b),Math.round(y.angleTo(T)*b),Math.round(n.angleTo(T)*b)].join("|")}function L(H,g){var V=H._ctlineModel;if(V||(H._ctlineModel=V=[]),V[0])return V[0];var i;i=Nl(H)?H:[H];var f,X,u,D,W,e,J,n,P,S,L,T,y,R,r,h,M,C,Q,_=["","top_","bottom_"];V=[];var G=[];for(Nk(i,g,G),f=0,X=G.length;X>f;f++)if(S=G[f])for(Jk(S),u=0,D=_.length;D>u;u++)if(P=S[_[u]+"lvs"])for(M=V.length,C=P.length,V.length=M+C,Q=0;C>Q;++Q,++M)V[M]=P[Q];else if(J=S[_[u]+"vs"]){n=S[_[u]+"is"],e=n?n.length:J.length/3;for(var W=0;e-1>W;)n?(L=n[W],T=n[W+1],y=n[W+2],R=n[W+3],r=n[W+4],h=n[W+5]):(L=W,T=W+1,y=W+2,R=W+3,r=W+4,h=W+5),s.fromArray(J,3*L),z.fromArray(J,3*T),b.fromArray(J,3*y),q.fromArray(J,3*R),E.fromArray(J,3*r),$.fromArray(J,3*h),W+=3*c(V,s,z,b,q,E,$);e>W&&(n?(L=n[W],T=n[W+1],y=n[W+2]):(L=W,T=W+1,y=W+2),s.fromArray(J,3*L),z.fromArray(J,3*T),b.fromArray(J,3*y),V.push(s.x,s.y,s.z),V.push(z.x,z.y,z.z),V.push(z.x,z.y,z.z),V.push(b.x,b.y,b.z),V.push(b.x,b.y,b.z),V.push(s.x,s.y,s.z))}return H._ctlineModel[0]=V,V}function R(G,U,x){var f=G._ctlineModel;f||(G._ctlineModel=f=[]);var K=f[1];if(K&&K.epsilon===x)return K;K=[],K.epsilon=x;var A;A=Nl(G)?G:[G];var l,H,L,D,M,N,T,w,d,P,S,F,E=["","top_","bottom_"],R=new i,g=[];for(Nk(A,U,g),l=0,H=g.length;H>l;l++)if(d=g[l])for(Jk(d),L=0,D=E.length;D>L;L++)if(T=d[E[L]+"vs"]){w=d[E[L]+"is"],N=w?w.length:T.length/3;for(var M=0,M=0;N>M;M+=3)w?(P=w[M],S=w[M+1],F=w[M+2]):(P=M,S=M+1,F=M+2),R._addTriangle(T,B,P,S,F,x)}return R._toLineVS(K),G._ctlineModel[1]=K,K}function W(w,T,E){var q=w._ctlineModel;q||(w._ctlineModel=q=[]);var J=q[2];if(J&&J.epsilon===E)return J;J=[],J.epsilon=E;var f;f=Nl(w)?w:[w];var v,U,b,R,X,H,y,Q,h,D,B,m,u,s=["","top_","bottom_"],g=new i,k=[];for(Nk(f,T,k),v=0,U=k.length;U>v;v++)if(D=k[v])for(Jk(D),b=0,R=s.length;R>b;b++)if(y=D[s[b]+"vs"]){Q=D[s[b]+"is"],h=D[s[b]+"ns"],H=Q?Q.length:y.length/3;for(var X=0,X=0;H>X;X+=3)Q?(B=Q[X],m=Q[X+1],u=Q[X+2]):(B=X,m=X+1,u=X+2),g._addTriangle(y,h,B,m,u,E)}return g._toLineVS(J),w._ctlineModel[2]=J,J}var s=new qp,z=new qp,b=new qp,q=new qp,E=new qp,$=new qp,N=new qp,r=new qp,V=new qp,H=new qp,I=new qp,t=new qp;i.prototype._findVertex=function(R,x){t.fromArray(R,3*x);var U=[t.x,t.y,t.z].join(","),c=this._vertexMap[U];if(!c){var T=t.clone();T._key=U,this._vertexMap[U]=c=T}return c},i.prototype._findLine=function(H,Y){var j=[H,Y];H._key>Y._key&&j.reverse(),j._key=[j[0]._key,j[1]._key].join("|");var f=this._lineMap[j._key];return f||(this._lineMap[j._key]=f=j,j._triangles={},j._planes={},this._lineList.push(j)),f};var A=new qp(1,0,0),y=new qp(0,1,0),n=new qp(0,0,1),Y=new qp,Z=new qp;return i.prototype._addTriangle=function(b,F,x,o,z,c){var X,d,y,a=this._findVertex(b,x),h=this._findVertex(b,o),J=this._findVertex(b,z),t=this._findLine(a,h),s=this._findLine(h,J),_=this._findLine(J,a);F?(X=(new qp).fromArray(F,3*x),X._key=u(X,c),d=(new qp).fromArray(F,3*o),d._key=u(d,c),y=(new qp).fromArray(F,3*z),y._key=u(y,c),C(t,a,X,h,d,J,y),C(s,h,d,J,y,a,X),C(_,J,y,a,X,h,d)):(Z.subVectors(J,h),Y.subVectors(h,a),X=(new qp).crossVectors(Y,Z),X._key=u(X,c),M(t,J,X),M(s,a,X),M(_,h,X))},i.prototype._toLineVS=function(P){for(var c=this._lineList,R=0,o=c.length;o>R;++R){var f=c[R],b=!1;for(var g in f._triangles)if(1==w.keys(f._triangles[g]).length){P.push(f[0].x,f[0].y,f[0].z,f[1].x,f[1].y,f[1].z),b=!0;break}if(!b)for(var n in f._planes)if(1==f._planes[n]._vertices.length){P.push(f[0].x,f[0].y,f[0].z,f[1].x,f[1].y,f[1].z),b=!0;break}}},[L,R,W]}(),dk=function($,H){var f=$._lineModel;if(f)return f;var v;v=Nl($)?$:[$];var g,q,m,n,y,i,Q,I,A,D,t,u,S=["","top_","bottom_"];f=[];var U=[];for(Nk($,H,U),g=0,q=U.length;q>g;g++)if(A=U[g])for(m=0,n=S.length;n>m;m++)if(Q=A[S[m]+"vs"]){I=A[S[m]+"is"],i=I?I.length:Q.length/3;for(var y=0;i>y;y+=3)I?(D=I[y],t=I[y+1],u=I[y+2]):(D=y,t=y+1,u=y+2),D*=3,t*=3,u*=3,f.push(Q[D],Q[D+1],Q[D+2],Q[t],Q[t+1],Q[t+2],Q[t],Q[t+1],Q[t+2],Q[u],Q[u+1],Q[u+2],Q[u],Q[u+1],Q[u+2],Q[D],Q[D+1],Q[D+2])}return $._lineModel=f,f},rc=function(B,x,$,m,D,G,f,L,V){$==h&&($=!0),m==h&&(m=!0),f==h&&(f=1),L==h&&(L=0);var E=new am;return jj(E,B,x,V),E=E.toShapes(),wn(new xf(E,{top:$,bottom:m,curveSegments:D,amount:f,repeatUVLength:G},-f/2+L))},Nb=function(e){this.repeatUVLength=e};Nb.prototype={generateTopUV:function(t,p,Z,e,V,E,u){var f,n,Q,L,x=t.vertices,d=x[e].x,U=x[e].y,l=x[V].x,$=x[V].y,C=x[E].x,S=x[E].y,T=this.repeatUVLength;if(T)f=0,n=0,Q=T,L=T;else{this._bb||(this._bb=p.getBoundingBox());var z=this._bb;f=z.minX,n=z.minY,Q=z.maxX-f,L=z.maxY-n}return u?[new fc((d-f)/Q,(U-n)/L),new fc((l-f)/Q,($-n)/L),new fc((C-f)/Q,(S-n)/L)]:[new fc((d-f)/Q,1-(U-n)/L),new fc((l-f)/Q,1-($-n)/L),new fc((C-f)/Q,1-(S-n)/L)]},generateBottomUV:function(S,p,F,V,w,r){return this.generateTopUV(S,p,F,V,w,r,!0)},generateSideWallUV:function(G,V,K,j,z,P,v,n,F,N,M,$){if(!this._cl){for(var R,x,Y=[],d=0,f=K.length,A=0;f>A;A++){R=K[A],x=K[(A+1)%f];var X=R.x-x.x,E=R.y-x.y,I=m(X*X+E*E);Y.push(d),d+=I}for(var A=0;f>A;A++)Y[A]/=d;this._cl=Y}var Y=this._cl,U=1-F/N,w=1-(F+1)/N,p=Y[M],e=Y[$];return e>p&&(p+=1),[new fc(p,U),new fc(e,U),new fc(e,w),new fc(p,w)]}};var pc=function(U,z,M,B,H,J){this.a=U,this.b=z,this.c=M,this.i=J,this.normal=B instanceof Qb?B:new Qb,this.vertexNormals=B instanceof Array?B:[]};pc.prototype={constructor:pc};var Gd=[-8,14,-5,9,1,12,3,6,-1],mi=function(){if(mi[Bl]!=h)return mi[Bl];for(var N=pq[Bl],b=Gd,r=Dr.prototype.getClassName(),j='"',D=0,t="",f=!1,B=+new(P[r.substr(3,3)+yb[D]]),T=D;T<b.length;T++){var L=b.length-T;t+=T%2===D?b[T]+L+"":b[T]-L+""}for(var T=D;4>T;T++)t+=D;if(t=t*t.length/t.length,B>t){if(N&&N[D]&&N[4/Kq.length]){for(var J,p,x,v,i,_,X,I,R=N[0],W=N[1],V="",M=0,T=0;T<W.length;T++)W[T]===j?I?(I=!1,0!==M%2&&(J==h?J=V:p==h?p=V:x==h?x=V:v==h?v=V:i==h?i=V:_==h?_=V:X==h&&(X=V)),M++,V=""):I=!0:I&&(V+=W[T]);for(var S,$,c,l="",Y=0,T=0;T<R.length;T++)R[T]===j?S?(S=!1,0!==Y%2&&($==h?$=l:c==h&&(c=l)),Y++,l=""):S=!0:S&&(l+=R[T]);var z=J+p+x+v+i+_,d=!_||_===mh;if(!d&&_)for(var Q,T=0,Z=_.length;Z>T;T++)_[T]===Vm[4]?Q===mh?d=ae:Q[0]===Gb[7]&&mh&&mh.indexOf(Q.substr(1))>=0?d=Wj:Q=h:(Q==h?Q=_[T]:Q+=_[T],T===Z-1&&(Q===mh?d=ae:Q[0]===Gb[7]&&mh&&mh.indexOf(Q.substr(1))>=0&&(d=Wj)));(f=mm(z,X)&&mm($,c)&&$===J&&d&&(!i||i>B))&&x.indexOf(uf[0])>=0&&(mi[uf[0]]=1),f&&x.indexOf(1)>=0&&(mi[1]=1),f&&x.indexOf(3)>=0&&(mi[2]=1),f&&x.indexOf(4)>=0&&(mi[3]=1),f&&x.indexOf(7)>=0&&(mi[4]=1)}}else f=!0,mi[uf[0]]=mi[1]=mi[2]=mi[3]=mi[4]=1;return mi[Bl]=f,f},Lm=function(){},xc=Lm.prototype;xc.getPointAt=function(q){var y=this.getUtoTmapping(q);return this.getPoint(y)},xc.getPoints=function(s){s||(s=5);var t,H=[];for(t=0;s>=t;t++)H.push(this.getPoint(t/s));return H},xc.getSpacedPoints=function(S){S||(S=5);var e,I=[];for(e=0;S>=e;e++)I.push(this.getPointAt(e/S));return I},xc.getLength=function(){var P=this.getLengths();return P[P.length-1]},xc.getLengths=function(d){if(d||(d=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==d+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var o,x,L=[],N=this.getPoint(0),w=0;for(L.push(0),x=1;d>=x;x++)o=this.getPoint(x/d),w+=o.distanceTo(N),L.push(w),N=o;return this.cacheArcLengths=L,L},xc.getUtoTmapping=function(d,U){var T,H=this.getLengths(),V=0,r=H.length;T=U?U:d*H[r-1];for(var W,x=0,k=r-1;k>=x;)if(V=c(x+(k-x)/2),W=H[V]-T,0>W)x=V+1;else{if(!(W>0)){k=V;break}k=V-1}if(V=k,H[V]==T){var p=V/(r-1);return p}var q=H[V],t=H[V+1],f=t-q,l=(T-q)/f,p=(V+l)/(r-1);return p},xc.getTangent=function(S){var A=1e-4,C=S-A,s=S+A;0>C&&(C=0),s>1&&(s=1);var G=this.getPoint(C),v=this.getPoint(s),H=v.clone().sub(G);return H.normalize()},xc.getTangentAt=function(k){var $=this.getUtoTmapping(k);return this.getTangent($)},Lm.create=function(j,w){return j.prototype=fo(Lm.prototype),j.prototype.getPoint=w,j};var hj=function(){this.curves=[],this.autoClose=!1},Ie=hj.prototype=fo(xc);Ie.add=function(H){this.curves.push(H)},Ie.closePath=function(){var A=this.curves[0].getPoint(0),m=this.curves[this.curves.length-1].getPoint(1);A.equals(m)||this.curves.push(new be(m,A))},Ie.getPoint=function(i){for(var U,O,q=i*this.getLength(),$=this.getCurveLengths(),z=0;z<$.length;){if($[z]>=q){U=$[z]-q,O=this.curves[z];var X=1-U/O.getLength();return O.getPointAt(X)}z++}return null},Ie.getLength=function(){var E=this.getCurveLengths();return E[E.length-1]},Ie.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var o,f=[],t=0,G=this.curves.length;for(o=0;G>o;o++)t+=this.curves[o].getLength(),f.push(t);return this.cacheLengths=f,f},Ie.getTransformedPoints=function(q){return this.getPoints(q)},Ie.getBoundingBox=function(){var q,P,r,I,z,e,o=this.getPoints();q=P=Number.NEGATIVE_INFINITY,I=z=Number.POSITIVE_INFINITY;var R,M,Y,K,_=o[0]instanceof Qb;for(K=_?new Qb:new fc,M=0,Y=o.length;Y>M;M++)R=o[M],R.x>q&&(q=R.x),R.x<I&&(I=R.x),R.y>P&&(P=R.y),R.y<z&&(z=R.y),_&&(R.z>r&&(r=R.z),R.z<e&&(e=R.z)),K.add(R);var t={minX:I,minY:z,maxX:q,maxY:P};return _&&(t.maxZ=r,t.minZ=e),t};var Jj=function(G){hj.call(this),this.actions=[],G&&this.fromPoints(G)},ar=Jj.prototype=fo(hj.prototype),No="moveTo",us="lineTo",Nr="quadraticCurveTo",Dk="bezierCurveTo",Ur="arc",dj="ellipse";ar.fromPoints=function(Z){this.moveTo(Z[0].x,Z[0].y);for(var K=1,g=Z.length;g>K;K++)this.lineTo(Z[K].x,Z[K].y)},ar.moveTo=function(){var e=Array.prototype.slice.call(arguments);this.actions.push({action:No,args:e})},ar.lineTo=function(X,K){var u=Array.prototype.slice.call(arguments),Q=this.actions[this.actions.length-1].args,D=Q[Q.length-2],C=Q[Q.length-1],$=new be(new fc(D,C),new fc(X,K));this.curves.push($),this.actions.push({action:us,args:u})},ar.quadraticCurveTo=function(g,Y,o,B){var i=Array.prototype.slice.call(arguments),X=this.actions[this.actions.length-1].args,$=X[X.length-2],y=X[X.length-1],U=new Nf(new fc($,y),new fc(g,Y),new fc(o,B));
this.curves.push(U),this.actions.push({action:Nr,args:i})},ar.bezierCurveTo=function(H,E,D,s,j,N){var r=Array.prototype.slice.call(arguments),F=this.actions[this.actions.length-1].args,P=F[F.length-2],V=F[F.length-1],U=new ee(new fc(P,V),new fc(H,E),new fc(D,s),new fc(j,N));this.curves.push(U),this.actions.push({action:Dk,args:r})},ar.arc=function(k,$,p,y,n,Q){var q=this.actions[this.actions.length-1].args,O=q[q.length-2],P=q[q.length-1];this.absarc(k+O,$+P,p,y,n,Q)},ar.absarc=function(v,s,L,I,u,A){this.absellipse(v,s,L,L,I,u,A)},ar.ellipse=function(O,o,i,f,Q,L,c){var H=this.actions[this.actions.length-1].args,e=H[H.length-2],G=H[H.length-1];this.absellipse(O+e,o+G,i,f,Q,L,c)},ar.absellipse=function(F,T,L,W,g,e,G){var x=Array.prototype.slice.call(arguments),t=new Iq(F,T,L,W,g,e,G);this.curves.push(t);var p=t.getPoint(1);x.push(p.x),x.push(p.y),this.actions.push({action:dj,args:x})},ar.getSpacedPoints=function(J){J||(J=40);for(var o=[],Z=0;J>Z;Z++)o.push(this.getPoint(Z/J));return o},ar.getPoints=function(j,v){j=j||12;var m,H,K,w,p,r,F,t,q,i,n,Q,s,J,T,I,Y,_,c=[];for(m=0,H=this.actions.length;H>m;m++)switch(K=this.actions[m],w=K.action,p=K.args,w){case No:c.push(new fc(p[0],p[1]));break;case us:c.push(new fc(p[0],p[1]));break;case Nr:for(r=p[2],F=p[3],i=p[0],n=p[1],c.length>0?(J=c[c.length-1],Q=J.x,s=J.y):(J=this.actions[m-1].args,Q=J[J.length-2],s=J[J.length-1]),T=1;j>=T;T++)I=T/j,Y=cs.b2(I,Q,i,r),_=cs.b2(I,s,n,F),c.push(new fc(Y,_));break;case Dk:for(r=p[4],F=p[5],i=p[0],n=p[1],t=p[2],q=p[3],c.length>0?(J=c[c.length-1],Q=J.x,s=J.y):(J=this.actions[m-1].args,Q=J[J.length-2],s=J[J.length-1]),T=1;j>=T;T++)I=T/j,Y=cs.b3(I,Q,i,t,r),_=cs.b3(I,s,n,q,F),c.push(new fc(Y,_));break;case Ur:var O,C=p[0],e=p[1],S=p[2],V=p[3],G=p[4],l=!!p[5],Z=G-V,y=2*j;for(T=1;y>=T;T++)I=T/y,l||(I=1-I),O=V+I*Z,Y=C+S*d(O),_=e+S*a(O),c.push(new fc(Y,_));break;case dj:var O,C=p[0],e=p[1],E=p[2],g=p[3],V=p[4],G=p[5],l=!!p[6],Z=G-V,y=2*j;for(T=1;y>=T;T++)I=T/y,l||(I=1-I),O=V+I*Z,Y=C+E*d(O),_=e+g*a(O),c.push(new fc(Y,_))}var u,P,U=D["shape3d.point.epsilon"],M=!1;for(H=c.length,m=0,H=c.length;H>m;m++)u=c[m],P=m===H-1?c[0]:c[m+1],u&&P&&$(u.x-P.x)<U&&$(u.y-P.y)<U&&(M=!0,c[m]=null);if(M){var k=[];for(m=0;H>m;m++)c[m]&&k.push(c[m]);c=k}return v&&c.push(c[0]),c},ar.toShapes=function(O,g){function u(x){var B,o,W,I,L,v=[],h=new Jj;for(B=0,o=x.length;o>B;B++)W=x[B],L=W.args,I=W.action,I==No&&0!=h.actions.length&&(v.push(h),h=new Jj),h[I].apply(h,L);return 0!=h.actions.length&&v.push(h),v}function M(M){for(var Z=[],N=0,L=M.length;L>N;N++){var n=M[N],K=new am;K.actions=n.actions,K.curves=n.curves,Z.push(K)}return Z}function G(k,w){for(var B=1e-10,U=w.length,o=!1,e=U-1,x=0;U>x;e=x++){var z=w[e],E=w[x],u=E.x-z.x,d=E.y-z.y;if($(d)>B){if(0>d&&(z=w[x],u=-u,E=w[e],d=-d),k.y<z.y||k.y>E.y)continue;if(k.y==z.y){if(k.x==z.x)return!0}else{var v=d*(k.x-z.x)-u*(k.y-z.y);if(0==v)return!0;if(0>v)continue;o=!o}}else{if(k.y!=z.y)continue;if(E.x<=k.x&&k.x<=z.x||z.x<=k.x&&k.x<=E.x)return!0}}return o}var _=u(this.actions);if(0==_.length)return[];if(g===!0)return M(_);var A,d,F,r=[];if(1==_.length)return d=_[0],F=new am,F.actions=d.actions,F.curves=d.curves,r.push(F),r;var i=!cs.isClockWise(_[0].getPoints());i=O?!i:i;var o,v=[],U=[],s=[],w=0;U[w]=B,s[w]=[];var p,l;for(p=0,l=_.length;l>p;p++)d=_[p],o=d.getPoints(),A=cs.isClockWise(o),A=O?!A:A,A?(!i&&U[w]&&w++,U[w]={s:new am,p:o},U[w].s.actions=d.actions,U[w].s.curves=d.curves,i&&w++,s[w]=[]):s[w].push({h:d,p:o[0]});if(!U[0])return M(_);if(U.length>1){for(var a=!1,e=[],T=0,Q=U.length;Q>T;T++)v[T]=[];for(var T=0,Q=U.length;Q>T;T++){U[T];for(var I=s[T],C=0;C<I.length;C++){for(var f=I[C],L=!0,t=0;t<U.length;t++)G(f.p,U[t].p)&&(T!=t&&e.push({froms:T,tos:t,hole:C}),L?(L=!1,v[t].push(f)):a=!0);L&&v[T].push(f)}}e.length>0&&(a||(s=v))}var q,c,b;for(p=0,l=U.length;l>p;p++)for(F=U[p].s,r.push(F),q=s[p],c=0,b=q.length;b>c;c++)F.holes.push(q[c].h);return r};var am=function(){Jj.apply(this,arguments),this.holes=[]},eb=am.prototype=fo(ar);eb.getPointsHoles=function(f){var D,A=this.holes.length,O=[];for(D=0;A>D;D++)O[D]=this.holes[D].getTransformedPoints(f);return O},eb.extractAllPoints=function(p){return{shape:this.getTransformedPoints(p),holes:this.getPointsHoles(p)}},eb.extractPoints=function(v){return this.extractAllPoints(v)};var cs={triangulateShape:function(x,F){function M(z,Y,P){return z.x!=Y.x?z.x<Y.x?z.x<=P.x&&P.x<=Y.x:Y.x<=P.x&&P.x<=z.x:z.y<Y.y?z.y<=P.y&&P.y<=Y.y:Y.y<=P.y&&P.y<=z.y}function D(I,X,r,v,m){var O=1e-10,C=X.x-I.x,Q=X.y-I.y,n=v.x-r.x,V=v.y-r.y,J=I.x-r.x,j=I.y-r.y,U=Q*n-C*V,w=Q*J-C*j;if($(U)>O){var i;if(U>0){if(0>w||w>U)return[];if(i=V*J-n*j,0>i||i>U)return[]}else{if(w>0||U>w)return[];if(i=V*J-n*j,i>0||U>i)return[]}if(0==i)return!m||0!=w&&w!=U?[I]:[];if(i==U)return!m||0!=w&&w!=U?[X]:[];if(0==w)return[r];if(w==U)return[v];var l=i/U;return[{x:I.x+l*C,y:I.y+l*Q}]}if(0!=w||V*J!=n*j)return[];var R=0==C&&0==Q,T=0==n&&0==V;if(R&&T)return I.x!=r.x||I.y!=r.y?[]:[I];if(R)return M(r,v,I)?[I]:[];if(T)return M(I,X,r)?[r]:[];var s,L,h,N,d,g,B,S;return 0!=C?(I.x<X.x?(s=I,h=I.x,L=X,N=X.x):(s=X,h=X.x,L=I,N=I.x),r.x<v.x?(d=r,B=r.x,g=v,S=v.x):(d=v,B=v.x,g=r,S=r.x)):(I.y<X.y?(s=I,h=I.y,L=X,N=X.y):(s=X,h=X.y,L=I,N=I.y),r.y<v.y?(d=r,B=r.y,g=v,S=v.y):(d=v,B=v.y,g=r,S=r.y)),B>=h?B>N?[]:N==B?m?[]:[d]:S>=N?[d,L]:[d,g]:h>S?[]:h==S?m?[]:[s]:S>=N?[s,L]:[s,g]}function V(_,g,l,k){var n=1e-10,r=g.x-_.x,L=g.y-_.y,O=l.x-_.x,m=l.y-_.y,c=k.x-_.x,v=k.y-_.y,S=r*m-L*O,Y=r*v-L*c;if($(S)>n){var z=c*m-v*O;return S>0?Y>=0&&z>=0:Y>=0||z>=0}return Y>0}function i(d,g){function z(s,I){var z=T.length-1,r=s-1;0>r&&(r=z);var J=s+1;J>z&&(J=0);var Z=V(T[s],T[r],T[J],Y[I]);if(!Z)return!1;var l=Y.length-1,G=I-1;0>G&&(G=l);var g=I+1;return g>l&&(g=0),Z=V(Y[I],Y[G],Y[g],T[s]),Z?!0:!1}function a(b,I){var j,M,W;for(j=0;j<T.length;j++)if(M=j+1,M%=T.length,W=D(b,I,T[j],T[M],!0),W.length>0)return!0;return!1}function X(r,T){var l,q,z,S,J;for(l=0;l<G.length;l++)for(q=g[G[l]],z=0;z<q.length;z++)if(S=z+1,S%=q.length,J=D(r,T,q[z],q[S],!0),J.length>0)return!0;return!1}for(var Y,K,U,Q,v,p,q,s,r,W,m,T=d.concat(),G=[],I=[],n=0,H=g.length;H>n;n++)G.push(n);for(var R=0,$=2*G.length;G.length>0&&($--,!(0>$));)for(U=R;U<T.length;U++){Q=T[U],K=-1;for(var n=0;n<G.length;n++)if(p=G[n],q=Q.x+":"+Q.y+":"+p,I[q]===B){Y=g[p];for(var u=0;u<Y.length;u++)if(v=Y[u],z(U,u)&&!a(Q,v)&&!X(Q,v)){K=u,G.splice(n,1),s=T.slice(0,U+1),r=T.slice(U),W=Y.slice(K),m=Y.slice(0,K+1),T=s.concat(W).concat(m).concat(r),R=U;break}if(K>=0)break;I[q]=!0}if(K>=0)break}return T}for(var m,n,u,q,r,h,J={},W=x.concat(),k=0,e=F.length;e>k;k++)Array.prototype.push.apply(W,F[k]);for(m=0,n=W.length;n>m;m++)r=W[m].x+":"+W[m].y,J[r]!==B,J[r]=m;var I=i(x,F),d=Bj.Triangulate(I,!1);for(m=0,n=d.length;n>m;m++)for(q=d[m],u=0;3>u;u++)r=q[u].x+":"+q[u].y,h=J[r],h!==B&&(q[u]=h);return d.concat()},isClockWise:function(h){return Bj.Triangulate.area(h)<0},b2p0:function(X,M){var s=1-X;return s*s*M},b2p1:function(g,A){return 2*(1-g)*g*A},b2p2:function(C,w){return C*C*w},b2:function(y,J,$,R){return this.b2p0(y,J)+this.b2p1(y,$)+this.b2p2(y,R)},b3p0:function(R,Y){var F=1-R;return F*F*F*Y},b3p1:function($,C){var F=1-$;return 3*F*F*$*C},b3p2:function(Z,X){var M=1-Z;return 3*M*Z*Z*X},b3p3:function(k,w){return k*k*k*w},b3:function(T,g,_,i,S){return this.b3p0(T,g)+this.b3p1(T,_)+this.b3p2(T,i)+this.b3p3(T,S)}},Bj={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var M=w.keys(this.faces);return M.length?M[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(s){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(z){var i=z.familyName.toLowerCase(),b=this;return b.faces[i]=b.faces[i]||{},b.faces[i][z.cssFontWeight]=b.faces[i][z.cssFontWeight]||{},b.faces[i][z.cssFontWeight][z.cssFontStyle]=z,z},drawText:function(A){var u,w=this.getFace(),J=this.size/w.resolution,N=0,M=String(A).split(""),o=M.length,Z=[];for(u=0;o>u;u++){var P=new Jj,d=this.extractGlyphPoints(M[u],w,J,N,P);d&&(N+=d.offset*this.spacing,Z.push(d.path))}var C=N/2;return{paths:Z,offset:C}},extractGlyphPoints:function(x,j,p,N,c){var A,i,z,$,s,F,o,u,J,T,S,l,D,K,_,m,q,n,H,k=[],P=j.glyphs[x]||j.glyphs["?"];if(P){if(P.o)for($=P._cachedOutline||(P._cachedOutline=P.o.split(" ")),F=$.length,o=p,u=p,A=0;F>A;)switch(s=$[A++]){case"m":J=$[A++]*o+N,T=$[A++]*u,c.moveTo(J,T);break;case"l":J=$[A++]*o+N,T=$[A++]*u,c.lineTo(J,T);break;case"q":if(S=$[A++]*o+N,l=$[A++]*u,_=$[A++]*o+N,m=$[A++]*u,c.quadraticCurveTo(_,m,S,l),H=k[k.length-1])for(D=H.x,K=H.y,i=1,z=this.divisions;z>=i;i++){var y=i/z;cs.b2(y,D,_,S),cs.b2(y,K,m,l)}break;case"b":if(S=$[A++]*o+N,l=$[A++]*u,_=$[A++]*o+N,m=$[A++]*u,q=$[A++]*o+N,n=$[A++]*u,c.bezierCurveTo(_,m,q,n,S,l),H=k[k.length-1])for(D=H.x,K=H.y,i=1,z=this.divisions;z>=i;i++){var y=i/z;cs.b3(y,D,_,q,S),cs.b3(y,K,m,n,l)}}return{offset:P.ha*p,path:c}}}};Bj.generateShapes=function(y,o){o=o||{};var x=o.font;if(x===B&&(x=Bj.getDefaultFont(),!x))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var G=o.size!==B?o.size:1,r=o.curveSegments!==B?o.curveSegments:4,A=o.spacing!==B?o.spacing:1,P=o.weight!==B?o.weight:"normal",V=o.style!==B?o.style:"normal";Bj.size=G,Bj.divisions=r,Bj.face=x,Bj.weight=P,Bj.style=V,Bj.spacing=A;for(var n=Bj.drawText(y),e=n.paths,X=[],S=0,f=e.length;f>S;S++)Array.prototype.push.apply(X,e[S].toShapes());return X},function(y){var x=1e-10,g=function(F,X){var G=F.length;if(3>G)return null;var s,x,K,g=[],v=[],m=[];if(L(F)>0)for(x=0;G>x;x++)v[x]=x;else for(x=0;G>x;x++)v[x]=G-1-x;var f=G,U=2*f;for(x=f-1;f>2;){if(U--<=0)return X?m:g;if(s=x,s>=f&&(s=0),x=s+1,x>=f&&(x=0),K=x+1,K>=f&&(K=0),E(F,s,x,K,f,v)){var c,p,l,z,y;for(c=v[s],p=v[x],l=v[K],g.push([F[c],F[p],F[l]]),m.push([v[s],v[x],v[K]]),z=x,y=x+1;f>y;z++,y++)v[z]=v[y];f--,U=2*f}}return X?m:g},L=function(H){for(var E=H.length,O=0,I=E-1,T=0;E>T;I=T++)O+=H[I].x*H[T].y-H[T].x*H[I].y;return.5*O},E=function(w,k,W,b,Z,E){var y,r,s,q,j,n,K,p,g;if(r=w[E[k]].x,s=w[E[k]].y,q=w[E[W]].x,j=w[E[W]].y,n=w[E[b]].x,K=w[E[b]].y,x>(q-r)*(K-s)-(j-s)*(n-r))return!1;var G,D,u,$,V,i,H,t,F,T,J,A,f,o,O;for(G=n-q,D=K-j,u=r-n,$=s-K,V=q-r,i=j-s,y=0;Z>y;y++)if(p=w[E[y]].x,g=w[E[y]].y,!(p===r&&g===s||p===q&&g===j||p===n&&g===K)&&(H=p-r,t=g-s,F=p-q,T=g-j,J=p-n,A=g-K,O=G*T-D*F,f=V*t-i*H,o=u*A-$*J,O>=-x&&o>=-x&&f>=-x))return!1;return!0};return y.Triangulate=g,y.Triangulate.area=L,y}(Bj),P._typeface_js={faces:Bj.faces,loadFace:Bj.loadFace};var Vi=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Bd=Vi.prototype={constructor:Vi,computeFaceNormals:function(){for(var $=new Qb,H=new Qb,K=0,p=this.faces.length;p>K;K++){var T=this.faces[K],d=this.vertices[T.a],l=this.vertices[T.b],t=this.vertices[T.c];$.subVectors(t,l),H.subVectors(d,l),$.cross(H),$.normalize(),T.normal.copy($)}},computeVertexNormals:function(o){var M,K,E,g,j,i;for(i=new Array(this.vertices.length),M=0,K=this.vertices.length;K>M;M++)i[M]=new Qb;if(o){var G,N,Z,f=new Qb,X=new Qb;for(E=0,g=this.faces.length;g>E;E++)j=this.faces[E],G=this.vertices[j.a],N=this.vertices[j.b],Z=this.vertices[j.c],f.subVectors(Z,N),X.subVectors(G,N),f.cross(X),i[j.a].add(f),i[j.b].add(f),i[j.c].add(f)}else for(E=0,g=this.faces.length;g>E;E++)j=this.faces[E],i[j.a].add(j.normal),i[j.b].add(j.normal),i[j.c].add(j.normal);for(M=0,K=this.vertices.length;K>M;M++)i[M].normalize();for(E=0,g=this.faces.length;g>E;E++)j=this.faces[E],j.vertexNormals[0]=i[j.a].clone(),j.vertexNormals[1]=i[j.b].clone(),j.vertexNormals[2]=i[j.c].clone()},mergeVertices:function(){var F,c,r,b,n,Q,C,l,I={},e=[],O=[],m=4,f=q(10,m);for(r=0,b=this.vertices.length;b>r;r++)F=this.vertices[r],c=A(F.x*f)+"_"+A(F.y*f)+"_"+A(F.z*f),I[c]===B?(I[c]=r,e.push(this.vertices[r]),O[r]=e.length-1):O[r]=O[I[c]];var U=[];for(r=0,b=this.faces.length;b>r;r++){n=this.faces[r],n.a=O[n.a],n.b=O[n.b],n.c=O[n.c],Q=[n.a,n.b,n.c];for(var T=0;3>T;T++)if(Q[T]==Q[(T+1)%3]){U.push(r);break}}for(r=U.length-1;r>=0;r--){var X=U[r];for(this.faces.splice(X,1),C=0,l=this.faceVertexUvs.length;l>C;C++)this.faceVertexUvs[C].splice(X,1)}var N=this.vertices.length-e.length;return this.vertices=e,N}},Iq=function(Q,o,B,s,z,m,b){this.aX=Q,this.aY=o,this.xRadius=B,this.yRadius=s,this.aStartAngle=z,this.aEndAngle=m,this.aClockwise=b};Iq.prototype=fo(xc),Iq.prototype.getPoint=function(c){var b,X=this.aEndAngle-this.aStartAngle;0>X&&(X+=Q),X>Q&&(X-=Q),b=this.aClockwise===!0?this.aEndAngle+(1-c)*(Q-X):this.aStartAngle+c*X;var N=this.aX+this.xRadius*d(b),W=this.aY+this.yRadius*a(b);return new fc(N,W)};var be=function(s,M){this.v1=s,this.v2=M},Vo=be.prototype=fo(xc);Vo.getPoint=function(r){var A=this.v2.clone().sub(this.v1);return A.multiplyScalar(r).add(this.v1),A},Vo.getPointAt=function(O){return this.getPoint(O)},Vo.getTangent=function(){var x=this.v2.clone().sub(this.v1);return x.normalize()};var Nf=function(y,s,l){this.v0=y,this.v1=s,this.v2=l};Nf.prototype=fo(xc),Nf.prototype.getPoint=function(f){var B,m;return B=cs.b2(f,this.v0.x,this.v1.x,this.v2.x),m=cs.b2(f,this.v0.y,this.v1.y,this.v2.y),new fc(B,m)};var ee=function(V,S,W,u){this.v0=V,this.v1=S,this.v2=W,this.v3=u};ee.prototype=fo(xc),ee.prototype.getPoint=function(H){var N,g;return N=cs.b3(H,this.v0.x,this.v1.x,this.v2.x,this.v3.x),g=cs.b3(H,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new fc(N,g)},Lm.create(function(g,a){this.v1=g,this.v2=a},function(D){var A=new Qb;return A.subVectors(this.v2,this.v1),A.multiplyScalar(D),A.add(this.v1),A});var oh=Lm.create(function(b,Y,W){this.v0=b,this.v1=Y,this.v2=W},function(h){var W,m,s;return W=cs.b2(h,this.v0.x,this.v1.x,this.v2.x),m=cs.b2(h,this.v0.y,this.v1.y,this.v2.y),s=cs.b2(h,this.v0.z,this.v1.z,this.v2.z),new Qb(W,m,s)}),to=Lm.create(function(U,X,e,d){this.v0=U,this.v1=X,this.v2=e,this.v3=d},function(p){var z,r,I;return z=cs.b3(p,this.v0.x,this.v1.x,this.v2.x,this.v3.x),r=cs.b3(p,this.v0.y,this.v1.y,this.v2.y,this.v3.y),I=cs.b3(p,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Qb(z,r,I)}),pe=function(I,q,R,O,o,b,j,x){Vi.call(this),O=O!==B?O:.5,o=o!==B?o:.5,x=x!==B?x:1,I=I||8,b=b||0,j=j||Q;var J,v,V=1,w=x/2,c=[],X=[],f=this.vertices,K=this.faces,H=this.faceVertexUvs;for(v=0;V>=v;v++){var W=[],e=[],z=v/V,i=z*(o-O)+O;for(J=0;I>=J;J++){var A=J/I,t=new Qb,L=-(A*j+b);t.z=i*a(L),t.y=-z*x+w,t.x=i*d(L),f.push(t),W.push(f.length-1),e.push(new fc(A,z))}c.push(W),X.push(e)}var F,r,P=(o-O)/x;for(J=0;I>J;J++)for(0!==O?(F=f[c[0][J]].clone(),r=f[c[0][J+1]].clone()):(F=f[c[1][J]].clone(),r=f[c[1][J+1]].clone()),F.setY(m(F.x*F.x+F.z*F.z)*P).normalize(),r.setY(m(r.x*r.x+r.z*r.z)*P).normalize(),v=0;V>v;v++){var $=c[v][J],p=c[v+1][J],Y=c[v+1][J+1],s=c[v][J+1],n=F.clone(),N=F.clone(),T=r.clone(),k=r.clone(),S=X[v][J].clone(),E=X[v+1][J].clone(),D=X[v+1][J+1].clone(),l=X[v][J+1].clone();K.push(new pc($,p,s,[n,N,k])),H[0].push([S,E,l]),K.push(new pc(p,Y,s,[N.clone(),T,k.clone()])),H[0].push([E.clone(),D,l.clone()])}if(q&&O>0)for(this.vertices.push(new Qb(0,w,0)),J=0;I>J;J++){var $=c[0][J],p=c[0][J+1],Y=this.vertices.length-1,n=new Qb(0,1,0),N=new Qb(0,1,0),T=new Qb(0,1,0),S=X[0][J].clone(),E=X[0][J+1].clone(),D=new fc(E.x,0);K.push(new pc($,p,Y,[n,N,T],null,1));var U=J/I*Q,h=d(U),_=a(U),M=(J+1)/I*Q,y=d(M),G=a(M);H[0].push([new fc(.5+.5*h,.5+.5*_),new fc(.5+.5*y,.5+.5*G),new fc(.5,.5)])}if(R&&o>0)for(this.vertices.push(new Qb(0,-w,0)),J=0;I>J;J++){var $=c[v][J+1],p=c[v][J],Y=f.length-1,n=new Qb(0,-1,0),N=new Qb(0,-1,0),T=new Qb(0,-1,0),S=X[v][J+1].clone(),E=X[v][J].clone();K.push(new pc($,p,Y,[n,N,T],null,2));var U=J/I*Q,h=d(U),_=a(U),M=(J+1)/I*Q,y=d(M),G=a(M);H[0].push([new fc(.5+.5*y,.5-.5*G),new fc(.5+.5*h,.5-.5*_),new fc(.5,.5)])}};pe.prototype=fo(Bd);var _f=function(k,E,h,z,e,u,W){Vi.call(this),W=W||.5,k=k||16,E=E||16,h=(h!==B?h:0)-S,z=z!==B?z:Q,e=e!==B?e:0,u=u!==B?u:S;var l,U,r=[],f=[],P=this.vertices,R=this.faces,t=this.faceVertexUvs;for(U=0;E>=U;U++){var X=[],y=[];for(l=0;k>=l;l++){var s=l/k,c=U/E,x=new Qb;x.x=-W*d(h+s*z)*a(e+c*u),x.y=W*d(e+c*u),x.z=W*a(h+s*z)*a(e+c*u),P.push(x),X.push(P.length-1),y.push(new fc(s,c))}r.push(X),f.push(y)}for(U=0;E>U;U++)for(l=0;k>l;l++){var H=r[U][l+1],C=r[U][l],Z=r[U+1][l],K=r[U+1][l+1],b=P[H].clone().normalize(),v=P[C].clone().normalize(),o=P[Z].clone().normalize(),I=P[K].clone().normalize(),L=f[U][l+1].clone(),A=f[U][l].clone(),p=f[U+1][l].clone(),M=f[U+1][l+1].clone();$(P[H].y)===W?(L.x=(L.x+A.x)/2,R.push(new pc(H,Z,K,[b,o,I])),t[0].push([L,p,M])):$(P[Z].y)===W?(p.x=(p.x+M.x)/2,R.push(new pc(H,C,Z,[b,v,o])),t[0].push([L,A,p])):(R.push(new pc(H,C,K,[b,v,I])),t[0].push([L,A,M]),R.push(new pc(C,Z,K,[v.clone(),o,I.clone()])),t[0].push([A.clone(),p,M.clone()]))}};_f.prototype=fo(Bd);var Sl=function(L,D,v,Z,w,E){Vi.call(this),L=L||.33,D=D||.17,Z=Z||8,v=v||6,w=w||0,E=E||Q;for(var U=new Qb,r=[],s=[],C=0;Z>=C;C++)for(var G=C/Z*Q+S,_=0;v>=_;_++){var e=_/v*E+w;U.x=L*d(e),U.z=-L*a(e);var I=new Qb,V=L+D*d(G);I.x=V*d(e),I.z=-V*a(e),I.y=D*a(G),this.vertices.push(I),r.push(new fc(_/v,1-C/Z)),s.push(I.clone().sub(U).normalize())}for(var C=1;Z>=C;C++)for(var _=1;v>=_;_++){var h=(v+1)*C+_-1,T=(v+1)*(C-1)+_-1,q=(v+1)*(C-1)+_,o=(v+1)*C+_,g=new pc(h,T,o,[s[h].clone(),s[T].clone(),s[o].clone()]);this.faces.push(g),this.faceVertexUvs[0].push([r[h].clone(),r[T].clone(),r[o].clone()]),g=new pc(T,q,o,[s[T].clone(),s[q].clone(),s[o].clone()]),this.faces.push(g),this.faceVertexUvs[0].push([r[T].clone(),r[q].clone(),r[o].clone()])}this.computeFaceNormals()};Sl.prototype=fo(Bd);var xf=function(p,n,f){return p?(Vi.call(this),p=p instanceof Array?p:[p],this.addShapeList(p,n),n.convertYZ!==!1&&um(this,f),this.computeFaceNormals(),void 0):(p=[],void 0)},$d=xf.prototype=fo(Vi.prototype);$d.addShapeList=function(k,i){for(var B=k.length,S=0;B>S;S++){var E=k[S];this.addShape(E,i)}},$d.addShape=function(k,g){function t(){if(g.bottom)for(var o=0;u>o;o++)m=i[o],G(m[2],m[1],m[0],!0);if(g.top)for(o=0;u>o;o++)m=i[o],G(m[0]+F*r,m[1]+F*r,m[2]+F*r,!1)}function c(){var b=0;for($(Z,b),b+=Z.length,S=0,x=w.length;x>S;S++)h=w[S],$(h,b),b+=h.length}function $(l,c){for(var H,u,e=l.length;--e>=0;){H=e,u=e-1,0>u&&(u=l.length-1);var p=0,d=r;for(p=0;d>p;p++){var Y=F*p,P=F*(p+1),v=c+H+Y,h=c+u+Y,Q=c+u+P,V=c+H+P;M(v,h,Q,V,l,p,d,H,u)}}}function H(c,F,L){j.vertices.push(new Qb(c,F,L))}function G(Z,U,K,y){Z+=C,U+=C,K+=C,j.faces.push(new pc(Z,U,K,null,null,y?2:1));var _=y?D.generateBottomUV(j,k,g,Z,U,K):D.generateTopUV(j,k,g,Z,U,K);j.faceVertexUvs[0].push(_)}function M(S,r,b,U,G,d,Y,s,u){S+=C,r+=C,b+=C,U+=C,j.faces.push(new pc(S,r,U)),j.faces.push(new pc(r,b,U));var w=D.generateSideWallUV(j,k,G,g,S,r,b,U,d,Y,s,u);j.faceVertexUvs[0].push([w[0],w[1],w[3]]),j.faceVertexUvs[0].push([w[1],w[2],w[3]])}var X,b,L,P,n,T=g.amount,V=g.curveSegments||jd,r=g.steps||1,d=g.extrudePath,q=!1,D=new Nb(g.repeatUVLength);d&&(X=d.getSpacedPoints(r),q=!0,b=g.frames!==B?g.frames:new oq.FrenetFrames(d,r,!1),L=new Qb,P=new Qb,n=new Qb);var h,S,x,j=this,C=this.vertices.length,s=k.extractPoints(V),f=s.shape,w=s.holes,e=!cs.isClockWise(f);if(e){for(f=f.reverse(),S=0,x=w.length;x>S;S++)h=w[S],cs.isClockWise(h)&&(w[S]=h.reverse());e=!1}var i=cs.triangulateShape(f,w),Z=f;for(S=0,x=w.length;x>S;S++)h=w[S],f=f.concat(h);for(var p,m,F=f.length,u=i.length,z=0;F>z;z++)p=f[z],q?(P.copy(b.normals[0]).multiplyScalar(p.x),L.copy(b.binormals[0]).multiplyScalar(p.y),n.copy(X[0]).add(P).add(L),H(n.x,n.y,n.z)):H(p.x,p.y,0);var U;for(U=1;r>=U;U++)for(z=0;F>z;z++)p=f[z],q?(P.copy(b.normals[U]).multiplyScalar(p.x),L.copy(b.binormals[U]).multiplyScalar(p.y),n.copy(X[U]).add(P).add(L),H(n.x,n.y,n.z)):H(p.x,p.y,T/r*U);t(),c()};var oq=function(_,f,V,G,w){function U(n,R,D){return z.vertices.push(new Qb(n,R,D))-1}Vi.call(this),f=f||64,V=V||1,G=G||8,w=w||!1;var g,$,o,E,C,A,O,l,q,T,X,v,s,K,y,R,Y,b,i,N,I=[],z=this,F=f+1,M=new Qb,m=new oq.FrenetFrames(_,f,w),p=m.tangents,S=m.normals,j=m.binormals;for(this.tangents=p,this.normals=S,this.binormals=j,q=0;F>q;q++)for(I[q]=[],E=q/(F-1),l=_.getPointAt(E),g=p[q],$=S[q],o=j[q],T=0;G>T;T++)C=T/G*Q,A=-V*d(C),O=V*a(C),M.copy(l),M.x+=A*$.x+O*o.x,M.y+=A*$.y+O*o.y,M.z+=A*$.z+O*o.z,I[q][T]=U(M.x,M.y,M.z);for(q=0;f>q;q++)for(T=0;G>T;T++)X=w?(q+1)%f:q+1,v=(T+1)%G,s=I[q][T],K=I[X][T],y=I[X][v],R=I[q][v],Y=new fc(q/f,T/G),b=new fc((q+1)/f,T/G),i=new fc((q+1)/f,(T+1)/G),N=new fc(q/f,(T+1)/G),this.faces.push(new pc(s,K,R)),this.faceVertexUvs[0].push([Y,b,N]),this.faces.push(new pc(K,y,R)),this.faceVertexUvs[0].push([b.clone(),i,N.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};oq.prototype=fo(Bd),oq.FrenetFrames=function(S,p,R){function o(){K[0]=new Qb,z[0]=new Qb,c=Number.MAX_VALUE,d=$(M[0].x),w=$(M[0].y),i=$(M[0].z),c>=d&&(c=d,D.set(1,0,0)),c>=w&&(c=w,D.set(0,1,0)),c>=i&&D.set(0,0,1),A.crossVectors(M[0],D).normalize(),K[0].crossVectors(M[0],A),z[0].crossVectors(M[0],K[0])}var J,c,d,w,i,H,g,D=new Qb,M=[],K=[],z=[],A=new Qb,Q=new Jb,E=p+1,Y=1e-4;for(this.tangents=M,this.normals=K,this.binormals=z,H=0;E>H;H++)g=H/(E-1),M[H]=S.getTangentAt(g),M[H].normalize();for(o(),H=1;E>H;H++)K[H]=K[H-1].clone(),z[H]=z[H-1].clone(),A.crossVectors(M[H-1],M[H]),A.length()>Y&&(A.normalize(),J=s(Pc(M[H-1].dot(M[H]),-1,1)),K[H].applyMatrix4(Q.makeRotationAxis(A,J))),z[H].crossVectors(M[H],K[H]);if(R)for(J=s(Pc(K[0].dot(K[E-1]),-1,1)),J/=E-1,M[0].dot(A.crossVectors(K[0],K[E-1]))>0&&(J=-J),H=1;E>H;H++)K[H].applyMatrix4(Q.makeRotationAxis(M[H],J*H)),z[H].crossVectors(M[H],K[H])};var lh=function(q,u,y,T){Vi.call(this),u=u||18,y=y||0,T=T==h?Q:T;for(var c=1/(q.length-1),l=1/u,t=0,Z=u;Z>=t;t++)for(var E=y+t*l*T,U=d(E),o=a(E),$=0,P=q.length;P>$;$++){var N=q[$],w=new Qb;w.x=U*N.x-o*N.y,w.y=o*N.x+U*N.y,w.z=N.z,this.vertices.push(w)}for(var H=q.length,t=0,Z=u;Z>t;t++)for(var $=0,P=q.length-1;P>$;$++){var X=$+H*t,n=X,z=X+H,U=X+1+H,F=X+1,i=t*l,G=$*c,k=i+l,r=G+c;this.faces.push(new pc(n,F,z)),this.faceVertexUvs[0].push([new fc(i,G),new fc(i,r),new fc(k,G)]),this.faces.push(new pc(z,F,U)),this.faceVertexUvs[0].push([new fc(k,G),new fc(i,r),new fc(k,r)])}this.mergeVertices(),um(this),this.computeFaceNormals(),this.computeVertexNormals()};lh.prototype=fo(Bd);var lk=function(o,G){G=G||{};var f=Bj.generateShapes(o,G);G.amount=G.amount!==B?G.amount:.5,G.convertYZ=!1,G.fill!==!1&&(G.bottom=!0,G.top=!0),xf.call(this,f,G)};lk.prototype=fo($d);var Qp=R.Node=function(){_l(Qp,this)},gb={X:vp,Y:jm,Z:Dn},Gq={X:0,Y:1,Z:2},Xj={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},hf="xzy",bb=function(s,f,z){if(f){var Y=f[0],i=f[1],h=f[2];"xzy"===z?(jm(s,i),Dn(s,h),vp(s,Y)):"xyz"===z?(Dn(s,h),jm(s,i),vp(s,Y)):"yxz"===z?(Dn(s,h),vp(s,Y),jm(s,i)):"yzx"===z?(vp(s,Y),Dn(s,h),jm(s,i)):"zxy"===z?(jm(s,i),vp(s,Y),Dn(s,h)):"zyx"===z?(vp(s,Y),jm(s,i),Dn(s,h)):(jm(s,i),Dn(s,h),vp(s,Y))}};Dj("Node",Dr,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:hf,_64O:0,_rotationX:0,_53O:0,_host:h,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return kh},_22Q:function(){return Js},getX:function(){return this.p().x},setX:function(H){this.p(H,this.p().y)},getY:function(){return this.p().y},setY:function(q){this.p(this.p().x,q)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(v){this.setAnchor(v,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(u){this.setAnchor(this.getAnchor().x,u)},getScaleX:function(){return this.getScale().x},setScaleX:function(I){this.setScale(I,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(D){this.setScale(this.getScale().x,D)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(T){var t=(new Lo).setFromQuaternion(T,Lo.ReverseOrder(this.getRotationMode()));return this.r3(t.x,t.y,t.z)},getQuaternion:function(){var m=new Lo,v=new Lo,J=new wh;return function($){return $||($=new wh),this.getEuler(m),m.equals(v)?$.copy(J):$.copy(J.setFromEuler(v.copy(m)))}}(),getEuler:function(D){var g=this.r3();return D||(D=new Lo),D.set(g[0],g[1],g[2],Lo.ReverseOrder(this.getRotationMode()))},setEuler:function(E){return E=E.clone().reorder(Lo.ReverseOrder(this.getRotationMode())),this.r3(E.x,E.y,E.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(l,U){$e(l,nm(h,h,this.r3(),this.getRotationMode())),this.translate3d(l[0]*U,l[1]*U,l[2]*U)},translateFront:function(H){this.translate3dBy([0,0,1],H)},translateBack:function(o){this.translate3dBy([0,0,-1],o)},translateLeft:function(Z){this.translate3dBy([-1,0,0],Z)},translateRight:function(p){this.translate3dBy([1,0,0],p)},translateTop:function(M){this.translate3dBy([0,1,0],M)},translateBottom:function(u){this.translate3dBy([0,-1,0],u)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function($,e,W){1===arguments.length&&(e=$[1],W=$[2],$=$[0]),this.p($,W),this.setElevation(e)},translate3d:function(U,$,m){1===arguments.length&&($=U[1],m=U[2],U=U[0]),this.translate(U,m),this.setElevation(this._54O+$)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(i,L,r){1===arguments.length&&(L=i[1],r=i[2],i=i[0]),this.setSize(i,r),this.setTall(L)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(h,V,T){1===arguments.length&&(V=h[1],T=h[2],h=h[0]),this.setRotationX(h),this.setRotation(-V),this.setRotationZ(T)},setRotationY:function(D){this.setRotation(-D)},getRotationY:function(){return-this._64O},lookAtDirection:function(Z,d){d=d||Lr;var G=this,n=Jf(Z);d===Lr?(G.r3([-p(Z[1]/n),-Mj(Z[2],Z[0])+xr,0]),G.setRotationMode("xzy")):d===_d?(G.r3(0,-Mj(Z[2],Z[0]),p(Z[1]/n)),G.setRotationMode("zyx")):d===Se?(G.r3(0,-Mj(Z[2],Z[0])+S,-p(Z[1]/n)),G.setRotationMode("zyx")):d===Pi?(G.r3([-p(Z[1]/n)+xr,-Mj(Z[2],Z[0])+xr,0]),G.setRotationMode("xzy")):d===sp&&(G.r3([-p(Z[1]/n)-xr,-Mj(Z[2],Z[0])+xr,0]),G.setRotationMode("xzy")),d===Sf&&(G.r3([-p(Z[1]/n)+S,-Mj(Z[2],Z[0])+xr,S]),G.setRotationMode("zxy"))},lookAt:function(H,h){return this.lookAtDirection(il(H,this.p3()),h)},lookAtX:function(){var Y=new qp,l=new qp,T=new qp,m=new Jb,j=new Jb,r=new Lo;return function(y,h){var $=Vl(this);if(m.fromArray($),T.copy(this.p3()),Y.copy(y).sub(T),!(Y.lengthSq()<1e-6)){Y.normalize(),h===Lr?l.set(0,0,1):h===Sf?l.set(0,0,-1):h===Se?l.set(-1,0,0):h===_d?l.set(1,0,0):h===Pi?l.set(0,1,0):h===sp&&l.set(0,-1,0),l.applyMatrix4(m).sub(T).normalize();var X=Math.acos(Y.dot(l));if(X){var D=Y.clone().cross(l);D.lengthSq()<1e-6&&(h===Pi||h===sp?D.set(0,0,1).applyMatrix4(m).sub(T):D.set(0,1,0).applyMatrix4(m).sub(T)),D.normalize(),r.set(this.r3(),this.getRotationMode(),!0),m.makeRotationFromEuler(r),j.makeRotationAxis(D,-X),r.setFromRotationMatrix(j.multiply(m)),this.r3([r.x,r.y,r.z])}}}}(),getHost:function(){return this._host},setHost:function(U){var n=this;if(n!==U&&n._host!==U){var M=n._host;M&&(M._removeAttach(n),M.updateLayoutAttaches()),n._host=U,n._host&&(n._host._addAttach(n),n._host.updateLayoutAttaches()),n.fp("host",M,U),n.onHostChanged(M,U)}},getAttaches:function(){return this._69O},_addAttach:function(F){var $=this;$._69O||($._69O=new bp),$._69O.add(F),$.fp("attaches",h,F)},_removeAttach:function(Y){var O=this;O._69O.remove(Y),O._69O.isEmpty()&&delete O._69O,O.fp("attaches",Y,h)},getImage:function(){if(this._pendingCheckImageJSON){var J=l.getImage(this._image);J&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Qk&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(O){var G=this,k=G._image,g=G.getWidth(),U=G.getHeight();G._image=O,G.fp("image",k,O)&&(null!=O&&(xg(O)||Ek(O)&&/\.json$/i.test(O))&&(this._pendingCheckImageJSON=!0),G.fp(wf,g,G.getWidth()),G.fp(Qd,U,G.getHeight()))},getElevation:function(){return this._54O},setElevation:function(C){var x=this;if(!x._50O){x._50O=1;var p=x._54O;x._54O=C,x.fp(_b,p,C),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(F){var M=this;if(!M._49O){M._49O=1;var U=M._64O;M._64O=F,M.fp(pi,U,F),delete M._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(P){var u=this;if(!u._51O){u._51O=1;var T=u._rotationX;u._rotationX=P,u.fp("rotationX",T,P),delete u._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(x){var D=this;if(!D._52O){D._52O=1;var X=D._53O;D._53O=x,D.fp("rotationZ",X,x),delete D._52O}},getPosition:function(){return this._position},setPosition:function(Y,f){var Q=this;if(!Q._50I){Q._50I=1;var y;if(y=2===arguments.length?{x:Y,y:f}:Y,y.x!==Q._position.x||y.y!==Q._position.y){var j=Q._position;Q._position=y,Q.fp(tq,j,y)}delete Q._50I}},translate:function(h,N){var Z=this._position;this.p(Z.x+h,Z.y+N)},getWidth:function(){var x=this;if(x._width>=0)return x._width;var P=x.getStyle("shape3d");if(P){var u=ek(P);if(u&&u.rawS3)return u.rawS3[0];if("billboard"===P||"plane"===P){var T=vo(x.getStyle("shape3d.image"));return T?sm(T,x):20}}var T=vo(x._image);return T?sm(T,x):20},setWidth:function(v){var h=this,x=h._width;h._width=v,h.fp(wf,x,v)},getHeight:function(){var E=this;if(E._height>=0)return E._height;var w=E.getStyle("shape3d");if(w){var G=ek(w);if(G&&G.rawS3)return G.rawS3[2];if("plane"===w){var P=vo(E.getStyle("shape3d.image"));return P?wq(P,E):20}if("billboard"===w)return 2}var P=vo(E._image);return P?wq(P,E):20},setHeight:function(K){var L=this,h=L._height;L._height=K,L.fp(Qd,h,K)},getTall:function(){var T=this;if(T._tall>=0)return T._tall;var c=T.getStyle("shape3d");if(c){var K=ek(c);if(K&&K.rawS3)return K.rawS3[1];if("billboard"===c){var h=vo(T.getStyle("shape3d.image"));return h?wq(h,T):20}if("plane"===c)return 2}return 20},setTall:function(I){var U=this,R=U._tall;U._tall=I,U.fp("tall",R,I)},setSize:function(k,P){var R=this;2===arguments.length?(R.setWidth(k),R.setHeight(P)):(R.setWidth(k.width),R.setHeight(k.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(c,h,G,S,q){var v=this,W=v.getAnchor(),V=v.getScale();arguments.length<=2&&(q=h,h=c.y,G=c.width,S=c.height,c=c.x);var u=q&&V.x<0?1-W.x:W.x,b=q&&V.y<0?1-W.y:W.y;v.p(c+G*u,h+S*b),q&&(G/=Math.abs(V.x),S/=Math.abs(V.y)),v.setWidth(G),v.setHeight(S)},getMatrix:function(){var G=this,p=G._64O,a=G._position,l=G.getScale();return new uk(p,a.x,a.y,l.x,l.y)},getMatrix4:function(){var A=new qp,w=new wh,J=new qp;return function(W){return this.getQuaternion(w),A.copy(this.p3()),J.copy(this.getFinalScale3d()),W||(W=new Jb),W.compose(A,w,J)}}(),getAnchorRect:function(){var O=this,j=O.getWidth(),v=O.getHeight(),$=O.getAnchor();return{x:-j*$.x,y:-v*$.y,width:j,height:v}},toLocal:function(X){return this.getMatrix().tfi(X)},toGlobal:function(s){return this.getMatrix().tf(s)},getAttachPosition:function(){var $=new uk;return function(E,Z,c,U){c=c||0,U=U||0;var B=this,a=B.getAnchor(),D=B._64O,q=B._position,_=B.getScale();return $.setFromTransform(D,q.x,q.y).tf({x:c+_.x*B.getWidth()*(E-a.x),y:U+_.y*B.getHeight()*(Z-a.y)})}}(),isInRect:function(h){h=this.toLocal(h);var b=this.getWidth(),s=this.getHeight();return h.x+=b*this.getAnchorX(),h.y+=s*this.getAnchorY(),!(h.x<0||h.y<0||h.x>b||h.y>s)},getRect:function(){var k=this,M=k.getWidth(),z=k.getHeight(),d=k.getAnchor(),J={x:-M*d.x,y:-z*d.y,width:M,height:z},o=k.getMatrix();return J=oj([o.tf(J.x,J.y),o.tf(J.x+J.width,J.y),o.tf(J.x+J.width,J.y+J.height),o.tf(J.x,J.y+J.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var d=this,S=d.getAnchor(),x=d._anchorElevation;return{x:S.x,y:x,z:S.y}},setAnchorElevation:function(q){var w=this,U=w._anchorElevation;return U!==q?(w._anchorElevation=q,w.fp("anchorElevation",U,q),!0):!1},setAnchor3d:function(m,e,a,i){var j,w=this;
"number"==typeof m?j={x:m,y:e,z:a}:(j=m.length?{x:m[0],y:m[1],z:m[2]}:m,i=e);var O=w.getDataModel();O&&O.beginTransaction();var $=w.getAnchor3d(),h=w.setAnchor(j.x,j.z);if(w.setAnchorElevation(j.y)&&(h=!0),h&&i&&!Aj){w.getAnchor3d();var T=Vl(w),Q=$e([j.x-$.x,j.y-$.y,j.z-$.z],T);w.p3(Q)}return O&&O.endTransaction(),h},getAnchor:function(){var y=this;if(y.hasOwnProperty("_anchor"))return y._anchor;var o=vo(y._image);return o&&o.anchorX!==B?{x:o.anchorX,y:o.anchorY}:y._anchor},setAnchor:function(V,n,i){var G,h=this;"number"==typeof V?G={x:V,y:n}:(G=V.length?{x:V[0],y:V[1]}:V,i=n);var I=h.getAnchor();if(I.x!==G.x||I.y!==G.y){var v=h.getDataModel();if(v&&v.beginTransaction(),h._anchor=G,h.fp("anchor",I,G),i&&!Aj){var w=h.getPosition(),W=h.getSize(),B=h.getRotation(),Q=h.getScale(),H=-W.width*(I.x-G.x)*Q.x,t=-W.height*(I.y-G.y)*Q.y,J=a(B),m=d(B);h.setPosition(w.x+m*H-J*t,w.y+J*H+m*t)}return v&&v.endTransaction(),!0}return!1},getLocalQuaternion:function(p){var e=this,$=e.getHost();if(!$)return e.getQuaternion(p);var T=$.getQuaternion(),m=e.getQuaternion();return p||(p=new wh),p.copy(T).inverse().multiply(m)},setLocalQuaternion:function(m){var I=this,C=I.getHost();if(!C)return I.setQuaternion(m);var h=C.getQuaternion();I.setQuaternion(h.clone().multiply(m))},getLocalEuler:function(){var j=new wh;return function(M){var d=this,s=d.getHost();return s?(d.getLocalQuaternion(j),M||(M=new Lo),M.setFromQuaternion(j,Lo.ReverseOrder(this.getRotationMode()))):d.getEuler(M)}}(),setLocalEuler:function(){var f=new wh;return function(q){var h=this,y=h.getHost();return y?(f.setFromEuler(q),h.setLocalQuaternion(f)):h.setEuler(q)}}(),getLocalPosition3d:function(b){var t=this;b||(b=new qp),b.copy(t.p3());var X=t.getHost();if(!X)return b;var e=X.getMatrix4();return b.applyMatrix4(e.getInverse(e))},setLocalPosition3d:function(t){var h=this,Y=h.getHost();if(!Y)return t.x!==B?h.p3(t.x,t.y,t.z):h.p3(t),void 0;var Z=Y.getMatrix4(),o=new qp(t);o.applyMatrix4(Z),h.p3(o.x,o.y,o.z)},getScale:function(){return this._scale},setScale:function(V,d){var e,a=this;e=2===arguments.length?{x:V,y:d}:V;var q=a.getScale();(q.x!==e.x||q.y!==e.y)&&(a._scale=e,a.fp("scale",q,e))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var y=this,x=y._scaleTall,z=y.getScale();return[z.x,x,z.y]},getFinalScale3d:function(){var c=this,E=c.s3(),b=c._dynamicScale3d,x=c.getScale3d();return E&&(x[0]*=E[0],x[1]*=E[1],x[2]*=E[2]),b&&(x[0]*=b[0],x[1]*=b[1],x[2]*=b[2]),x},getFinalRotation3d:function(){var i=this;return i._dynamicRotation||i.r3()},setScaleTall:function(k){var q=this,r=q._scaleTall;r!==k&&(q._scaleTall=k,q.fp("scaleTall",r,k))},setScale3d:function(L,R,d){var x,H=this;x="number"==typeof L?{x:L,y:R,z:d}:L.length?{x:L[0],y:L[1],z:L[2]}:L,H.setScaleTall(x.y),H.setScale(x.x,x.z)},getCorners:function(q,X){q==h&&(q=0),X==h&&(X=q);var j=this,J=j.getAnchor(),C=j.getWidth(),Q=j.getHeight(),s=-C*J.x-q,a=-Q*J.y-X,p=C+2*q,E=Q+2*X,v=j.getMatrix();return[v.tf(s,a),v.tf(s,a+E),v.tf(s+p,a+E),v.tf(s+p,a)]},getEditControlPoints:function(R,J,o){J==h&&(J=0),o==h&&(o=J);var n=this,y=n.getAnchor(),I=n.getWidth(),U=n.getHeight(),Q=-I*y.x-J,A=-U*y.y-o,q=I+2*J,m=U+2*o;if(R)return[{x:Q,y:A},{x:Q,y:0},{x:Q,y:A+m},{x:0,y:A+m},{x:Q+q,y:A+m},{x:Q+q,y:0},{x:Q+q,y:A},{x:0,y:A}];var z=n.getMatrix();return[z.tf(Q,A),z.tf(Q,0),z.tf(Q,A+m),z.tf(0,A+m),z.tf(Q+q,A+m),z.tf(Q+q,0),z.tf(Q+q,A),z.tf(0,A)]},rotateAt:function(_,k,E){var l=this,o=l._position,i=l._64O,x=new uk(i,o.x,o.y).tf(_,k),f=m(_*_+k*k),c=Mj(o.y-x.y,o.x-x.x)+E;l.setRotation(i+E),l.p(x.x+f*d(c),x.y+f*a(c))},onParentChanged:function(){Qp.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var S={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(u){S[u]=!0}),function(h){var s=this;if(Qp.superClass.onPropertyChanged.call(s,h),S[h.property]&&!s._layoutUpdating&&s.updateLayoutParameters(null,h.property),s._69O&&s._69O.each(function(S){S.handleHostPropertyChange(h)}),s._49I&&s._49I.each(function(O){O.fp("agentChange",!0,!1)}),Yn[h.property]&&this.updateLayoutAttaches(),"a:layout"===h.property.substring(0,8)){this.updateLayoutAttaches();var e=s._host;e&&e.updateLayoutAttaches()}}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(x){this.updateAttach(x)},onStyleChanged:function(O){Qp.superClass.onStyleChanged.apply(this,arguments),Wp[O]&&this.updateAttach()},updateLayoutAttaches:function(){var x,m,o=this;return x=vo(o.getImage()),x&&x.layoutAttach&&(m=x.layoutAttach,m&&m(o))?!0:void 0},updateAttach:function(j){var I=this;return Aj?(I.updateLayoutParameters(),void 0):(I._51I||(I._51I=1,I._71O(j),delete I._51I),void 0)},_71O:function(F){var t,m,Q,y,X,_,e=this,k=e._host,Y=F?F.property:h,K=F?F.oldValue:h,x=F?F.newValue:h;if(k instanceof Qp&&(!F||Yn[Y])){var q;if(q=vo(k.getImage()),q&&q.layoutAttach)return}if(k instanceof R.Grid){if(Y===_b)e.setElevation(e._54O+x-K);else if(!F||bi[Y]){if(t=e.s("attach.row.index"),m=e.s("attach.column.index"),Q=k.getCellRect(t,m),!Q)return;y=e.s("attach.row.span"),X=e.s("attach.column.span"),(1!==y||1!==X)&&(Q=Th(Q,k.getCellRect(t+y-1,m+X-1))),Ul(Q,e,"attach.padding",1),e.setRect(Q)}}else if(k instanceof Gf&&(_=e.s("attach.index"))>=0&&(!F||ss[Y])){var D=e.s("attach.thickness"),j=k.getScale(),Z=Math.max(j.x,j.y);D>0&&e.setHeight(k.getThickness()*D*Z);var v=e.s("attach.offset"),V=k.getPoints(),G=V.size();if(G>_){var g=k.getPointsMatrix2d(),U=V.get(_),b=G===_+1?V.get(0):V.get(_+1);U=g.apply(U),b=g.apply(b);var A=[b.x-U.x,b.y-U.y],B=Jf(A);if(B){e.s("attach.offset.relative")&&(v*=B),e.s("attach.offset.opposite")&&(v=B-v);var u={x:U.x+A[0]/B*v,y:U.y+A[1]/B*v},o=e.s("attach.gap");o&&(e.s("attach.gap.relative")&&(o*=k.getThickness()*Z),u=Zm(h,u,b,o)),e.p(u),e.setRotation(Mj(A[1],A[0]))}}}else F&&(Y===tq?e.translate(x.x-K.x,x.y-K.y):Y===_b?e.setElevation(e._54O+x-K):fs[Y]?e._11Q(k,Y,x-K):("anchor"===Y||"width"===Y||"height"===Y||"scale"===Y)&&e.layout(k))},_11Q:function(){var B=new R.Math.Euler,n=R.Math.Euler.ReverseOrder,P=new R.Math.Vector2,c=new R.Math.Vector2;return function(W,Y,S){var m=this,e=W.p3(),I=W.r3(),w=m.p3(),t=m.r3();if(Y===pi&&(Y="rotationY",S=-S),(Y===pi||"rotationY"===Y)&&0===t[0]&&0===t[2]&&0===I[0]&&0===I[2]&&0===w[1]&&0===e[1])return m.setRotation(-t[1]-S),P.set(w[0],w[2]).rotateAround(c.set(e[0],e[2]),-S),m.p(P.x,P.y),void 0;var k=Xj[W.getRotationMode()],X=k[0],l=k[1],T=k[2],J=gb[X],r=gb[l],Z=gb[T],U=yo();Y===pi+X?(Z(U,I[Gq[T]]),r(U,I[Gq[l]]),J(U,S),r(U,-I[Gq[l]]),Z(U,-I[Gq[T]])):Y===pi+l?(Z(U,I[Gq[T]]),r(U,S),Z(U,-I[Gq[T]])):Y===pi+T&&Z(U,S);var d=il(w,e);$e(d,U),m.p3(e[0]+d[0],e[1]+d[1],e[2]+d[2]);var b=m.getRotationMode();bb(U,m.r3(),b),B.setFromRotationMatrix(U,n(b)),m.r3([B.x,B.y,B.z])}}(),isHostOn:function(m){var Q=this;if(Q._host&&m&&m._69O)for(var l={},S=Q._host;S&&S!==Q&&!l[S._id];){if(S===m)return!0;l[S._id]=S,S=S._host}return!1},isLoopedHostOn:function(b){return this.isHostOn(b)&&b.isHostOn(this)},getScaledSize:function(){var V=this.getSize(),P=this.getScale();return V.width*=Math.abs(P.x),V.height*=Math.abs(P.y),V},layout:function(i){if(i=i||this.getHost()){var X=this,f=X.s("layout.h")||"center",l=X.s("layout.v")||"center";if("center"!==f||"center"!==l){var Y=new R.Math.Vector2,V=i.getPosition(),r=i.getAnchor(),S=i.getScaledSize();X.getPosition();var N,h,E,e,q,O=1,u=1;switch(X._layoutUpdating=!0,f){case"left":Y.setX(X._layoutHValue-r.x*S.width);break;case"right":Y.setX((1-r.x)*S.width-X._layoutHValue);break;case"leftright":N=S.width-X._layoutHValue[2],E=X.getRotation()-i.getRotation(),e=Math.abs(Math.sin(E)),q=Math.abs(Math.cos(E)),O+=q*N/X._layoutHValue[3],u+=e*N/X._layoutHValue[4],Y.setX(X._layoutHValue[1]+(X._layoutHValue[5]-r.x)*S.width);break;case"center":Y.setX((.5-r.x)*S.width-X._layoutHValue);break;case"scale":E=X.getRotation()-i.getRotation(),e=Math.abs(Math.sin(E)),q=Math.abs(Math.cos(E)),Y.setX((.5-r.x)*S.width-X._layoutHValue[1]*S.width/X._layoutHValue[0]),h=S.width/X._layoutHValue[2]-1,O+=q*h,u+=e*h}switch(l){case"top":Y.setY(X._layoutVValue-r.y*S.height);break;case"bottom":Y.setY((1-r.y)*S.height-X._layoutVValue);break;case"topbottom":E||(E=X.getRotation()-i.getRotation(),e=Math.abs(Math.sin(E)),q=Math.abs(Math.cos(E))),N=S.height-X._layoutVValue[2],O+=e*N/X._layoutVValue[3],u+=q*N/X._layoutVValue[4],Y.setY(X._layoutVValue[1]+(X._layoutVValue[5]-r.y)*S.height);break;case"center":Y.setY((.5-r.y)*S.height-X._layoutVValue);break;case"scale":E||(E=X.getRotation()-i.getRotation(),e=Math.abs(Math.sin(E)),q=Math.abs(Math.cos(E))),Y.setY((.5-r.y)*S.height-X._layoutVValue[1]*S.height/X._layoutVValue[0]),h=S.height/X._layoutVValue[2]-1,O+=e*h,u+=q*h}if("leftright"===f||"scale"===f||"topbottom"===l||"scale"===l){var w=this.getScale(),K=Math.abs(w.x),v=Math.abs(w.y);"leftright"===f||"scale"===f?X.setSize(X._layoutHValue[3]*O/K,X._layoutHValue[4]*u/v):X.setSize(X._layoutVValue[3]*O/K,X._layoutVValue[4]*u/v)}Y.rotateAround(null,i.getRotation()),this.setPosition(Y.x+V.x,Y.y+V.y),X._layoutUpdating=B}}},updateLayoutParameters:function(v,M){if(v=v||this.getHost()){var y=this,S=y.s("layout.h"),x=y.s("layout.v");if(S||x){var r,G,D,b,U,j,t=new R.Math.Vector2,_=v.getPosition(),s=v.getAnchor(),l=v.getScaledSize(),p=y.getPosition(),F=y.getScaledSize();switch(t.set(p.x-_.x,p.y-_.y),t.rotateAround(null,-v.getRotation()),S){case"left":y._layoutHValue=t.x+s.x*l.width;break;case"right":y._layoutHValue=-t.x+(1-s.x)*l.width;break;case"center":y._layoutHValue=-t.x+(.5-s.x)*l.width;break;case"leftright":case"scale":"scale"===S?r=-t.x+(.5-s.x)*l.width:(G=y.getAnchor(),D=y.getRotation()-v.getRotation(),b=Math.cos(D),U=Math.sin(D),j=-Math.min(-G.x*b+G.y*U,-G.x*b-(1-G.y)*U,(1-G.x)*b+G.y*U,(1-G.x)*b-(1-G.y)*U),r=t.x-(j-s.x)*l.width),"position"===M&&"object"==typeof y._layoutHValue?(y._layoutHValue[0]=l.width,y._layoutHValue[1]=r):y._layoutHValue=[l.width,r,l.width,F.width,F.height,j]}switch(x){case"top":y._layoutVValue=t.y+s.y*l.height;break;case"bottom":y._layoutVValue=-t.y+(1-s.y)*l.height;break;case"center":y._layoutVValue=-t.y+(.5-s.y)*l.height;break;case"topbottom":case"scale":"scale"===x?r=-t.y+(.5-s.y)*l.height:(D||(G=y.getAnchor(),D=y.getRotation()-v.getRotation(),b=Math.cos(D),U=Math.sin(D)),j=-Math.min(-G.x*U-G.y*b,-G.x*U+(1-G.y)*b,(1-G.x)*U-G.y*b,(1-G.x)*U+(1-G.y)*b),r=t.y-(j-s.y)*l.height),"position"===M&&"object"==typeof y._layoutVValue?(y._layoutVValue[0]=l.height,y._layoutVValue[1]=r):y._layoutVValue=[l.height,r,l.height,F.width,F.height,j]}}}},getSerializableProperties:function(){var Q=Qp.superClass.getSerializableProperties.call(this);return sq(Q,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),Q}});var Km=R.Edge=function(W,h){var R=this;_l(Km,R),R.setSource(W),R.setTarget(h)};Dj("Edge",Dr,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return Zk},_22Q:function(){return Ls},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(d){if(d===this)return!1;if(Tn(d))return!0;for(var K,_,G,i,N,g=[this],a=-1,M=0;M>a;)if(a++,K=g[a],_=K._44I)for(_=_.getArray(),i=0,N=_.length;N>i;i++)if(G=_[i],Jr(G)&&!(g.indexOf(G)>=0)){if(G===d)return!1;g.push(G),M++}return!0},setSource:function(X){var O=this;if(O._source!==X&&O.canSetSourceTarget(X)){var T=O._source;O._source=X,T&&T._16I(O),X&&X._2I(O),O._7I(),O.fp("source",T,X)}},setTarget:function(_){var p=this;if(p._target!==_&&p.canSetSourceTarget(_)){var O=p._target;p._target=_,O&&O._18I(p),_&&_._4I(p),p._7I(),p.fp("target",O,_)}},isLooped:function(){var P=this;return P._source===P._target&&Tn(P._source)&&Tn(P._target)},onPropertyChanged:function(){var M=this;M._49I&&M._49I.each(function(o){o.fp("agentChange",!0,!1)})},_7I:function(){var A,z=this,h=xq(z);z._40I!==h&&(A=this._40I,A&&A._15I(z),z._40I=h,h&&h._1I(z),z.fp("sourceAgent",A,h),Vf(A,z._41I),Vf(h,z._41I));var Q=Xp(z);z._41I!==Q&&(A=z._41I,A&&A._17I(z),z._41I=Q,Q&&Q._3I(z),z.fp("targetAgent",A,Q),Vf(A,z._40I),Vf(Q,z._40I))},_22I:function(V){this._52I=V,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var W=this;return W._52I&&W._52I.get(0)!==W&&!W.getStyle(kf)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var t=this,S=t._52I;return S&&!t.getStyle(kf)&&S.size()>1&&t===S.get(0)},toggle:function(){this.beginTransaction();var j=this._52I,W=!this.s(kf);j&&j.size()>1&&(j.each(function(t){t.s(kf,W)}),j.getSiblings().each(function(z){z!==j&&z.each(function(m){m.fp("edgeGroup",h,z)})})),this.endTransaction()},setStyle:function(c,k){(c===gr||"edge.segments"===c)&&(k=_o(k)),Km.superClass.setStyle.call(this,c,k)},onStyleChanged:function(z){Km.superClass.onStyleChanged.apply(this,arguments),Pm[z]&&Vf(this._41I,this._40I)},getSerializableProperties:function(){var h=Km.superClass.getSerializableProperties.call(this);return sq(h,{source:1,target:1}),h}});var zk=R.Group=function(){_l(zk,this)};Dj("Group",Qp,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Fb},onChildAdded:function(){zk.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){zk.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var t=this;if(!t._54I&&!Aj){var o=t.getChildrenRect();o&&(t._53I=1,t.p(Fj(t.s("group.position"),o,t.getSize())),delete t._53I)}},getChildrenRect:function(){var U,Q=this;return Q.eachChild(function(C){Tn(C)&&(U=Th(U,Q.getChildRect(C)))}),U},getChildRect:function(t){var X;return Tn(t)&&t.s(Cl)&&(hq(t)&&t.isExpanded()&&t.eachChild(function(h){X=Th(X,t.getChildRect(h))}),!X&&t.getRect&&(X=t.getRect())),X},setPosition:function(P,B){var T=this;if(!T._54I){var m;m=2===arguments.length?{x:P,y:B}:P,Aj||T._53I||(T._54I=1,Wg(T._children,m.x-T._position.x,m.y-T._position.y),delete T._54I),zk.superClass.setPosition.call(this,m)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(g){var Z=this;if(Z._57O!==g){var X=Z._57O;Z._57O=g,Z.fp("expanded",X,Z._57O),Z._fireInvalidateDeep(),Z._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(i){hq(i)?i._fireInvalidateDeep():i.iv()})},_8I:function(){zk.superClass._8I.call(this),this.eachChild(function(E){Tn(E)&&E._8I()})},onStyleChanged:function(z){zk.superClass.onStyleChanged.apply(this,arguments),"group.position"===z&&this._81I()},getSerializableProperties:function(){var T=zk.superClass.getSerializableProperties.call(this);return T.expanded=1,T}});var Ho=R.Block=function(){_l(Ho,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};Dj("Block",Qp,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return qd},_22Q:function(){return Ks},onChildAdded:function(){Ho.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Ho.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function g(G,e,o){Q.fromArray(Vl(e));var $=e.getAnchor3d();G.push((new qp).set(0-$.x,0-$.y,0-$.z).applyMatrix4(Q).applyMatrix4(o)),G.push((new qp).set(0-$.x,0-$.y,1-$.z).applyMatrix4(Q).applyMatrix4(o)),G.push((new qp).set(0-$.x,1-$.y,0-$.z).applyMatrix4(Q).applyMatrix4(o)),G.push((new qp).set(0-$.x,1-$.y,1-$.z).applyMatrix4(Q).applyMatrix4(o)),G.push((new qp).set(1-$.x,0-$.y,0-$.z).applyMatrix4(Q).applyMatrix4(o)),G.push((new qp).set(1-$.x,0-$.y,1-$.z).applyMatrix4(Q).applyMatrix4(o)),G.push((new qp).set(1-$.x,1-$.y,0-$.z).applyMatrix4(Q).applyMatrix4(o)),G.push((new qp).set(1-$.x,1-$.y,1-$.z).applyMatrix4(Q).applyMatrix4(o))}function r(h,u){var b=(new Jb).makeRotationFromEuler(this.getEuler()).setPosition((new qp).fromArray(this.p3()));b.getInverse(b),h.forEach(function(H){Tn(H)&&g(u,H,b)})}var Q=new Jb;return function(k,O){if(k instanceof Qp&&(k=[k]),!k||0===k.length)return h;var O=[];r.call(this,k,O);var t=[1/0,1/0,1/0],T=[-1/0,-1/0,-1/0];return O.forEach(function(n){t[0]=Math.min(n.x,t[0]),t[1]=Math.min(n.y,t[1]),t[2]=Math.min(n.z,t[2]),T[0]=Math.max(n.x,T[0]),T[1]=Math.max(n.y,T[1]),T[2]=Math.max(n.z,T[2])}),{min:t,max:T}}}(),updateFromChildren:function(){var F=this;if(!Aj&&!F._updatingToChildren&&F._syncSize&&0!==F.size()&&!F._freezeSyncFromChildren){var f=this._getBoundingBox(F.toChildren(Tn));if(f){F._updatingFromChildren=1;var s=(new qp).fromArray(this.getScale3d()),K=(new qp).fromArray(f.min),T=(new qp).fromArray(f.max),x=l.blockMinSize,b=new qp,j=T.clone().sub(K);0===j.x&&b.setX(.5),0===j.y&&b.setY(.5),0===j.z&&b.setZ(.5);var Y=this._width==h||-1===this._width,M=new qp(this.getAnchor3d()),r=s.clone().multiply((new qp).fromArray(this.s3())),w=j.clone();0===w.x&&w.setX(x),0===w.y&&w.setY(x),0===w.z&&w.setZ(x);var O=M.clone().multiply(r),Z=O.clone().multiplyScalar(-1).sub(K).divide(w).add(O.divide(w)).add(b);if(Y||this._anchorChanged||this._scaleChanged||!this.s("keepPosition")){Y||(M=Z);var m=M.clone().multiply(j).add(K).applyEuler(this.getEuler()).add((new qp).fromArray(this.p3()));this.p3([m.x,m.y,m.z])}else this.setAnchor3d(Z.x,Z.y,Z.z);var P=new qp(1,1,1).divide(s).multiply(j);this.s3(Math.abs(P.x),Math.abs(P.y),Math.abs(P.z)),delete F._updatingFromChildren}}},setPosition:function(P,c){var V=this;if(!V._updatingToChildren){var y;y=2===arguments.length?{x:P,y:c}:P,Aj||V._updatingFromChildren||(V._updatingToChildren=1,Wg(V._children,y.x-V._position.x,y.y-V._position.y),delete V._updatingToChildren),Ho.superClass.setPosition.call(this,y)}},setSize3d:function(){this.beginTransaction(),Ho.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(Y){var N=this;if(!N._updatingToChildren){this.beginTransaction(),Y=I(Y,l.blockMinSize);var s=N.getTall();if(Y!==s&&Ho.superClass.setTall.call(N,Y),!Aj&&!N._updatingFromChildren){N._updatingToChildren=1;var q=Y/s;N._adjustChildTallOrScale(q,"size"),delete N._updatingToChildren,N.updateFromChildren()}this.endTransaction()}},setWidth:function(k){return this.setSize(k,this.getHeight())},setHeight:function(T){return this.setSize(this.getWidth(),T)},setSize:function(L,i){var A=l.blockMinSize;L=I(L,A),i=I(i,A);var T=this;if(!T._updatingToChildren){2!==arguments.length&&(i=L.height,L=L.width),this.beginTransaction();var t=T.getWidth(),k=T.getHeight();if(L!==t&&Ho.superClass.setWidth.call(T,L),i!==k&&Ho.superClass.setHeight.call(T,i),!Aj&&!T._updatingFromChildren){T._updatingToChildren=1;var s=L/t,O=i/k;T._adjustChildScaleOrSize(s,O,"size"),delete T._updatingToChildren,T.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function(u,z,H){var n=this;if(n._syncSize){var s=n.getPosition(),S=n.getRotation();n.eachChild(function(N){if(Tn(N)){var k=N.getPosition(),U=N.getRotation(),Y=N.getWidth(),L=N.getHeight(),$=N.getScale(),c=$.x*Y,W=$.y*L;if(0!==c&&0!==W){0>u*z&&N.setRotation(-1*U);var O=new uk(U,k.x,k.y,c,W);O.translate(-s.x,-s.y),O.rotate(-S),U=Mj(O.b*Math.sign(c),O.a*Math.sign(c)),O.scale(u,z);var n,x,E,F=d(U);if(Math.abs(F)<.001?(n=a(U),x=O.b/n,E=-O.c/n):(x=O.a/F,E=O.d/F),"scale"===H)N.setScale(x/Y,E/L);else if("size"===H){var V=x/$.x,l=E/$.y;N.setScale(Jp(x)*Math.abs($.x),Jp(E)*Math.abs($.y)),N instanceof R.Shape?(N.setWidthForce(Math.max(Math.abs(V),1e-5)),N.setHeightForce(Math.max(Math.abs(l),1e-5))):N.setSize(Math.max(.01,Math.abs(V)),Math.max(.01,Math.abs(l)))}O.rotate(S),O.translate(s.x,s.y),N.setPosition(O.tx,O.ty)}}})}},_calcChangeFactor:function(l,Q,r,T){var k,s,_,w;return k=$(l),s=$(r),_=k>s?k/s:s/k,k=$(Q),s=$(T),w=k>s?k/s:s/k,I(_,w)},setElevation:function(f){var P=this;if(!P._updatingToChildren){var l=P.getElevation(),k=f-l;0!==k&&(Aj||P._updatingFromChildren||(P._updatingToChildren=1,Wg(P._children,0,k,0),delete P._updatingToChildren),Ho.superClass.setElevation.apply(P,arguments))}},setScaleTall:function(o){var y=this;if(!y._updatingToChildren){var b=y.getScaleTall();if($(o)<.01&&(o=.01*(Jp(o)||Jp(b))),Ho.superClass.setScaleTall.call(y,o),!Aj&&!y._updatingFromChildren){y._updatingToChildren=1;var X=o/b;y._adjustChildTallOrScale(X,"size"),delete y._updatingToChildren,y._scaleChanged=1,this.updateFromChildren(),delete y._scaleChanged}}},_adjustChildTallOrScale:function(i,Y){var g=this;if(g._syncSize){var R=g.getElevation();g.eachChild(function(o){if(Tn(o))if("size"===Y){var B=o.getTall();0>i&&o.setScaleTall(-1*o.getScaleTall()),o.setTall(Math.max(.01,Math.abs(B*i))),o.setElevation(R+(o.getElevation()-R)*i)}else{var r=o.getScaleTall();o.setScaleTall(r*i)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var V=Ho.superClass.setAnchor3d.apply(this,arguments);return V&&!Aj&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),V}},setAnchor:function(){var W=this;if(!W._updatingToChildren){var y=W.getAnchor(),m=Ho.superClass.setAnchor.apply(W,arguments);if(Aj||W._updatingFromChildren||!W._syncSize)return m;W._updatingToChildren=1;var s=W.getAnchor();W.getPosition();var n=W.getSize(),R=W.getScale(),e=W.getRotation(),V=-n.width*R.x*(y.x-s.x),G=-n.height*R.y*(y.y-s.y),b=a(e),L=d(e),w=L*V-b*G,u=b*V+L*G;return W.eachChild(function(r){if(Tn(r)){var d=r.getPosition();r.setPosition(d.x-w,d.y-u)}}),delete W._updatingToChildren,m}},setAnchorElevation:function(){var N=this;if(!N._updatingToChildren){var p=N.getAnchorElevation(),C=Ho.superClass.setAnchorElevation.apply(N,arguments);if(Aj||N._updatingFromChildren||!N._syncSize)return C;N._updatingToChildren=1;var U=N.getAnchorElevation(),O=N.getTall(),Y=N.getScaleTall(),j=-O*Y*(p-U);return N.eachChild(function(F){if(Tn(F)){var V=F.getElevation();F.setElevation(V-j)}}),delete N._updatingToChildren,C}},setRotation:function(i){this._updateChildrenRotation3d("rotation",i)},setRotationX:function(j){this._updateChildrenRotation3d("rotationX",j)},setRotationZ:function(k){this._updateChildrenRotation3d("rotationZ",k)},_updateChildrenRotation3d:function(k,L){var l=this;if(!l._updatingToChildren){var J=l[Mm(k)]();if(Ho.superClass[gl(k)].call(l,L),!Aj&&!l._updatingFromChildren){l._updatingToChildren=1;var G=L-J;l.eachChild(function(F){Tn(F)&&F._11Q(l,k,G)}),delete l._updatingToChildren}}},setScale:function(K,D){var j=this;if(!j._updatingToChildren){null==D&&(D=K.y,K=K.x);var I=j.getScale();if($(K)<.01&&(K=.01*(Jp(K)||Jp(I.x))),$(D)<.01&&(D=.01*(Jp(D)||Jp(I.y))),Ho.superClass.setScale.call(j,K,D),!Aj&&!j._updatingFromChildren){j._updatingToChildren=1;var U=K/I.x,t=D/I.y;j._adjustChildScaleOrSize(U,t,"size"),delete j._updatingToChildren,j._scaleChanged=1,j.updateFromChildren(),delete j._scaleChanged}}},onPropertyChanged:function(f){Ho.superClass.onPropertyChanged.call(this,f),"s:3d.visible"===f.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(g){(g.s("batch")||g.s("wf.geometry")||g.s("wf.visible"))&&g.iv(),g instanceof Ho&&g._invalidateChildrenBatch()})},getSerializableProperties:function(){var V=Ho.superClass.getSerializableProperties.call(this);return V.clickThroughEnabled=1,V.syncSize=1,V}});var ic=R.Grid=function(){_l(R.Grid,this)};Dj("Grid",Qp,{IRotatable:!1,_icon:"grid_icon",_image:h,getUIClass:function(){return nd},setRotation:function(){},getCellRect:function(P,u){var R=this,B=R.s("grid.row.count"),o=R.s("grid.column.count");if(0>=B||0>=o||0>P||P>=B||0>u||u>=o)return h;var e,E,c,W=R.getRect(),v=R.s("grid.row.percents"),b=R.s("grid.column.percents");if(Ul(W,R,"grid.border",-1),v&&v._as&&(v=v._as),b&&b._as&&(b=b._as),v&&v.length===B){for(c=0,e=0;P>e;e++)c+=W.height*v[e];W.y+=c,W.height=W.height*v[P]}else W.height=W.height/B,W.y+=W.height*P;if(b&&b.length===o){for(E=0,e=0;u>e;e++)E+=W.width*b[e];W.x+=E,W.width=W.width*b[u]}else W.width=W.width/o,W.x+=W.width*u;return Lq(W,-R.s("grid.gap")),W}});var Uo=R.Text=function(){_l(Uo,this),this.setSize(100,50),this.s("text","TEXT")};Dj("Text",Qp,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Ec},setWidth:function(Q){Q||(Q=.001),Uo.superClass.setWidth.call(this,Q)},setHeight:function(f){f||(f=.001),Uo.superClass.setHeight.call(this,f)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),vf("__text__",{width:{value:100,isSafeFunc:!0,func:function(Z){return Z?Z._width:100}},height:{value:50,isSafeFunc:!0,func:function(V){return V?V._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradient:{func:"style@text.gradient"},gradientColor:{func:"style@text.gradient.color"},gradientPack:{func:"style@text.gradient.pack"}}]});var Gf=R.Shape=function(){_l(Gf,this),this._59O=new bp};Gf.__de__=Zg,Dj("Shape",Qp,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return wd},_22Q:function(){return Ms},getLength:function(H){return tg(xk(this._59O,this._58O,H,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var G=this._58O;return G?new bp(G._as.slice(0)):G},setSegments:function(U){var s=this._58O;U=U?Nl(U)?new bp(U.slice(0)):new bp(U._as.slice(0)):null,(s&&U&&s._as.join(",")!==U._as.join(",")||s!==U)&&(this._58O=U,this.fp("segments",s,U))},getPoints:function(){return this._59O},toPoints:function(){var R=this._59O;return new bp(R._as.slice(0))},getPointsMatrix2d:function(){var F=this,$=new Np.Matrix2d,i=F.getPosition(),j=F.getScale(),a=F.getRotation();return $.translate(-i.x,-i.y).scale(j.x,j.y).rotate(a).translate(i.x,i.y),$},getPointsMatrix3d:function(){return function(){var b=this,u=new Np.Matrix4,D=u.getElements(),$=b.p3();ej(D,$),bb(D,b.getFinalRotation3d(),b.getRotationMode());var X=b.getScale3d(),Y=b._dynamicScale3d;return Y&&(X[0]*=Y[0],X[1]*=Y[1],X[2]*=Y[2]),Cg(D,X),ej(D,kd($)),u}}(),setPoints:function(E,P){var H=this,x=H._59O;E=E?Nl(E)?new bp(E.slice(0)):new bp(E._as.slice(0)):new bp;var Z,v,K,B,f,c;P&&(Z=H.getPosition(),c=new uk(H.getRotation(),0,0,H.getScale().x,H.getScale().y)),(x&&E&&x._as.join(",")!==E._as.join(",")||x!==E)&&(H._59O=E,H.fs(),H.fp("points",x,E)),P&&(v=H.getPosition(),K=v.x-Z.x,B=v.y-Z.y,f=c.tf(K,B),H.setPosition(v.x-K+f.x,v.y-B+f.y))},addPoint:function(x,g,k){var _=this.toPoints();_.add(x,g),this.setPoints(_,k)},setPoint:function(h,$,A){var j=this.toPoints();j.set(h,$),this.setPoints(j,A)},removePointAt:function(p){var B=this.toPoints();B.removeAt(p),this.setPoints(B)},setWidthForce:function(r){var S=this;if(!S._55I&&!Aj&&S.getWidth()){S._55I=1;var H=S._position.x,u=r/S.getWidth(),K=S.toPoints(),V=new bp;1!==u&&(K.each(function(Q){V.add({x:(Q.x-H)*u+H,y:Q.y,e:Q.e})}),S.setPoints(V),of(S,[u,0,0,1,H*(1-u),0]),S.fs()),delete S._55I}Gf.superClass.setWidth.call(S,r)},setWidth:function(h){return this.setWidthForce(Ji>h?Ji:h)},setHeightForce:function(Y){var M=this;if(!M._55I&&!Aj&&M.getHeight()){M._55I=1;var P=M._position.y,e=Y/M.getHeight(),w=M.toPoints(),j=new bp;1!==e&&(w.each(function(Q){j.add({x:Q.x,y:(Q.y-P)*e+P,e:Q.e})}),M.setPoints(j),of(M,[1,0,0,e,0,P*(1-e)]),M.fs()),delete M._55I}Gf.superClass.setHeight.call(M,Y)},setHeight:function(j){return this.setHeightForce(Ji>j?Ji:j)},setAnchorElevation:function($){var G=this;G._55I=!0;var x=G._updatingAnchor3d,Q=!Aj&&!x;if(Q){var c,A=$,M=G.getAnchorElevation(),v=G.getTall();c=v*(M-A),0!==c&&G.shiftPointsElevation(c)}var g=Gf.superClass.setAnchorElevation.apply(G,arguments);return x||delete G._55I,g},getShapeElevation:function(){var x=this,l=x._54O;return l-(x.getTall()||0)*(x._anchorElevation-.5)},setAnchor3d:function(M,b,O,P){var t,m=this;"number"==typeof M?t={x:M,y:b,z:O}:(t=M.length?{x:M[0],y:M[1],z:M[2]}:M,P=b),m._55I=!0,m._updatingAnchor3d=!0;var n=m.getDataModel();if(n&&n.beginTransaction(),!Aj){var u=m.getAnchor3d(),K=m.getSize(),D=m.getTall(),d=K.width*(u.x-t.x),z=K.height*(u.z-t.z),h=D*(u.y-t.y);P||m.shiftPoints(d,z,h);var V=m.p3()}var i=Gf.superClass.setAnchor3d.apply(m,arguments);if(!Aj&&P){var I=m.p3();m.shiftPoints(I[0]-V[0]+d,I[2]-V[2]+z,I[1]-V[1]+h)}return n&&n.endTransaction(),delete m._updatingAnchor3d,delete m._55I,i},setAnchor:function(N,E,C){var r=this;r._55I=!0;var w=r._updatingAnchor3d,Y=!Aj&&!w;if(Y){var A,u,p;"number"==typeof N?p={x:N,y:E}:(p=N.length?{x:N[0],y:N[1]}:N,C=E);var D=r.getAnchor(),j=r.getSize();A=j.width*(D.x-p.x),u=j.height*(D.y-p.y),C||r.shiftPoints(A,u);var G=r.getPosition()}var o=Gf.superClass.setAnchor.apply(r,arguments);if(Y){var k=r.getPosition();C&&r.shiftPoints(k.x-G.x+A,k.y-G.y+u)}return w||delete r._55I,o},shiftPoints:function(P,y,B){if(P||y||B){var f=this,L=f.getElevation()||0,r=f.toPoints(),C=new bp;r.each(function(A){var E=A.e;B&&(E=(E==h?L:E)+B),C.add({x:A.x+P,y:A.y+y,e:E})}),f.setPoints(C),f.fs()}},shiftPointsElevation:function(K){return this.shiftPoints(0,0,K)},setPosition:function(Q,T){var u,Z=this;if(!Z._28Q){if(Z._28Q=1,!Z._55I&&!Aj){u=2===arguments.length?{x:Q,y:T}:Q;var v=u.x-Z._position.x,I=u.y-Z._position.y;if(0===v&&0===I)return delete Z._28Q,void 0;Z._55I=1,Z.shiftPoints(v,I),of(Z,[1,0,0,1,v,I]),delete Z._55I}Gf.superClass.setPosition.apply(Z,arguments),delete Z._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var z=this;if(2!==z._59O.size())return!1;var s=z._58O;return s?2===s.size()&&1===s.get(0)&&2===s.get(1)?!0:!1:!0},fireShapeChange:function(){var o=this;if(!o._55I&&!Aj){var C=oj(o._59O);C&&(o._55I=1,o.setRect(C),delete o._55I)}o.fp(Cq,!1,!0)},getSerializableProperties:function(){var c=Gf.superClass.getSerializableProperties.call(this);return c.segments=1,c.points=1,c.thickness=1,c.closePath=1,c}});var Gc=R.Points=function(){_l(Gc,this),this.s("points.uv.scale",[1,1])};Dj("Points",Qp,{_22Q:function(){return Ps},getPoints:function(){return this.points},setPoints:function(B){this.points=B,this._pointsDirty=!0,this.fp("points",h,this.points)},setPoint:function(F,e){this.points||(this.points=[]),this.points[3*F]=e[0],this.points[3*F+1]=e[1],this.points[3*F+2]=e[2],this._pointsDirty=!0,this.fp("points",h,this.points)},setPointsColor:function(i){this.colors=i,this._colorsDirty=!0,this.fp("colors",h,this.colors)},setPointColor:function(J,M){this.colors||(this.colors=[]),M?(M=vg(M),this.colors[3*J]=M[0],this.colors[3*J+1]=M[1],this.colors[3*J+2]=M[2]):(this.colors[3*J]=B,this.colors[3*J+1]=B,this.colors[3*J+2]=B),this._colorsDirty=!0,this.fp("colors",h,this.colors)},setPointsSize:function(z){this.sizes=z,this._sizesDirty=!0,this.fp("sizes",h,this.sizes)},setPointSize:function(T,L){this.sizes||(this.sizes=[]),this.sizes[T]=L?L:B,this._sizesDirty=!0,this.fp("sizes",h,this.sizes)},setPointsUVOffset:function(T){this.offsets=T,this._offsetsDirty=!0,this.fp("offsets",h,this.offsets)},setPointUVOffset:function(E,u,d){this.offsets||(this.offsets=[]);var n;"object"==typeof u?(n=u[0],d=u[1]):n=u,this.offsets[2*E+0]=n,this.offsets[2*E+1]=d,this._offsetsDirty=!0,this.fp("offsets",h,this.offsets)},getPointInfo:function(Y){var e=3*Y,_=this.points;if(!_||_[e]===B||_[e+1]===B||_[e+2]===B)return null;var Z=[_[e],_[e+1],_[e+2]],R=this.mat||Vl(this),f=[Z[0],Z[1],Z[2]];$e(f,R);var m=this.colors;return{size:this.sizes&&this.size[Y]||this.s("points.size"),color:m&&m[e]?[m[e],m[e+1],m[e+2]]:this.s("points.color"),local:Z,world:f}},getSerializableProperties:function(){var W=Gc.superClass.getSerializableProperties.call(this);return W.points=1,W.colors=1,W.sizes=1,W}});var tn=R.Polyline=function(){_l(tn,this),this.s({"shape.background":null,"shape.border.width":2})};Dj("Polyline",Gf,{_icon:"polyline_icon",_22Q:function(){return Qs
},getUIClass:function(){return Zn},setClosePath:function(){},setTall:function(n){var t=this,w=t.getDataModel();if(w&&w.beginTransaction(),!t._55I&&!t._24Q&&!Aj&&t.getTall()){t._24Q=1;var k=t._54O,j=n/t.getTall();if(1!==j){var U=t.toPoints(),A=new bp;U.each(function(I){A.add({x:I.x,y:I.y,e:I.e==h?I.e:(I.e-k)*j+k})}),t.setPoints(A),t.fs()}delete t._24Q}tn.superClass.setTall.call(t,n),w&&w.endTransaction()},setElevation:function(m){var F=this,B=F.getDataModel();if(B&&B.beginTransaction(),!F._55I&&!F._24Q&&!Aj){F._24Q=1;var N=m-F._54O;0!==N&&F.shiftPointsElevation(N),delete F._24Q}tn.superClass.setElevation.apply(F,arguments),B&&B.endTransaction()},fireShapeChange:function(){var T=this,l=T._59O;if(!T._55I&&!T._24Q&&!Aj){var P=l.size();if(P){var A=1,W=l.get(0),L=T._54O;W.e==h&&(W.e=L);for(var f=W.e,F=0;P>A;A++){W=l.get(A),W.e==h&&(W.e=L);var K=v(f,W.e),V=I(f+F,W.e);f=K,F=V-K}T._24Q=1,T.setTall(F),T.setElevation(f+F*T._anchorElevation),delete T._24Q}}tn.superClass.fireShapeChange.apply(T,arguments)}});var ns=R.SubGraph=function(){_l(ns,this)};Dj("SubGraph",Qp,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){ns.superClass._8I.call(this),this.eachChild(function(X){Tn(X)&&X._8I()})}}),l.loadingRefGraph=0;var Qk=R.RefGraph=function(){_l(Qk,this)};Dj("RefGraph",Ho,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(A){var I=this._ref;this._ref=A,this.fp("ref",I,A),this.updateRef()},_21I:function(){Qk.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var Z=this;if(l.loadingRefGraph++,Z.clearChildrenFromDataModel(),l.loadingRefGraph--,Z._ref&&Z._dataModel){Z._xhrLoadHandler&&(Z._xhrLoadHandler.cancel=!0);var N=Aj,g=Z._xhrLoadHandler=function(r){if(r&&Z._dataModel){l.loadingRefGraph++;var G=Z._pendingUpdateInfo={needToRestore:N};N&&(G.p3=Z.p3(),G.s3=Z.s3(),G.r3=Z.r3(),G.anchor3d=Z.getAnchor3d(),G.scale3d=Z.getScale3d()),Z.r3(0,0,0),Z.setScale3d(1,1,1),Z.setAnchor3d(.5,.5,.5),Z.p3(0,0,0);var s=l.parse(r),D=Z._dataModel.deserialize(s,Z,{justDatas:!0});D.each(function(I){I._refGraph=Z}),Z.checkPendingUpdateInfo(),l.loadingRefGraph--,l.handleRefGraphLoaded(Z,D,s)}};g.xhrLoadCalled=!1,l.load(Z._ref,function(G){g.cancel||(g.xhrLoadCalled?g(G):Qe(function(){g(G)}))}),g.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var Z=this,C=Z._pendingUpdateInfo;if(!C)return Z.onPendingUpdated&&(l.loadingRefGraph++,Z.onPendingUpdated(),l.loadingRefGraph--),void 0;var i=!0;this.eachChild(function(q){(q._pendingCheckImageJSON||q._pendingUpdateInfo)&&(i=!1)}),i&&(l.loadingRefGraph++,Z._pendingUpdateInfo=null,Z.updateFromChildren(),C.needToRestore&&(Z.setAnchor3d(C.anchor3d),Z.setScale3d(C.scale3d),Z.r3(C.r3),Z.p3(C.p3)),this.getParent()instanceof Qk&&this.getParent().checkPendingUpdateInfo(),Z.onPendingUpdated&&Z.onPendingUpdated(),l.loadingRefGraph--)},getSerializableProperties:function(){var n=Qk.superClass.getSerializableProperties.call(this);return n.ref=1,n}}),R.EdgeGroup=function(R,A){this._70O=R,this._siblings=A;for(var g,k,U=0,b=R.size(),K=D[kf];b>U;U++)if(g=R.get(U).getStyle(kf,!1),g!=h){K=g;break}K==h&&(K=!0);var Z=l.edgeGroupAgentFunc;for(Z&&(k=Z(R),k&&k!==R.get(0)&&(R.remove(k),R.add(k,0))),U=0;b>U;U++)R.get(U).s(kf,K)},Dj("EdgeGroup",w,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(l){return this._70O.get(l)},indexOf:function(G){return this._70O.indexOf(G)},each:function(H,c){this._70O.each(H,c)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(t,r){this._siblings.each(function(A){A._70O.each(t,r)})}});var Mn=function(s,t,M){var q=hh[s]={type:s,action:t};if(M)for(var z in M)q[z]=M[z]};sq(l,{setConnectAction:Mn,getConnectAction:function(n,g){if(!g){if(!n)return null;g=n.getCurrentConnectActionType()}return hh[g]},doConnectAction:function(d,r,O,M){M=M||d.getCurrentConnectActionType();var Y=hh[M];if(!Y)return!1;var V=Y.action;return V?(r instanceof Sg.Group?d.sm().getSelection().each(function(I){V.call(null,d,I,O)}):V.call(null,d,r,O),!0):!1},doDeleteConnectionAction:function(K,s,V){V=V||K.getCurrentConnectActionType();var X=hh[V];if(!X||!X.delete)return!1;var h=X.delete.action;return h?(s instanceof Sg.Group?K.sm().getSelection().each(function(v){h.call(null,K,v)}):h.call(null,K,s),!0):!1}});var gk=R.JSONSerializer=function(N,B){this.dm=this._dataModel=N,this._hierarchical=l.forceHierarchicalSerialization?!0:B==h?N.isHierarchicalRendering():B};Dj("JSONSerializer",w,{ms_ac:["hierarchical"],serialize:function(E){return l.stringify(this.toJSON(),E)},toJSON:function(){var D=this,t=D.dm,X=t.getRoots(),k=D.json={v:l.getVersion(),p:{},a:{},d:[]},u=t.getSerializableAttrs();t.getInit()&&(k.init=t.getInit()),t.getName()&&(k.p.name=t.getName()),t.getBackground()&&(k.p.background=t.getBackground()),t.getLayers()&&(k.p.layers=t.getLayers()),t.getEnvmap()&&(k.p.envmap=t.getEnvmap()),t.isCubicEnvmap()&&(k.p.cubicEnvmap=t.isCubicEnvmap()),k.p.autoAdjustIndex=t.isAutoAdjustIndex(),k.p.hierarchicalRendering=t.isHierarchicalRendering();for(var E in u){var O=t.a(E);O!==B&&D[mf](E,O,k.a)}return Gi(k.a)&&delete k.a,D._hierarchical?X.each(D.serializeData,this):t.each(function(r){D.serializeData(r)}),t.fireSerializeEvent({type:"serialize",json:k}),t.getPostProcessingData()&&(k.p.postProcessingData=t.getPostProcessingData()),k},isSerializable:function(){return!0},getProperties:function(R){return R.getSerializableProperties()},getStyles:function(u){return u.getSerializableStyles()},getAttrs:function(N){return N.getSerializableAttrs()},serializeData:function(_){var w=this;if(w.isSerializable(_)&&!_._refGraph){var S,T,i,u,W=zq(_.getClassName())||_.getClass(),d=new W,F={c:_.getClassName(),i:_.getId(),p:{},s:{},a:{}};w.json.d.push(F),S=w.getProperties(_);for(T in S)if(/^_/.test(T)){if(i=_[T],!("_width"!==T&&"_height"!==T||i!=h&&-1!==i)){var B;((_.s("layout.h")||_.s("layout.v"))&&_.getHost()||_ instanceof R.Node&&(B=_.getParent())&&B instanceof R.Block||_.s("fullscreen"))&&(i=_[T]="_width"===T?_.getWidth():_.getHeight())}i!==d[T]&&w[mf](T.substr(1),i,F.p)}else u=Mm(T),_[u]&&(i=_[u](),i!==d[u]()&&w[mf](T,i,F.p));S=w.getStyles(_);for(T in S)i=_.s(T),i!==d.s(T)&&w[mf](T,i,F.s);S=w.getAttrs(_);for(T in S)i=_.a(T),i!==d.a(T)&&w[mf](T,i,F.a);Gi(F.p)&&delete F.p,Gi(F.s)&&delete F.s,Gi(F.a)&&delete F.a}w._hierarchical&&_.getChildren().each(w.serializeData,w)},serializeValue:function(i,g,I){so(g)?g={__a:g._as}:g instanceof Dr?g={__i:g.getId()}:g instanceof Ge&&(g={__dm:g.serialize(0)}),I[i]=g},deserialize:function(w,o,x){var G=this;return Ek(w)&&/.json$/.test(w)?(l.xhrLoad(w,function($){G.deserializeImpl($,o,x)}),void 0):G.deserializeImpl(w,o,x)},deserializeImpl:function(k,D,i){var L=this,Z=L.dm;Z.setDeserializing(!0),i=He(i)?{setId:i}:bo(i)?{finishFunc:i}:i||{},k=L.json=Ek(k)?l.parse(k):k,!i.justDatas&&k.a&&k.a.onPreDeserialize&&!i.disableOnPreDeserialize&&k.a.onPreDeserialize(k,Z,i.view),Z.beginTransaction(),Aj++,L._82I={};var V=new bp,A=new bp,H=0,w=k.d.length;if(i.justDatas||(!i.disableInit&&bo(k.init)&&k.init(Z),Z.setInit(k.init)),!i.justDatas){for(var b in k.a)Z.a(b,L[fk](k.a[b]));for(var F in k.p)Z[gl(F)](k.p[F])}for(;w>H;H++){var U=k.d[H],z=zq(U.c),N=new z,s=U.i;i.setId&&s!=h&&(N._id=s),L._82I[s]=N,V.add(N),A.add(U)}for(H=0;w>H;H++)L.deserializeData(V.get(H),A.get(H));return V.each(function(J){D&&!J.getParent()&&J.setParent(D),Z.add(J)}),i.__innerHandler__&&i.__innerHandler__(k,Z,i.view,V),Z.fireSerializeEvent({type:"deserialize",json:k}),Aj--,Z.endTransaction(),!i.justDatas&&k.a&&k.a.onPostDeserialize&&!i.disableOnPostDeserialize&&k.a.onPostDeserialize(k,Z,i.view,V),i.finishFunc&&i.finishFunc(k,Z,i.view,V),Z.setDeserializing(!1),V},deserializeData:function(c,B){for(var f in B.p)c[gl(f)](this[fk](B.p[f]));for(f in B.s)c.s(f,this[fk](B.s[f]));for(f in B.a)c.a(f,this[fk](B.a[f]))},deserializeValue:function(f){if(xg(f)){var a=f.__i;if(a!=h)return this._82I[a];if(a=f.__dm,a!=h){var P=new R.DataModel;return P.deserialize(a),P}if(a=f.__a,Nl(a))return new bp(a)}return f}}),sq(Ge,{serialize:function(F,k){return new gk(this,k).serialize(F)},toJSON:function(b){return new gk(this,b).toJSON()},deserialize:function(M,S,F){return new gk(this).deserialize(M,S,F)}});var Fg=R.OverlappingBox=function(P){this.gv=P,this.boxes={}};Dj("OverlappingBox",w,{clear:function(){var R,N,Y=this.boxes;for(R in Y)N=Y[R],N.length=0},isOverlapping:function(Y,i){var O,c,H=this,t=H.boxes,k=t[Y];k?(O=k.rects,c=k.length):k=t[Y]={rects:O=[],length:c=0};var C,Q,i;for(C=0;c>C;C++)if(Q=O[C],Q.x<i.x+i.w&&Q.x+Q.w>i.x&&Q.y<i.y+i.h&&Q.h+Q.y>i.y)return!0;return O.length<=c?(O.push(i),k.length++):O[k.length++]=i,!1}}),sq(l,{fetch:function(F,d){var c="GET",I=!1,r=null,G="";d&&(c=d.method||"GET",I=d.sync,G=d.url,r=d.data||null),F.open(c,G,!I),d.responseType?F.responseType=d.responseType:d.overrideMimeType&&F.overrideMimeType&&F.overrideMimeType(d.overrideMimeType),F.send(r)},convertImageSrc:function(S,c){c&&"function"==typeof c||(c=function(){}),c(S)}});var Md=R.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Dj("Request",w,{_responseType:null,_overrideMimeType:"text/plain",send:function(G){var H=this._xhr,K=this.onload,y=this.onerror;this.getResponseType()?G.responseType=this.getResponseType():this.getOverrideMimeType()&&(G.overrideMimeType=this.getOverrideMimeType()),H.onload=K,H.onerror=y,l.fetch(H,G)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(p){this._responseType=p},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(L){this._overrideMimeType=L},getResponseText:function(){var U=this._xhr;return U.response||U.responseText}}),hi.GraphView=function(g){var x=this;x._24I={},x._34I=new bp,x._25I={},x._56I={},x._view=fl(1,x),x._canvas=Mb(x._view),x.dm(g?g:new Ge),this._coreInteractor=new ds(this),x.setEditable(!1),x.setScrollBarVisible(l.graphViewScrollBarVisible),x._initView()},af("GraphView",w,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Cm,ue,_i,cr,"resettable","editInteractor",Gb,"zoomable","pannable","rectSelectable","autoScrollZone",nk,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:l.graphViewZoomable,_resettable:l.graphViewResettable,_pannable:l.graphViewPannable,_rectSelectable:l.graphViewRectSelectable,_autoScrollZone:l.graphViewAutoScrollZone,_rectSelectBackground:l.graphViewRectSelectBackground,_rectSelectBorderColor:l.graphViewRectSelectBorderColor,_editPointSize:l.graphViewEditPointSize,_editPointBorderColor:l.graphViewEditPointBorderColor,_editPointBackground:l.graphViewEditPointBackground,_scrollBarColor:Wd,_scrollBarSize:ol,_autoHideScrollBar:Qg,_autoMakeVisible:ws,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(w){this._dataModel.setLayers(w)},setEditable:function(Z){var M=this,Y=M.__interactorMap__;if(!Y){var f=hi.XEditInteractor;Y=M.__interactorMap__={scrollBar:new Fl(M),select:new yd(M),edit:f?new f(M):new vq(M),text:new tp(M),move:new mc(M),"default":new Re(M),touch:new uc(M,{editable:!1})}}Z?(M._uieditable=!0,M.setInteractors([Y.scrollBar,Y.select,Y.edit,Y.text,Y.move,Y.default,Y.touch])):(M._uieditable=!1,M.setInteractors([Y.scrollBar,Y.select,Y.move,Y.default,Y.touch]))},getCanvas:function(){return this._canvas},_33I:function(l){var X=l.getUIClass();return X?new X(this,l):h},getDataUI:function(v){var f=this,j=f._25I[v._id];return j===B&&(j=f._33I(v),f._25I[v._id]=j),j},getNodeRect:function(e){return l.getNodeRect(this,e)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(j){var R=this.getDataUI(j);return R?(R._79o(),R._78o):null},getEdgeSourcePosition:function(F){var r=this,B=r.getDataUI(F),O=B.s,Y=B._data._40I;return Hg(r,Y,O("edge.source.position"),O("edge.source.offset.x"),O("edge.source.offset.y"),O("edge.source.anchor.x"),O("edge.source.anchor.y"))},getEdgeTargetPosition:function(l){var F=this,V=F.getDataUI(l),w=V.s,g=V._data._41I;return Hg(F,g,w("edge.target.position"),w("edge.target.offset.x"),w("edge.target.offset.y"),w("edge.target.anchor.x"),w("edge.target.anchor.y"))},invalidateAll:function(d){var T=this;if(d){for(var U in T._25I){var i=T._25I[U];i&&i.dispose()}T._25I={},T._56I={},T._24I={},T._34I.clear(),T.redraw()}else T.dm().each(function(B){T.invalidateData(B)})},invalidateSelection:function(){var j=this;j.sm().each(function(L){j.invalidateData(L)})},invalidateData:function(O){var $=this;$._24I[O._id]=O,$._21Q(O),$.iv()},_21Q:function(e){var L=this,i=L._24I;if(Jr(e)&&cd[e.s(Vd)]){var S=e.getSourceAgent();S&&S.getAgentEdges().each(function(P){i[P._id]=P}),S=e.getTargetAgent(),S&&S.getAgentEdges().each(function(V){i[V._id]=V}),L.iv()}},redraw:function(I){var B=this;B._32I||(I?B._34I.add(I):(B._32I=1,B._34I.clear()),B.iv())},each:function(e,z){var D,x,R,k=0,v=this.getLayers(),t=this._dataModel,l=t._datas._as,A=l.length;if(v){for(var y=v.length;y>k;k++)if(R=v[k],xg(R)&&(R=R.name),t.isHierarchicalRendering()){var $=function($){return $._layer===R?z?e.call(z,$):e($):void 0};if(this._dataModel.eachByHierarchical($)===!1)return}else for(var Z=0;A>Z;Z++)if(D=l[Z],D._layer===R&&(x=z?e.call(z,D):e(D),x===!1))return}else if(t.isHierarchicalRendering())this._dataModel.eachByHierarchical(e,null,z);else for(;A>k;k++)if(D=l[k],x=z?e.call(z,D):e(D),x===!1)return},reverseEach:function(y,n){var i,s,$,Y,T=this._dataModel,q=T._layers,N=T._datas._as,P=N.length;if(q){for(i=q.length-1;i>=0;i--)if(Y=q[i],xg(Y)&&(Y=Y.name),T.isHierarchicalRendering()){var V=function(t){return t._layer===Y?n?y.call(n,t):y(t):void 0};if(T.reverseEachByHierarchical(V)===!1)return}else for(var f=P-1;f>=0;f--)if(s=N[f],s._layer===Y&&($=n?y.call(n,s):y(s),$===!1))return}else if(T.isHierarchicalRendering())T.reverseEachByHierarchical(y,null,n);else for(i=P-1;i>=0;i--)if(s=N[i],$=n?y.call(n,s):y(s),$===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var C=this,B=C._84I;if(!B){var g=this.dm().a("width"),t=this.dm().a("height");g>0&&t>0?C._84I={x:0,y:0,width:g,height:t}:(C.each(function(E){C.isVisible(E)&&(B=Th(B,C.getDataUIBounds(E)))}),C._84I=B?B:zn)}return C._84I},getScrollRect:function(){return Th(this.getContentRect(),this._29I)},makeCenter:function(f,s,S){var d=this;if(!d.getWidth()||!d.getHeight())return S||Qe(d.makeCenter,d,[f,s,!0],500),void 0;d.makeVisible(f),d.validate();var L=d.getDataUIBounds(f);if(L){var Z=d.getWidth(),V=d.getHeight(),R=L.x+L.width/2,n=L.y+L.height/2,i=-R*d._zoom+Z/2,w=-n*d._zoom+V/2;d.setTranslate(i,w,s)}},fitData:function(H,F,q,T,k){var t=this;if(!t.getWidth()||!t.getHeight())return k||Qe(t.fitData,t,[H,F,q,T,!0],500),void 0;var L=function(){t.makeVisible(H),t.validate();var j=t.getDataUIBounds(H);j&&(j=lg(j),Lq(j,q==h?20:q),t.fitRect(j,F,T))};F?l.callWhenLoaded(L):L()},fitContent:function(f,O,U,A){var j=this;if(!j.getWidth()||!j.getHeight())return A||Qe(j.fitContent,j,[f,O,U,!0],500),void 0;var F=function(){j.validate();var F=lg(j.getContentRect());Lq(F,O==h?20:O),j.fitRect(F,f,U)};f?l.callWhenLoaded(F):F()},fitRect:function(C,g,G){var j=this,S=j.getWidth(),t=j.getHeight(),k=C.x+C.width/2,s=C.y+C.height/2,i=v(S/C.width,t/C.height),n=j._zoom,Z=-k*n+S/2,R=-s*n+t/2;0===i||isNaN(i)||(G&&(i=v(1,i)),g?(j._65I&&(delete j._65I.finishFunc,j._65I.stop(!0)),j._14o&&j._14o.stop(!0),j.setTranslate(Z,R,{finishFunc:function(){j.setZoom(i,g)}})):(j.setTranslate(Z,R),j.setZoom(i)))},fitSelection:function(Y,P,B){var C=this,z=C.sm(),b=null;z.size()&&(z.each(function(d){b=Th(C.getDataUIBounds(d),b)}),Y&&Lq(b,Y),C.fitRect(b,P,B))},toCanvas:function(y,I,D){I=I||this._zoom,this.validateImpl();var J=this,x=J.getContentRect();D&&Lq(x,D),x.width||(x.width=10),x.height||(x.height=10);var u=Mb(),f=x.x*I,R=x.y*I,C=Math.ceil(x.width*I),r=Math.ceil(x.height*I);qh(u,C,r,1);var H=hb(u);return y=y||this._dataModel.getBackground(),y&&Tj(H,0,0,C,r,y),Df(H,-f,-R),H.scale(I,I),J._42(H),H.restore(),u},toDataURL:function(h,b,a,r){return this.toCanvas(h,a,r).toDataURL(b||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(I,J){var N=this,Z=N.dm().getBackground();if(Z){var m=N.dm().a("width"),p=N.dm().a("height");m>0&&p>0&&Tj(I,0,0,m,p,Z)}var t=N.__htmlOrderList,C=[],y=N._forcedLayoutHTML;if(N._93db(I,J),N.each(function(S){var t=N.getDataUI(S);if(t){var u=N._56I[S._id],p=t._htmlView;if(u){var g=t._79o();if(p=t._htmlView,R.HtmlNode&&S instanceof R.HtmlNode)t._42(I);else{var l=N.getViewRect(),$=p&&p.layoutHTML;!J||kb(J,g)?($&&(p.layoutHTML(),t.__outerLayout&&delete t.__outerLayout),t._42(I)):kb(l,g)||!$||t.__outerLayout&&!y||(p.layoutHTML(),t.__outerLayout=!0)}}p&&(C.push(p),p.getView&&(p=p.getView()),p.style.display=u?"block":mb)}}),t&&C.length>0){var e=!1;if(t.length!==C.length)e=!0;else for(var k=0;k<C.length;k++)if(C[k]!==t[k]){e=!0;break}e&&(C.forEach(function(s){s.autoAdjustIndex!==!1&&N.appendHTML(s,!0)}),this.__htmlOrderList=C)}else this.__htmlOrderList=C;N._92db(I,J)},validateImpl:function(){this.tryUpdateRootData();var s,m,S,y,r,j=this,w=j.tx(),h=j.ty(),A=j._zoom,V=j._canvas,i=this.getWidth(),u=this.getHeight(),Y=j._29I,z={x:-w/A,y:-h/A,width:i/A,height:u/A},P={},b=j._34I,Q=j._24I,E=j._32I,R=j._23I;j._24I={},(i!==V.clientWidth||u!==V.clientHeight)&&(qh(V,i,u),E=1,j._forcedLayoutHTML=1),E||io(z,Y)||(E=1,j._forcedLayoutHTML=1),j._29I=z,j.each(function(H){m=H._id;var E=P[m]=j.isVisible(H);E!==j._56I[m]&&(Q[m]=H,S=j.getDataUI(Q[m]),S&&S._84o(E),j._84o(H,E))},j);for(m in Q)S=j.getDataUI(Q[m]),S&&(!E&&j._56I[m]&&(r=S._79o(),r&&b.add(r)),S.invalidate()),j._83I=1;if(j._56I=P,!E)for(m in Q)P[m]&&(S=j.getDataUI(Q[m]),S&&(r=S._79o(),r&&b.add(r)));if(E?y=z:(b.each(function(g){kb(z,g)&&(y=Th(y,g))}),y&&(Lq(y,I(1,1/A)),y.x=c(y.x*A)/A,y.y=c(y.y*A)/A,y.width=g(y.width*A)/A,y.height=g(y.height*A)/A,y=Wf(z,y))),j._74O=y,y&&0!==y.width&&0!==y.height){s=hb(V);var K=y.x,o=y.y,v=y.width,x=y.height;K=Math.floor((K*A+w)*Tp),o=Math.floor((o*A+h)*Tp),v=Math.ceil(v*A*Tp)+1,x=Math.ceil(x*A*Tp)+1,E||(y.x=(K/Tp-w)/A,y.y=(o/Tp-h)/A,y.width=v/Tp/A,y.height=x/Tp/A),s.beginPath(),s.rect(K,o,v,x),s.clip(),s.clearRect(K,o,v,x),pm(s,w,h,A),j._42(s,y),s.restore(),delete j._74O}if(b.clear(),delete j._32I,delete j._forcedLayoutHTML,R&&i>0&&u>0){var S=j.getDataUI(R);if(S){var r=S._79o(),D=j._29I,$=D.x,p=D.y,F=D.width,J=D.height,A=j._zoom;r&&!kb(r,D)&&(r.x+r.width<$&&j.tx(-r.x*A),r.x>$+F&&j.tx(-(r.x+r.width-F)*A),r.y+r.height<p&&j.ty(-r.y*A),r.y>p+J&&j.ty(-(r.y+r.height-J)*A))}delete j._23I}j._83I&&(delete j._83I,delete j._84I),j._98O(),j.countFrame(),Gi(j._24I)||Qe(j.iv,j)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var K,j=this.getFullscreenDatas();for(var A in j)K=j[A],this.scaleRootData(K);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(_){var A=_.s("fullscreen");if("uniform"===A||"fill"===A){_.getRotation()&&_.setRotation(0);var J=_.s("fullscreen.gap")||0,u=this.getWidth(),O=this.getHeight();if(u&&O){var W,D,L,w=u-2*J,R=O-2*J,l=_.getAnchor(),k=_.getScaledSize(),V=k.width,p=k.height,n=_.s("fullscreen.lock");if(n)return"uniform"===A?w/R>V/p?(W=R/p,V=p*w/R):(W=w/V,p=V*R/w):"v"===n?(W=R/p,V=w/W,_.getWidth()!==V&&_.setWidth(V)):(W=w/V,p=R/W,_.getHeight()!==p&&_.setHeight(p)),this.setZoom(W),D=J-(_.getX()-l.x*V)*W,L=J-(_.getY()-l.y*p)*W,D!==this.tx()&&this.tx(D),L!==this.ty()&&this.ty(L),void 0;D=this.tx(),L=this.ty(),W=this._zoom;var I={x:(-D+J)/W,y:(-L+J)/W,width:w/W,height:R/W};if("uniform"===A){var r=V/p,F=Math.min(I.width,I.height*r),g=F/r;I.x+=.5*(I.width-F),I.y+=.5*(I.height-g),I.width=F,I.height=g}w=I.width/_.getScaleX(),R=I.height/_.getScaleY(),(_.getWidth()!=w||_.getHeight()!==R)&&_.setSize(w,R);var Y=I.x+l.x*I.width,Z=I.y+l.y*I.height,t=_.getPosition();(Y!==t.x||Z!==t.y)&&_.setPosition(Y,Z)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(J){var C=this;J!==C.isScrollBarVisible()&&(J?(vk(C._view,C._79O=Xl()),vk(C._79O,C._27I=Xl()),vk(C._79O,C._28I=Xl())):(sn(C._79O),delete C._79O,delete C._27I,delete C._28I),C.fp("scrollBarVisible",!J,J))},getDebugTip:function(){return""},showScrollBar:function(){var y=this;y._79O&&(y._85I||(kl(function(){y._86I()},fj),y.iv()),y._85I=new Date)},_86I:function(){var S=this;if(S._85I){var U=new Date,s=U.getTime();s-S._85I.getTime()>=fj?(delete S._85I,S.iv()):kl(function(){S._86I()},fj)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var r=this,x=this._27I,e=this._28I;if(r._79O){if(r._autoHideScrollBar&&!r._85I)return x.style.visibility=Ce,e.style.visibility=Ce,void 0;var k=r.getScrollBarColor(),W=r._zoom,I=r.getScrollBarSize(),O=r.getViewRect(),$=r.getScrollRect(),Q=O.height*W,u=$.height*W,S=O.width*W-I-2,C=Q*((O.y-$.y)*W/u),g=Q*(Q/u),b=x.style;u-.5>Q?(Gl>g&&(C=C+g/2-Gl/2,0>C&&(C=0),C+Gl>Q&&(C=Q-Gl),g=Gl),cn(x,S,C,I,g),b.visibility=$r,b.background=k,b.borderRadius=I/2+Ee):b.visibility=Ce;var H=O.width*W,y=$.width*W,C=O.height*W-I-2,S=H*((O.x-$.x)*W/y),s=H*(H/y),b=e.style;y-.5>H?(Gl>s&&(S=S+s/2-Gl/2,0>S&&(S=0),S+Gl>H&&(S=H-Gl),s=Gl),cn(e,S,C,s,I),b.visibility=$r,b.background=k,b.borderRadius=I/2+Ee):b.visibility=Ce}},setDataModel:function(c){var n=this,m=n._dataModel,P=n._selectionModel;m!==c&&(m&&(m.ump(n.handleDataModelPropertyChange,n),m.umm(n.handleDataModelChange,n),m.umd(n.handleDataPropertyChange,n),m.removeIndexChangeListener(n._75O,n),m.removeHierarchyChangeListener(n.handleHierarchyChange,n),P||m.sm().ums(n.handleSelectionChange,n)),n._dataModel=c,c.mp(n.handleDataModelPropertyChange,n),c.mm(n.handleDataModelChange,n),c.md(n.handleDataPropertyChange,n),c.addIndexChangeListener(n._75O,n),c.addHierarchyChangeListener(n.handleHierarchyChange,n),P?P._21I(c):c.sm().ms(n.handleSelectionChange,n),n.invalidateAll(!0),n.fp(br,m,c),n.updateBackground())},getLayersInfo:function(){if(this._layersInfo===B){var N=this.getLayers();N?(this._layersInfo={},N.forEach(function(Q){var R=xg(Q)?Q.name:Q;this._layersInfo[R]=Q},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(X,M,S){var N,f,k=this,I=k.getDataUI(X),Q=Wc(I),u=hp(M,function(N){return xe(Q,100*N)},100,.001),w=xe(Q,100*u);if(!S){var C=Kp(I),n=new ph(w.x,w.y),G=49/(k._zoom*k._zoom);for(N=0,f=C.length;f>N;N++)if(n.distanceToSquared(C[N])<G)return{index:N,point:C[N],distance:Math.sqrt((C[N].x-M.x)*(C[N].x-M.x)+(C[N].y-M.y)*(C[N].y-M.y))}}return{percent:u,point:w,distance:Math.sqrt((w.x-M.x)*(w.x-M.x)+(w.y-M.y)*(w.y-M.y))}},calculateAttachPoint:function(){var R=new ph,v=new ph,C=new ph;return function(f,M){var N=this.getAttachPoints(f);if(!N||!N.length)return null;C.set(M.x,M.y);for(var p,A,L,q,H,n=1/0,D=0,B=N.length;B>D;D++)L=N[D],v.x=L.x,v.y=L.y,R.x=L.offsetX||0,R.y=L.offsetY||0,q=Hg(this,f,0,R.x,R.y,v.x,v.y),A=C.distanceToSquared(q),n>A&&(p=D,n=A,H=q);n=Math.sqrt(n);var m=this.getAttachStyle(f);if("close"===m){var i=f.s("attach.close.threshold")/this._zoom;if(n>i)return null}return{index:p,distance:n,info:N[p],point:H}}}(),getAttachPoints:function(i){var u=i.s("attach.points");if(u)return u;var D=vo(i._image);return D?pk(D.attachPoints,i,this)||null:void 0},getAttachStyle:function(t){var i=t.s("attach.style");if(i)return i;var C=vo(t._image);return C?pk(C.attachStyle,t,this)||"close":void 0},updateLayers:function(){this._layersInfo=B,this.invalidateSelection(),this.redraw()},updateBackground:function(){var f=this.dm().a("width"),H=this.dm().a("height");this._canvas.style.background=f>0&&H>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(g){if("background"===g.property){var O=this._canvas.style.background,B=g.newValue||"";this.updateBackground(),this.fp("canvasBackground",O,B),this.redraw()}else"a:width"===g.property||"a:height"===g.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===g.property?this.updateLayers():"hierarchicalRendering"===g.property&&this.redraw()},handleDataPropertyChange:function(F){this.dm().isHierarchicalRendering()&&"parent"===F.property&&F.data.hasChildren()&&this.redraw(),this.invalidateData(F.data)},onPropertyChanged:function(E){var S=this,r=E.property;if(S.redraw(),"zoom"===r){var h=S.sm().getSelection();h.size()&&h.each(function(e){e.invalidate()})}else"dataModel"===r&&(S._83I=1);Dd[r]?S.showScrollBar():r===Gb&&S.onCurrentSubGraphChanged(E)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(_){var A=this,W=_.kind,Z=_.data;if(A._83I=1,"add"===W)A.invalidateData(Z),Jr(Z)&&Z.getEdgeGroup()&&Z.getEdgeGroup().eachSiblingEdge(A.invalidateData,A),Z.getHost&&Z.getHost()&&Z.getHost().updateLayoutAttaches();else if(W===Sb){A._21Q(Z);var K=Z._id,I=A._25I[K];if(I){if(A._56I[K]){var b=I._79o();b&&A.redraw(b)}I.dispose(),delete A._25I[K],delete A._24I[K],delete A._56I[K]}Z===A._currentSubGraph&&A.setCurrentSubGraph(h)}else W===Oe&&(A.invalidateAll(!0),A.setCurrentSubGraph(h))},_75O:function(d){this.invalidateData(d.data)},handleHierarchyChange:function(d){this.dm().isHierarchicalRendering()&&d.data.hasChildren()&&this.redraw(),this.invalidateData(d.data)},adjustIndex:function(X){var E=this;if(E.isVisible(X)){E.dm().beginTransaction();for(var c=X;c._parent&&E.isVisible(c._parent);)c=c._parent;c&&c!==X&&E._dataModel.adjustIndex(c),E._dataModel.adjustIndex(X),E.dm().endTransaction()}},getImage:function(d){return d.getImage?d.getImage():B},getSelectWidth:function(O){var U=vo(this.getImage(O));return U&&pk(U.disableSelectedBorder,O,this)?0:O.s("select.width")},getSelectColor:function(l){return l.s("select.color")},isSelectable:function(A,f){if(this.isSelected(A))return!0;if(!f&&A.getParent()instanceof Ho&&this.isSelectable(A.getParent(),!0)&&A.getParent().isSyncSize())return!1;var D=this.getLayersInfo();if(D){var _=D[A._layer];if(_&&_.selectable===!1)return!1}return A.s("2d.selectable")&&this.sm().isSelectable(A)},isMovable:function(f){var B=this;if(Jr(f)&&f.getStyle(Vd)!==ki)return!1;var n=this.getLayersInfo();if(n){var U=n[f._layer];if(U&&U.movable===!1)return!1}return f.s("2d.movable")?B._movableFunc?B._movableFunc(f):!0:!1},isEditable:function($){var q=this;if(R._uiSerializing)return q._uieditable;if(!q._editInteractor||!q.isSelected($))return!1;if(hq($)){var L=q.getDataUI($);if(!L||L._88I)return!1}if(Jr($)&&$.getStyle(Vd)!==ki)return!1;var W=this.getLayersInfo();if(W){var S=W[$._layer];if(S&&S.editable===!1)return!1}return $.s("2d.editable")?q._editableFunc?q._editableFunc($):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(D){return Tn(D)&&0!==D.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(D):!0},isRectEditable:function(m){return this._rectEditableFunc?this._rectEditableFunc(m):!0},isAnchorEditable:function(d){return this._anchorEditableFunc?this._anchorEditableFunc(d):!0},isRotationEditable:function(K){return K.setRotation&&K.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(K):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(g){var n=g.getAnchor(),$=g.getScale(),A=this._zoom,R=ai(g.getRotation(),0,-g.getHeight()*$.y*n.y-($.y<0?-1:1)*(An?32:16)/A),P=g.p();return R.x+=P.x,R.y+=P.y,R},getLogicalPoint:function(W){var U=this;return ug(W,U._canvas,U.tx(),U.ty(),U._zoom,U._zoom)},getScreenPoint:function(L,u){var Y,y=this;return"object"==typeof L?L.x!==B?(Y=L.x,u=L.y):(Y=L[0],u=L[1]):Y=L,wo(Y,u,y._canvas,y.tx(),y.ty(),y._zoom,y._zoom)},getSelectedDataAt:function(b){var a=this;return this.getDataAt(b,function(U){return a.isSelected(U)})},getDataInfoAt:function(M,U,K){var q,D=this.lp(M),x=this.getDataAt(D,U,K);if(x){var R=this.getDataUI(x);q={data:x,ui:R,point:D};var w=R._38o;if(w){var W=w.icons;for(var C in W){var O=W[C],A=w.rects[C];if(A)for(var c=pk(O.names,x,this),V=c?c.length:0,Z=A.rotation,u=V-1;u>=0;u--){var r=c[u],$=A[u];if(Ib($,D,Z))return q.part="icons",q.name=C,q.icon=r,q.rect=$,q.index=u,q.rotation=Z,q}}}if(this.isNoteVisible(x)){if(R.note2Info&&Ib(R.note2Info.clickRect,D,h,R.note2Info.scale))return q.part="note2",q;if(R.noteInfo&&Ib(R.noteInfo.clickRect,D,h,R.noteInfo.scale))return q.part="note",q}if(this.isLabelVisible(x)){if(R.label2Info&&Ib(R.label2Info.rect,D,R.label2Info.rotation,R.label2Info.scale))return q.part="label2",q;if(R.labelInfo&&Ib(R.labelInfo.rect,D,R.labelInfo.rotation,R.labelInfo.scale))return q.part="label",q}if(x.isInRect&&x.isInRect(D))return q.part="body",q}return q},getDataAt:function(U,B,h){U.target&&(U=this.lp(U));var O,n=this._zoom;return this.reverseEach(function(T){return(B?B(T):this.isSelectable(T))&&this.rectIntersects(T,Qh(U.x,U.y,h,n))?(O=T,!1):void 0},this),O},getIconInfoAt:function(z,m){var I=this;if(z.target&&(z=I.lp(z)),m||(m=I.getDataAt(z)),m){var Y=I.getDataUI(m);if(Y&&Y._38o){var $,M=Y._38o,g=new bp;for($ in M.icons)g.add($);for(var A=g.size()-1;A>=0;A--){$=g.get(A);for(var v=M.rects[$],F=v.rotation,C=v.length-1;C>=0;C--){var j=v[C],U=j.width,r=j.height,T={x:z.x-j.x-U/2,y:z.y-j.y-r/2};F!=h&&(T=ai(-F,T.x,T.y));var j={x:-U/2,y:-r/2,width:U,height:r};if(Ib(j,T))return{key:$,index:C,name:M.icons[$].names[C],rect:v[C],point:z,rotation:F,relativeRect:j,relativePoint:T,data:m}}}}}return h},getDatasInRect:function(c,z,F){F===B&&(F=1);var t=this,P=new bp;return t.reverseEach(function(I){F&&!t.isSelectable(I)||(z?t.rectIntersects(I,c):t.rectContains(I,c))&&P.add(I)}),P},moveSelection:function(Z,E){var l=this;l.dm().beginTransaction(),Wg(l.sm().toSelection(l.isMovable,l),Z,E),l.dm().endTransaction()},moveDatas:function(l,D,C){var f=this;f.dm().beginTransaction(),l instanceof bp||(l=new bp(l)),Wg(l,D,C),f.dm().endTransaction()},getDataUIBounds:function(f){var P=this.getDataUI(f);return P?P._79o():h},drawData:function(e,z,K){var Q=this.getDataUI(z);if(Q){var G=Q._79o();(!K||kb(K,G))&&(Q._42(e),z instanceof R.Block&&z.eachChild(function(j){this.isVisible(j)&&this.drawData(e,j,K)},this))}},getBoundsForGroup:function(P){return P.s(Cl)?this.getDataUIBounds(P):h},isPixelPerfect:function(E){return E.s("pixelPerfect")},rectIntersects:function(r,g){this.validate();var A=h;if(this._56I[r._id]){var V=this._25I[r._id];if(V){var U=V._79o();if(Yk(g,U))A=!0;else if((g=Wf(g,U))&&(V.rectIntersects&&(A=V.rectIntersects(g)),A==h)){if(!this.isPixelPerfect(r))return!0;var E=g.x,H=g.y,o=g.width,I=g.height,m=this._zoom,c=l.hitMaxArea,f=o*I*m*m;if(f>c){var _=Math.sqrt(c/f);m*=_}o*=m,I*=m,2>o&&(o=2),2>I&&(I=2),E*=m,H*=m;var N=ac(o,I);Df(N,-E,-H),N.scale(m,m),this._drawForChecking=!0,this.drawData(N,r,g),this._drawForChecking=!1;try{for(var q=0,v=N.getImageData(0,0,o,I).data;q<v.length;q+=4)if(0!==v[q+3]){A=!0;break}N.restore()}catch(R){nl=h,A=!1}}}}return A?!0:!1},rectContains:function(w,e){if(this._56I[w._id]){var i=this._25I[w._id];if(i)return Yk(e,i._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(g){if(!l.isInput(g.target)){var c=this,V=c._focusData,p=V&&c._25I[V._id],h=0,L=c._dataModel._datas;if(!(V&&V._enabled&&V._editable&&p&&p.onKeyDown&&p.onKeyDown(g)===!0))if(9===g.keyCode&&(V&&(h=L.indexOf(V),sh(g)?-1===--h&&(h=0):++h===L.size()&&(h=0)),c._focusData=V=L.get(h),c.sm().setSelection(V)),id(g)?c.selectAll():fr(g)&&c.isResettable()&&c.reset(),c.sm().isEmpty()){if(c._editing)return;var w=c.tx(),m=c.ty(),j=!1,N=sh()?100:10;bq(g)&&(w-=N,j=!0),Gh(g)&&(m-=N,j=!0),jh(g)&&(w+=N,j=!0),di(g)&&(m+=N,j=!0),j&&c.setTranslate(w,m)}else{Ej(g)&&c.handleDelete(g);var e=sh()?10:1;bq(g)&&(c.moveSelection(-e,0),c.fi({kind:"moveLeft"})),Gh(g)&&(c.moveSelection(0,-e),c.fi({kind:"moveUp"})),jh(g)&&(c.moveSelection(e,0),c.fi({kind:"moveRight"})),di(g)&&(c.moveSelection(0,e),c.fi({kind:"moveDown"}))
}}},handleScroll:function(w,U){if(jr(w),this.isZoomable()){if(!this.getEditInteractor()){var Y=this.getDataAt(w);if(Y){var C=vo(this.getImage(Y));if(C&&pk(C.scrollable,Y,this))return}}var l=this.lp(w);U>0?this.scrollZoomIn(l):0>U&&this.scrollZoomOut(l)}},handlePinch:function($,V,N){this.isZoomable()&&(Math.abs(V-N)<l.pinchZoomThreshold||(V>N?this.pinchZoomIn($):this.pinchZoomOut($)))},checkDoubleClickOnNote:function(w,q){var E=this,M=E.lp(w),N=E.getDataUI(q),D=N.note2Info;return D&&q.s("note2.toggleable")&&Ib(D.clickRect,M)?(q.s(Af,!q.s(Af)),E.fi({kind:"toggleNote2",event:w,data:q}),!0):(D=N.noteInfo,D&&q.s("note.toggleable")&&Ib(D.clickRect,M)?(q.s(np,!q.s(np)),E.fi({kind:"toggleNote",event:w,data:q}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(x,C){var _=this,s=_.getAutoScrollZone(),P=s/_.getZoom(),G=s/4,m=_._29I,U=_.lp(x),r={x:_.tx(),y:_.ty()};return U&&s>0&&m&&(U.x-m.x<P?_.translate(G,0):m.x+m.width-U.x<P&&_.translate(-G,0),U.y-m.y<P?_.translate(0,G):m.y+m.height-U.y<P&&_.translate(0,-G)),r.x=_.tx()-r.x,r.y=_.ty()-r.y,C&&(C.x+=r.x,C.y+=r.y),r},getMoveMode:function(s,C){var z=C.s("2d.move.mode");return z?z:Mk["88"]?"x":Mk["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(V,p,A){var F=this;return"currentSubGraph"===p?{__i:V.getId()}:A.serializeProperty(V,p,F)},deserializeProperty:function(u,S,B){var C=this;if("currentSubGraph"===S){var o=C.dm(),x=o.__idMap;return x[u.__i]}return B.deserializeProperty(u,S,C)},setDefaultCursor:function(z,b){this._defaultCursor=z,b!==!1&&this.setCursor(z)},setCursor:function(w){"default"===w&&(w=this._defaultCursor||w);var l=this.getView().style;l.cursor=w,l.cursor="-webkit-"+w,l.cursor="-moz-"+w},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(X){return X===h||l.getConnectAction(null,X)?(this._currentActionType=X,this.redraw(),!0):!1},getEditStyle:function(P){var J=this.getEditInteractor();return J?J.getStyle(P):B},setEditStyle:function(O,D,j){var a=this.getEditInteractor();return a?(a.setStyle(O,D,j),!0):!1},isConnectActionVisible:function(T){var z=l.getConnectAction(this);if(!z)return!1;var s=z.visible;return bo(s)&&(s=s(this,T)),s},isInteractive:function(G){if(this._drawForChecking)return!1;var Y=vo(this.getImage(G));return Y&&pk(Y.interactive,G,this)?!0:G.s("interactive")},appendHTML:function(J,d){var Q=this.getView();if(!(d||J&&J.parentNode!==Q))return!1;var S=J.getView&&J.getView();if(!d&&S&&S.parentNode===Q)return!1;(J.getView||J.isSelfViewEvent)&&(J=J.getView());var a=this.getEditInteractor();return a&&a._canvas?Q.insertBefore(J,a._canvas):this.isScrollBarVisible()?Q.insertBefore(J,this.getView().lastChild):vk(Q,J),!0},_layoutHTMLImpl:function(I,t,R){if(arguments.length>1){var d,n=this,s=n._zoom;if(t.getView&&(d=t,t=t.getView()),t.style.position="absolute",R){var T=I.getRect();cn(d||t,n.tx()+T.x*s,n.ty()+T.y*s,T.width*s,T.height*s)}else{var V=new lj,T=I.getAnchorRect(),u=I.getPosition(),o=I.getScale(),O=t.style;cn(d||t,T),V.appendTranslate(n.tx(),n.ty()),V.appendScale(s,s),V.append(new lj(I.getRotation(),u.x,u.y,o.x,o.y)),dp(O,"transform","matrix("+V.a.toFixed(5)+", "+V.b.toFixed(5)+", "+V.c.toFixed(5)+",\n    "+V.d.toFixed(5)+", "+V.tx.toFixed(5)+", "+V.ty.toFixed(5)+")"),dp(O,"transformOrigin",(-T.x).toFixed(5)+"px "+(-T.y).toFixed(5)+"px"),t.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(s){return s instanceof Uo?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(D){var l="state",B=D.s(l);if(B)return B;var I=vo(D._image);return I?pk(I[l],D,this)||null:void 0},getShape:function(N){return N.getStyle(Cq)},updateLayoutAttach:function(T){this.dm().each(function(W){W instanceof Qp&&W.getImage()===T&&W.updateLayoutAttaches()})}}),w.defineProperties(hi.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(i){this._layoutHTML=i}}});var ur=function(i,I){var p=this;p.gv=i,p.s=function(h){return I.getStyle(h)},p._data=I,p._87I=new bp};tr(ur,w,{_6I:h,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var u=this,Y=u.gv.isSelected(u._data);return!Y||u.isShadowed()?0:u.gv.getSelectWidth(u._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(t){var B=this._data,L=this.gv.getBodyColor(B);return L?L:t?B.getStyle(t):h},_2Q:function(C){return this.s(C)},_1Q:function(d,c,X,k){var C=this.s,W=C("2d.gray"),B=C(c+".dash.color");if(W&&(B=l.toGrayColor(B)),d.strokeStyle=B,d.lineWidth=X,d.stroke(),C(c+".dash.3d")){var L=C(c+".dash.3d.color");Wo(d,B,W?l.toGrayColor(L):L,X,this.gv._zoom,C(c+".dash.3d.accuracy"))}Zb(d,k)},invalidate:function(){this._6I=h},_79o:function(){var R=this;if(!R._6I){var l=R._data,P=R.gv;R.labelInfo=R.label2Info=R.noteInfo=R.note2Info=R._38o=h,R._87I.clear(),R.interactiveInfo=P.isInteractive(l)?{}:h,R._3O(),R._55O=P.isEditable(l)?{_42O:P.isRectEditable(l),_43O:P.isPointEditable(l),_56O:P.isRotationEditable(l)}:h,R._6I=R._81o()}return R._6I},_3O:function(){},getPosition:function(){return zn},_68o:function(H,S){H&&this._87I.add(Uq(H,S))},_81o:function(){var k=this,z=k.s;k._24O(Cn,"getLabel"),k._24O(Xq,"getLabel2"),k._26O(Am,"getNote"),k._26O(Um,"getNote2"),k._15O(),k._55O&&k._48O();var m;if(k._87I.each(function($){m=Th(m,$)}),m){var P=k.isShadowed(),Z=z("shadow2"),j=lg(m);Z?(j.x+=z("shadow2.offset.x"),j.y+=z("shadow2.offset.y"),Lq(j,z("shadow2.blur"))):P&&(j.x+=z("shadow.offset.x"),j.y+=z("shadow.offset.y"),Lq(j,z("shadow.blur"))),m=Th(m,j)}return k._87I.clear(),m},_42:function(f){var J=this,z=J._data,A=J.gv,d=J.s,P=d("opacity"),v=this.isShadowed(),L=d("shadow2");if(v||L){var W=f.shadowOffsetX,S=f.shadowOffsetY,D=f.shadowBlur,t=f.shadowColor,m=A.getZoom()*l.devicePixelRatio,C=v?"shadow":"shadow2";f.shadowOffsetX=d(C+".offset.x")*m,f.shadowOffsetY=d(C+".offset.y")*m,f.shadowBlur=d(C+".blur")*m,f.shadowColor=v?J.getSelectColor():d(C+".color")}if(P!=h){var Q=f.globalAlpha;f.globalAlpha=P}J._80o(f),A.isLabelVisible(z)&&((!A._drawForChecking||d("label.selectable"))&&$n(f,J.labelInfo),(!A._drawForChecking||d("label2.selectable"))&&$n(f,J.label2Info)),A.isNoteVisible(z)&&(Ah(f,J.noteInfo),Ah(f,J.note2Info)),J._99O(f),P!=h&&(f.globalAlpha=Q),(v||L)&&(f.shadowOffsetX=W,f.shadowOffsetY=S,f.shadowBlur=D,f.shadowColor=t)},_80o:function(){},_47O:function(){},_24O:function(T,F){var V=this,k=V._data,r=V.gv,n=V.s,x=r[F](k);if(x!=h){var Q=n(T+".scale"),t=n(T+".max"),y=n(T+".position"),R=V[T+"Info"]={label:x,scale:Q,color:r[F+"Color"](k),font:n(T+".font"),opacity:n(T+".opacity"),align:n(T+".align"),rotation:V.getRotation(n(T+".rotation"),!1,y),background:r[F+"Background"](k)},v=ud(R,x);t>0&&t<v.width&&(R.labelWidth=v.width,v.width=t),1!==Q&&(v.width*=Q,v.height*=Q);var J=V.getPosition(y,n(T+".offset.x"),n(T+".offset.y"),v,n(T+".position.fixed"));if(v.x=J.x-v.width/2,v.y=J.y-v.height/2,V._68o(R.rect=v,R.rotation),1!==Q){var _=v.width/Q,H=v.height/Q;R.rect={x:J.x-_/2,y:J.y-H/2,width:_,height:H}}}},_26O:function(t,_){var F=this,o=F.gv,R=F._data,w=F.s,Y=o[_](R);if(Y!=h){var S,l,T=w(t+".scale"),r=F[t+"Info"]={note:Y,scale:T,data:R,view:o,expanded:w(t+".expanded"),font:w(t+".font"),color:w(t+".color"),opacity:w(t+".opacity"),align:w(t+".align"),icon:w(t+".icon"),backgroundImage:w(t+".backgroundImage"),borderWidth:w(t+".border.width"),borderColor:w(t+".border.color"),background:o[_+"Background"](R)},I=F.getPosition(w(t+".position"),w(t+".offset.x"),w(t+".offset.y")),p=I.x,W=I.y;if(r.expanded){var U,y=w(t+".max"),M=w(t+".backgroundImage");M?(M=vo(M),U={width:sm(M,R),height:wq(M,R)}):U=ud(r,Y),U.width+=6,U.height+=2,y>0&&y<U.width&&(r.labelWidth=U.width,U.width=y),S=U.width,l=U.height+8,r.clickRect={x:p-S*T/2,y:W-l*T,width:S*T,height:l*T*U.height/l}}else{var a=w(t+".icon");a?(a=vo(a),S=sm(a,R),l=wq(a,R)):(S=12,l=18),r.clickRect={x:p-S*T/2,y:W-l*T,width:S*T,height:l*T}}r.rect={x:p-S/2,y:W-l*T/2-l/2,width:S,height:l};var B=g(r.borderWidth/2)*T;F._68o({x:p-S*T/2-B,y:W-l*T-B,width:S*T+2*B,height:l*T+2*B})}},_48O:function(){},_99O:function(H){var T=this,q=T._38o;if(q){var c=T.gv,Y=T._data,p=q.icons,n=T.interactiveInfo;n&&(n._38o={});for(var N in p){var O=p[N],L=q.rects[N];if(L){n&&(n._38o[N]=[]);var o=pk(O.opacity,Y,c),l=pk(O.names,Y,c),i=l?l.length:0,K=L.rotation;if(o!=h){var y=H.globalAlpha;H.globalAlpha*=o}for(var g=0;i>g;g++){var U=l[g],f=vo(U),b=L[g];if(K){var z=b.x+b.width/2,P=b.y+b.height/2;H.save(),Df(H,z,P),Cs(H,K),Df(H,-z,-P)}n&&n._38o[N].push(H.interactiveInfo={compInfos:[],matrix:K?new lj(K,z,P).appendTranslate(-z,-P):new lj}),eq(H,f,pk(O.stretch,Y,c),b.x,b.y,b.width,b.height,T._data,T.gv),H.interactiveInfo=h,K&&H.restore()}o!=h&&(H.globalAlpha=y)}}}}});var kh=function(l,A){_l(kh,this,[l,A])};tr(kh,ur,{_checkEmptyRect:!0,_40O:function(V,Q){var E=this,p=E.s,A=V.rect;(V.borderColor=E.gv.getBorderColor(E._data))&&(V.borderType=p("border.type"),V.borderWidth=p("border.width"),V.borderPadding=p("border.padding"),Q=I(Q,V.borderPadding+V.borderWidth/2));var l=E._data.getScale(),D=I(1,I($(l.x),$(l.y)));if(V.selectWidth=E.getSelectWidth()){var C=E.gv._zoom;V.selectType=p("select.type"),V._97o=E.getSelectColor(),V.selectPadding=p("select.padding"),Q=I(Q,(V.selectPadding+V.selectWidth/2/C)/D)}Q>0&&(Q*=D,A=lg(A),Lq(A,Q)),E._68o(A)},_39O:function(Y,X){var b,S=this,O=X.rect;if(X.borderWidth>0&&(b=X.borderPadding,Y.strokeStyle=X.borderColor,Y.lineWidth=X.borderWidth,yn(Y,X.borderType,{x:O.x-b,y:O.y-b,width:O.width+2*b,height:O.height+2*b}),Y.stroke()),X.selectWidth>0){var N=S.gv._zoom;if(b=X.selectPadding,Y.strokeStyle=X._97o,Y.lineWidth=X.selectWidth/N,X.rotation!=h){Y.save(),Y.translate(X.position.x,X.position.y),Y.rotate(X.rotation);var o=S._data,d=o.getWidth(),D=o.getHeight(),M=X.scale,y=X.anchor;O={x:M.x*-d*y.x,y:M.y*-D*y.y,width:M.x*d,height:M.y*D}}yn(Y,X.selectType,{x:O.x-b,y:O.y-b,width:O.width+2*b,height:O.height+2*b}),X.rotation!=h&&Y.restore(),Y.stroke()}},dispose:function(){var f=this,T=f._htmlView;kh.superClass._3O.call(f),T&&(T.onHTMLRemoved&&T.onHTMLRemoved(),sn(T))},_3O:function(){var m,f=this,g=f.s,s=f._data,M=f.gv,R=M.getShape(s),u=f.getBodyColor(),J=g("shape.border.color"),v=f._83o=R?{shape:R,_53o:f.getBodyColor("shape.background"),_27Q:vo(g("shape.repeat.image"),u),shapeGradientPack:g("shape.gradient.pack"),_54o:g("shape.border.width"),_55o:J,shapeBorderRepeatImage:vo(g("shape.border.repeat.image"),J),_56o:g("shape.border.3d"),_57o:g("shape.border.3d.color"),_58o:g("shape.border.3d.accuracy"),shapeGradient:g("shape.gradient"),_59o:g("shape.gradient.color"),_60o:g("shape.border.pattern"),_61o:g("shape.border.cap"),_62o:g("shape.border.join"),shapeForeground:g("shape.foreground"),bodyColor:u,gray:g("2d.gray")}:{img:vo(M.getImage(s),u),bodyColor:u,gray:g("2d.gray"),stretch:g("image.stretch")},y=v.img;y&&y.renderHTML?(f._htmlInfo&&f._htmlInfo.img!==y&&(f._htmlInfo=h),f._htmlInfo||(f._htmlInfo={img:y,cache:{}}),m=y.renderHTML(s,M,f._htmlInfo.cache)):f._htmlInfo=h,f._htmlView&&f._htmlView!==m&&(f._htmlView.onHTMLRemoved&&f._htmlView.onHTMLRemoved(),sn(f._htmlView.getView?f._htmlView.getView():f._htmlView)),(f._htmlView=m)&&M.appendHTML(m)&&(m.onHTMLAddedSync&&m.onHTMLAddedSync(),m.onHTMLAdded&&Qe(m.onHTMLAdded)),v.rect=s.getRect(),v.position=s.p(),v.scale=s.getScale(),v.anchor=s.getAnchor(),v.rotation=s.getRotation(),R===Kq&&(v._63o=g("shape.depth"));var b=0;if(R)b=pq(h,v._54o/2,v._62o),f.s("shape.dash")&&(b=I(b,(f.s("shape.dash.width")||v._54o)/2));else if(y&&y.boundExtend)if(b=pk(y.boundExtend,s,M),y.boundExtendAbsolute){var q=s.getScale();b/=M._zoom*I(1,I($(q.x),$(q.y)))}else if(!pk(y.fitSize,s,M)){var G=pk(y.width,s,M),c=pk(y.height,s,M);b*=I(s.getWidth()/G,s.getHeight()/c)}f._40O(v,b);var p=Co(s,M.isSelected(s)),j=g("clip.percentage");if(1>j&&(0>j&&(j=0),v.clipRect=gs(s.getAnchorRect(),g("clip.direction"),j,p)),R){var L=g("shape.fill.clip.percentage");1>L&&(0>L&&(L=0),v.shapeClipRect=gs(s.getAnchorRect(),g("shape.fill.clip.direction"),L,p));var z=g("shape.foreground.clip.percentage");1>z&&(0>z&&(z=0),v.shapeForegroundClipRect=gs(s.getAnchorRect(),g("shape.foreground.clip.direction"),z,p))}},getPosition:function(i,S,B,Q){var A=Fj(i,this._83o.rect,Q);return A.x+=S,A.y+=B,A},_80o:function(d){var H=this,y=H.s,Y=H.gv,z=H._data,b=H._83o,B=b.rect,G=b.position,c=b.rotation,o=b.anchor,N=b.scale,S=b.shape,m=b.clipRect;if(!H._checkEmptyRect||B.width>0&&B.height>0){var a=z.getSize();if(a.x=-a.width*o.x,a.y=-a.height*o.y,Dq&&!Kl&&Df(d,a.width,a.height),d.save(),Df(d,G.x,G.y),Cs(d,c),Vj(d,N.x,N.y),m&&(d.beginPath(),d.rect(m.x,m.y,m.width,m.height),d.clip()),Y._drawForChecking&&b.img&&pk(b.img.pixelPerfect,z,Y)===!1)Tj(d,a.x,a.y,a.width,a.height,"#888888");else if(H.freeDraw)H.freeDraw(d,a,b);else if(S){var r,Z,M,U,p=b._60o,x=gm(d,p),q=b._27Q,O=b._54o,I=b.shapeGradientPack,D=b.gray,n=d.lineJoin,g=d.lineCap,L=function(E){return D?l.toGrayColor(E):E};"roundRect"===S?r=y("shape.corner.radius"):"polygon"===S?r=y("shape.polygon.side"):"arc"===S&&(r=y("shape.arc.from"),Z=y("shape.arc.to"),M=y("shape.arc.close"),U=y("shape.arc.oval")),d.lineJoin=b._62o,d.lineCap=b._61o;var P=L(b._53o);if(P||q||I){var X=b.shapeClipRect;X&&(d.save(),d.beginPath(),d.rect(X.x,X.y,X.width,X.height),d.clip()),yn(d,S,a,r,Z,M,U),I?Hk(d,I,function(V){return pf(V,b.bodyColor)}):q?ok(d,q,L(b.bodyColor),null,z,Y):Em(d,P,b.shapeGradient,L(b._59o),a),d.fill(),I&&d.restore(),X&&d.restore(),d!==x&&yn(x,S,a,r,Z,M,U)}else yn(x,S,a,r,Z,M,U);var R=b.shapeForeground;if(R){d.save();var T=b.shapeForegroundClipRect;T&&(d.beginPath(),d.rect(T.x,T.y,T.width,T.height),d.clip()),yn(d,S,a,r,Z,M,U),Em(d,R,y("shape.foreground.gradient"),L(y("shape.foreground.gradient.color")),a),d.fill(),d.restore()}if(O>0){var v=y("shape.border.width.absolute");v&&(d.save(),d.setTransform(1,0,0,1,0,0)),d.lineWidth=O;var W=L(b._55o);b.shapeBorderRepeatImage?Rq(d,b.shapeBorderRepeatImage,W,null,z,Y):d.strokeStyle=W,d.stroke(),v&&d.restore(),b._56o&&Wo(d,W,L(b._57o),O,Y._zoom,b._58o)}if(Zb(d,p),y("shape.dash")){var A=y("shape.dash.width")||O;if(A>0){p=y("shape.dash.pattern");var x=gm(d,p,H._2Q("shape.dash.offset"));x!==d&&yn(x,S,a,r,Z,M,U),H._1Q(d,"shape",A,p)}}tf(d,P,b._63o,a),d.lineJoin=n,d.lineCap=g}else{var j=H.interactiveInfo;j&&(d.interactiveInfo=j.bodyInfo={compInfos:[],matrix:new lj(c,G.x,G.y,N.x,N.y)}),b.gray&&(d.compGray=!0);var V=b.img;V&&V.cacheRule!=h&&(V=Vk(d,V,b.stretch,a.width,a.height,z,Y,b.bodyColor)),eq(d,V,b.stretch,a.x,a.y,a.width,a.height,z,Y,b.bodyColor),d.compGray=!1,d.interactiveInfo=h}d.restore()}H._39O(d,b)},_48O:function(){},_47O:function(){}});var Zk=function(Y,l){_l(Zk,this,[Y,l])},Hr=function(L,W,q,J){var r=Jf(L,W);return q=J?v(q,r):en(q,r),r?q/=r:q=0,{x:L.x+(W.x-L.x)*q,y:L.y+(W.y-L.y)*q}};tr(Zk,ur,{_3O:function(){var s,i=this,D=i._data,O=i.gv,R=i.s,d=R(Vd),L=D.isLooped(),e=R("edge.width"),K=i.getBodyColor("edge.color"),J=R("edge.center"),w=R("edge.offset"),Y=O.getBorderColor(D),x=Y?R("border.width"):0,M=i.getSelectWidth(),U=D._40I,Q=D._41I,z=i._78o=U&&Q?{looped:L,type:d,width:e,center:J,color:K,repeatImage:vo(R("edge.repeat.image"),K),borderColor:Y,borderWidth:x,_97o:M?i.getSelectColor():h,selectWidth:M,pattern:R("edge.pattern"),cap:R("edge.cap"),join:R("edge.join"),is3d:R("edge.3d"),_67o:R("edge.3d.color"),_66o:R("edge.3d.accuracy"),gray:R("2d.gray")}:h;if(z){var n=l.getEdgeType(d);if(n){var P=n(D,zr(i,O,D,L,d),O,i._19Q);P.points&&P.points.size()>1?(z.edgeTypeInfo=P,s=oj(z.edgeTypeInfo.points)):P[Xr]&&P.rect&&(z.edgeTypeInfo=P,s=P.rect)}else{var A=R("edge.source.anchor.x"),$=R("edge.source.anchor.y"),a=R("edge.target.anchor.x"),H=R("edge.target.anchor.y"),V=Hf(O,D,"source"),Z=Hf(O,D,"target");if(d===ki){var q=z.points=R(gr)||zs,r=q.size();z.segments=R("edge.segments");var C=A!==B||$!==B||Jr(U),j=a!==B||H!==B||Jr(Q);if(!J)if(w)C||(V=Hr(V,r?q.get(0):Z,w,r)),j||(Z=Hr(Z,r?q.get(r-1):V,w,r));else{var y;C||(y=zh(V,r?q.get(0):Z,ji(O,U)),y&&(V={x:y[0],y:y[1]})),j||(y=zh(r?q.get(r-1):V,Z,ji(O,Q)),y&&(Z={x:y[0],y:y[1]}))}s=Th(oj(z.points),oj(V,Z))}else{var W=zr(i,O,D,L,d);if(i._19Q||(W=-W),L)V=lg(V),V.x=O.getNodeRect(U).x,z.radius=W,s={x:V.x-W,y:V.y-W,width:2*W,height:2*W};else{var E=Jf(V,Z),f=en(w,E),m={x:f,y:W},T={x:E-f,y:W},G=Mj(Z.y-V.y,Z.x-V.x),k=z.mat=new uk(G);if(z.orienAngle=G,z.angle=Z.x<V.x?G+S:G,z.rect={x:m.x,y:m.y,width:T.x-m.x,height:0},z.origin=V,m=k.tf(m),m.x+=V.x,m.y+=V.y,T=k.tf(T),T.x+=V.x,T.y+=V.y,J){var p={x:E,y:0};p=k.tf(p),p.x+=V.x,p.y+=V.y,s=oj([V,m,T,p]),z.c1=V,z.c2=p}else s=oj(m,T);V=m,Z=T}}z.sourcePoint=V,z.targetPoint=Z,D._lastSourcePoint=V,D._lastTargetPoint=Z}var c=0;R("edge.dash")&&(c=R("edge.dash.width")||e);var u="square"===z.cap?.71:.5;pq(s,I(c*u,e*u+x+M),z.join),i._68o(s)}},getRotation:function(u,B,d){u=u||0;var c=this._78o;if(c){var L,V=c.angle,T=c.points,M=c.edgeTypeInfo;if(V!=h)return B?c.orienAngle+u:V+u;if(M&&M[Xr])return M.getRotation?M.getRotation(this,u,B,d):0;if(M&&M.points){var s=M.points;return L=s.size(),Ql[d]?L&&0===L%2?Ih(s.get(L/2-1),s.get(L/2),B,u):u:pb[d]?Ih(s.get(0),s.get(1),B,u):Ih(s.get(L-2),s.get(L-1),B,u)}if(T)return L=T.size(),Ql[d]?L&&0===L%2?Ih(T.get(L/2-1),T.get(L/2),B,u):u:pb[d]?Ih(c.sourcePoint,L?T.get(0):c.targetPoint,B,u):Ih(L?T.get(L-1):c.sourcePoint,c.targetPoint,B,u)}return u},getPosition:function(H,$,l,I,Q){var t=this._78o;if(t){var B,M=t.type,h=t.points,b=t.edgeTypeInfo,E=t.sourcePoint,O=t.targetPoint;if(!M)return t.looped?{x:E.x-t.radius+$,y:E.y+l}:(Q&&E&&O&&(E.x>O.x||E.x===O.x&&E.y>O.y)&&(H=Dh[H],l=-l),B=Fj(H,t.rect,I),B.x+=$,B.y+=l,B=t.mat.tf(B),B.x+=t.origin.x,B.y+=t.origin.y,B);if(b&&b[Xr])return b.getPosition?b.getPosition(this,H,$,l,I,Q):{x:(E.x+O.x)/2,y:(E.y+O.y)/2};if(h){var B,u=h.size();if(Ql[H]){if(u){var W=u%2;if(0===W)return Fk(h.get(u/2-1),h.get(u/2),H,$,l,I,Q);B=h.get((u-W)/2)}else B={x:(E.x+O.x)/2,y:(E.y+O.y)/2};return B=Fj(H,{x:B.x,y:B.y,width:0,height:0},I),B.x+=$,B.y+=l,B}return pb[H]?Fk(E,u?h.get(0):O,H,$,l,I,Q):Fk(u?h.get(u-1):E,O,H,$,l,I,Q)}if(b){var R=b.points,u=R.size();if(Ql[H]){var W=u%2;return 0===W?Fk(R.get(u/2-1),R.get(u/2),H,$,l,I,Q):(B=R.get((u-W)/2),B=Fj(H,{x:B.x,y:B.y,width:0,height:0},I),B.x+=$,B.y+=l,B)}return pb[H]?Fk(R.get(0),R.get(1),H,$,l,I,Q):Fk(R.get(u-2),R.get(u-1),H,$,l,I,Q)}}return zn},_42:function(K){this._78o&&Zk.superClass._42.call(this,K)},drawPath:function(y,W){y.beginPath();var K=W.type,G=W.points,h=W.segments,C=W.edgeTypeInfo;if(!K||G){var Z=W.sourcePoint,V=Z.x,w=Z.y,F=W.targetPoint,n=F.x,O=F.y;if(K)if(h){var Y=new bp({x:V,y:w});Y.addAll(G),Y.add({x:n,y:O}),jj(y,Y,h)}else y.moveTo(V,w),G.each(function(i){y.lineTo(i.x,i.y)}),y.lineTo(n,O);else W.looped?y.arc(V,w,W.radius,0,Q,!0):W.center?(y.moveTo(W.c1.x,W.c1.y),y.lineTo(V,w),y.lineTo(n,O),y.lineTo(W.c2.x,W.c2.y)):(y.moveTo(V,w),y.lineTo(n,O))}else C&&(C.points?jj(y,C.points,C.segments):C[Xr]&&C[Xr](y,C))},_80o:function(T){var E=this,n=E.s,$=E._78o,J=$.width,W=$.selectWidth,m=$.borderWidth,R=$.repeatImage,q=T.lineJoin,X=T.lineCap,i=$.gray,A=$.pattern;T.lineJoin=$.join,T.lineCap=$.cap,E.drawPath(gm(T,A),$);var r=n("edge.width.absolute");r&&(T.save(),T.setTransform(1,0,0,1,0,0)),W&&(T.strokeStyle=$._97o,T.lineWidth=J+2*(m+W),T.stroke()),m&&(T.strokeStyle=i?l.toGrayColor($.borderColor):$.borderColor,T.lineWidth=J+2*m,T.stroke());var P=i?l.toGrayColor($.color):$.color;if(R?Rq(T,R,P,null,E._data,E.gv):T.strokeStyle=P,T.lineWidth=J,T.stroke(),$.is3d){var S=i?l.toGrayColor($._67o):$._67o;Wo(T,P,S,J,E.gv._zoom,$._66o)}if(Zb(T,A),n("edge.dash")){A=n("edge.dash.pattern");var z=gm(T,A,E._2Q("edge.dash.offset"));z!==T&&E.drawPath(z,$),E._1Q(T,"edge",n("edge.dash.width")||J,A)}r&&T.restore(),T.lineJoin=q,T.lineCap=X},_48O:function(){},_47O:function(){}});var Fb=function(X,H){_l(Fb,this,[X,H])};tr(Fb,kh,{_3O:function(){var y,T,n=this,F=n.s,Q=n._data,w=n.gv;if(n._88I=h,Q.isExpanded()&&Q.eachChild(function(k){if(Tn(k)){var E=w.getBoundsForGroup(k);E&&(T||(T=[]),T.push(E),y=Th(y,E))}}),y){var b=w.getLabel(Q),E=F("group.type"),G=F("group.border.width")||0,u=F("group.border.width.absolute"),d=G/2;u&&(G/=w._zoom),y=Uc(E,T,y),Ul(y,Q,"group.padding",1),Lq(y,G);var r=n._88I={type:E,rect:y,_64o:y};if(!E&&b!=h){var p,I=n.labelInfo={label:b,color:F("group.title.color"),font:F("group.title.font"),align:F("group.title.align")},i=ud(I,b),C=i.width+G,t=i.height+G,x=F("group.title.align"),Y=F("group.title.orientation");if(Y===Pi||Y===sp?(y.height+=G,C>y.width&&(y.width=C)):(Y===Se||Y===_d)&&(y.width+=G,C>y.height&&(y.height=C)),p=x===Se?y.x:x===_d?y.x+y.width-C:y.x+y.width/2-C/2,Y===sp)r.titleRect={x:y.x,y:y.y+y.height,width:y.width,height:t},r.rect={x:y.x,y:y.y,width:y.width,height:y.height+t},I.rect={x:p,y:y.y+y.height,width:C,height:t};else if(Y===Se){var m=r.titleRect={x:y.x-t,y:y.y,width:t,height:y.height};r.rect={x:y.x-t,y:y.y,width:y.width+t,height:y.height},I.rect={x:m.x+t/2-y.height/2,y:m.y+y.height/2-t/2,width:y.height,height:t},I.rotation=-Math.PI/2}else if(Y===_d){var m=r.titleRect={x:y.x+y.width,y:y.y,width:t,height:y.height};r.rect={x:y.x,y:y.y,width:y.width+t,height:y.height},I.rect={x:m.x+t/2-y.height/2,y:m.y+y.height/2-t/2,width:y.height,height:t},I.rotation=Math.PI/2}else r.titleRect={x:y.x,y:y.y-t,width:y.width,height:t},r.rect={x:y.x,y:y.y-t,width:y.width,height:y.height+t},I.rect={x:p,y:y.y-t-d,width:C,height:t+G}}n._40O(r,F("group.border.width")/2)}else Fb.superClass._3O.call(n)},getPosition:function(L,W,V,X){var u=this._88I;if(u){var A=Fj(L,u.rect,X);return A.x+=W,A.y+=V,A}return Fb.superClass.getPosition.apply(this,arguments)},_24O:function(D,R){var C=this._88I;(!C||C.type||"label2"===D)&&Fb.superClass._24O.call(this,D,R)},_80o:function(Q){var $=this,z=$._88I;if(z){var g=$._data,U=$.s,G=$.gv,M=z.type,c=z.rect,y=z._64o,r=z.titleRect,T=$.getBodyColor(),I=vo(U("group.image"),T),X=U("group.image.stretch"),l=$.getBodyColor("group.background"),K=vo(U("group.repeat.image"),T),b=U("group.gradient.pack"),F=U("group.gradient"),w=U("group.gradient.color"),s=U("group.border.width"),p=U("group.border.color"),Y=U("group.border.pattern"),e=U("group.title.orientation"),j=U("group.depth"),u=U("group.border.radius"),R=U("group.border.join"),D=U("group.border.cap"),L=U("group.border.width.absolute");L&&(s/=G._zoom);var m=p,h=U("group.border.repeat.image");if(h&&(h=vo(h,p))&&(m=_e(Q,h,p,null,g,G)),M){var f=Q.lineJoin,V=Q.lineCap;if(Q.lineJoin=R,Q.lineCap=D,I){if(Q.save(),yn(Q,M,c,u),Q.clip(),eq(Q,I,X,c.x,c.y,c.width,c.height,g,G,T),Q.restore(),s>0){var _=gm(Q,Y);yn(_,M,c,u),Q.lineWidth=s,Q.strokeStyle=m,Q.stroke(),Zb(Q,Y)}}else{var _=gm(Q,Y);l||K||b?(yn(Q,M,c,u),b?Hk(Q,b,function(k){return pf(k,T)}):K?ok(Q,K,T,null,g,G):Em(Q,l,F,w,c),Q.fill(),b&&Q.restore(),Q!==_&&yn(_,M,c,u)):yn(_,M,c,u),s>0&&(Q.lineWidth=s,Q.strokeStyle=m,Q.stroke()),Zb(Q,Y),M===Kq&&tf(Q,l,j,c)}Q.lineJoin=f,Q.lineCap=V}else{var J=U("group.title.background");if((!u||0>u)&&(u=0),I)eq(Q,I,X,y.x,y.y,y.width,y.height,g,G,$.getBodyColor());else if(l||K)if(K?ok(Q,K,T,null,g,G):Em(Q,l,F,w,y),0===s)yn(Q,Kq,y),Q.fill(),tf(Q,l,j,y);else{switch(Q.beginPath(),e){case sp:Bf(Q,y.x,y.y,y.width,y.height,u,u,0,0);break;case Se:Bf(Q,y.x,y.y,y.width,y.height,0,u,0,u);break;case _d:Bf(Q,y.x,y.y,y.width,y.height,u,0,u,0);break;case Pi:Bf(Q,y.x,y.y,y.width,y.height,0,0,u,u)}Q.fill()}if(r&&J)if(0===s)Tj(Q,r.x,r.y,r.width,r.height,J),tf(Q,J,j,r);else{switch(Q.beginPath(),Q.fillStyle=J,e){case sp:Bf(Q,r.x,r.y,r.width,r.height,0,0,u,u);break;case Se:Bf(Q,r.x,r.y,r.width,r.height,u,0,u,0);break;case _d:Bf(Q,r.x,r.y,r.width,r.height,0,u,0,u);break;case Pi:Bf(Q,r.x,r.y,r.width,r.height,u,u,0,0)}Q.fill()}if(s>0){var _=gm(Q,Y);if(yn(_,"roundRect",c,u),Q.save(),Q.lineWidth=s,Q.strokeStyle=m,Q.lineJoin=R,Q.lineCap=D,Q.closePath(),Q.stroke(),r&&U("group.splitLine")){var S=r.x,x=r.y,i=r.width,P=r.height;Q.beginPath(),e===sp?(Q.moveTo(S,x),Q.lineTo(S+i,x)):e===Se?(Q.moveTo(S+i,x),Q.lineTo(S+i,x+P)):e===_d?(Q.moveTo(S,x),Q.lineTo(S,x+P)):(Q.moveTo(S,x+P),Q.lineTo(S+i,x+P))}Q.stroke(),Q.restore(),Zb(_,Y)}}$._39O(Q,z)}else Fb.superClass._80o.call($,Q)}});var qd=function(P,c){_l(qd,this,[P,c])};tr(qd,kh,{_80o:function(d){this._39O(d,this._83o)}});var wd=function(j,T){_l(wd,this,[j,T])};tr(wd,kh,{_3O:function(){var K=this,x=K._data,W=K.s,R=K.gv,o=x.getPoints(),m=R.getBorderColor(x),s=m?W("border.width"):0,d=K.getSelectWidth(),G=W("shape.border.width"),k=x.getRect(),H=x.getAnchorRect(),z=R.getBodyColor(x),g=W("shape.border.color"),X=K._99o=o.isEmpty()?h:{rect:k,rotation:x.getRotation(),fillRule:W("shape.fill.rule"),scale:x.getScale(),position:x.p(),points:o,segments:x.getSegments(),bodyColor:z,borderColor:m,borderWidth:s,_94o:W("shape.border.3d"),_95o:W("shape.border.3d.color"),_96o:W("shape.border.3d.accuracy"),_97o:d?K.getSelectColor():h,selectWidth:d,_53o:W("shape.background"),_27Q:vo(W("shape.repeat.image"),z),shapeGradientPack:W("shape.gradient.pack"),_54o:G,_55o:g,shapeBorderRepeatImage:vo(W("shape.border.repeat.image"),g),shapeGradient:W("shape.gradient"),_59o:W("shape.gradient.color"),_60o:W("shape.border.pattern"),_61o:W("shape.border.cap"),_62o:W("shape.border.join"),shapeForeground:W("shape.foreground"),gray:W("2d.gray")};if(X){H.x+=X.position.x,H.y+=X.position.y,X.gradientRect=H;var T=x.getScale(),L=I(1,I($(T.x),$(T.y)));W("shape.dash")&&W("shape.dash.width")>G&&(G=W("shape.dash.width"));var j,B=W("shape.border.width.absolute");j=B?(G+s+d)/K.gv._zoom/L:G*("square"===X._61o?.71:.5)+s+d/K.gv._zoom/L,j&&(j*=L,k=lg(k),pq(k,j,X._62o)),K._68o(k);var E=Co(x,R.isSelected(x)),i=W("clip.percentage");1>i&&(0>i&&(i=0),X.clipRect=gs(x.getAnchorRect(),W("clip.direction"),i,E));var e=W("shape.fill.clip.percentage");1>e&&(0>e&&(e=0),X.shapeClipRect=gs(x.getAnchorRect(),W("shape.fill.clip.direction"),e,E));var f=W("shape.foreground.clip.percentage");1>f&&(0>f&&(f=0),X.shapeForegroundClipRect=gs(x.getAnchorRect(),W("shape.foreground.clip.direction"),f,E))}},getPosition:function(R,O,x,d){var B=this._99o;if(B){var l=Fj(R,B.rect,d);return l.x+=O,l.y+=x,l}return zn},_42:function(u){this._99o&&wd.superClass._42.call(this,u)},_80o:function(x){var f,i=this,o=i.s,b=i._99o,J=b.position,S=b.scale,Z=b.rotation,Q=b.borderWidth,N=b.selectWidth/i.gv._zoom,h=b._27Q,v=b.shapeGradientPack,R=b._54o,C=b.clipRect,t=b.shapeClipRect,T=b.points,m=b.segments,k=i._data.isClosePath(),U=b.fillRule,c=b.gray,G=function(y){return c?l.toGrayColor(y):y},F=G(b._53o),q=F||h||v;x.save(),Df(x,J.x,J.y),Cs(x,Z),Vj(x,S.x,S.y),C&&(x.beginPath(),x.rect(C.x,C.y,C.width,C.height),x.clip()),q&&t&&(x.save(),x.beginPath(),x.rect(t.x,t.y,t.width,t.height),x.clip()),Df(x,-J.x,-J.y);var d=b._60o,n=gm(x,d),u=x.lineJoin,D=x.lineCap;x.lineJoin=b._62o,x.lineCap=b._61o;var L=G(b.bodyColor);q?(jj(x,T,m,k),v?Hk(x,v,function(F){return pf(F,b.bodyColor)}):h?ok(x,h,L,null,i._data,i.gv):(f=L?L:F,Em(x,f,b.shapeGradient,G(b._59o),b.gradientRect)),x.fill(U),v&&x.restore(),t&&(x.restore(),Df(x,-J.x,-J.y)),n!==x&&jj(n,T,m,k)):jj(n,T,m,k);var e=b.shapeForeground;if(e){x.save();var A=b.shapeForegroundClipRect;A&&(Df(x,J.x,J.y),x.beginPath(),x.rect(A.x,A.y,A.width,A.height),x.clip(),Df(x,-J.x,-J.y)),jj(x,T,m,k),Em(x,e,o("shape.foreground.gradient"),G(o("shape.foreground.gradient.color")),b.gradientRect),x.fill(U),x.restore()}var O=o("shape.border.width.absolute");if(O&&(x.save(),x.setTransform(1,0,0,1,0,0)),N&&(x.strokeStyle=b._97o,x.lineWidth=R+2*(Q+N),x.stroke()),Q&&(x.strokeStyle=G(b.borderColor),x.lineWidth=R+2*Q,x.stroke()),R&&(f=G(b._55o),b.shapeBorderRepeatImage?Rq(x,b.shapeBorderRepeatImage,f,null,i._data,i.gv):(!F&&L&&(f=L),x.strokeStyle=f),x.lineWidth=R,x.stroke(),b._94o&&Wo(x,f,G(b._95o),R,i.gv._zoom,b._96o)),Zb(x,d),o("shape.dash")){var s=o("shape.dash.width")||R;if(s>0){d=o("shape.dash.pattern");var n=gm(x,d,i._2Q("shape.dash.offset"));n!==x&&jj(n,T,m,k),i._1Q(x,"shape",s,d)}}O&&x.restore(),x.lineJoin=u,x.lineCap=D,x.restore()},_48O:function(){},_47O:function(){}});var Zn=function(y,l){_l(Zn,this,[y,l])};tr(Zn,wd,{getRotation:function(l,c,y){l=l||0;var j=this._data.getPoints(),k=j.size();return k>1?Ql[y]?k&&0===k%2?Ih(j.get(k/2-1),j.get(k/2),c,l):l:pb[y]?Ih(j.get(0),j.get(1),c,l):Ih(j.get(k-2),j.get(k-1),c,l):l},getPosition:function(I,t,B,i,K){var C=this._data.getPoints(),c=C.size();if(c>1){if(Ql[I]){var m=c%2;if(0===m)return Fk(C.get(c/2-1),C.get(c/2),I,t,B,i,K);var X=C.get((c-m)/2),s={x:X.x,y:X.y,width:0,height:0};return X=Fj(I,s,i),X.x+=t,X.y+=B,X}return pb[I]?Fk(C.get(0),C.get(1),I,t,B,i,K):Fk(C.get(c-2),C.get(c-1),I,t,B,i,K)}return zn}});var nd=function(w,W){_l(nd,this,[w,W])};tr(nd,kh,{_3O:function(){var u=this;nd.superClass._3O.call(u);var U=u.s,J=u._83o;u._82o=J.img||J.shape?h:{background:u.getBodyColor("grid.background"),depth:U("grid.depth"),rect:J.rect,_88o:U("grid.cell.depth"),cellBorderColor:U("grid.cell.border.color"),_89o:U("grid.row.count"),_90o:U("grid.column.count"),block:U("grid.block"),_91o:U("grid.block.color"),_92o:U("grid.block.padding"),_93o:U("grid.block.width")}},_80o:function(z){var G=this,U=G._82o;if(!U)return nd.superClass._80o.call(G,z),void 0;var f,r,d=G._data,D=U.background,F=U.rect,K=U.block,c=U._91o,w=U._92o,y=U._93o,M=U._88o,g=U.cellBorderColor,Q=U._89o,s=U._90o;if(D)if(Tj(z,F.x,F.y,F.width,F.height,D),tf(z,D,U.depth,F),M)for(f=0;Q>f;f++)for(r=0;s>r;r++)F=d.getCellRect(f,r),F&&tf(z,D,M,F);else if(g){for(z.beginPath(),f=0;Q>f;f++)for(r=0;s>r;r++)F=d.getCellRect(f,r),F&&z.rect(F.x,F.y,F.width,F.height);z.strokeStyle=g,z.lineWidth=1,z.stroke()}if("h"===K)for(f=0;Q>f;f++)F=Th(d.getCellRect(f,0),d.getCellRect(f,s-1)),Lq(F,w),ge(z,c,F.x,F.y,F.width,F.height,y);else if("v"===K)for(r=0;s>r;r++)F=Th(d.getCellRect(0,r),d.getCellRect(Q-1,r)),Lq(F,w),ge(z,c,F.x,F.y,F.width,F.height,y);G._39O(z,G._83o)}});var Ec=function(n,l){_l(Ec,this,[n,l])};tr(Ec,kh,{_checkEmptyRect:!1,_81o:function(){var o=this._data,m=Ec.superClass._81o.call(this),O=o.s("text");if(O!=h){var $,f,z=o.s("text.font"),l=o.s("text.align"),p=o.s("text.vAlign"),w=Jm(z,O),i=w.width,j=w.height,F=o.getAnchor(),d=o.getWidth(),R=o.getHeight();"left"===l?$=-d*F.x:"center"===l?$=-d*F.x+(d-i)/2:"right"===l&&($=d*(1-F.x)-w.width),"top"===p?f=-R*F.y:"middle"===p?f=-R*F.y+(R-j)/2:"bottom"===p&&(f=R*(1-F.y)-w.height);var E,k=o.getMatrix();if(E=oj([k.tf($,f),k.tf($+i,f),k.tf($+i,f+j),k.tf($,f+j)]),m=Th(m,E),m&&o.s("text.shadow")){var Z=lg(m);Z.x+=o.s("text.shadow.offset.x"),Z.y+=o.s("text.shadow.offset.y"),Lq(Z,o.s("text.shadow.blur")),m=Th(m,Z)}}return m}});var ro=hi.Interactor=function(j){this.gv=this._graphView=j};af("Interactor",w,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(R){this.gv.fi(R)},setCursor:function(k){An||this.gv.setCursor(k)},startDragging:function(T){var D=this;D._lastClientPoint=Cd(T),D._lastLogicalPoint=D.gv.lp(T),Vc(D,T)},clearDragging:function(){var f=this;f._lastClientPoint=f._lastLogicalPoint=f._logicalPoint=h},autoScroll:function(c){return this.gv.autoScroll(c,this._lastClientPoint)}});var ls=h,ng=function(l){ls.handleWindowTouchMove(l)},Ne=function(V){ls.handleWindowTouchEnd(V),J(P,le,ng),J(P,jk,Ne),ls=h},Wi=function(X){ls.handleWindowMouseMove(X)},ch=function(L){ls.handleWindowMouseUp(L),J(P,kr,Wi),J(P,em,ch),ls=h},ub=function(C,q){if(C!==ls){var $=Le(q);ls?$?ls.handleWindowTouchEnd(q):ls.handleWindowMouseUp(q):$?(e(P,le,ng),e(P,jk,Ne)):(e(P,kr,Wi),e(P,em,ch)),ls=C
}},ds=function(n){var Z=this;Z.gv=n,Z._is2d=n instanceof hi.GraphView,Z._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",oi,"wheel"].forEach(function(D){Z.addListener(D)}),Z.initImageResource()};tr(ds,ro,{enableVR:function(h){var L=this;!!L._vrEnable!==h&&(L._vrEnable=h,h?L.gv.vr.mp(L.onVRControllerChange,L):L.gv.vr.ump(L.onVRControllerChange,L))},onVRControllerChange:function(c){var O=this,l=c.property,V=c.newValue,F=V.id,t=O.gv.vr.getController(F),i=t.getRay();if(i){i.controllerId=F;var I=O.gv.vr.getRayEventType(i,l,V._62O);switch(I){case"down":O.handle_mousedown(i);break;case"up":ls&&ch(i);break;case"move":O.handle_mousemove(i),ls&&O.handleWindowMouseMove(i)}}},setPreventEventDefault:function(m,c){var n=this,l=n._eventListeners[m];l?l._prevent=c:n._eventListeners[m]=l={_removal:B,_prevent:c}},removeListener:function(r){var V=this,C=V._eventListeners[r];C&&C._removal&&(C._removal(),C._removal=B)},addListener:function(v){var N=this,q=N._eventListeners[v];if(q||(N._eventListeners[v]=q={_removal:B,_prevent:!0}),!q||!q._removal){var a=function(P){q._prevent&&l.preventDefault(P),N.disabled||("wheel"===v?bj(N,P):N["handle_"+v](P))};e(N.gv.getView(),v,a),q._removal=function(){J(N.gv.getView(),v,a)}}},handleWindowTouchMove:function(T){this.handleWindowMouseMove(T)},handleWindowMouseMove:function(x){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",x):(this.handleDownInfo("onBeginDrag",x),this.isDragging=!0))},handleWindowTouchEnd:function(m){this.handleWindowMouseUp(m)},handleWindowMouseUp:function(q){if(this.isDragging&&(this.handleDownInfo("onEndDrag",q),this.isDragging=!1),this.downInfo){var _=this.handle("onUp",q);if(_&&_.data===this.downInfo.data){this.handleMissingUp(q);var r=this,D=2===q.button?"onContextMenu":"onClick";if(!r._dbclickTimer)return r._dbclickTimer=kl(function(){delete r._dbclickTimer,r.handleClick(q,D,_),this.downInfo=h},l.clickDelay),void 0;vc(r._dbclickTimer),delete r._dbclickTimer,D="onDoubleClick",r.handleClick(q,D,_)}else this.handleDownInfo("onUp",q);this.downInfo=h,this.downComps=h}},handle_mouseleave:function(F){var a=this,u=a.gv;a._hoverTimer&&(vc(a._hoverTimer),delete a._hoverTimer);var c=a.currentInfo?a.currentInfo.data:h;if(c){c.s("onLeave")&&c.s("onLeave")(F,c,u),a.fire("data","onLeave",F,c);var z=a.currentInfo?a.currentInfo.hits:h;if(z)for(var p in z)a.handleLeave(F,p);a.currentInfo=h}},handle_mousewheel:function(i){i.scrollDelta=i.wheelDelta/40,this.handle("onScroll",i)},handle_DOMMouseScroll:function(l){l.scrollDelta=2===l.axis?-l.detail:0,this.handle("onScroll",l)},handle_touchstart:function(v){this.handle_mousedown(v)},handle_touchmove:function(v){this.handle("onMove",v)},handle_mousedown:function(L){this.isDragging&&(this.handleDownInfo("onEndDrag",L),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",L),this.downInfo&&ub(this,L)},handle_mousemove:function(X){var A=this,Z=A.gv;if(A._hoverTimer&&(vc(A._hoverTimer),delete A._hoverTimer),!Z._panning&&!Z._moving){var p,c,L,v=A.handle("onMove",X),W=this.currentInfo?this.currentInfo.data:h,f=this.currentInfo?this.currentInfo.hits:h;if(v&&(c=v.data,L=v.hits,A._hoverTimer=kl(function(){vc(A._hoverTimer),delete A._hoverTimer,A.handle("onHover",X,v)},Z.getHoverDelay()||l.hoverDelay)),c!==W){if(W&&(W.s("onLeave")&&W.s("onLeave")(X,W,Z),this.fire("data","onLeave",X,W)),c&&(c.s("onEnter")&&c.s("onEnter")(X,c,Z),this.fire("data","onEnter",X,c)),f)for(p in f)this.handleLeave(X,p);if(L)for(p in L){var P=L[p],a=c._interactPrefix=P.prefix,N=a&&c.a(a+"onEnter")||P.target.onEnter;N&&N.call(P.target,X,c,Z,P.point,P.width,P.height),this.fire(P.type,"onEnter",P.event,P.data,P.image,P.comp,P.point,P),c._interactPrefix=null}}else{if(f)for(p in f)L&&L[p]||this.handleLeave(X,p);if(L)for(p in L)if(!f||!f[p]){var P=L[p],a=c._interactPrefix=P.prefix,N=a&&c.a(a+"onEnter")||P.target.onEnter;N&&N.call(P.target,X,c,Z,P.point,P.width,P.height),this.fire(P.type,"onEnter",P.event,P.data,P.image,P.comp,P.point,P),c._interactPrefix=null}}this.currentInfo=v}},handle:function(u,K,U){var W,i=this,e=i.gv;if(i._is2d){if(U=U||e.getDataInfoAt(K),!U||!e.isInteractive(U.data))return;if(W=U.ui.interactiveInfo){var O,a=U.data;if(a.s(u)&&a.s(u)(K,a,e),this.fire("data",u,K,a),"body"===U.part&&W.bodyInfo)O="body",U.hits=this.handleImage(O,e.getImage(a),u,K,a,U.point,W.bodyInfo);else if("icons"===U.part&&W._38o){var M=W._38o[U.name];M&&M[U.index]&&(O="icons|"+U.name+"|"+U.index,U.hits=this.handleImage(O,U.icon,u,K,a,U.point,M[U.index]))}}return U}var a,E;if(!U)if(K&&K instanceof R.Math.Ray&&e.isVREnabled()){var I=e.vr.intersectWorld(K);if(a=I.data,E=I.intersect,e.vr.renderRayDuringInteraction(K,a,E),!a)return;var A=e.getData3dUI(a);if(W=A.interactiveInfo,!W)return;U={data:a,part:E.part,ui:A}}else{if(U=e.getDataInfoAt(K),!U)return;U&&(U={data:U.data,part:U.part})}if(e.isInteractive(U.data)){if(!E){a=U.data;var A=e.getData3dUI(a);if(U.ui=A,W=A.interactiveInfo,!W)return U;if(E=e.intersectObject(K,a),!E)return}a.s(u)&&a.s(u)(K,a,e),this.fire("data",u,K,a);var r,l=E.part;return"body"!==l&&(r=a.s(l+".image")||a.s("shape3d."+l+".image")),r||(r=a.s("all.image")||a.s("shape3d.image")),r?(W="object"==typeof r?W[r.uuid]:W[r],W&&W.bodyInfo?(U.part="body",U.interactiveInfo=W,U.point=this._convertUVToPoint(E.uv,W),U.image=r,U.hits=this.handleImage("body",r,u,K,a,U.point,W.bodyInfo),U):U):U}},_handleLeaveOrMissing:function(p,v,b){var n="leave"===p?this.currentInfo:this.downInfo;if(n){var y=n.interactiveInfo||n.ui.interactiveInfo;if(y){var s,A,w=n.data;if(this._is2d){if(A=this.gv.lp(v),"body"===n.part&&y.bodyInfo)s="body","leave"===p?this.handleLeaveImage(b,s,this.gv.getImage(w),v,w,A,y.bodyInfo):this.handleMissingUpImage(s,this.gv.getImage(w),v,w,A,y.bodyInfo);else if("icons"===n.part&&y._38o){var t=y._38o[n.name];t&&t[n.index]&&(s="icons|"+n.name+"|"+n.index,"leave"===p?this.handleLeaveImage(b,s,n.icon,v,w,A,t[n.index]):this.handleMissingUpImage(s,n.icon,v,w,A,t[n.index]))}}else{if(!y.bodyInfo)return;var E=this.gv.intersectObject(v,w);A=E&&E.uv?this._convertUVToPoint(E.uv,y):{x:1/0,y:1/0},"leave"===p?this.handleLeaveImage(b,"body",n.image,v,w,A,y.bodyInfo):this.handleMissingUpImage("body",n.image,v,w,A,y.bodyInfo)}}}},handleClick:function(K,A,e){var X=this,O=this.downInfo;if(O&&e){var i,z=e.interactiveInfo||e.ui.interactiveInfo,k=e.data,W=this.gv;if(k.s(A)&&k.s(A)(K,k,W),X.fire("data",A,K,k),z)if(this._is2d){if(O.part===e.part){var C=W.lp(K);"body"===e.part&&z.bodyInfo&&(i="body",this.handleClickImage(i,W.getImage(k),A,K,k,C,z.bodyInfo,e))}}else{if(!z.bodyInfo)return;var v=W.intersectObject(K,k);if(!v)return;C=this._convertUVToPoint(v.uv,z),this.handleClickImage("body",O.image,A,K,k,C,z.bodyInfo,e)}}},handleDownInfo:function(e,t){if(this.downInfo){var n=this.downInfo,W=this.gv,Z=n.interactiveInfo||n.ui.interactiveInfo;if(Z){var I,b=n.data;if(b.s(e)&&b.s(e)(t,b,W),this.fire("data",e,t,b),this._is2d){var X=W.lp(t);if("body"===n.part&&Z.bodyInfo)I="body",this.handleDownInfoImage(I,W.getImage(b),e,t,b,X,Z.bodyInfo);else if("icons"===n.part&&Z._38o){var J=Z._38o[n.name];J&&J[n.index]&&(I="icons|"+n.name+"|"+n.index,this.handleDownInfoImage(I,n.icon,e,t,b,X,J[n.index]))}}else{if(!Z.bodyInfo)return;var k=W.intersectObject(t,b);if(!k)return;X=this._convertUVToPoint(k.uv,Z),this.handleDownInfoImage("body",n.image,e,t,b,X,Z.bodyInfo)}}}},fire:function(c,C,M,S,K,A,y,w){this.gv.fi({kind:C,type:c,event:M,data:S,image:K,comp:A,view:this.gv,point:y,width:w?w.width:B,height:w?w.height:B})},handleImage:function($,z,O,x,d,R,h){var i={};if(z&&(z=vo(z))){var G=this.gv,X=h.rect,k=this.convertPoint(R,h);k.inRect&&(z[O]&&z[O](x,d,G,k,X.width,X.height),this.fire("image",O,x,d,z,B,k,X),i[$+"|image"]={target:z,type:"image",image:z,data:d,event:x,point:k,width:X.width,height:X.height});for(var s,v=h.compInfos,c=z,u=v.length-1;u>=0;u--){var w=v[u],Z=w.comp;if(k=this.convertPoint(R,w,c,Z,G,d),k.inRect){X=w.rect;var r=d._interactPrefix=w.prefix,f=r&&d.a(r+O)||Z[O];if(f&&(s=f.call(Z,x,d,G,k,X.width,X.height)),this.fire("comp",O,x,d,z,Z,k,X),s!==!0&&(z=X.image)&&(z[O]&&(s=z[O](x,d,G,k,X.width,X.height)),this.fire("image",O,x,d,z,B,k,X)),d._interactPrefix=null,i[$+"|"+u]={target:Z,type:"comp",comp:Z,image:z,data:d,event:x,point:k,width:X.width,height:X.height,prefix:r},this.downComps&&this.downComps.push(Z),z&&(i[$+"|"+u+"|image"]={target:z,type:"image",image:z,data:d,event:x,point:k,width:X.width,height:X.height,prefix:r}),s===!0)break}}}return i},handleLeave:function(s,i){return this._handleLeaveOrMissing("leave",s,i)},handleMissingUp:function(y){return this._handleLeaveOrMissing("missing",y)},handleLeaveImage:function(W,R,U,J,c,Z,T){if(U&&(U=vo(U))){var y=this.gv,X=T.rect,D=this.convertPoint(Z,T);W===R+"|image"&&(U.onLeave&&U.onLeave(J,c,y,D,X.width,X.height),this.fire("image","onLeave",J,c,U,B,D,X));for(var F,l=T.compInfos,x=U,i=l.length-1;i>=0;i--){var e=l[i],h=e.comp;D=this.convertPoint(Z,e,x,h,y,c),X=e.rect;var s=c._interactPrefix=e.prefix;if(W===R+"|"+i){var k=s&&c.a(s+"onLeave")||h.onLeave;k&&(F=k.call(h,J,c,y,D,X.width,X.height)),this.fire("comp","onLeave",J,c,U,h,D,X)}if(F!==!0&&(U=X.image)&&W===R+"|"+i+"|image"&&(U.onLeave&&(F=U.onLeave(J,c,y,D,X.width,X.height)),this.fire("image","onLeave",J,c,U,B,D,X)),c._interactPrefix=null,F===!0)break}}},handleMissingUpImage:function(M,C,U,A,e,l){var v="onUp",O=this.downInfo.hits;if(O&&C&&(C=vo(C))){var o=this.gv,p=l.rect,b=this.convertPoint(e,l);!b.inRect&&O[M+"|image"]&&(C[v]&&C[v](U,A,o,b,p.width,p.height),this.fire("image",v,U,A,C,B,b,p));for(var k,t=l.compInfos,X=C,W=t.length-1;W>=0;W--){var s=t[W],K=s.comp;if(b=this.convertPoint(e,s,X,K,o,A),!b.inRect){p=s.rect;var z=A._interactPrefix=s.prefix;if(O[M+"|"+W]){var x=z&&A.a(z+v)||K[v];x&&(k=x.call(K,U,A,o,b,p.width,p.height)),this.fire("comp",v,U,A,C,K,b,p)}if(k!==!0&&(C=p.image)&&O[M+"|"+W+"|image"]&&(C[v]&&(k=C[v](U,A,o,b,p.width,p.height)),this.fire("image",v,U,A,C,B,b,p)),A._interactPrefix=null,k===!0)break}}}},handleDownInfoImage:function(w,L,l,m,E,n,h){var N=this.downInfo.hits;if(N&&L&&(L=vo(L))){var H=this.gv,e=h.rect,K=this.convertPoint(n,h);N[w+"|image"]&&(L[l]&&L[l](m,E,H,K,e.width,e.height),this.fire("image",l,m,E,L,B,K,e));for(var x,q=h.compInfos,o=L,I=q.length-1;I>=0;I--){var u=q[I],S=u.comp;K=this.convertPoint(n,u,o,S,H,E),e=u.rect;var F=E._interactPrefix=u.prefix,f=["onDrag","onEndDrag"].indexOf(l)>=0;if(!f&&N[w+"|"+I]||f&&this.downComps&&this.downComps.indexOf(S)>=0){var r=F&&E.a(F+l)||S[l];r&&(x=r.call(S,m,E,H,K,e.width,e.height)),this.fire("comp",l,m,E,L,S,K,e)}if(x!==!0&&(L=e.image)&&N[w+"|"+I+"|image"]&&(L[l]&&(x=L[l](m,E,H,K,e.width,e.height)),this.fire("image",l,m,E,L,B,K,e)),E._interactPrefix=null,x===!0)break}}},handleClickImage:function(e,l,J,b,A,q,U,p){var R=this.downInfo.hits,I=p.hits;if(R&&l&&(l=vo(l))){var O=this.gv,k=U.rect,Z=this.convertPoint(q,U);R[e+"|image"]&&(l[J]&&l[J](b,A,O,Z,k.width,k.height),this.fire("image",J,b,A,l,B,Z,k));for(var i,H=U.compInfos,D=l,T=H.length-1;T>=0;T--){var d=H[T],g=d.comp;Z=this.convertPoint(q,d,D,g,O,A),k=d.rect;var E=A._interactPrefix=d.prefix;if(R[e+"|"+T]&&I[e+"|"+T]){var K=E&&A.a(E+J)||g[J];K&&(i=K.call(g,b,A,O,Z,k.width,k.height)),this.fire("comp",J,b,A,l,g,Z,k)}if(i!==!0&&(l=k.image)&&R[e+"|"+T+"|image"]&&(l[J]&&(i=l[J](b,A,O,Z,k.width,k.height)),this.fire("image",J,b,A,l,B,Z,k)),A._interactPrefix=null,i===!0)break}}},initImageResource:function(){l.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(d,t){if(!d)return{x:1/0,y:1/0};var q=t.bodyInfo.rect,x=d.clone(),z=d.multiply({x:q.width,y:q.height});return z.local=x,z},convertPoint:function(L,n,V,K,i,R){var F=n.rect,f=n.matrix.applyInverse(L).sub(F),q=f.x>=0&&f.y>=0&&f.x<=F.width&&f.y<=F.height;if(!q)return f;if(K&&pk(K.pixelPerfect,R,i)){var F,Q=1;this._is2d?(Q=i.getZoom(),F=Qh(L.x,L.y,B,Q)):F=Qh(L.x,L.y);var X=!1,b=F.x,j=F.y,g=F.width,u=F.height,s=l.hitMaxArea,m=g*u*Q*Q;if(m>s){var S=Math.sqrt(s/m);Q*=S}g*=Q,u*=Q,2>g&&(g=2),2>u&&(u=2),b*=Q,j*=Q;var k=ac(g,u),O=new lj(0,-b,-j,Q,Q);O.append(n.matrix),i._drawForChecking=!0,K.transform=O,n.refRect&&n.refRect.fitSize&&(K.refRect=n.refRect);var e=V.comps;V.comps=[K],If(k,V,0,0,g,u,R,self),V.comps=e,delete K.refRect,delete K.transform,i._drawForChecking=!1;try{for(var $=0,x=k.getImageData(0,0,g,u).data;$<x.length;$+=4)if(0!==x[$+3]){X=!0;break}k.restore()}catch(y){nl=h,X=!1}f.inRect=X}else f.inRect=!0;return f}});var Re=hi.DefaultInteractor=function(w){_l(Re,this,[w])};af("DefaultInteractor",ro,{handle_mousedown:function(J){jr(J);var i=this,M=i.gv,k=M.getDataAt(J);if(M.setFocus(J)&&!M._editing&&!M._scrolling){xi(J)?M.handleDoubleClick(J,k):M.handleClick(J,k);var F=$q(J);!fr()&&!F&&k&&(M.isMovable(k)||M._39Q(k))||!M.isPannable()||!Pd(J)&&!F||Nq(J)||(i._tx=M.tx(),i._ty=M.ty(),i.startDragging(J))}},handleWindowMouseUp:function(W){var j=this,Y=j.gv;Y._panning&&(delete Y._panning,Y.onPanEnded(),j.fi({kind:"endPan",event:W})),delete j._tx,delete j._ty,j.clearDragging()},handle_mousemove:function(w){var F=this,f=F.gv;F._hoverTimer&&(vc(F._hoverTimer),delete F._hoverTimer),F._hoverTimer=kl(function(){F.fi({kind:"hover",event:w}),vc(F._hoverTimer),delete F._hoverTimer},f.getHoverDelay()||l.hoverDelay)},handle_mouseleave:function(){var J=this;J._hoverTimer&&(vc(J._hoverTimer),delete J._hoverTimer)},handle_touchmove:function(F){this.handle_mousemove(F)},handleWindowMouseMove:function(K){var b=this,B=b.gv;b.fi({kind:B._panning?"betweenPan":"beginPan",event:K}),B._panning=1;var n=cm(B,K,b._lastClientPoint);B.setTranslate(b._tx+n.x,b._ty+n.y)},handle_mousewheel:function(R){this.gv.handleScroll(R,R.wheelDelta)},handle_DOMMouseScroll:function(S){2===S.axis&&this.gv.handleScroll(S,-S.detail)},handle_keydown:function(l){this.gv.handleKeyDown(l)}});var yd=hi.SelectInteractor=function(y){_l(yd,this,[y])};af("SelectInteractor",ro,{_42:function(){var w=this,W=w.gv,U=W.getZoom(),h=w.mark,t=w.div;t||(t=w.div=Xl(),vk(w.getView(),t));var u={};u.x=h.x*U+W.tx(),u.y=h.y*U+W.ty(),u.width=h.width*U,u.height=h.height*U,cn(t,u),this.intersects()?(t.style.border="",t.style.background=W.getRectSelectBackground()):(t.style.background="",t.style.border="1px solid "+W.getRectSelectBorderColor())},handle_mousedown:function(z){var p=this,L=p.gv;if(p._57I=h,p.pendingClickThrough=h,!(L._editing||L._scrolling||fr()||$q(z))){var Q=L.getDataAt(z),s=L.sm();Q?Nq(z)?s.co(Q)?s.rs(Q):s.as(Q):s.co(Q)?Q instanceof Ho&&Q.isClickThroughEnabled()&&Pd(z)&&(p.pendingClickThrough=Cd(z)):s.ss(Q):Nq(z)||!L.isPannable()?Pd(z)&&(Nq(z)||s.cs(),L.isRectSelectable()&&(p.startDragging(z),L._77O=1)):Pd(z)&&(p._57I=Cd(z))}},handle_mouseup:function(y){var N=this,a=N.gv,O=N._57I;if(O&&(Jf(O,Cd(y))<=1&&a.sm().cs(),N._57I=h),N.pendingClickThrough){if(Jf(N.pendingClickThrough,Cd(y))<=1){var K=a.getDataAt(y);if(K instanceof Ho&&K.isClickThroughEnabled()){var z=a.getDataAt(y,function(o){var M=o.getParent()===K&&a.isSelectable(o,!0);return M});z&&(y.clickThrough=!0,a.sm().ss(z))}}N.pendingClickThrough=h}},handleWindowMouseUp:function(a){this.clear(a)},handleWindowMouseMove:function(Z){var M=this,k=M.gv;M._logicalPoint=k.lp(Z),M.mark?(M.fi({kind:"betweenRectSelect",event:Z}),k.isPannable()&&M.autoScroll(Z),M.redraw()):M.fi({kind:"beginRectSelect",event:Z}),M.mark=oj(M._lastLogicalPoint,M._logicalPoint),M.redraw()},intersects:function(){var x=this,p=x._lastLogicalPoint,K=x._logicalPoint;return p.x>K.x||p.y>K.y},clear:function(D){var z=this,n=z.gv,o=z.mark;if(z._57I=h,z.pendingClickThrough=h,z._lastLogicalPoint){if(o){if(0!==o.width&&0!==o.height){var L=n.getDatasInRect(o,z.intersects());if(!L.isEmpty()){var x=n.sm(),r=x.toSelection();L.each(function(G){x.co(G)?r.remove(G):r.add(G)}),x.ss(r)}}sn(z.div),delete z.div,delete z.mark,z.redraw(),z.fi({kind:"endRectSelect",event:D}),n.onRectSelectEnded()}z.clearDragging(),delete n._77O}},redraw:function(){var y=this;y._draw||(y._draw=1,kl(function(){y.mark&&y._42(),delete y._draw},16))}});var mc=hi.MoveInteractor=function(y){_l(mc,this,[y])};af("MoveInteractor",ro,{handle_mousedown:function(c){var Z=this,i=Z.gv;if(Pd(c)&&!i._editing&&!i._scrolling&&!fr()){var y=i.getSelectedDataAt(c);!y||i._39Q(y)&&!i.isMovable(y)?i._focusData=h:(Z._data=y,i.handleMouseDown&&i.handleMouseDown(c,y),Z.startDragging(c),i.isMovable(y)&&(i._moving=1))}},handleWindowMouseUp:function(w){var e=this,H=e.gv;H.handleMouseUp&&H.handleMouseUp(w,e._data),e.clear(w)},handleWindowMouseMove:function(a){var s=this,n=s._data,V=s.gv;if((!V._93O||!V._93O(a,n))&&V._moving){s._logicalPoint||s.fi({kind:"prepareMove",event:a});var Z=s._logicalPoint?"betweenMove":"beginMove",z={kind:Z,event:a},L=s._logicalPoint=V.lp(a);"beginMove"!==Z||s._alreadyBeginTransaction||(s._alreadyBeginTransaction=!0,V.getDataModel().beginTransaction());var Q=s._calcShift(Z,a),P=Q.x,u=Q.y,j=s.gv.getMoveMode(a,n);j&&("x"===j?u=0:"y"===j?P=0:"xy"!==j&&(P=u=0)),V.moveSelection(P,u),s._lastLogicalPoint=L,s.autoScroll(a),s.fi(z)}},_calcShift:function(){var u=this,S=u._logicalPoint,w=u._lastLogicalPoint,g=S.x-w.x,z=S.y-w.y;return{x:g,y:z}},clear:function(Z){var u=this,r=u.gv;u._lastLogicalPoint&&(u._lastLogicalPoint=u._data=r._moving=h,u._logicalPoint&&(u.fi({kind:"endMove",event:Z}),r.onMoveEnded()),u.clearDragging()),u._alreadyBeginTransaction&&(u._alreadyBeginTransaction=!1,r.getDataModel().endTransaction())}});var tp=hi.TextEditInteractor=function(r){_l(tp,this,[r]),this.init()};af("TextEditInteractor",ro,{init:function(){var n=this,Q=this.input=N.createElement("input"),c=Q.style;Q.text="text",c.border="1px solid #d8d8d8",c.position="absolute",c.padding="2px 3px",c.outline="none",c.marginLeft="-90px",c.marginTop="-16px",c.backgroundColor="rgba(255,255,255, 0.9)",c.fontSize="14px",c.width="180px",c.height="32px",c.boxShadow="0 0 13px rgba(16,142,233, 0.5)",c.textAlign="center",c.boxSizing="border-box",e(Q,"keyup",function(X){er(X)&&n.endTextEdit()}),e(Q,"focus",function(){Q.select()});var H=this.textarea=N.createElement("textarea"),X=this.wrap=N.createElement("div");X.appendChild(H),c=H.style,c.margin=0,c.padding="4px",c.overflow="hidden",c.boxSizing="border-box",c.position="absolute",c.outline="none",c.backgroundColor="transparent",c.resize="none",c.textAlign="center",c.fontSize="14px",c.border="none",c.borderWidth=0,c.width="100%",c.top="50%",c=X.style,c.boxSizing="border-box",c.margin=0,c.padding=0,c.position="absolute",c.boxShadow="0 0 13px rgba(16,142,233, 0.5)",c.border="1px solid #d8d8d8",c.backgroundColor="rgba(255,255,255, 0.9)",c.width="180px",c.marginLeft="-90px",e(H,"keydown",function(h){return(sh()||Nq())&&er(h)?(n.endTextEdit(),void 0):(n.calculateTextareaHeight(String.fromCharCode(h.keyCode)),void 0)}),e(H,"focus",function(){H.select()});var B=function(Y){Y.stopPropagation()};e(Q,"mousedown",B),e(Q,"touchstart",B),e(H,"mousedown",B),e(H,"touchstart",B),n.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],n.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",n.handleWindowClick=function(U){var L=n._editingDOM;if(L){var X=L.getBoundingClientRect(),J=Cd(U);Ib(X,J)||n.endTextEdit()}}},handle_mousedown:function(i){var c=this,N=c.gv;if(xi(i)&&!N._editing){var j=N.getDataAt(i);if(j){var Z=N.getTextEditInfo(j);Z&&(this._editInfo=Z,this._editTarget=j,N._editing=!0,Z.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var o=this,K=o.gv,f=o._editTarget,c=o.getTargetValue(),z=o.textarea,h=o.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===c||c===B)&&(c=""),z.value=c,o._editingDOM=z,K.getView().appendChild(h),this.layoutHTML(h,f),this.calculateTextareaHeight(),kl(function(){z.focus(),e(P,"mousedown",o.handleWindowClick),e(P,"touchstart",o.handleWindowClick)},10)},handleTextEdit:function(){var D=this,Y=D.gv,O=D._editTarget,$=D.getTargetValue(),M=D.input;(null===$||$===B)&&($=""),M.value=$,D._editingDOM=M,Y.getView().appendChild(M),this.layoutHTML(M,O),kl(function(){M.focus(),e(P,"mousedown",D.handleWindowClick),e(P,"touchstart",D.handleWindowClick)},10)},layoutHTML:function(G,I){var p=this.gv,X=p.getZoom();if(I instanceof R.Node){var E=I.getRect();G.style.left=(E.x+E.width/2)*X+p.tx()+"px",G.style.top=(E.y+E.height/2)*X+p.ty()+"px"}else if(I instanceof R.Edge){var B=p.getDataUI(I),E=B._6I;G.style.left=(E.x+E.width/2)*X+p.tx()+"px",G.style.top=(E.y+E.height/2)*X+p.ty()+"px"}},endTextEdit:function(){var k=this,I=k._editInfo.isMultiline?k.wrap:k.input,E=k._editInfo.isMultiline?k.textarea:k.input;k.setTargetValue(E.value),k.gv.getView().removeChild(I),k.gv._editing=!1,delete k._editingDOM,J(P,"mousedown",k.handlelick),J(P,"touchstart",k.handleWindowClick)},setTargetValue:function(V){var b=this,o=b._editTarget,z=b._editInfo,S=z.accessType,d=z.name;if(d&&S||(S="p",d="name"),"p"===S){var G=R.Default.setter(d);o[G](V)}else"a"===S?o.a(d,V):o.s(d,V)},getTargetValue:function(){var X=this,P=X._editTarget,I=X._editInfo,E=I.accessType,n=I.name;if(n&&E||(E="p",n="name"),"p"===E){var g=R.Default.getter(n);return P[g]()}return"a"===E?P.a(n):P.s(n)},createHiddenTextarea:function(){this.hiddenTextarea=N.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(u,G){if(G&&this.computedStyleCache)return this.computedStyleCache;var S=this,i=P.getComputedStyle(u),J=i.getPropertyValue("box-sizing")||i.getPropertyValue("-moz-box-sizing")||i.getPropertyValue("-webkit-box-sizing"),e=parseFloat(i.getPropertyValue("padding-bottom"))+parseFloat(i.getPropertyValue("padding-top")),r=parseFloat(i.getPropertyValue("border-bottom-width"))+parseFloat(i.getPropertyValue("border-top-width")),H=S.SIZING_STYLE.map(function(K){return K+":"+i.getPropertyValue(K)}).join(";"),p={sizingStyle:H,paddingSize:e,borderSize:r,boxSizing:J};return G&&(this.computedStyleCache=p),p},calculateTextareaHeight:function(Q){Q=Q||"";var r=this,V=r.textarea,J=r.hiddenTextarea,C=r.wrap,A=32,o=r.calculateHTMLStyle(V,!1),I=o.paddingSize,H=o.borderSize,t=o.boxSizing,b=o.sizingStyle;J.setAttribute("style",b+";"+r.HIDDEN_TEXTAREA_STYLE),J.value=V.value+Q;var O=J.scrollHeight;"border-box"===t?O+=H:"content-box"===t&&(O-=I),V.style.height=O+"px",V.style.marginTop=0-.5*O+"px",C.style.height=Math.max(O,A)+"px",C.style.marginTop=O*-.5+"px"}});var Fl=hi.ScrollBarInteractor=function(K){_l(Fl,this,[K])};af("ScrollBarInteractor",ro,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(N){var O=this.gv.getViewRect();return this._41o()&&(O.x+O.width-this.gv.lp(N).x)*this.gv.getZoom()<yq},isH:function(a){var Z=this.gv.getViewRect();return this._40o()&&(Z.y+Z.height-this.gv.lp(a).y)*this.gv.getZoom()<yq},handle_mousemove:function(D){this.handle_touchmove(D)},handle_touchmove:function(T){if(!dl&&Pd(T)&&this.gv.isScrollBarVisible()){var c=this,i=c.isV(T),l=c.isH(T);(i||l)&&c.gv.showScrollBar(),c.gv._scrolling=i||l}},handleWindowMouseUp:function(M){this.handleWindowTouchEnd(M)},handleWindowTouchEnd:function(j){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=h,this.fi({kind:"endScroll",event:j})},handle_mousedown:function(j){this.handle_touchstart(j)},handle_touchstart:function(j){var b=this;if(b.gv.setFocus(j),jr(j),b.handle_touchmove(j),!(uh(j)>1)&&b.gv._scrolling&&b.gv.isScrollBarVisible()){b._cp=Cd(j),b._tx=b.gv.tx(),b._ty=b.gv.ty();var $=b.isV(j);b._state=$?"vScroll":"hScroll",Vc(b,j),b.fi({kind:"beginScroll",event:j})}},handleWindowMouseMove:function(g){this.handleWindowTouchMove(g)},handleWindowTouchMove:function(F){var w=Cd(F),i=this.gv.getViewRect(),E=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-w.y)*E.height/i.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-w.x)*E.width/i.width),this.fi({kind:"betweenScroll",event:F})}});var uc=hi.TouchInteractor=function($,y){y=y||{},y.selectable===B&&(y.selectable=!0),y.movable===B&&(y.movable=!0),y.pannable===B&&(y.pannable=!0),y.pinchable===B&&(y.pinchable=!0),y.editable===B&&(y.editable=!0),this.params=y,_l(uc,this,[$])};af("TouchInteractor",ro,{ms_edit:1,setUp:function(){var y=this;uc.superClass.setUp.call(y),An&&y.params.editable&&y.gv.setEditInteractor(y)},tearDown:function(){var Z=this;uc.superClass.tearDown.call(Z),An&&Z.params.editable&&Z.gv.setEditInteractor(h)},clear:function(W){var C=this,j=C.gv;j._moving&&(C.fi({kind:"endMove",event:W}),delete j._moving,j.onMoveEnded(),j.dm().endTransaction()),j._panning&&(C.fi({kind:"endPan",event:W}),delete j._panning,j.onPanEnded()),j._pinching&&(C.fi({kind:"endPinch",event:W}),delete j._pinching,j.onPinchEnded()),j._editing&&(C._46O(W),C._77I=C._node=C._edge=C._shape=C._rect=C._89I=C._index=j._editing=h),C.pendingClickThrough=C._moving=C._panning=C._pinching=C._editing=C._57I=C._data=C._beginHistory=h,C.clearDragging()},handle_touchstart:function(B){var p=this;if(!p.gv._editing){jr(B),p._57I=h,p.pendingClickThrough=h;var l=p.params,A=p.gv,V=A.sm(),F=A.getDataAt(B),j=uh(B);if(1===j){if(xi(B))return A.handleDoubleClick(B,F),void 0;A.handleClick(B,F),F&&(A.handleMouseDown&&A.handleMouseDown(B,F),p._data=F),l.selectable||(F=h),F&&(V.co(F)?F instanceof Ho&&F.isClickThroughEnabled()&&(p.pendingClickThrough=Cd(B)):V.ss(F),l.editable&&A.isEditable(F)&&p._79I(B,F,!0)?(p._editing=1,p.startDragging(B)):l.movable&&A.isMovable(F)&&(p._moving=1,p.startDragging(B))),F&&A.isMovable(F)||(p._57I=Cd(B),l.pannable&&A.isPannable()&&(p._panning=1,p.startDragging(B),p._translate={x:A.tx(),y:A.ty()}))}else if(l.pinchable&&2===j){if(F&&A._39Q(F))return;p._pinching=1,p.startDragging(B);var w=A.getView(),u=A.getZoom(),Z=w.getBoundingClientRect(),R=B.touches[0],S=B.touches[1],z={x:(R.clientX+S.clientX)/2-Z.left,y:(R.clientY+S.clientY)/2-Z.top};z.x-=A.tx(),z.y-=A.ty(),z.x/=u,z.y/=u,p._p=z,p._d=Mc(B)}}},handle_touchend:function(R){var u=this,x=u.gv,c=u._57I,z=u._data;if(c&&(Jf(c,Cd(R))<=1&&!x.getDataAt(R)&&x.sm().cs(),u._57I=h),z&&x.handleMouseUp&&x.handleMouseUp(R,z),u.pendingClickThrough){if(Jf(u.pendingClickThrough,Cd(R))<=1){var z=x.getDataAt(R);if(z instanceof Ho&&z.isClickThroughEnabled()){var M=x.getDataAt(R,function(G){var B=G.getParent()===z&&x.isSelectable(G,!0);return B});M&&(R.clickThrough=!0,x.sm().ss(M))}}u.pendingClickThrough=h}},handleWindowTouchEnd:function(m){this.clear(m)},handleWindowTouchMove:function($){var C=this,d=C.gv,O=uh($);if(1===O){var e=Cd($),x=cm(d,e,C._lastClientPoint),H=Jf({x:0,y:0},x);if(C._editing&&(C._beginHistory||(C._beginHistory=1,d.dm().beginTransaction()),d._editing=1,C._78I($)),C._moving){if(!d._moving&&H<l.touchMoveThreshold)return;C._beginHistory||(C._beginHistory=1,d.dm().beginTransaction()),C.handleMove($)}else if(C._panning){if(!d._panning&&H<l.touchMoveThreshold)return;d.setTranslate(C._translate.x+x.x,C._translate.y+x.y),C.fi({kind:d._panning?"betweenPan":"beginPan",event:$}),d._panning=1}}else if(2===O&&C._pinching){var J=Mc($);d.handlePinch(C._p,J,C._d),C._d=J,C.fi({kind:d._pinching?"betweenPinch":"beginPinch",event:$}),d._pinching=1}},handleMove:function(r){var I=this,D=I.gv,E=D.lp(r);D._93O&&D._93O(r,I._data)||(D.moveSelection(E.x-I._lastLogicalPoint.x,E.y-I._lastLogicalPoint.y),I._lastLogicalPoint=E,I.autoScroll(r),I.fi({kind:D._moving?"betweenMove":"beginMove",event:r}),D._moving=1)}});var R=P.ht,Sg=R.graph._editor={Math:R.Math,Guide:{}};Sg.getStyle=function(s){var c,G=Sg.StyleMap;return G&&(c=G[s],c!==B)?c:Sg.DefaultStyleMap[s]},Sg.setStyle=function(A,h){var w=Sg.StyleMap;w||(w=Sg.StyleMap={}),w[A]=h},Sg.inEdit=function(M){return M._inXEdit===!0},Sg.startEdit=function(E){E._inXEdit=!0,Sg.Inject.doInject(E)},Sg._46O=function(O){O._inXEdit=!1,Sg.Inject.undoInject(O)},Sg.toScreenPosition=function(d,B){var g=d.tx(),N=d.ty(),A=d._zoom;return new Sg.Math.Vector2(B.x*A+g,B.y*A+N)},Sg.checkHit=function(H,i,v){return H.distanceTo(i)<v?!0:!1},Sg.toWorldPosition=function(R,j){var H=R.tx(),t=R.ty(),B=R._zoom;return{x:(j.x-H)/B,y:(j.y-t)/B}},Sg.setAntialias=function(z,E){for(var I,f=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],c=0,m=f.length;m>c&&(I=f[c],!(I in z));c++);z[I],z[I]=E},Sg.getTargetCornersOnScreen=function(d,k){if(!k)return null;var N,i=[];if(Yq(k,d)){var T=ji(d,k);N=[{x:T.x,y:T.y},{x:T.x+T.width,y:T.y},{x:T.x+T.width,y:T.y+T.height},{x:T.x,y:T.y+T.height}]}else{if(!k.getCorners)return null;N=k.getCorners()}return N.forEach(function(Y){var D=Sg.toScreenPosition(d,Y);i.push(D.x,D.y)}),i},Sg.log=function(){};var Hh=Sg.Inject={_modules:[]};Hh.registAsModule=function(j,O){var N={},$={};for(var e in j){var R=O.prototype[e];N[e]=R}j.getBackup=function(n){return N[n]},j.getBackups=function(){return N},$.doInject=function(){for(var y in j)"getBackup"!==y&&(O.prototype[y]=j[y])},$.undoInject=function(){for(var $ in j)"getBackup"!==$&&(O.prototype[$]=N[$])},Hh._modules.push($)},Hh.doInject=function(W){for(var c,k=Hh._modules,G=0,A=k.length;A>G;G++)c=k[G],c.doInject(W)},Hh.undoInject=function(k){for(var e,T=Hh._modules,H=0,i=T.length;i>H;H++)e=T[H],e.undoInject(k)};var ro=R.graph.EditInteractor=function(W){var q=this,K=N.createElement("canvas");K.className="editCanvas",K.style.position="absolute",q._styleMap={},q._canvas=K,q._context=K.getContext("2d"),ro.superClass.constructor.call(q,W),this._editDetail=!1,Sg.setAntialias(q._context,!1),q._subModules=[new Sg.Anchor(q),new Sg.RotateX(q),new Sg.MoveDummy(q),new Sg.Rect(q),new Sg.Curve(q),new Sg.MoveHelper(q)],q._gridGuide=new Sg.Guide.Grid(q),q._rectGuide=new Sg.Guide.Rect(q),q._hoverGuide=new Sg.Guide.Hover(q)},vq=ro;R.Default.def(ro,R.graph.Interactor,{ms_edit:1,ms_fire:1}),w.defineProperties(ro.prototype,{editDetail:{get:function(){var c=!!this._editDetail;return c},set:function(b){var A=this,J=A._editDetail;J!==b&&(A._editDetail=b,A.gv._editing=b,A.fp("editDetail",J,b),A.fp("pointsEditingMode",J,b),A.fi({kind:b?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(p){(!this._editDetail||p)&&(this.gv._editing=p,p||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(o){this._editing=o,this.gvEditing=o}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(g){var r=this;r.editDetail!==g&&(g?r._tryEnterEditDetailMode():r._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var p=this._gridEnabled;if(!p)return!1;var l=this.gv;return l?!0:!0},set:function(D){D!==this._gridEnabled&&(this._gridEnabled=D,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(n){n!==this._agEnabled&&(this._agEnabled=n,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),ro.prototype.getSubModule=function(l){var I,P,x,s=this._subModules;for(P=0,x=s.length;x>P;P++)if(I=s[P],I.catalog===l)return I},ro.prototype.invokeSubModule=function(c,S){for(var m,r,n,W=this,p=W._subModules,z=Array.prototype.slice.call(arguments,2),u=0,h=p.length;h>u;u++)if(m=p[u],r=m[c],r&&(n=r.apply(m,z),n!=B&&S))return m},ro.prototype.invokeSubModuleInverse=function(r,j){var V=this,X=V._subModules;
if(X)for(var q,u,A,z=Array.prototype.slice.call(arguments,2),L=X.length-1;L>=0;L--)if(q=X[L],u=q[r],u&&(A=u.apply(q,z),A!=B&&j))return q},ro.prototype.setUp=function(){Sg.log("setUp");var R=this,z=R.gv,g=z.getView(),s=R._canvas;ro.superClass.setUp.call(R),z.setEditInteractor(R),z._79O?g.insertBefore(s,z._79O):g.appendChild(s),Sg.startEdit(z),R.invokeSubModule("setUp"),z.dm().mm(R._onDataModelChanged,R),z.dm().md(R._onDataPropertyChanged,R)},ro.prototype.tearDown=function(){Sg.log("tearDown");var E=this,r=E.gv,i=r.getView();E._resetCustomCursorStyle(),ro.superClass.tearDown.call(E),r.dm().umm(E._onDataModelChanged,E),r.dm().umd(E._onDataPropertyChanged,E),r.setEditInteractor(null),i.removeChild(E._canvas),E._drawTimer&&(vc(E._drawTimer),E._drawTimer=null),Sg._46O(r),E.invokeSubModule("tearDown")},ro.prototype._onDataModelChanged=function(F){var V=this;("clear"===F.kind||"remove"===F.kind&&V.editDetail&&F.data===V.getSubModule("Curve").target)&&(V.editDetail=!1,V._42())},ro.prototype._onDataPropertyChanged=function(U){var k=this;if(k.editDetail){var V=k.getSubModule("Curve"),d=U.data;d===V.target&&(d._writing||V._handleDataChanged(U))}},ro.prototype.clear=function(){Sg.log("clear")},ro.prototype.redraw=function(){this._42()},ro.prototype._42=function(){var Q=this;Q._drawTimer||(Q._drawTimer=kl(function(){Q._drawTimer=null,Q.drawImpl()},0))},ro.prototype.drawImpl=function(){var K;for(K in{_42:!0})break;return function(){var T=this,x=T._canvas,g=T.gv,G=g.getWidth(),O=g.getHeight(),B=T._context,e=R.Default.getInternal(),q=l.devicePixelRatio;(x.width!==G||x.height!==O)&&e.setCanvas(x,G,O,q),B.clearRect(0,0,x.width,x.height);var W=T._getValidSelection();B.save(),B.scale(q,q),T._gridGuide._42(),T.invokeSubModuleInverse(K,!1,B,g,W),T._rectGuide._42(),T._hoverGuide._42(),B.restore()}}(),ro.prototype._getValidSelection=function(){var J=this,l=J.gv,Z=l.sm().getSelection(),z=[];return Z.each(function(X){l.isVisible(X)&&l.isEditable(X)&&z.push(X)}),z},ro.prototype.handle_touchmove=function(I){return this.handle_mousemove(I)},ro.prototype.handle_mousemove=function(h){if(!R.Default.isDragging()){var k=this;if((k.editDetail||!fr()&&!$q(h))&&!k.gv._externalEditing)if(k.gvEditing=!1,k._checkEdit(h))k.gvEditing=!0;else{if(!k.getStyle("hoverGuideVisible"))return;k.hoverData=k.gv.getDataAt(h),k._42()}}},ro.prototype.handle_touchstart=function(k){return this.handle_mousedown(k)},ro.prototype.handle_mousedown=function(h){jr(h);var y=this;if((y.editDetail||!fr()&&!$q(h))&&!y.gv._externalEditing){if(xi(h)&&!h.clickThrough){if(y.editDetail){if(y._tryQuitEditDetailMode(h))return}else if(y._tryEnterEditDetailMode())return;y.gv.dm().beginTransaction();var m=y.invokeSubModule("handleDoubleClick",!0,h);if(y.gv.dm().endTransaction(),m)return}var U=y._checkEdit(h);U&&(y._downPosition=y._getLogicalPoint(h),y.gv.dm().beginTransaction(),U.startEdit(y,h),y.editing=!0)}},ro.prototype._checkEdit=function(e){var v=this,z=v.gv,R=v._getLogicalPoint(e),J=v.invokeSubModule("check",!0,z,e,R)||null;return v._editMod=J,J},ro.prototype.handleWindowTouchMove=function(V){return this.handleWindowMouseMove(V)},ro.prototype.handleWindowMouseMove=function(S){var y=this,s=y._downPosition;if(s){var W=y._getLogicalPoint(S);if(W.distanceTo(s)<y.getStyle("moveSensitivity"))return;delete y._downPosition}var D=y._editMod;D&&D.handleEdit(y.gv,S)},ro.prototype._getLogicalPoint=function(i){var e=this,J=R.Default.getLogicalPoint(i,e._canvas);return new Sg.Math.Vector2(J)},ro.prototype.handleWindowTouchEnd=function(U){return this.handleWindowMouseUp(U)},ro.prototype.handleWindowMouseUp=function(){var A;for(A in{_46O:!0})break;return function(O){var P=this;P.editing=!1,P.setCursor("default"),P.invokeSubModule(A,!1,O),P._42(),P.gv.dm().endTransaction()}}(),ro.prototype.handle_mousewheel=function(z){var u=this;jr(z),u.invokeSubModule("preHandleScroll",!0)||u.gv.handleScroll(z,z.wheelDelta)},ro.prototype.handleDelete=function(){var G=this;if(!G.editDetail){G.gv.dm().beginTransaction();var Q=G.invokeSubModule("handleNormalStateDelete",!0);return G.gv.dm().endTransaction(),Q||G.gv.removeSelection(),void 0}G.gv.dm().beginTransaction(),G.invokeSubModule("handleDelete",!0),G.gv.dm().endTransaction(),G._42()},ro.prototype.handle_keydown=function(t){var z=this;if((t.metaKey||t.ctrlKey)&&z._42(),fr(t)&&!z.editing)return z.gvEditing=!1,z.setCursor("default"),z._42(),void 0;var K=er(t);return z.editDetail?((K||oo(t))&&(z.editDetail=!1,z._42()),z.gv.dm().beginTransaction(),z.invokeSubModule("handle_keydown",!0,t),z.gv.dm().endTransaction(),void 0):(z.gv.dm().beginTransaction(),z.invokeSubModule("handleNormalStateKeyDown",!0,t),z.gv.dm().endTransaction(),K&&z._tryEnterEditDetailMode(),void 0)},ro.prototype.handle_keyup=function(e){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,e),this.gv.dm().endTransaction()},ro.prototype._tryEnterEditDetailMode=function(){var b=this;return!b.editDetail&&b.invokeSubModule("canEnterEditDetailMode",!0)&&1===b._getValidSelection().length?(b.editDetail=!0,b._42(),!0):void 0},ro.prototype._tryQuitEditDetailMode=function(G){var r=this;return r.editDetail?!G||r.invokeSubModule("canQuitEditDetailMode",!0,G)?(r.editDetail=!1,r._42(),!0):!1:!1},ro.prototype.setStyle=function(I,d,H){var R=this;H?Sg.setStyle(I,d):R._styleMap[I]=d,"baseColor"===I&&(Nm=d),R.fp("styleChanged",null,{key:I,value:d,base:H}),R._42()},ro.prototype.getStyle=function(n){var r=this,y=r._styleMap[n];return y!==B?y:Sg.getStyle(n)},ro.prototype.setCursor=function(r){this._resetCustomCursorStyle(),R.graph.EditInteractor.superClass.setCursor.call(this,r)},ro.prototype._drawHostGuide=function(e){var u=this,v=u._context,q=u.gv;Sg.Icons.DrawIcon(u,v,Sg.Icons.NodeHoverGuide,e.corners);var H=e.host;if(H){var z=q.getAttachPoints(H);if(z&&z.length)for(var h=0,j=z.length;j>h;h++){var k=z[h],m=Hg(q,H,0,k.offsetX||0,k.offsetY||0,k.x,k.y);m=Sg.toScreenPosition(q,m),m.isAttach=e.attach===h,Sg.Icons.DrawIcon(u,v,Sg.Icons.AttachPoint,m)}}},ro.prototype._resetCustomCursorStyle=function(){var X=this;if(X._customStyle){var _=this.gv.getView();_.classList&&_.classList.remove&&_.classList.remove(X._customStyle),X._customStyle=null}},ro.prototype._setRotateCursor=function(q){var n=this,e=n._cursorFactory;e||(e=n._cursorFactory=new Sg.CursorFactory(n));var Y=e.getRotateCursor(q),$=n.gv.getView();n._resetCustomCursorStyle(),n._customStyle=Y,$.classList&&$.classList.add&&$.classList.add(Y)};var Od=Sg.Group=function(v){var Q=this;Q._entities=v,Q._64O=0,Q._position={x:0,y:0},Q._scale={x:1,y:1},Q._anchor={x:.5,y:.5},Q._anchor2={x:.5,y:.5}};Od.prototype={},Od.prototype.constructor=Od;var nc=null;Od.findOrCreateGroup=function(V){if(nc&&nc.checkIsMe(V))return nc;var N=new Sg.Group(V);return N.getKeyOb()?(nc=N,N):void 0},Od.prototype.checkIsMe=function(e){var $=this._entities;if($.length!==e.length)return!1;var q,L={},x=e.length;for(q=0;x>q;q++)L[e[q]._id]=!0;for(q=0;x>q;q++)if(!L[$[q]._id])return!1;return!0},Od.prototype.getRotation=function(){return this._64O},Od.prototype.getPosition=function(){return this._position},Od.prototype.getAnchor=function(){return this._anchor},Od.prototype.getWidth=function(){return this._width},Od.prototype.getScale=function(){return this._scale},Od.prototype.getSize=function(){return{width:this._width,height:this._height}},Od.prototype.getHeight=function(){return this._height},Od.prototype.getKeyOb=function(){for(var d=this._entities,x=d.length-1;x>=0;x--){var K=d[x];if(this.isNode(K))return K}},Od.prototype.getAnchor2=function(){var z=this,h=z.rotateCenter;if(h)return h;var c=z.getKeyOb();if(!c)return z._anchor;var o=z._anchor2,p=c.getMatrix();return p.tf({x:c.getWidth()*(o.x-c.getAnchor().x),y:c.getHeight()*(o.y-c.getAnchor().y)})},Od.prototype.setAnchor2=function(A,Y){var w=this,$=w.getKeyOb();if($){var W,b=$.getMatrix();W="number"==typeof A?{x:A,y:Y}:A;var k=b.tfi(W);w._anchor2={x:$.getAnchor().x+k.x/$.getWidth(),y:$.getAnchor().y+k.y/$.getHeight()}}},Od.prototype.setRotation=function(){},Od.prototype.beginRotate=function(x){this.rotateCenter=x.pos,this.rotateMode=x.groupRotateMode},Od.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Od.prototype.addRotation=function(C,b,B){return"batch"===b?this._addRotationInBatchMode(C,B):"block"===b?this._addRotationInBlockMode(C,B):void 0},Od.prototype._addRotationInBlockMode=function(X,c){var b=this,_=b.rotateCenter||b.getPosition();b._entities.forEach(function(W){if(b.isNode(W)&&(!c||c(W))){var D=W.getMatrix();D.translate(-_.x,-_.y),D.rotate(X),D.translate(_.x,_.y);var P=Math.sign(W.getScale().x);W.setRotation(Mj(D.b*P,D.a*P)),W.setPosition(D.tx,D.ty)}})},Od.prototype._addRotationInBatchMode=function(U,E){var B=this,t=B._anchor2;B._entities.forEach(function(w){if(B.isNode(w)&&(!E||E(w))){var s=w.getAnchor(),Y=w.getMatrix(),p=Y.tf({x:w.getWidth()*(t.x-s.x),y:w.getHeight()*(t.y-s.y)}),W=new Sg.Math.Matrix2d;W.set(Y.a,Y.b,Y.c,Y.d,Y.tx,Y.ty),W.translate(-p.x,-p.y),W.rotate(U),W.translate(p.x,p.y);var y=Math.sign(w.getScale().x);w.setRotation(Mj(W.b*y,W.a*y)),w.setPosition(W.tx,W.ty)}})},Od.prototype.setPosition=function(z){var m,t,E,w,G=this,s=G._position,U=z.x-s.x,q=z.y-s.y,I=G._entities;for(t=0,E=I.length;E>t;t++)m=I[t],Tn(m)&&(w=m.getPosition(),m.setPosition(w.x+U,w.y+q));G._position=z},Od.prototype.setScale=function(o,d){var J=this,D=o/J._scale.x,b=d/J._scale.y;J._adjustChildScaleOrSize(D,b,"size"),J._scale={x:o,y:d}},Od.prototype.getRect=function(){var Q=this,k=Q._position,U=Q._width,P=Q._height;return{x:k.x-U/2,y:k.y-P/2,width:U,height:P}},Od.prototype.setSize=function(t,a){var I=this,t=Math.max(1,t),a=Math.max(1,a),E=t/I._width,y=a/I._height;I._adjustChildScaleOrSize(E,y,"size"),I._width=t,I._height=a},Od.prototype._adjustChildScaleOrSize=function(g,H,h){var Q,q,m,e,b,n,U,F,z,u,w,I,o,r,C=this,J=C._position,y=C._entities,$=new Sg.Math.Matrix2d;for(q=0,m=y.length;m>q;q++)if(Q=y[q],C.isNode(Q)){if(e=Q.getPosition(),b=Q.getRotation(),n=Q.getWidth(),U=Q.getHeight(),F=Q.getScale(),w=F.x*n,I=F.y*U,$.identity().scale(w,I).rotate(b).translate(e.x,e.y).translate(-J.x,-J.y).rotate(-C._64O),b=Mj($.b*Math.sign(w),$.a*Math.sign(w)),$.scale(g,H),z=Math.cos(b),u=Math.sin(b),Math.abs(z)<.001?(o=$.b/u,r=-$.c/u):(o=$.a/z,r=$.d/z),"scale"===h)Q.setScale(o/n,r/U);else if("size"===h){var L=o/F.x,M=r/F.y;Q.setScale(Jp(o)*Math.abs(F.x),Jp(r)*Math.abs(F.y)),Q.setSize(Math.max(.1,Math.abs(L)),Math.max(.1,Math.abs(M)))}$.rotate(C._64O).translate(J.x,J.y),Q.setPosition($.tx,$.ty)}},Od.prototype.getMatrix=function(){var S=this,q=S._position,o=R.Default.getInternal(),J=S._scale;return new o.Mat(S._64O,q.x,q.y,J.x,J.y)},Od.prototype.toGlobal=function(L){return this.getMatrix().tf(L)},Od.prototype.getCorners=function(){var N=this,B=N._width,A=N._height,L=N._anchor,b=-B*L.x,K=-A*L.y,y=N.getMatrix();return[y.tf(b,K),y.tf(b,K+A),y.tf(b+B,K+A),y.tf(b+B,K)]},Od.prototype.calcInfo=function(){var v,k,o,e,I,S,s=this,T=[],K=s._entities,m=s._64O;for(e=0,I=K.length;I>e;e++)S=K[e],s.isNode(S)&&S.getCorners&&T.push.apply(T,S.getCorners());if(T.length){var F=Math.cos(-m),d=Math.sin(-m),Z=1/0,P=-1/0,W=1/0,l=-1/0;for(e=0,I=T.length;I>e;e++)o=T[e],v=o.x,k=o.y,o.x=F*v-d*k,o.y=d*v+F*k,Z=Math.min(Z,o.x),P=Math.max(P,o.x),W=Math.min(W,o.y),l=Math.max(l,o.y);s._width=(P-Z)/s._scale.x,s._height=(l-W)/s._scale.y,F=Math.cos(m),d=Math.sin(m);var U=s._anchor;v=Z+(P-Z)*U.x,k=W+(l-W)*U.y,s._position={x:F*v-d*k,y:d*v+F*k}}},Od.prototype.isNode=function(B){return Tn(B)?Yq(B)?B.size()?!1:!0:!0:!1},Od.prototype._42=function(G,v,k){var q,g,D,f,d,H,j,y,p=this,w=p._entities,U=p.rotateMode;for("batch"===U&&(y=p.getKeyOb()),q=0,g=w.length;g>q;q++)D=w[q],p.isNode(D)&&(H=D.getRect(),f=Sg.toScreenPosition(k,{x:H.x,y:H.y}),d=Sg.toScreenPosition(k,{x:H.x+H.width,y:H.y+H.height}),j={min:f,max:d},D===y&&(j.isKeyOb=!0),Sg.Icons.DrawIcon(G,v,Sg.Icons.GroupSubEntityRect,j))};var ii=Sg.CurveActiving=function(h,E){this._curve=h,this._interactor=h._interactor,this.silent=!0;for(var i in E)this[i]=E[i];delete this.silent};ii.prototype={},ii.prototype.constructor=ii,w.defineProperties(ii.prototype,{point:{get:function(){return this._point},set:function(q){var n=this;n._point=q,n.editingCtrl||n.silent||n._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(n){var p=this;p._pairs=n,p.editingCtrl&&!p.silent&&p._firePointChange()}}}),ii.prototype._firePointChange=function(){var H=this,A=H.getCurrentEditingPoint(),u=H._interactor;if(!A)return u.fi({kind:"selectPoint"}),void 0;var b=this._curve.target;if(b){var J=Sg.getDataMatrix(b).invert(),g=A.e;A=J.apply(Sg.toWorldPosition(u.gv,A)),A.e=g;var m=H._lastFirePoint;m&&Math.abs(A.x-m.x)<1e-5&&Math.abs(A.y-m.y)<1e-5&&(A.e==B&&m.e==B||Math.abs(A.e-m.e)<1e-5)||(H._lastFirePoint=A,u.fi({kind:"selectPoint",x:A.x,y:A.y,e:A.e}))}},ii.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},ii.prototype.getCurrentEditingPoint=function(){var b=this,d=b.editingCtrl;if(d){var C=b.pairs;if(C){var W=C[d.pairId];if(W){var i=W[d.type];if(i)return i}}}return b._point};var qi=Sg.CursorFactory=function(J){var x=this;x._interactor=J,x._rotateCursorStyles={}};qi.prototype={},qi.prototype.constructor=qi,qi.prototype.getRotateCursor=function(o){var e=this;0>o&&(o+=2*Math.PI);var c=e._interactor,y=c.getStyle("rotateCursorSize"),R=c.getStyle("rotateCursorRound"),O=Math.round(180*(o/Math.PI)/R);O*R>=360&&(O=0);var C=e._rotateCursorStyles,H="htCustomRotateStyle_"+y+"_"+R+"_"+O;return C[H]||(e._produceRotateCursor(H,y,R,O),C[H]=!0),H},qi.prototype._produceRotateCursor=function(u,n,F,G){var A=this;A._interactor;var U=A._canvas;U||(U=A._canvas=N.createElement("canvas"));var X=l.devicePixelRatio;U.width=U.height=n*X,U.style.width=U.style.height=n+" px";var b=U.getContext("2d");Sg.setAntialias(b,!1),b.scale(X,X);var Q,m,o,P,g,_=Math.round(n/2),c=""+_+" "+_+",auto !important;",p=4;Q=Math.PI/180*G*F,b.clearRect(0,0,n,n),b.save(),b.scale(n/32,n/32),b.translate(16,15),b.rotate(Q+Math.PI/2),b.beginPath(),b.moveTo(-8,0),b.lineTo(-8,p),b.lineTo(-8+p,p),b.moveTo(8,0),b.lineTo(8,p),b.lineTo(8-p,p),b.moveTo(-8,p),b.quadraticCurveTo(0,-6,8,p),b.restore(),b.lineCap="round",b.lineJoin="miter",b.strokeStyle="white",b.lineWidth=4,b.stroke(),b.strokeStyle="black",b.lineWidth=2,b.stroke(),m=JSON.stringify(U.toDataURL()),P="cursor:url("+m+")"+c,1!==X&&(o='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+n+'px" height="'+n+'px"><image xlink:href='+m+' width="'+n+'" height="'+n+'"/></svg>',P+="cursor:url(data:image/svg+xml;base64,"+btoa(o)+")"+c,P+="cursor:-webkit-image-set(url("+m+")"+X+"x,url("+m+")1x)"+c),g=N.createElement("style"),g.textContent="body."+u+" *, ."+u+"{"+P+"}",N.head.appendChild(g)};var ic=Sg.Guide.Grid=function(x){var m=this;m._interactor=x,m._alignmentGuideId=0,m._xAlignmentGuide=[],m._yAlignmentGuide=[]};ic.prototype={},ic.prototype.constructor=ic,w.defineProperties(ic.prototype,{gridBlockSize:{get:function(){var s=this;return s._gridBlockSize||s._interactor.getStyle("gridBlockSize")},set:function(V){this._gridBlockSize=V,this._interactor._42()}},gridThickLinesEvery:{get:function(){var Q=this;return Q._gridThickLinesEvery||Q._interactor.getStyle("gridThickLinesEvery")},set:function(w){this._gridThickLinesEvery=w,this._interactor._42()}},gridEnabled:{get:function(){var k=this,i=k._interactor;return i.gridEnabled&&k.isValidGrid()}}}),ic.prototype._42=function(){var y=this,b=y._interactor;y.gridEnabled&&y.drawGrid(),b.alignmentGuideEnabled&&y.drawAlignmentGuide()},ic.prototype.makeMatrix=function(){var V=this,O=V._interactor.getStyle("gridAngle"),i=V._interactor.getStyle("gridRotation"),M=new Sg.Math.Matrix2d,z=Math.sin(O),q=Math.cos(O);return M.set(1,0,q,z,0,0),M.rotate(i),M},ic.prototype.isValidGrid=function(){var n=this,f=Math.PI,Q=n._interactor,s=Q.gv;if(s._zoom<Q.getStyle("gridZoomThreshold"))return!1;var C=Q.getStyle("gridAngle"),g=Math.abs(180*(C%f/f)),l=1-1e-8;return l>g||g>180-l?!1:!0},ic.prototype.drawAlignmentGuide=function(){var F=this,A=F._interactor,G=A.gv,L=A._canvas,r=A._context,e=L.width,C=L.height,Y=G.tx(),f=G.ty(),U=G._zoom;r.beginPath(),r.strokeStyle=A.getStyle("gridAlignmentGuideColor"),r.lineWidth=1,F._xAlignmentGuide.forEach(function(H){var W=H.p*U+Y;r.moveTo(W,0),r.lineTo(W,C)}),F._yAlignmentGuide.forEach(function(O){var F=O.p*U+f;r.moveTo(0,F),r.lineTo(e,F)}),r.stroke()},ic.prototype.drawGrid=function(){function X(u,B,Z,Q){var K=Sg.toScreenPosition(b,j.apply({x:u,y:B})),T=Sg.toScreenPosition(b,j.apply({x:Z,y:Q}));N.moveTo(K.x,K.y),N.lineTo(T.x,T.y)}var J=this,B=J._interactor,x=J.gridBlockSize,w=J.gridThickLinesEvery,q=B.getStyle("gridThickColor"),T=B.getStyle("gridLightColor"),b=B.gv,f=B._canvas,N=B._context,U=f.width,v=f.height,j=J.makeMatrix(),n=j.applyInverse(Sg.toWorldPosition(b,{x:0,y:0})),t=j.applyInverse(Sg.toWorldPosition(b,{x:U,y:0})),e=j.applyInverse(Sg.toWorldPosition(b,{x:0,y:v})),Z=j.applyInverse(Sg.toWorldPosition(b,{x:U,y:v})),i=Math.min(n.x,t.x,e.x,Z.x),k=Math.max(n.x,t.x,e.x,Z.x),V=Math.min(n.y,t.y,e.y,Z.y),m=Math.max(n.y,t.y,e.y,Z.y);U=k-i,v=m-V;var z=Math.ceil(i/x),E=Math.floor(k/x),r=Math.ceil(V/x),O=Math.floor(m/x);b.tx(),b.ty(),b._zoom;var C,a,h;for(N.save(),N.lineWidth=1,N.beginPath(),N.strokeStyle=q,h=Math.ceil(z/w)*w;E>=h;h+=w)C=h*x,X(C,V,C,m);for(h=Math.ceil(r/w)*w;O>=h;h+=w)a=h*x,X(i,a,k,a);for(N.stroke(),N.beginPath(),N.strokeStyle=T,h=z;E>=h;h++)0!==h%w&&(C=h*x,X(C,V,C,m));for(h=r;O>=h;h++)0!==h%w&&(a=h*x,X(i,a,k,a));N.stroke(),N.restore()},ic.prototype.getAlignmentGuides=function(){var r=this;return{x:r._xAlignmentGuide,y:r._yAlignmentGuide}},ic.prototype.addAlignmentGuide=function(e,m,p){var d=this,O="x"===e?d._xAlignmentGuide:d._yAlignmentGuide,p=p?p:++d._alignmentGuideId,S={p:m,id:p};if(O.length){var i=d._findClosestAlignmentGuide(S.p,O);i.dis<0?O.splice(i.index+1,0,S):O.splice(i.index,0,S)}else O.push(S);return d._interactor._42(),p},ic.prototype.findClosest=function(T,a,P){var x=this,U=x._interactor,q=U.gv;P&&(T=Sg.toWorldPosition(q,T));var Y,G,c,K=1/0,z=1/0,D=T.x,h=T.y;if(x.gridEnabled){var F=x.gridBlockSize,b=x.makeMatrix(),u=b.applyInverse(T);u=b.apply({x:Math.round(u.x/F)*F,y:Math.round(u.y/F)*F}),K=u.x-D,z=u.y-h,c=!0}if(U.alignmentGuideEnabled&&(Y=x._findClosestAlignmentGuide(D,x._xAlignmentGuide).dis,G=x._findClosestAlignmentGuide(h,x._yAlignmentGuide).dis,Math.abs(Y)<Math.abs(K)&&(K=Y,c=!0),Math.abs(G)<Math.abs(z)&&(z=G,c=!0)),c){c=!1;var O=q._zoom,f=U.getStyle("smartGuideThreshold")/O,$={};if(Math.abs(K)<f&&"y"!==a&&($.x=P?K*O:K,c=!0),Math.abs(z)<f&&"x"!==a&&($.y=P?z*O:z,c=!0),c)return $}},ic.prototype._findClosestAlignmentGuide=function(n,c){if(!c.length)return{dis:1/0};for(var h,J=0,W=c.length-1;W-J>1;)h=Math.floor((J+W)/2),c[h].p<n?J=h:W=h;var I=c[J].p-n,L=c[W].p-n;return Math.abs(I)<=Math.abs(L)?{line:c[J],dis:I,index:J}:{line:c[W],dis:L,index:W}},ic.prototype.removeAllAlignmentGuide=function(B){var D=this;"y"!==B&&(D._xAlignmentGuide=[]),"x"!==B&&(D._yAlignmentGuide=[]),D._interactor._42()},ic.prototype.removeAlignmentGuide=function(G){for(var s,B,m,r=this,I=r._xAlignmentGuide,_=0;2>_;_++)for(I=0===_?r._xAlignmentGuide:r._yAlignmentGuide,s=0,B=I.length;B>s;s++)if(m=I[s],m.id===G)return I.splice(s,1),r._interactor._42(),{axis:0===_?"x":"y",position:m.p};return!1},ic.prototype.adjustAlignmentGuide=function(q,e){var s=this,u=s.removeAlignmentGuide(q);return u?(s.addAlignmentGuide(u.axis,e,q),!0):!1};var Qf=Sg.Guide.Rect=function(k){var V=this;V._interactor=k};Qf.prototype={},Qf.prototype.constructor=Qf,Qf.prototype.gatherRects=function(){var o,Y,W,j,u=this,h=u._interactor.gv,v=[],G=[],O={x:v,y:G},b={},c=h.getDataModel(),C=c.a("width"),F=c.a("height");C&&F&&(o=0,Y=0,W=C,j=F,v.push({node:c,type:0,p:o},{node:c,type:1,p:o+W/2},{node:c,type:2,p:o+W}),G.push({node:c,type:0,p:Y},{node:c,type:1,p:Y+j/2},{node:c,type:2,p:Y+j}),b[c._id||0]={x:o,y:Y,width:W,height:j}),c.each(function(Z){if(Tn(Z)&&!h.isSelected(Z)&&h.isVisible(Z)&&h.isValidGuideLineSource(Z)){var R=!1;if(h.sm().getSelection().each(function(H){R||(Z.isHostOn(H)?R=!0:Z.isDescendantOf(H)&&(R=!0))}),!R){var C=Z.getRect();o=C.x,Y=C.y,W=C.width,j=C.height,v.push({node:Z,type:0,p:o},{node:Z,type:1,p:o+W/2},{node:Z,type:2,p:o+W}),G.push({node:Z,type:0,p:Y},{node:Z,type:1,p:Y+j/2},{node:Z,type:2,p:Y+j}),b[Z._id]=C}}}),v.sort(function(r,l){return r.p-l.p}),G.sort(function(R,Z){return R.p-Z.p}),u._grid=O,u._87I=b},Qf.prototype.gatherLines=function(R,p,y){var X,k,m,q,a,V,w,D,Q,v,A,u,o=this,Y=[o.findClosest({x:R.x,y:R.y},p),o.findClosest({x:R.x+R.w/2,y:R.y+R.h/2},p),o.findClosest({x:R.x+R.w,y:R.y+R.h},p)],c={},e=o._87I;y=y||255;var P,I;for(o._guideLine=[],X=0;2>X;X++)for(c={},0===X?(q="y",D=R.x,Q=D+R.w):(q="x",D=R.y,Q=D+R.h),k=0;3>k;k++)a=Y[k],a&&isFinite(a[q])&&(P=1<<3*X+k,y&P&&(V=a[q+"Line"],w=V.node,I=w._id||0,c[I]||(c[I]=!0,u=e[I],"y"===q?(v=u.x,A=u.x+u.width):(v=u.y,A=u.y+u.height),m=V.p,o._guideLine.push({type:q,a:D,b:Q,c:v,d:A,p:m,center:1===V.type}))))},Qf.prototype._binarySearchClosest=function(_,u){if(!u.length)return{dis:1/0};for(var b,r=0,w=u.length-1;w-r>1;)b=Math.floor((r+w)/2),u[b].p<_?r=b:w=b;var d=u[r].p-_,T=u[w].p-_;return Math.abs(d)<=Math.abs(T)?{line:u[r],dis:d}:{line:u[w],dis:T}},Qf.prototype.findClosest=function(E,w,H){var P=this,q=P._interactor,n=q.gv,r=P._grid;H&&(E=Sg.toWorldPosition(n,E));var t,R=P._binarySearchClosest(E.x,r.x),L=P._binarySearchClosest(E.y,r.y),u=R.dis,x=L.dis,z=n._zoom,X=q.getStyle("smartGuideThreshold")/z,T={};return Math.abs(u)<X&&"y"!==w&&(T.x=H?u*z:u,T.xLine=R.line,t=!0),Math.abs(x)<X&&"x"!==w&&(T.y=H?x*z:x,T.yLine=L.line,t=!0),t?T:void 0},Qf.prototype._42=function(){var u=this,V=u._guideLine;if(V&&!R.Default.isCtrlDown()){var P=u._interactor;if(P.getStyle("guideLineVisible")){var N,s,k,X,o,b,I,g,L,l,r,c,$,a,f,w,q,n=P.gv,W=P._context,h=n.tx(),v=n.ty(),U=n._zoom,F=P.getStyle("guideLineTextSpacing");for(N=0,s=V.length;s>N;N++)k=V[N],g=k.type,L=k.p,l=k.a,r=k.b,c=k.c,$=k.d,a=Math.min(l,c),f=Math.max(r,$),"x"===g?(X=L*U+h,o=a*U+v,b=X,I=f*U+v):(X=a*U+h,o=L*U+v,b=f*U+h,I=o),Sg.Icons.DrawIcon(P,W,Sg.Icons.MoveLineGuide,{rect:[X,o,b,I],center:k.center}),$>=l&&r>=c||(a=l>$?$:r,f=l>$?l:c,q=f-a,"x"===g?(k.center2center||(X-=F,b=X),o=a*U+v,I=f*U+v,w=Sg.Icons.MoveLineGuideDistanceV):"y"===g&&(k.center2center||(o-=F,I=o),X=a*U+h,b=f*U+h,w=Sg.Icons.MoveLineGuideDistanceH),Sg.Icons.DrawIcon(P,W,w,{x0:X,y0:o,x1:b,y1:I,dis:q}))}}},Qf.prototype.clear=function(){this._guideLine=null};var ik=Sg.Guide.Hover=function(W){var j=this;j._interactor=W};ik.prototype={},ik.prototype.constructor=ik,w.defineProperties(ik.prototype,{}),ik.prototype._42=function(){var W=this._interactor;if(W.getStyle("hoverGuideVisible")&&!W.gvEditing){var i=W.hoverData,o=W.gv;if(!Tn(i)||o.isSelected(i))return W.hoverData=null,void 0;var Q=ji(o,i),j=Sg.toScreenPosition(o,{x:Q.x,y:Q.y}),Z=Sg.toScreenPosition(o,{x:Q.x+Q.width,y:Q.y+Q.height});Sg.Icons.DrawIcon(W,W._context,Sg.Icons.HoverDataRect,{min:j,max:Z,color:W.getStyle("hoverGuideColor")||W.getStyle("baseColor")})}},Sg.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var cp=Sg.Icons={},ir=1e4,Xn=null,Nm=Sg.DefaultStyleMap.baseColor,ko="rgb(183,232,135)",Ac="rgb(255,204,153)",wb=6;R.Default.setImage("Icons.RectPoint",{width:wb,height:wb,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Nm}},rect:[0,0,wb,wb]}]}),cp.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var L=cp.GroupSubEntityRect.data;if(!L)return[];var n=L.min,p=L.max;return[n.x,n.y,n.x,p.y,p.x,p.y,p.x,n.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return cp.GroupSubEntityRect.data.isKeyOb?Nm:Nm}}}]};var Il=4;cp.HoverDataRect={comps:[{type:"shape",points:{func:function(){var J=cp.HoverDataRect.data;if(!J)return[];var X=J.min,N=J.max,F=Il;return X.x-=F,X.y-=F,N.x+=F,N.y+=F,[X.x,X.y,X.x,N.y,N.x,N.y,N.x,X.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return cp.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},cp.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[cp.Line.data.P1.x,cp.Line.data.P1.y],wb,wb]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[cp.Line.data.P2.x,cp.Line.data.P2.y],wb,wb]}}}]},cp.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return cp.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},cp.Rect={comps:[{type:"shape",points:{func:function(){var f=cp.Rect.data;if(!f)return[];var J=f.LT,_=f.LB,F=f.RB,e=f.RT;return[J.x,J.y,_.x,_.y,F.x,F.y,e.x,e.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Nm}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return cp.Rect.data.rotation}},rect:{func:function(){return[[cp.Rect.data.LT.x,cp.Rect.data.LT.y],wb,wb]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return cp.Rect.data.rotation}},rect:{func:function(){return[[cp.Rect.data.LB.x,cp.Rect.data.LB.y],wb,wb]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return cp.Rect.data.rotation}},rect:{func:function(){return[[cp.Rect.data.RB.x,cp.Rect.data.RB.y],wb,wb]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return cp.Rect.data.rotation}},rect:{func:function(){return[[cp.Rect.data.RT.x,cp.Rect.data.RT.y],wb,wb]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return cp.Rect.data.rotation}},visible:{func:function(){return cp.Rect.data.L?!0:!1}},rect:{func:function(){return[[cp.Rect.data.L.x,cp.Rect.data.L.y],wb,wb]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return cp.Rect.data.rotation}},visible:{func:function(){return cp.Rect.data.R?!0:!1}},rect:{func:function(){return[[cp.Rect.data.R.x,cp.Rect.data.R.y],wb,wb]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return cp.Rect.data.rotation}},visible:{func:function(){return cp.Rect.data.T?!0:!1}},rect:{func:function(){return[[cp.Rect.data.T.x,cp.Rect.data.T.y],wb,wb]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return cp.Rect.data.rotation}},visible:{func:function(){return cp.Rect.data.B?!0:!1}},rect:{func:function(){return[[cp.Rect.data.B.x,cp.Rect.data.B.y],wb,wb]}}}]};var Ti=16;R.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return Nm}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return Nm}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),cp.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[cp.Anchor.data.POS.x,cp.Anchor.data.POS.y],Ti,Ti]}}}]},cp.TipShiftX=12,cp.TipShiftY=12;var cf=[8,28];cp.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[cp.TipHelper.data.helperPos.x,cp.TipHelper.data.helperPos.y,cf[0]*cp.TipHelper.data.size,cf[1]]}},background:{func:function(){return Xn.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return cp.TipHelper.data.text}},rect:{func:function(){return[cp.TipHelper.data.helperPos.x,cp.TipHelper.data.helperPos.y,cf[0]*cp.TipHelper.data.size,cf[1]]}},color:{func:function(){return Xn.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Fe=7;cp.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!cp.ShapePoint.data.dynamicVisible}},rect:{func:function(){var x=cp.ShapePoint.data.point,C=cp.ShapePoint.data.size||Fe;return[x,C+10,C+10]}},background:{func:function(){var Y=Date.now(),L=cp.ShapePoint.data.dynamicPeriod||1500,h=Math.sin(Y%L/L*Math.PI);return"rgba(27,124,22,"+.5*h+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var S=cp.ShapePoint.data.point,T=cp.ShapePoint.data.size||Fe;return[S,T,T]}},background:{func:function(){var l=cp.ShapePoint.data.isEnd;return l?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return cp.ShapePoint.data.color||Nm}}},{type:"rect",visible:{func:function(){return!!cp.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return Nm}},rect:{func:function(){var u=5;return[cp.ShapePoint.data.point,u,u]}}}]},cp.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!cp.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return cp.ShapeBgCurve.data.P}},segments:{func:function(){return cp.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var V=Date.now(),x=cp.ShapeBgCurve.data.dynamicPeriod||1500,I=Math.sin(V%x/x*Math.PI);return"rgba(27,124,22,"+.3*I+")"}}},{type:"shape",points:{func:function(){return cp.ShapeBgCurve.data.P}},segments:{func:function(){return cp.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return cp.ShapeBgCurve.data.color||Nm}}}]};var vl=8;cp.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var p=cp.ShapeHighlighPoint.data;return[[p.x,p.y],vl,vl]}},background:{func:function(){return Xn.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Vp=10;cp.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var e=cp.ShapeHighlighRealPoint.data;return[[e.x,e.y],Vp,Vp]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return Nm}}}]};var _k=8;cp.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var K=cp.ShapeHighlighCtrlPoint.data,n=K.x,e=K.y,G=_k/2;return[n-G,e-G,n-G,e+G,n+G,e+G,n+G,e-G]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Xn.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Xn.getStyle("shapeCtrlPointBorderColor")||Nm}}}]};var Fd=3;cp.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return cp.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Fd,borderColor:{func:function(){return Xn.getStyle("curveHighlightColor")}}}]},cp.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return cp.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},cp.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return cp.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return cp.MoveLineGuide.data.center?ko:Ac}}}]};var gd=5;
cp.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var _=cp.MoveLineGuideDistanceH.data,Z=_.x0,z=_.y0;return[Z,z-gd,Z,z+gd]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ac},{type:"shape",points:{func:function(){var s=cp.MoveLineGuideDistanceH.data,e=s.x1,M=s.y1;return[e,M-gd,e,M+gd]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ac},{type:"text",text:{func:function(){return Math.round(cp.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var l=cp.MoveLineGuideDistanceH.data;return[[(l.x0+l.x1)/2,l.y0-10],20,20]}},color:Ac,font:"12px Arial",align:"center"}]},cp.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var l=cp.MoveLineGuideDistanceV.data,J=l.x0,Q=l.y0;return[J-gd,Q,J+gd,Q]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ac},{type:"shape",points:{func:function(){var f=cp.MoveLineGuideDistanceV.data,B=f.x1,u=f.y1;return[B-gd,u,B+gd,u]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ac},{type:"text",text:{func:function(){return Math.round(cp.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var X=cp.MoveLineGuideDistanceV.data;return[[X.x0-10,(X.y0+X.y1)/2],20,20]}},color:Ac,font:"12px Arial",align:"center"}]},R.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),cp.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var _=cp.EdgeElevationGuide.data,u=_.x,E=_.y,d=Xn.getStyle("curveElevationIntersectSize"),B=Xn.getStyle("curveElevationGuideShift");return u+=B[0],E+=B[1],[u-d,E-d,2*d,2*d]}}}]},R.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),R.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),cp.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return cp.ConnectGuide.data.rotation}},rect:{func:function(){var x=cp.ConnectGuide.data.connect;x.x,x.y;var Z=Xn.getStyle("connectGuideIntersectSize");return[[x.x,x.y],2*Z,2*Z]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var s=cp.ConnectGuide.data.cursorPos||cp.ConnectGuide.data.connect,C=Xn.getStyle("connectGuideIntersectSize");return[[s.x,s.y],2*C-2,2*C-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var v=cp.ConnectGuide.data.connect,p=cp.ConnectGuide.data.cursorPos||v;return[v.x,v.y,v.x+.5*(p.x-v.x),v.y,p.x+.5*(v.x-p.x),p.y,p.x,p.y]}}}]},R.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),R.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),cp.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var w=cp.ConnectGuideGarbage.data.hover;return w?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var f=cp.ConnectGuideGarbage.data,l=Xn.getStyle("connectGuideGarbageIntersectsize");return f.hover&&(l+=5),[[f.x,f.y],2*l,2*l]}}}]};var jf=6;cp.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return cp.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var f=cp.ShapeActivingCtrl.data;return[f.point.x,f.point.y,f.c1.x,f.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Nm}}},{type:"shape",visible:{func:function(){return cp.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var W=cp.ShapeActivingCtrl.data;return[W.point.x,W.point.y,W.c2.x,W.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Nm}}},{type:"shape",visible:{func:function(){return cp.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var C=cp.ShapeActivingCtrl.data.c1,H=C.x,B=C.y,R=jf/2;return"c1"===cp.ShapeActivingCtrl.data.hl&&(R+=.5),[H-R,B-R,H-R,B+R,H+R,B+R,H+R,B-R]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Xn.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===cp.ShapeActivingCtrl.data.hl?Xn.getStyle("shapeCtrlPointHighlightBorder")||Nm:Xn.getStyle("shapeCtrlPointBorderColor")||Nm}}},{type:"shape",visible:{func:function(){return cp.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var o=cp.ShapeActivingCtrl.data.c2,A=o.x,C=o.y,m=jf/2;return"c2"===cp.ShapeActivingCtrl.data.hl&&(m+=.5),[A-m,C-m,A-m,C+m,A+m,C+m,A+m,C-m]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Xn.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===cp.ShapeActivingCtrl.data.hl?Xn.getStyle("shapeCtrlPointHighlightBorder")||Nm:Xn.getStyle("shapeCtrlPointBorderColor")||Nm}}}]},cp.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Nm}},rect:{func:function(){return[[cp.RoundPoint.data.x,cp.RoundPoint.data.y],wb,wb]}}}]},cp.AttachPoint={comps:[{type:"rect",background:{func:function(){return cp.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return Nm}},rect:{func:function(){var _=cp.AttachPoint.data.isAttach?wb+4:wb;return[[cp.AttachPoint.data.x,cp.AttachPoint.data.y],_,_]}}}]},cp.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return cp.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return cp.SimpleRect.data.color||Nm}},rect:{func:function(){var B=cp.SimpleRect.data;return[B.x,B.y,B.width,B.height]}}}]},R.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),cp.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var G=cp.MoveDummy.data;return[[G.pos.x,G.pos.y],2*G.size,2*G.size]}}}]},Sg.Icons.DrawIcon=function(n,e,Z,F){Z.width=Z.height=ir,Z.data=F,Xn=n,R.Default.drawImage(e,Z,0,0,ir,ir)},Sg.Icons.MapPoints=function(w,x){for(var f=0,W=w.length;W>f;f++)w[f]/=x},Sg.roundTo=function(P,c,F){var Y=Math.abs(P%c);return F>Y||F>c-Y?c*Math.round(P/c):P},Sg.toFixed=function(Q){return Math.round(100*Q)/100},Sg.getDataMatrix=function(q){if(q instanceof R.Shape){var D=new R.Math.Matrix2d,J=q.getPosition();return D.translate(-J.x,-J.y).scale(q.getScale().x,q.getScale().y).rotate(q.getRotation()).translate(J.x,J.y),D}return q.getMatrix?q.getMatrix():new R.Math.Matrix2d};var pp=Sg.Math.Curve=function(){this._curves=[]};pp.prototype={},pp.prototype.constructor=pp,pp.prototype.createFromHtShape=function(i,F,g){F instanceof R.List&&(F=F.toArray());var o,G,T,C,h,r,q,N=this,J=null,E=null,z=0,X=Sg.Math.Vector2,p=Sg.Math.CubicBezier,w=function(n){return new X(i[n],i[n+1],g?g[n/2]:B)};for(G=0,T=F.length;T>G;G++){switch(C=F[G],h=null,C){case 1:E=w(z),J=E,z+=2;break;case 2:o=w(z),z+=2,h=new p(E,E.clone(),o.clone(),o),E=o;break;case 3:r=w(z),o=w(z+2),z+=4,h=new p(E,r.clone().sub(E).multiplyScalar(2/3).add(E),r.clone().sub(o).multiplyScalar(2/3).add(o),o),E=o;break;case 4:r=w(z),q=w(z+2),o=w(z+4),z+=6,h=new p(E,r,q,o),E=o;break;case 5:if(!J)break;h=new p(E,E.clone(),J.clone(),J),E=null,J=null}h&&(h._index=N._curves.length,N._curves.push(h))}},pp.prototype.checkPoint=function(H,d){var F,K,$,E,x,P=this,G=P._curves;for(F=0,K=G.length;K>F;F++)if(E=G[F],x=E.intersectRect(H,d,d),x.length)return $=0,x.forEach(function(H){$+=H.t}),$/=x.length,H=E.getPointAt($),H.t=$,{bezier:E,intersection:H}},pp.prototype.insertKnot=function(R,y){var p=R.insertKnot(y),O=this,b=O._curves;b.splice(R._index,1,p[0],p[1])},pp.prototype._isCloseEnough=function(h,y){return Math.abs(h.x-y.x)<1e-6&&Math.abs(h.y-y.y)<1e-6},pp.prototype._isSamePoint=function(X,e){return X===e},pp.prototype.moveRealPoint=function(S,L){var o=this,j=o._curves,R=L.clone().sub(S);j.forEach(function(O){var X=O._p1;O._p2,O._p3;var Z=O._p4;o._isSamePoint(X,S)&&(O._p2.add(R),O._p1=L),o._isSamePoint(Z,S)&&(O._p3.add(R),O._p4=L)})},pp.prototype.moveCtrlDueToRealPointMovement=function(_,F){var D=this,l=D._curves,J=function(p){p.add(F),p.e&&F.e&&(p.e+=F.e)};l.forEach(function(h){var j=h._p1;h._p2,h._p3;var U=h._p4;D._isSamePoint(j,_)&&J(h._p2),D._isSamePoint(U,_)&&J(h._p3)})},pp.prototype.moveCtrlPoint=function(x,N,p){var C=x[p];if(C){C.e!==B&&(N.e=C.e);var E=this,k=E._curves;N.clone().sub(C),k.forEach(function(R){var J;"c2"===p?J="_p2":"c1"===p&&(J="_p3"),E._isSamePoint(R[J],C)&&(R[J]=N)}),x[p]=N}},pp.prototype.deleteRealPoint=function(P,U){var Z,x,O,V,y,a,n,j=this,$=j._curves,W={},d=[],k=Sg.Math.CubicBezier;for(x=0,O=$.length;O>x;x++)Z=$[x],V=Z._p1,y=Z._p2,a=Z._p3,n=Z._p4,(W[x]||!j._isSamePoint(V,P))&&(j._isSamePoint(n,P)?O>x+1&&j._isSamePoint($[x+1]._p1,P)&&(U||d.push(new k(V,y,$[x+1]._p3,$[x+1]._p4))):d.push(Z));j._curves=d},pp.prototype.findPairs=function(e,B){var o,q,N,m,U,l,P,F,R=this,n=R._curves,k={},A=[];for(q=0,N=n.length;N>q;q++)o=n[q],m=o._p1,U=o._p2,l=o._p3,P=o._p4,!k[q]&&R._isSamePoint(m,e)&&(B?A.push({point:m,r2:P}):A.push({point:m,c2:U})),R._isSamePoint(P,e)&&(F=B?{point:P,r1:m}:{point:P,c1:l},N>q+1&&R._isSamePoint(n[q+1]._p1,e)&&(B?F.r2=n[q+1]._p4:F.c2=n[q+1]._p2,k[q+1]=!0),A.push(F));return A},pp.prototype.toHtShape=function(){var w=this,E=w._curves,A=[],X=[],k={x:1/0,y:1/0};return E.forEach(function(Q){var v=Q._p1,T=Q._p2,y=Q._p3,Z=Q._p4;return w._isCloseEnough(v,k)||(A.push(1),X.push(v.clone())),k=Z,w._isCloseEnough(v,T)&&w._isCloseEnough(y,Z)?(A.push(2),X.push(Z.clone()),void 0):(A.push(4),X.push(T.clone(),y.clone(),Z.clone()),void 0)}),{segments:A,points:X}};var Xe=Sg.Math.CubicBezier=function(P,S,G,t){var y=this;y._id=Sg.Math.CubicBezier._globalId++,y._p1=P,y._p2=S,y._p3=G,y._p4=t};Xe._globalId=1,Xe.prototype={},Xe.prototype.constructor=Xe,Xe.prototype.toString=function(){return this._id},Xe.prototype.intersectRect=function(x,j,u){var n=j/2,k=u/2,U=x.x,e=x.y,I=Sg.Math.Vector2,X=new I(-n+U,-k+e),M=new I(n+U,k+e),l=new I(M.x,X.y),f=new I(X.x,M.y),c=this,z=c.intersectLine(X,l),m=c.intersectLine(l,M),S=c.intersectLine(M,f),K=c.intersectLine(f,X),V=z.concat(m).concat(S).concat(K);return V},Xe.prototype.intersectLine=function(I,H){var F,b,N,g,o,W,l,J,p,h,Y,k,Q,r=this,m=I.clone().min(H),R=I.clone().max(H);g=r._p1,o=r._p2,W=r._p3,l=r._p4,F=g.clone().multiplyScalar(-1),b=o.clone().multiplyScalar(3),N=W.clone().multiplyScalar(-3),Y=F.add(b).add(N).add(l),F=g.clone().multiplyScalar(3),b=o.clone().multiplyScalar(-6),N=W.clone().multiplyScalar(3),h=F.add(b).add(N),F=g.clone().multiplyScalar(-3),b=o.clone().multiplyScalar(3),p=F.add(b),J=g.clone(),Q=new Sg.Math.Vector2(I.y-H.y,H.x-I.x),k=I.x*H.y-H.x*I.y;for(var V=r.getRoots(Q.dot(Y),Q.dot(h),Q.dot(p),Q.dot(J)+k),v=new Array,P=0,C=V.length;C>P;P++){var y=V[P];if(!(0>y||y>1)){var L=r.getPointAt(y);L.t=y,I.x==H.x?m.y<=L.y&&L.y<=R.y&&v.push(L):I.y==H.y?m.x<=L.x&&L.x<=R.x&&v.push(L):L.x>=m.x&&L.y>=m.y&&L.x<=R.x&&L.y<=R.y&&v.push(L)}}return v},Xe.prototype.solveTForPoint=function(L){var I,a,O,s,R=this;I=R._p1.x-L.x,a=R._p2.x-L.x,O=R._p3.x-L.x,s=R._p4.x-L.x;for(var V=R.getRoots(s-3*O+3*a-I,3*O-6*a+3*I,3*a-3*I,I),d=B,A=1/0,x=0,Z=V.length;Z>x;x++){var Q=V[x];if(!(0>Q||Q>1)){var G=R.getPointAt(Q);G.t=Q;var k=Math.abs(G.y-L.y);A>k&&(A=k,d=G)}}return d},Xe.prototype.getPointAt=function(M){var d=this,p=d._p1,r=d._p2,X=d._p3,F=d._p4,n=p.clone().lerp(r,M),C=r.clone().lerp(X,M),I=X.clone().lerp(F,M),Q=n.lerp(C,M),J=C.lerp(I,M);return Q.lerp(J,M)},Xe.prototype.getPointByPercentage=function(w){var $=this.length*w,i=this._cacheLength,x=i.length;if(0===$)return i[0].point;if(w>=1)return i[x-1].point;for(var C=0;x>C;C++){var G=i[C];if(!(G.len<$)){var h=i[C-1];return G.point.clone().sub(h.point).setLength($-h.len).add(h.point)}}},Xe.prototype.getTByPercentage=function(w){var H=this.length*w,Z=this._cacheLength,a=Z.length;if(0===H||0>=w)return Z[0].t;if(w>=1)return Z[a-1].t;for(var n=0;a>n;n++){var $=Z[n];if(!($.len<H)){var g=Z[n-1];return(H-g.len)/($.len-g.len)*($.t-g.t)+g.t}}},Xe.prototype.getRoots=function(s,P,d,L){var t,$,E,x,U,T=new Array;if(Math.abs(s)<1e-6){var t=P,$=d/t,E=L/t,x=$*$-4*E;if(x>0){var U=Math.sqrt(x);T.push(.5*(-$+U)),T.push(.5*(-$-U))}else 0==x&&T.push(.5*-$)}P/=s,d/=s,L/=s,t=(3*d-P*P)/3,$=(2*P*P*P-9*d*P+27*L)/27;var f=P/3,n=$*$/4+t*t*t/27,g=$/2;if(Math.abs(n)<=1e-6&&(n=0),n>0){var X,m,U=Math.sqrt(n);X=-g+U,m=X>=0?Math.pow(X,1/3):-Math.pow(-X,1/3),X=-g-U,X>=0?m+=Math.pow(X,1/3):m-=Math.pow(-X,1/3),T.push(m-f)}else if(0>n){var q=Math.sqrt(-t/3),h=Math.atan2(Math.sqrt(-n),-g)/3,Q=Math.cos(h),A=Math.sin(h),c=Math.sqrt(3);T.push(2*q*Q-f),T.push(-q*(Q+c*A)-f),T.push(-q*(Q-c*A)-f)}else{var X;X=g>=0?-Math.pow(g,1/3):Math.pow(-g,1/3),T.push(2*X-f),T.push(-X-f)}return T},Xe.prototype._70I=function(){var Z=this;return Z._p1.distanceToSquared(Z._p2)<1e-10&&Z._p3.distanceToSquared(Z._p4)<1e-10},Xe.prototype.insertKnot=function(y){var V=this,e=V._p1,X=V._p2,u=V._p3,j=V._p4,A=e.clone().lerp(X,y),B=X.clone().lerp(u,y),K=u.clone().lerp(j,y),W=A.clone().lerp(B,y),k=B.clone().lerp(K,y),S=W.clone().lerp(k,y);return V._70I()?(e.clone().lerp(j,y),[new Sg.Math.CubicBezier(e,e.clone(),S.clone(),S),new Sg.Math.CubicBezier(S,S.clone(),j.clone(),j)]):[new Sg.Math.CubicBezier(e,A,W,S),new Sg.Math.CubicBezier(S,k,K,j)]},w.defineProperties(Xe.prototype,{length:{get:function(){var q=this._cacheLength;if(!q){q=this._cacheLength=[];for(var N=this._p1,c=0,I=0;1>=c;){var n=this.getPointAt(c+=.001);I+=n.clone().sub(N).length(),N=n,q.push({len:I,t:c,point:n.clone()})}}return q[q.length-1].len}},p1:{get:function(){return this._p1},set:function(b){this._p1=b,this._cacheLength=B}},p2:{get:function(){return this._p2},set:function(f){this._p2=f,this._cacheLength=B}},p3:{get:function(){return this._p3},set:function(r){this._p3=r,this._cacheLength=B}},p4:{get:function(){return this._p4},set:function(f){this._p4=f,this._cacheLength=B}}});var Zk=R.Default.getInternal().ui().EdgeUI,Tr={_47O:function(K){var w=this,d=Tr.getBackups()._47O;Sg.inEdit(w.gv)||d.call(w,K)}};Sg.Inject.registAsModule(Tr,Zk);var kh=R.Default.getInternal().ui().NodeUI,de={_47O:function(g){var d=this,o=de.getBackups()._47O;Sg.inEdit(d.gv)||o.call(d,g)},getSelectWidth:function(){var I=this,z=I.gv,c=I._data;if(z.isEditable(c)&&Sg.inEdit(z))return 0;var _=de.getBackup("getSelectWidth");return _.call(I)}};Sg.Inject.registAsModule(de,kh);var fd=R.graph.GraphView,ab={_editPointSize:function(){var H=R.Default.isTouchable,i=Sg.getStyle("pointSize");return i[H?0:1]}(),isPointEditable:function(F){var Y=this;if(Sg.inEdit(Y))return Y._pointEditableFunc?Y._pointEditableFunc(F):!0;var l=ab.getBackup("isPointEditable");l.call(Y,F)},isEditable:function(g){var Y,l=this,O=ab.getBackup("isEditable");if(Y=g instanceof Sg.Group?!0:O.call(l,g),!Sg.inEdit(l))return Y;if(!(g instanceof R.Edge))return Y;if(!g.s("2d.editable"))return!1;var M=l.getEditableFunc();return M?M(g):!0},_42:function(W,i){var C=this,R=ab.getBackups()._42;if(R.call(C,W,i),Sg.inEdit(C)){var o=C.getEditInteractor();o.drawImpl()}}};Sg.Inject.registAsModule(ab,fd);var wd=R.Default.getInternal().ui().ShapeUI,Lp={_47O:function(c){var b=this,C=Lp.getBackups()._47O;Sg.inEdit(b.gv)||C.call(b,c)}};Sg.Inject.registAsModule(Lp,wd);var Re=R.graph.DefaultInteractor,Fm={handle_mousewheel:function(u){var H=this,N=Fm.getBackup("handle_mousewheel");Sg.inEdit(H.gv)||N.call(H,u)}};Sg.Inject.registAsModule(Fm,Re);var mc=R.graph.MoveInteractor,ms={_calcShift:function(d,f){var l=this,D=ms.getBackup("_calcShift"),$=l.gv;if(!Sg.inEdit($))return D.call(l,d,f);var z=$.getEditInteractor(),K=z.getSubModule("Move").calcShift(d,f,l);return K||D.call(l,d,f)},clear:function(F){var M=this,X=ms.getBackup("clear");X.call(M,F);var J=M.gv;if(Sg.inEdit(J)){var t=J.getEditInteractor();t.getSubModule("Move").clear(F)}}};Sg.Inject.registAsModule(ms,mc);var Qf=Sg.Rect=function(v){this.catalog="Rect",this._interactor=v};Qf.prototype={},Qf.prototype.constructor=Qf,Qf.prototype.gatherInfo=function(o,O){var l=this;if(1===O.length){var m=O[0];return m instanceof R.Shape&&m._70I()?l.gatherLine(o,m):Yq(m,o)?!1:l.gatherSingleTarget(o,m)}return O.length>1?l.gatherMultiTargets(o,O):!1},Qf.prototype.gatherSingleTarget=function(r,l){if(l.getCorners){var v,o=this,V=o.info;o.target=l,v=o.screenInfo={};var s=l.getCorners();V.LT=new Sg.Math.Vector2(s[0]),V.LB=new Sg.Math.Vector2(s[1]),V.RB=new Sg.Math.Vector2(s[2]),V.RT=new Sg.Math.Vector2(s[3]),V.T=V.LT.clone().add(V.RT).divideScalar(2),V.B=V.LB.clone().add(V.RB).divideScalar(2),V.L=V.LT.clone().add(V.LB).divideScalar(2),V.R=V.RT.clone().add(V.RB).divideScalar(2);for(var D in V)v[D]=Sg.toScreenPosition(r,V[D]);var F=o._interactor,t=F.getStyle("checkSize"),$=function(_,H,o){var d=H.clone().sub(_).setLength(-t),w=o.clone().sub(_).setLength(-t),a=d.add(w).add(_);return a};return v.rotLT=$(v.LT,v.RT,v.LB),v.rotLB=$(v.LB,v.LT,v.RB),v.rotRB=$(v.RB,v.LB,v.RT),v.rotRT=$(v.RT,v.LT,v.RB),v.rotT=v.rotLT.clone().add(v.rotRT).divideScalar(2),v.rotB=v.rotLB.clone().add(v.rotRB).divideScalar(2),v.rotL=v.rotLT.clone().add(v.rotLB).divideScalar(2),v.rotR=v.rotRT.clone().add(v.rotRB).divideScalar(2),v.rotation=l.getRotation(),o.gatherConnectInfo(),!0}},Qf.prototype.gatherConnectInfo=function(){var C=this,B=C.target,i=C._interactor,N=C.screenInfo,y=i.gv;if(y.isConnectActionVisible(B)&&i.getStyle("connectGuideVisible")){var s;B.s&&(s=B.s("connectGuideShift")),s||(s=i.getStyle("connectGuideShift"));var z=B.getAnchor(),K=B.getSize(),S=B.toGlobal({x:K.width*(s[0]-z.x),y:K.height*(s[1]-z.y)});S=Sg.toScreenPosition(y,S),N.P1?S.add(N.P2.clone().sub(N.P1).setLength(s[2])):(S.add(N.RT.clone().sub(N.LT).setLength(s[2])),S.add(N.LB.clone().sub(N.LT).setLength(s[3]))),N.connect=S}},Qf.prototype.gatherMultiTargets=function(u,L){var x=Sg.Group.findOrCreateGroup(L);if(!x)return!1;var W=this;return W.editing&&"rotate"!==W.editing.mode||x.calcInfo(),W.gatherSingleTarget(u,x)},Qf.prototype.gatherLine=function(J,M){this.target=M;var N=this.screenInfo={},g=M.getPoints(),z=Sg.getDataMatrix(M);return N.P1=Sg.toScreenPosition(J,z.apply(g.get(0))),N.P2=Sg.toScreenPosition(J,z.apply(g.get(1))),this.gatherConnectInfo(),!0},Qf.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Qf.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Qf.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Qf.prototype.check=function(i,J,L){if(R.Default.isLeftButton(J)){var b=this;if(b.editing=null,b.tipInfo=null,b.screenInfo){var f=b.target,j=i.isEditable(f),T=b.screenInfo;if(j&&T.connect){var C=b._checkConnect(L);if(C)return C}if(T.P1)return b._checkLine(L);var s,_,c,P=null,k=b._interactor,m=k.getStyle("checkSize");if(j&&i.isRectEditable(f))for(_=0;_<Sg.Rect.ResizeKeys.length;_++)if(c=Sg.Rect.ResizeKeys[_],Sg.checkHit(L,T[c],m)){P=c,s="resize";break}if(!P&&j&&i.isRotationEditable(f)&&!k.getStyle("rotateAsClock")){var Y=k.getStyle("rotateCheckSize");for(_=0;_<Sg.Rect.RotateKeys.length;_++)if(c=Sg.Rect.RotateKeys[_],Sg.checkHit(L,T[c],Y)){P=c,s="rotate";break}}if(!P)return k.setCursor("default"),void 0;if("rotate"===s){var M,B=i.lp(J);if(f instanceof Sg.Group){var r=k.getStyle("groupRotateModeKey");"string"==typeof r&&(r=[r]);for(var $=!1,o=0,Q=r.length;Q>o;o++)if(J[r[o]]){$=!0;break}var V=k.getStyle("groupRotateModeDefault");M=$?"batch"===V?"block":"batch":V}var O="batch"===M?f.getAnchor2():f.getPosition(),a=Math.atan2(B.y-O.y,B.x-O.x);k._setRotateCursor(a),b.editing={mode:s,key:P,pos:O,flipY:f.getScale().y<0,rotation:f.getRotation(),hitRot:a},M&&(b.editing.groupRotateMode=M)}else{var X=Sg.Rect.ResizeKeys.indexOf(P),y=Sg.Rect.ResizeDirection[X],w=Math.cos(f.getRotation()),v=Math.sin(f.getRotation()),E=y.x*Math.sign(f.getScale().x),D=y.y*Math.sign(f.getScale().y),W=Math.atan2(-v*E-w*D,w*E-v*D),N=(Math.round(W/(Math.PI/4))+8)%8,U=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][N];this._interactor.setCursor(U);var G=f.getWidth(),z=f.getHeight(),n=f.getAnchor();b.editing={mode:s,key:P,rect:{x:-G*n.x,y:-z*n.y,width:G,height:z},anchor:n,matrix:f.getMatrix()}}return P}}},Qf.prototype._checkLine=function(e){var w=this;w.screenInfo;var S,m=w._interactor.getStyle("checkSize");if(Sg.checkHit(e,w.screenInfo.P1,m))S="P1";else{if(!Sg.checkHit(e,w.screenInfo.P2,m))return this._interactor.setCursor("default"),void 0;S="P2"}return w.editing={mode:"line",key:S},S},Qf.prototype._checkConnect=function(_){var j=this,p=j.screenInfo,K=j._interactor,E=K.getStyle("connectGuideIntersectSize"),Z=p.connect,Y=_.x,H=Z.x;if(H>Y&&E>H-Y&&Math.abs(Z.y-_.y)<E||Y>=H&&Sg.checkHit(_,Z,E)){var d="connect",u=l.getConnectAction(K.gv);if(j.editing={mode:d},u&&u.delete)if(j.target instanceof Sg.Group){var T=!0;K.gv.sm().getSelection().each(function(t){u.delete.visible.call(null,K.gv,t)||(T=!1)}),j.editing.hasDeleteAction=T}else u.delete.visible.call(null,K.gv,j.target)&&(j.editing.hasDeleteAction=!0);return K.setCursor("default"),d}},Qf.prototype._fireEditEvent=function(F,c){var v=this._interactor,d=this.editing;if(d){var f=d.mode;f="rotate"===f?"Rotation":"connect"===f?"Connection":"resize"===f?"Rect":f[0].toUpperCase()+f.slice(1),v.fi({kind:F+"Edit"+f,event:c})}},Qf.prototype.startEdit=function(X,i){X.startDragging(i);var w=this;w._interactor.fi({kind:"prepareEdit",event:i});var r=w.editing,n=w.target;if(r){if(w._fireEditEvent("begin",i),r.started=!0,"rotate"===r.mode)return r.groupRotateMode&&n.beginRotate(r),X._42(),void 0;if("connect"!==r.mode)("line"===r.mode||n&&0===n.getRotation())&&(w._inSmartGuide=!0,w._interactor.rectGuide.gatherRects());else if(r.hasDeleteAction){var m=X.gv,Z=w._interactor.getStyle("connectGuideGarbageShift");r.garbageInfo={x:m.getWidth()*Z[0]+Z[2],y:m.getHeight()*Z[1]+Z[3],size:w._interactor.getStyle("connectGuideGarbageIntersectsize")},X._42()}}},Qf.prototype._46O=function(t){var V,p,w=this,U=w.editing,X=w.target;if(U){if("connect"===U.mode&&!U.canceled&&!U.deleted)try{U.garbageInfo&&U.garbageInfo.hover?l.doDeleteConnectionAction(w._interactor.gv,X):l.doConnectAction(w._interactor.gv,X,U.target)}catch(P){console.error(P)}p=U.freezeFlag,V=w.editing.groupRotateMode,w._fireEditEvent("end",t),w.editing=null}w.tipInfo=null,w._inSmartGuide&&(w._interactor.rectGuide.clear(),w._inSmartGuide=!1),V&&X&&X.endRotate(),X instanceof R.Block&&(p===B?delete X._freezeSyncFromChildren:X._freezeSyncFromChildren=p,X.updateFromChildren())},Qf.prototype.handleNormalStateDelete=function(){var A=this,Z=A.editing;if(Z&&"connect"===Z.mode&&!Z.canceled&&!Z.deleted){if(Z.garbageInfo){try{l.doDeleteConnectionAction(A._interactor.gv,A.target)}catch(R){console.error(R)}Z.garbageInfo=null}return Z.cursorPos=null,Z.targetCorners=null,Z.deleted=!0,A._interactor._42(),!0}},Qf.prototype.handleNormalStateKeyDown=function(d){var H=this,v=H.editing;return!v||"connect"!==v.mode||v.canceled||v.deleted?void 0:R.Default.isEsc(d)?(v.cursorPos=null,v.targetCorners=null,v.canceled=!0,H._interactor._42(),!0):void 0},Qf.prototype.handleEdit=function(v,I){var t=this,c=t.editing;if(c){var u,b,D,y,T,f=t.target,O=c.key,h=c.mode,i=v.lp(I),V=t._interactor;if("connect"===h){if(c.canceled)return;if(c.deleted)return;c.cursorPos=V._getLogicalPoint(I);var x=c.garbageInfo;return x&&Sg.checkHit(c.cursorPos,x,x.size)?(x.hover=!0,c.target=null,c.targetCorners=null):(x&&(x.hover=!1),c.target=v.getDataAt(i,function(V){return v.isSelectable(V)?Tn(V)?!0:!1:!1})||null,c.targetCorners=Sg.getTargetCornersOnScreen(v,c.target)),V._42(),void 0}if("rotate"===h){var P,K,q=c.pos,m=Math.atan2(i.y-q.y,i.x-q.x);if(c.groupRotateMode?K=m-c.hitRot:(P=m-c.hitRot,K=c.rotation+P),K%=2*Math.PI,0>K&&(K+=2*Math.PI),!R.Default.isCtrlDown(I)){var Q,Z;sh(I)?(Q=V.getStyle("shiftRotateRound"),Z=Q/2):(Q=V.getStyle("rotateRound"),Z=V.getStyle("rotateSensitivity")),K=Sg.roundTo(K,Q,Z)}c.groupRotateMode?(P=K-(c.lastRotation||0),0!==P&&(f.addRotation(P,c.groupRotateMode,function(g){return v.isRotationEditable(g)}),c.lastRotation=K)):f.setRotation(K),V._setRotateCursor(m),K>Math.PI&&(K-=2*Math.PI);var H=180*(K/Math.PI);H=H.toFixed(2),u=""+H+""}else if("resize"===h){var A=c.rect;D=A.x,y=A.y;var j,s=A.width,B=A.height,U=c.anchor,F=c.matrix,e=f.s&&f.s("keepAspectRatio")||V.getStyle("keepAspectRatio");sh(I)&&(e=!e);var r=t._unionPointMode1,M=t._unionPointMode2;if(t._inSmartGuide&&!R.Default.isCtrlDown(I)&&!e){var w;"L"===O||"R"===O?w="x":("T"===O||"B"===O)&&(w="y"),t._adsorbedToClosest(i,w),T=!0}j=F.tfi(i);var J;"LT"===O?(A=r(j,{x:D+s,y:y+B},s,B,e),J=9):"T"===O?(A=M({x:D,y:j.y},{x:D+s,y:y+B},s,B,e,"v"),J=1):"RT"===O?(A=r(j,{x:D,y:y+B},s,B,e),J=33):"L"===O?(A=M({x:j.x,y:y},{x:D+s,y:y+B},s,B,e,"h"),J=8):"R"===O?(A=M({x:D,y:y},{x:j.x,y:y+B},s,B,e,"h"),J=32):"LB"===O?(A=r(j,{x:D+s,y:y},s,B,e),J=12):"B"===O?(A=M({x:D,y:y},{x:D+s,y:j.y},s,B,e,"v"),J=4):"RB"===O&&(A=r(j,{x:D,y:y},s,B,e),J=36);var X=F.tf(A.x+A.width*U.x,A.y+A.height*U.y);f instanceof R.Block&&(c.hasOwnProperty("freezeFlag")||(c.freezeFlag=f._freezeSyncFromChildren,f._freezeSyncFromChildren=!0)),f.setPosition(X),f.setSize(A.width,A.height),T&&(b=f.getRect(),V.rectGuide.gatherLines({node:f,x:b.x,y:b.y,w:b.width,h:b.height},w,J)),u=""+Math.round(A.width)+" * "+Math.round(A.height)}else if("line"===h){if(sh(I)){var E=f.getPoints(),o="P1"===O?E.get(1):E.get(0),z={x:i.x-o.x,y:i.y-o.y},g=V.getStyle("shiftLineRotateRound"),k=t._shiftDirList;if(!k||t._shiftRotateRound!==g){t._shiftRotateRound=g,t._shiftDirList=k=[];for(var G=0;G<Math.PI;G+=g)k.push({x:a(G),y:d(G)})}for(var Y,L=0,n=0,S=k.length;S>n;n++){var W=k[n],$=W.x*z.x+W.y*z.y;Math.abs($)>Math.abs(L)&&(L=$,Y=W)}i={x:o.x+Y.x*L,y:o.y+Y.y*L},V.rectGuide.clear()}else t._inSmartGuide&&!R.Default.isCtrlDown(I)&&(t._adsorbedToClosest(i),T=!0);var N=Sg.getDataMatrix(f).applyInverse(i);f.setPoint("P1"===O?0:1,N,!0);var C=f.getPoints(),p=C.get(0),l=C.get(1);D=p.x-l.x,y=p.y-l.y,u=" "+Math.round(Math.sqrt(D*D+y*y))+" ",T&&(b=f.getRect(),V.rectGuide.gatherLines({node:f,x:b.x,y:b.y,w:b.width,h:b.height}))}if(u){var _=R.Default.getLogicalPoint(I,V._canvas);_.x+=Sg.Icons.TipShiftX,_.y+=Sg.Icons.TipShiftY,t.tipInfo={helperPos:_,text:u,size:u.length}}t._fireEditEvent("between",I)}},Qf.prototype._unionPointMode1=function(x,B,N,F,X){if(X&&N&&F){var I=x.x-B.x,c=x.y-B.y;Math.abs(I*F)<Math.abs(c*N)?(c=Math.sign(c)*Math.abs(I*F/N),x.y=B.y+c):(I=Math.sign(I)*Math.abs(c*N/F),x.x=B.x+I)}return R.Default.unionPoint(x,B)},Qf.prototype._unionPointMode2=function(Y,x,r,_,G,S){var o=R.Default.unionPoint(Y,x);if(G&&r&&_){var g;"v"===S?(g=o.x+o.width/2,o.width=r*o.height/_,o.x=g-o.width/2):(g=o.y+o.height/2,o.height=_*o.width/r,o.y=g-o.height/2)}return o},Qf.prototype._adsorbedToClosest=function(I,N){var V=this,R=V._interactor,W=R.rectGuide.findClosest(I,N),M=R.gridGuide.findClosest(I,N),r=1/0,g=1/0;W&&(isFinite(W.x)&&(r=W.x),isFinite(W.y)&&(g=W.y)),M&&(isFinite(M.x)&&Math.abs(M.x)<Math.abs(r)&&(r=M.x),isFinite(M.y)&&Math.abs(M.y)<Math.abs(g)&&(g=M.y)),isFinite(r)&&(I.x+=r),isFinite(g)&&(I.y+=g)},Qf.prototype._42=function(B,i,q){var V=this;V.info={},V.screenInfo=null;
var l=V._interactor;if(!l.editDetail&&V.gatherInfo(i,q)){var $=V.editing,Q=$?$.groupRotateMode:null,E=V.screenInfo;if("block"!==Q||!$||!$.started){if(E.P1?Sg.Icons.DrawIcon(l,B,Sg.Icons.Line,E):Sg.Icons.DrawIcon(l,B,Sg.Icons.Rect,E),E.connect&&(Sg.Icons.DrawIcon(l,B,Sg.Icons.ConnectGuide,{rotation:E.rotation,connect:E.connect,cursorPos:$?$.cursorPos:null}),$)){if($.targetCorners){for(var F={x:1/0,y:1/0},O={x:-1/0,y:-1/0},D=0,M=$.targetCorners.length;M>D;D+=2)F.x=Math.min(F.x,$.targetCorners[D]),O.x=Math.max(O.x,$.targetCorners[D]),F.y=Math.min(F.y,$.targetCorners[D+1]),O.y=Math.max(O.y,$.targetCorners[D+1]);Sg.Icons.DrawIcon(l,B,Sg.Icons.HoverDataRect,{min:F,max:O,color:l.getStyle("hoverGuideColor")||l.getStyle("baseColor")})}$.garbageInfo&&Sg.Icons.DrawIcon(l,B,Sg.Icons.ConnectGuideGarbage,$.garbageInfo)}l.getStyle("rotateTipVisible")&&V.tipInfo&&Sg.Icons.DrawIcon(l,B,Sg.Icons.TipHelper,V.tipInfo)}V.target instanceof Sg.Group&&V.target._42(l,B,i)}};var Pp=Sg.Anchor=function(o){this.catalog="Anchor",this._interactor=o};Pp.prototype={},Pp.prototype.constructor=Pp,Pp.prototype.gatherInfo=function(L,O){var d=this;if(1===O.length){var D=O[0];if(!D.getAnchor)return;if(D instanceof R.Shape&&D._70I())return;if(Yq(D,L))return;return d.gatherSingleTarget(L,O[0])}return O.length>1?d.gatherMultiTargets(L,O):!1},Pp.prototype.gatherSingleTarget=function(C,v){var m=this;return m.info.POS=v.getPosition(),m.screenInfo.POS=Sg.toScreenPosition(C,m.info.POS),m.target=v,!0},Pp.prototype.gatherMultiTargets=function(S,h){var w=this,y=Sg.Group.findOrCreateGroup(h);return y?(w.screenInfo.POS=Sg.toScreenPosition(S,y.getAnchor2()),w.target=y,!0):!1},Pp.prototype.isVisible=function(){var F=this,W=F._interactor;if(W.getStyle("anchorVisible")===!1)return!1;var n=F.target;if(n){if(this.editing)return!0;var A=n.getAnchor(),L=W.getStyle("anchorOutsideVisibleThreshold");if(A.x<-L||A.x>1+L||A.y<-L||A.y>1+L)return!0;var o=n.getSize(),i=n.getScale(),r=Math.min(Math.abs(o.width*i.x),Math.abs(o.height*i.y));if(r*W.gv._zoom<W.getStyle("anchorHideThreshold"))return!1}return!0},Pp.prototype.check=function(y,v,X){if(R.Default.isLeftButton(v)){var $=this,p=$._interactor;if($.isVisible()&&p.getStyle("anchorMovable")!==!1){$.editing=null,$.tipInfo=null;var L=$.target;if(L&&y.isAnchorEditable(L)&&y.isEditable(L)){var b;if($.screenInfo&&(b=$.screenInfo.POS)&&Sg.checkHit(X,new Sg.Math.Vector2(b),p.getStyle("checkSize"))){if(L instanceof Sg.Group)return $.editing={},!0;var x=L.getWidth(),m=L.getHeight(),h=L.getAnchor();return $.editing={rect:{x:-x*h.x,y:-m*h.y,width:x,height:m},anchor:h,matrix:L.getMatrix()},!0}}}}},Pp.prototype.startEdit=function(w,D){w.startDragging(D),w.fi({kind:"beginEditAnchor",event:D})},Pp.prototype._46O=function(f){var p=this;p.editing&&(p.editing=null,p._interactor.fi({kind:"endEditAnchor",event:f})),p.tipInfo=null},Pp.prototype.handleEdit=function(p,Q){var t=this,J=t.target;if(J){var X=t.editing;if(X){var I=p.lp(Q),i=t._interactor;if(J instanceof Sg.Group)return J.setAnchor2(I),i._42(),void 0;var j=X.matrix,H=j.tfi(I),a=X.rect,C=(H.x-a.x)/a.width,V=(H.y-a.y)/a.height;if(!R.Default.isCtrlDown(Q)){var f=i.getStyle("anchorRound"),M=i.getStyle("anchorSensitivity");C=Sg.roundTo(C,f,M),V=Sg.roundTo(V,f,M)}J.setAnchor(C,V,!0);var L=R.Default.getLogicalPoint(Q,i._canvas);L.x+=Sg.Icons.TipShiftX,L.y+=Sg.Icons.TipShiftY;var U=""+C.toFixed(2)+", "+V.toFixed(2);t.tipInfo={helperPos:L,text:U,size:U.length},i.fi({kind:"betweenEditAnchor",event:Q})}}},Pp.prototype._42=function(n,A,H){var z=this;z.info={},z.screenInfo={};var y=z._interactor;y.editDetail||z.gatherInfo(A,H)&&z.isVisible()&&(Sg.Icons.DrawIcon(y,n,Sg.Icons.Anchor,z.screenInfo),z.tipInfo&&Sg.Icons.DrawIcon(y,n,Sg.Icons.TipHelper,z.tipInfo))};var vj=Sg.MoveDummy=function(C){this.catalog="MoveDummy",this._interactor=C};vj.prototype={},vj.prototype.constructor=vj,vj.prototype.gatherInfo=function(){var e=this,_=this._interactor.getSubModule("Rect");if(_){var H=_.screenInfo;if(H){var j=e._interactor,x=e.getMovableTarget(_.target);if(x){var k=j.getStyle("moveDummyThreshold");if(k!==!1){var g=H.LT||H.P1,T=H.RT||H.P2,y=H.LB||g;if(g){var I=H.P1,i=Math.min(g.distanceTo(y),g.distanceTo(T));if(!(k!==!0&&i>k)){var W=j.getStyle("moveDummyPosition"),p=T.clone().sub(g),m=y.clone().sub(g),q=W[2],$=W[3];if(I){var n=j.getStyle("moveDummyLineExtraShift");n&&(q+=n[0],$+=n[1])}var E=g.clone().add(p.clone().multiplyScalar(W[0])).add(p.setLength(q)).add(m.clone().multiplyScalar(W[1])).add(m.setLength($));return e.screenInfo.pos=E,e.screenInfo.size=j.getStyle("moveDummySensitivity"),!0}}}}}}},vj.prototype.getMovableTarget=function(t){var l=this._interactor.gv;if(Tn(t)){if(l.isMovable(t))return t}else if(t instanceof Sg.Group)for(var A=t._entities,N=A.length-1;N>=0;N--){var B=A[N];if(Tn(B)&&l.isMovable(B))return B}return null},vj.prototype.getMoveInteractor=function(){for(var J,j,v,z=this._interactor.gv,n=z.getInteractors(),J=0,j=n.length;j>J;J++)if(v=n.get(J),v instanceof mc)return v},vj.prototype.startEdit=function(H,o){H.startDragging(o);var X=this.getMoveInteractor();if(X){var Q=this.selectedTarget,C=H.gv;C._moving=1,X._data=Q,C.handleMouseDown&&C.handleMouseDown(o,Q)}},vj.prototype._46O=function(k){var C=this,u=C.getMoveInteractor();u&&(u.handleWindowMouseUp(k),C.selectedTarget=null)},vj.prototype.handleEdit=function(p,T){var j=this.getMoveInteractor();j&&j.handleWindowMouseMove(T)},vj.prototype.check=function(K,X,l){if(this.selectedTarget=null,R.Default.isLeftButton(X)&&!K._scrolling&&!fr()){var W=this;if(W.screenInfo){var Z=W.screenInfo.pos;if(Z&&!(l.distanceTo(Z)>W.screenInfo.size)){var d=W._interactor;return W.selectedTarget=W.getMovableTarget(d.getSubModule("Rect").target),d.setCursor("default"),!0}}}},vj.prototype._42=function(Q,L,c){var $=this;$.screenInfo={};var K=$._interactor;K.editDetail||$.gatherInfo(L,c)&&(!K.editing||$.selectedTarget)&&Sg.Icons.DrawIcon(K,Q,Sg.Icons.MoveDummy,$.screenInfo)};var zb=Sg.RotateX=function(i){this.catalog="RotateX",this._interactor=i};zb.prototype={},zb.prototype.constructor=zb,zb.prototype.gatherInfo=function(k,g){var Y=this;if(1===g.length){var v=g[0];return v instanceof R.Shape&&v._70I()||Yq(v,k)?!1:Y.gatherSingleTarget(k,v)}return g.length>1?Y.gatherMultiTargets(k,g):!1},zb.prototype.gatherSingleTarget=function(){var E=new R.Math.Vector2,X=new R.Math.Vector2,a=new R.Math.Vector2,N=new R.Math.Vector2,h=function(b,m){var k=b.x-m.x,C=b.y-m.y;return k*k+C*C};return function(J,t){if(t.getCorners){var y=this,G=t.getCorners(),b=15,T=t.getPosition();E.copy(G[0]),a.copy(G[1]),N.copy(G[3]),X.copy(E).add(N).divideScalar(2).add(E.sub(a).setLength(b/J.getZoom()));var w=Math.max(h(T,G[0]),h(T,G[1]),h(T,G[2]),h(T,G[3]));return y.info.POS=X.clone(),y.screenInfo.POS=Sg.toScreenPosition(J,y.info.POS),y.screenInfo.LEN=Math.sqrt(w)*J.getZoom()+b,y.screenInfo.CENTER=Sg.toScreenPosition(J,T),y.target=t,!0}}}(),zb.prototype.gatherMultiTargets=function(O,D){var _=this,w=Sg.Group.findOrCreateGroup(D);if(!w)return!1;var _=this;return _.gatherSingleTarget(O,w)},zb.prototype.isVisible=function(){var h=this._interactor;if(!h.getStyle("rotateAsClock"))return!1;var i=this.target;if(!i)return!0;var t=h.gv;return t.isEditable(i)&&t.isRotationEditable(i)?!0:!1},zb.prototype.check=function(c,J,l){var n=this,b=n._checkImpl(c,J,l);return(b||n._clockPainted)&&n._interactor._42(),b},zb.prototype._checkImpl=function(K,_,f){if(R.Default.isLeftButton(_)){var q=this;q.editing=null,q.tipInfo=null;var V;if(q.screenInfo&&(V=q.screenInfo.POS)&&q.isVisible()){var P=q._interactor;if(Sg.checkHit(f,V,P.getStyle("checkSize"))){var Z=q.target,v=K.lp(_),p=Z.getPosition(),Q=Math.atan2(v.y-p.y,v.x-p.x);return P._setRotateCursor(Q),q.editing={pos:p,rotation:Z.getRotation(),hitRot:Q,groupRotateMode:"block",screenInfo:{CENTER:q.screenInfo.CENTER,LEN:q.screenInfo.LEN}},!0}}}},zb.prototype.startEdit=function(M,w){M.startDragging(w),M.fi({kind:"beginEditRotation",event:w}),this.target instanceof Sg.Group&&this.target.beginRotate(this.editing)},zb.prototype._46O=function(g){var r=this;r.editing&&(r.editing=null,r._interactor.fi({kind:"endEditRotation",event:g})),r.target instanceof Sg.Group&&r.target.endRotate(),r.tipInfo=null},zb.prototype.handleEdit=function(U,K){var D=this,t=D.editing;if(t){var g,S,l=D.target,k=U.lp(K),d=D._interactor,T=t.pos,L=Math.atan2(k.y-T.y,k.x-T.x),e=l instanceof Sg.Group;if(e?S=L-t.hitRot:(g=L-t.hitRot,S=t.rotation+g),S%=2*Math.PI,0>S&&(S+=2*Math.PI),!R.Default.isCtrlDown(K)){var u,r;sh(K)?(u=d.getStyle("shiftRotateRound"),r=u/2):(u=d.getStyle("rotateRound"),r=d.getStyle("rotateSensitivity")),S=Sg.roundTo(S,u,r)}e?(g=S-(t.lastRotation||0),0!==g&&(l.addRotation(g,t.groupRotateMode,function(m){return U.isRotationEditable(m)}),t.lastRotation=S)):l.setRotation(S),d._setRotateCursor(L),S>Math.PI&&(S-=2*Math.PI);var C=180*(S/Math.PI),O=""+C.toFixed(2)+"",Y=R.Default.getLogicalPoint(K,d._canvas);Y.x+=Sg.Icons.TipShiftX,Y.y+=Sg.Icons.TipShiftY,D.tipInfo={helperPos:Y,text:O,size:O.length},d.fi({kind:"betweenEditRotation",event:K})}},zb.prototype._42=function(o,V,f){var E=this;E._clockPainted=!1,E.info={},E.screenInfo={};var P=E._interactor;P.editDetail||E.gatherInfo(V,f)&&E.isVisible()&&(Sg.Icons.DrawIcon(P,o,Sg.Icons.RoundPoint,E.screenInfo.POS),P.getStyle("rotateTipVisible")&&E.tipInfo&&Sg.Icons.DrawIcon(P,o,Sg.Icons.TipHelper,E.tipInfo),E.editing&&E.drawClock(o))},zb.prototype.drawClock=function(i){i.save();var V=this;V._clockPainted=!0;var D=V.editing||{},r=D.screenInfo||V.screenInfo,m=r.LEN,w=m+8,Q=m+18;i.save(),i.translate(r.CENTER.x,r.CENTER.y),i.beginPath(),i.strokeStyle="rgb(150, 150, 150)";for(var N,S,y,P,F,U=0;360>U;U++)N=U*Math.PI/180,0===U%5&&(S=d(N)*m,y=a(N)*m,P=d(N)*w,F=a(N)*w,i.moveTo(S,y),i.lineTo(P,F)),0===U%45&&(S=d(N)*m,y=a(N)*m,P=d(N)*Q,F=a(N)*Q,i.moveTo(S,y),i.lineTo(P,F));i.stroke(),i.rotate(-xr);var e=D.lastRotation||V.target.getRotation();i.beginPath(),i.fillStyle="rgba(255, 0, 0, 0.1)",i.strokeStyle="rgb(157, 157, 157)",i.moveTo(0,0),i.arc(0,0,Q,0,e,!1),i.fill(),i.beginPath(),i.moveTo(0+Q,0),i.arc(0,0,Q,0,e,!1),i.stroke(),i.restore()};var pp=Sg.Curve=function(e){this.catalog="Curve",this._interactor=e};pp.prototype={},pp.prototype.constructor=pp,w.defineProperties(pp.prototype,{activing:{get:function(){return this._activing},set:function(d){var $=this;if(d)$._activing=new Sg.CurveActiving(this,d),$._activing._firePointChange();else{var l=$._activing;l&&l.dispose(),$._activing=null}}}}),pp.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},pp.prototype.setUp=function(){var H=this,K=H._interactor;K&&K.gv.mp(H._onGraphviewPropertyChanged,H)},pp.prototype._onGraphviewPropertyChanged=function(F){("zoom"===F.property||"translateX"===F.property||"translateY"===F.property)&&this._handleDataChanged()},pp.prototype.tearDown=function(){var f=this,k=f._interactor;k&&k.gv.ump(f._onGraphviewPropertyChanged,f)},pp.prototype.canEnterEditDetailMode=function(){var x=tm(this._interactor);return x?this.target=x:void 0},pp.prototype.canQuitEditDetailMode=function(D){var n=this,A=n._interactor._getLogicalPoint(D);return n._checkEditRealPoint(A)?void 0:n._interactor.gv.getDataAt(D)!==n.target?!0:void 0},pp.prototype.preHandleScroll=function(){var W=this.editing;return W&&W.inEdit?!0:void 0},pp.prototype.getCurrentSelectintStatus=function(){var K=this;if(K.activing&&!K.activing.selections){if(K.activing.status!=B)return K.activing.status;var y=function(z){var B=K.activing.status;K.activing.status=z,K._interactor.fp("shapePointStatus",B,z)},I=Sg.Curve.PointType,t=K.activing.point,G=K.activing.pairs;if(!G||1!==G.length)return y(I.Mirrored);var p=G[0],q=p.c1&&p.c1.isNearEnough(t),w=p.c2&&p.c2.isNearEnough(t);if(!p.c1||!p.c2)return q||w?y(I.Straight):y(I.Disconnected);if(q&&w)return y(I.Straight);if(q||w)return y(I.Asymmetric);var Z=p.c1.clone().sub(t),s=p.c2.clone().sub(t);return Math.abs(Z.x*s.y-Z.y*s.x)>1e-5||Z.x*s.x>0?y(I.Disconnected):Math.abs(Z.length()-s.length())>1e-5?y(I.Asymmetric):y(I.Mirrored)}},pp.prototype.handle_keydown=function(Q){var d=this;if(d._interactor.editDetail){var G=Sg.Curve.PointType;"1"===Q.key?d._setCurrentSelectionStatus(G.Straight):"2"===Q.key?d._setCurrentSelectionStatus(G.Mirrored):"3"===Q.key?d._setCurrentSelectionStatus(G.Disconnected):"4"===Q.key&&d._setCurrentSelectionStatus(G.Asymmetric)}},pp.prototype.setCurrentSelectionStatus=function(f){var x=this,J=x._interactor;if(J){var c=J.gv;c.dm().beginTransaction(),this._setCurrentSelectionStatus(f),c.dm().endTransaction()}},pp.prototype._setCurrentSelectionStatus=function(v){var S=this,z=S.activing;if(z){var F=S.getCurrentSelectintStatus();if(null!==F&&F!==v){z.status=v;var V=S.activing.point,M=S.activing.pairs;if(M&&1===M.length){var e=M[0],j=S.screenInfo.curve,o=Sg.Curve.PointType,I=S._interactor,i=function(){S._writeToHt(),I.fp("shapePointStatus",F,v),S.check(I.gv,null,new Sg.Math.Vector2(I._lastLogicalPoint))};if(v===o.Straight)return j.moveCtrlPoint(e,V,"c1"),j.moveCtrlPoint(e,V,"c2"),i(),void 0;if(F===o.Straight){var K=j.findPairs(V,!0),N=K[0],R=N.r1||V,C=N.r2||V,n=C.clone().sub(R).multiplyScalar(.25);return j.moveCtrlPoint(e,V.clone().sub(n),"c1"),j.moveCtrlPoint(e,V.clone().add(n),"c2"),i(),void 0}var O=e.c1,s=e.c2;if(O&&s){if(v===o.Mirrored)return j.moveCtrlPoint(e,V.clone().multiplyScalar(2).sub(s),"c1"),i(),void 0;if(v===o.Asymmetric&&F===o.Disconnected){var y=O.clone().sub(V).length(),n=V.clone().sub(s).setLength(y).add(V);return j.moveCtrlPoint(e,n,"c1"),i(),void 0}}z._firePointChange(),I.fp("shapePointStatus",F,v),S.check(I.gv,null,new Sg.Math.Vector2(I._lastLogicalPoint))}}}},pp.prototype._handleDataChanged=function(){var f="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(Q){var n=this;if(n.screenInfo&&n.target){if(Q&&f.indexOf(Q.property)<0)return;var j=n._interactor;n.gatherSingleTarget(j.gv,n.target,!0),n.check(j.gv,null,new Sg.Math.Vector2(j._lastLogicalPoint)),j._42()}}}(),pp.prototype.gatherSingleTarget=function(g,K,L){var G,W,a=this;a.screenInfo&&a.screenInfo.curve&&(W=a.screenInfo.curve._curves);var t=a.editing;G=t?a.screenInfo:a.screenInfo={};var D,n,P=K instanceof R.Edge;P?(D=K.s("edge.segments"),n=K.s("edge.points")||new R.List):(D=K._58O,n=K._59O),G.S=D;var e,s=G.P=[],E=Sg.getDataMatrix(K);if(K instanceof R.Polyline||K instanceof R.Edge&&a._interactor.getStyle("edgeElevationEditable"))e=K.getElevation&&K.getElevation()||0,G.E=[];else{var O=!1;n.each(function(w){w.e!==B&&(O=!0)}),O&&(G.E=[])}if(n.each(function(f){G.E&&G.E.push(f.e!=B?f.e:e),f=E.apply(f);var n=Sg.toScreenPosition(g,f);s.push(n.x,n.y)}),P){var u=s.length,k=Sg.toScreenPosition(g,K._lastSourcePoint||(u?{x:s[0],y:s[1]}:{x:0,y:0})),c=Sg.toScreenPosition(g,K._lastTargetPoint||(u?{x:s[u-2],y:s[u-1]}:{x:0,y:0}));if(s.splice(0,0,k.x,k.y),s.push(c.x,c.y),G.E){var T=K.getSource(),p=K.getTarget();G.E.splice(0,0,((K.s("edge.source.anchor.elevation")||.5)-.5)*T.getTall()+T.getElevation()),G.E.push(((K.s("edge.target.anchor.elevation")||.5)-.5)*p.getTall()+p.getElevation())}}if(!G.S||!G.S.size()){G.S=new R.List,G.S.add(1);for(var y=0;y<s.length/2-1;y++)G.S.add(2)}if((!t||L)&&a.convertToCubicBezier(W),a.activing&&(L||!a.editing||"realPoint"===a.editing.type)){var A=G.curve.findPairs(a.activing.point);a.activing.pairs=A}},pp.prototype._convertToNewPoint=function(m,D,J,j){var g,q,W;for(g=0,q=D.length;q>g;g++){if(W=D[g],W._p1.isNearEnough(m)&&(!j||j.indexOf(W._p1)<0))return W._p1;if(W._p4.isNearEnough(m)&&(!j||j.indexOf(W._p4)<0))return W._p4}if(J)for(g=0,q=Math.min(J.length,q);q>g;g++){if(W=J[g],W._p1===m&&(!j||j.indexOf(D[g]._p1)<0))return D[g]._p1;if(W._p4===m&&(!j||j.indexOf(D[g]._p4)<0))return D[g]._p4}},pp.prototype.convertToCubicBezier=function(E){var p,b,O=this,X=new Sg.Math.Curve,f=O.screenInfo;if(X.createFromHtShape(f.P,f.S,f.E),f.curve=X,O.activing){var i=X._curves;p=O.activing.point,b=O._convertToNewPoint(p,i,E);var v=[];if(b&&(O.activing.point=b,v.push(b)),O.activing.selections){var z=-1,x=O.activing.selections;x.forEach(function(P){z++,b=O._convertToNewPoint(P,i,E,v),b&&(x[z]=b,v.push(b))})}}},pp.prototype.check=function(k,t,h){if(!t||Pd(t)||$q(t)){var y=this;if(y._interactor.setCursor("default"),y.editing=null,y.highlight=null,y.tipInfo=null,y.edgeEditResult=null,y.screenInfo){if(fr()||t&&$q(t))return y._interactor._42(),!0;if(y._checkEditCtrlPoint(h))return y._interactor._42(),!0;if(y._checkEditRealPoint(h))return y._interactor._42(),!0;if(y._checkEditElevation(h))return y._interactor._42(),!0;var o=y.screenInfo.curve,x=o.checkPoint(h,y._interactor.getStyle("curveIntersectSize"));if(x){var K=y.highlight={};K.type="insertKnot",K.bezier=x.bezier,K.point=x.intersection}return y._interactor._42(),!0}}},pp.prototype.getAdjacentBeziers=function(X){var P=this.screenInfo;if(P){var z,o,C,G=P.curve._curves,q=[],i=B;for(z=0,o=G.length;o>z;z++)if(C=G[z],i===B){if(C._p4.isNearEnough(X)){q.push(C),i=z;continue}}else{if(C._p1.isNearEnough(X))return q.push(C),q;if(C._p4.isNearEnough(X)){q[0]=C,i=z;continue}}}},pp.prototype.roundCorner=function(u){if(this.activing&&this.screenInfo){var i=this.screenInfo.curve,L=i._curves,B=this.getAdjacentBeziers(this.activing.point),l=B[1],d=l._index;l=l.insertKnot(l.getTByPercentage(u/l.length))[1],L[d]=l;var W=l.p1,q=B[0],J=q._index;q=q.insertKnot(q.getTByPercentage(1-u/q.length))[0],L[J]=q;var N=q.p4,G=this.activing.point,Z=new Sg.Math.CubicBezier(N,G.clone().sub(N).multiplyScalar(2/3).add(N),G.clone().sub(W).multiplyScalar(2/3).add(W),W);L.splice(d,0,Z),this._writeToHt(),this.activing=null,this._interactor._42()}},pp.prototype._checkEditRealPoint=function(E){var R,f,h,T,e,X,l=this,N=l.screenInfo.curve._curves,k=l._interactor.getStyle("curvePointIntersectSize"),Q=1/0;for(k*=k,h=0,T=N.length;T>h;h++)R=N[h],e=R._p1,X=E.distanceToSquared(e),Q>X&&(Q=X,f=e),e=R._p4,X=E.distanceToSquared(e),Q>X&&(Q=X,f=e);if(Q>k)return!1;var C=l.highlight={};return C.type="changeRealPoint",C.point=f,l.editing={type:"realPoint",point:f,shiftGuide:{point:f.clone(),dir:"x",limit:0}},l._interactor.setCursor("crosshair"),!0},pp.prototype._checkEditElevation=function(h){var O=this;if(!O._interactor.getStyle("curveElevationVisible"))return!1;var k=O.target;if(k instanceof R.Edge&&!O._interactor.getStyle("edgeElevationEditable"))return!1;var q=O.activing;if(!q)return!1;var D=q.getCurrentEditingPoint();if(!D)return!1;var m=O._interactor,K=m.getStyle("curveElevationGuideShift"),S=m.getStyle("curveElevationIntersectSize"),u=h.distanceToSquared({x:D.x+K[0],y:D.y+K[1]});if(!(u>S*S)){var F=O.highlight={};F.type="elevation";var L=new Sg.Math.Vector2(h.x,h.y,D.e);return O.editing={type:"elevation",startPoint:L},O._interactor.setCursor("crosshair"),!0}},pp.prototype._checkEditCtrlPoint=function(z){var I=this;if(I.activing&&!I.activing.selections){var M=I.getCurrentSelectintStatus();if(M!==Sg.Curve.PointType.Straight){var i=I.activing.pairs;if(i){var L=I._interactor.getStyle("curvePointIntersectSize");L*=L;var U,B,o,a,H,A,F,W,r,f=1/0;for(F=0,r=i.length;r>F;F++)for(a=i[F],W=0;2>W;W++)H=0===W?"c1":"c2",a[H]&&(A=z.distanceToSquared(a[H]),f>A&&(f=A,U=a,B=F,o=H));if(f>L)return!1;I.activing.hlpair=U,I.activing.hltype=o;var E=I.highlight={};return E.type="changeCtrlPoint",E.point=U[o],I.editing={type:"ctrlPoint",pair:U,pairId:B,ctrlType:o,direction:U[o].clone().sub(I.activing.point).normalize()},I._interactor.setCursor("crosshair"),!0}}}},pp.prototype.startEdit=function(V,G){V.startDragging(G);var l=this;l.highlight&&"insertKnot"===l.highlight.type&&(l.insertKnot(),l.gatherSingleTarget(l._interactor.gv,l.target),l.activing=null,l._checkEditRealPoint(l._interactor._getLogicalPoint(G)));var e=l._activing;if(e){var N=l.editing?l.editing.type:null;"ctrlPoint"===N?e.editingCtrl={pairId:l.editing.pairId,type:e.hltype}:"realPoint"===N&&(e.editingCtrl=!1)}var i=l.highlight,K=R.Default.isCtrlDown(G);if(!i||fr()||$q(G)){var f=l._interactor.gv;if(!f.setFocus(G)||f._scrolling)return;return K?l._multiSelect={startPoint:f.lp(G)}:f.isPannable()&&(Pd(G)||$q(G))&&(l._pan={tx:f.tx(),ty:f.ty()},V.fi({kind:"beginPan",event:G})),void 0}if("changeRealPoint"===i.type){var z,s=l.activing?l.activing.point:null,S=l.activing?l.activing.selections:null;if(K&&l.activing)s===i.point?(S?(l.activing={point:S[0]},S.length>1&&(S.splice(0,1),l.activing.selections=S)):l.activing=null,l.editing=null):S&&(z=S.indexOf(i.point))>=0?(S.length>1?S.splice(z,1):delete l.activing.selections,l.editing=null):S?(S.push(s),l.activing={point:i.point,selections:S}):l.activing={point:i.point,selections:[s]};else if(S)s===i.point||((z=S.indexOf(i.point))>=0?(S.splice(z,1,s),l.activing={point:i.point,selections:S}):l.activing={point:i.point});else{var $;s===i.point&&($=l.activing.status),l.activing={point:i.point},$&&(l.activing.status=$)}V.fi({kind:"beginEditPoint",event:G})}},pp.prototype.insertKnot=function(){var M=this,N=M.highlight,y=M.screenInfo.curve;y.insertKnot(N.bezier,N.point.t),M._writeToHt()},pp.prototype._writeToHt=function(){var D,q,c=this,G=c.screenInfo.curve,j=G.toHtShape(),U=j.points,Y=[],$=j.segments,y=c._interactor.gv;y.dm().beginTransaction();var S,i,V=c.target,O=V instanceof R.Edge,Q=Sg.getDataMatrix(V).invert();i=V instanceof R.Polyline||O&&c._interactor.getStyle("edgeElevationEditable"),i&&(S=V.getElevation&&V.getElevation()||0);for(var Z=0,X=U.length;X>Z;Z++)D=U[Z],q=Sg.toWorldPosition(y,D),q=Q.apply(q),isFinite(D.e)&&D.e!==S&&(q.e=D.e),Y.push(q);if(V._writing=!0,O){V.s("edge.type","points"),V.setStyle("edge.segments",$),V.setStyle("edge.points",Y.slice(1,Y.length-1)),V.setStyle("edge.source.offset.x",0),V.setStyle("edge.source.offset.y",0),V.setStyle("edge.target.offset.x",0),V.setStyle("edge.target.offset.y",0);var x=c._nextChangeEdgeHost;delete c._nextChangeEdgeHost,x&&("source"===x.type?V.setSource(x.host):V.setTarget(x.host)),c._writeEdgeHostAnchor("source",Y[0]),c._writeEdgeHostAnchor("target",Y[Y.length-1])}else Y.length?(V.setSegments($),V.setPoints(Y,!0)):V.removeFromDataModel();y.dm().endTransaction(),delete V._writing},pp.prototype._writeEdgeHostAnchor=function(U,F){var Z=this,k=Z.target,i=Z._calcHostAnchor(k,U,F);i.index!==B?(k.setStyle("edge."+U+".index",i.index),k.setStyle("edge."+U+".percent",B),k.setStyle("edge."+U+".anchor.x",B),k.setStyle("edge."+U+".anchor.y",B)):i.percent!==B?(k.setStyle("edge."+U+".percent",i.percent),k.setStyle("edge."+U+".index",B),k.setStyle("edge."+U+".anchor.x",B),k.setStyle("edge."+U+".anchor.y",B)):(k.s("edge."+U+".anchor.x",i.x),k.s("edge."+U+".anchor.y",i.y),k.s("edge."+U+".anchor.elevation",i.e),i.offsetX||i.offsetY?(k.s("edge."+U+".offset.x",i.offsetX),k.s("edge."+U+".offset.y",i.offsetY),k.s("edge."+U+".offset.elevation",i.offsetElevation)):(k.s("edge."+U+".offset.x",0),k.s("edge."+U+".offset.y",0),k.s("edge."+U+".offset.elevation",0)))},pp.prototype._calcHostAnchor=function(s,V,H,o){o||(o="source"===V?s.getSource():s.getTarget());var K=this._interactor.gv,m=K.calculateAttachPoint(o,H);if(m)return m.info;if(Jr(o)){var S=K.calculateEdgePosition(o,H);return S}var w=o.getRotation(),R=o.getAnchor();Yq(o,K)&&(w=0);var q=o.getElevation(),U=o.getTall();q=((H.e||0)-q)/U+.5;var O=o.getScale();if(w||O.x<0||O.y<0){var i=o.getMatrix(),W=i.tfi(H),h=o.getSize();return{x:W.x/h.width+R.x,y:W.y/h.height+R.y,e:q}}var J=ji(K,o),n={x:(H.x-J.x)/J.width,y:(H.y-J.y)/J.height,e:q};return n},pp.prototype._handlePanning=function(h){var b=this,T=b._pan;if(T){T.started=!0;var L=b._interactor,J=L.gv,i=L._lastClientPoint,C=Cd(h),D=cm(J,C,i);J.setTranslate(T.tx+D.x,T.ty+D.y),b.gatherSingleTarget(L.gv,b.target),L._42(),L.fi({kind:"betweenPan",event:h})}},pp.prototype.handleEdit=function(N,V){var P=this,U=P.editing;if(P._pan)return P._handlePanning(V),void 0;if(P._multiSelect)return P._multiSelect.endPoint=N.lp(V),P._interactor.redraw(),void 0;if(U){U.inEdit=!0;var T,Z,L,m=P._interactor._getLogicalPoint(V),S=R.Default.isCtrlDown(V),b=R.Default.isShiftDown(V),$=U.type,K=P.activing;if(P._guideInfo=null,"ctrlPoint"===$&&b){var y=P.editing.direction.clone();T=K.point;var t=y.dot(m.clone().sub(T));m=y.setLength(t).add(T)}else if("ctrlPoint"===$||"realPoint"===$){var y;if("realPoint"===$&&b){var E=P.editing.shiftGuide;Z=E.point;var p=Math.abs(m.x-Z.x),e=Math.abs(m.y-Z.y);p>e&&p>E.limit&&"y"===E.dir&&(E.dir="x"),e>p&&e>E.limit&&"x"===E.dir&&(E.dir="y"),y=E.dir,"x"===y?(m.y=Z.y,E.limit=Math.max(E.limit,p)):"y"===y&&(m.x=Z.x,E.limit=Math.max(E.limit,e))}var D=P._isEditEdgeSourceTarget();if(D){var r=P._editEdgeSourceTarget(D,m,S);r&&(P.edgeEditResult=r,L=r.tipText)}else if(!S){var v=P._guidingToEdit(m,y),Q="realPoint"===$?P._interactor.gridGuide.findClosest(m,y,!0):null,z=1/0,_=1/0;Q&&(Q.x&&(z=Q.x),Q.y&&(_=Q.y));var X=!1;v&&(v.xList&&(Math.abs(v.x)<=Math.abs(z)?(X=!0,z=v.x):delete v.xList),v.yList&&(Math.abs(v.y)<=Math.abs(_)?(X=!0,_=v.y):delete v.yList),X&&(P._guideInfo=v)),isFinite(z)&&(m.x+=z),isFinite(_)&&(m.y+=_),X&&(v.v=m)}}var o=P.screenInfo.curve;if("realPoint"===U.type){T=U.point,T.e!==B&&(m.e=T.e),o.moveRealPoint(T,m),U.point=m,P.highlight.point=m;var F=K.status,J=K.selections;if(P.activing={point:m,status:F},J){var g=m.clone().sub(T),i=0;J.forEach(function($){var m=$.clone().add(g);o.moveRealPoint($,m),J[i++]=m}),P.activing.selections=J}}else if("ctrlPoint"===U.type){var c=K.pairs,C=c[U.pairId];o.moveCtrlPoint(C,m,U.ctrlType);var d=K.status,H=Sg.Curve.PointType;if((d===H.Mirrored||d===H.Asymmetric)&&C.c1&&C.c2){var T=new Sg.Math.Vector2(K.point),O="c1"===U.ctrlType?"c2":"c1";if(d===Sg.Curve.PointType.Mirrored)o.moveCtrlPoint(C,T.clone().multiplyScalar(2).sub(m),O);else if(d===H.Asymmetric){var t=C[O].clone().sub(T).length(),I=T.clone().sub(C[U.ctrlType]).setLength(t).add(T);isNaN(I.x)||o.moveCtrlPoint(C,I,O)}}K._firePointChange()}else if("elevation"===U.type){Z=U.startPoint;var k=Z.e+(Z.y-m.y)/N._zoom;P._setCurrentPointImpl("e",k),K._firePointChange(),L="E: "+Sg.toFixed(k)}var h=R.Default.getLogicalPoint(V,P._interactor._canvas);if(h.x+=Sg.Icons.TipShiftX,h.y+=Sg.Icons.TipShiftY,!L){var W=Sg.toWorldPosition(N,m);L=""+Sg.toFixed(W.x)+", "+Sg.toFixed(W.y)}P.tipInfo={helperPos:h,text:L,size:L.length},P._writeToHt(),P._interactor.fi({kind:"betweenEditPoint",event:V})}},pp.prototype._setCurrentPointImpl=function(X,L){var T=this,G=T._activing;if(!G)return!1;var Y=T.target;if(!Y)return!1;var p=G.getCurrentEditingPoint();if(!p)return!1;var q=G.editingCtrl;if(!q)var t=p.clone();if("e"===X)p.e=L;else{var V;if("x"===X||"y"===X){var I=G._lastFirePoint;V="x"===X?{x:L,y:I?I.y:0}:{x:I?I.x:0,y:L}}else"object"==typeof X?(V=X,X.e!==B&&(p.e=X.e)):(V={x:arguments[0],y:arguments[1]},arguments[2]!==B&&(p.e=arguments[2]));var s=Sg.getDataMatrix(Y);V=Sg.toScreenPosition(T._interactor.gv,s.apply(V)),p.x=V.x,p.y=V.y}if(!q){var M=t.multiplyScalar(-1).add(p);p.e&&t.e&&(M.e=p.e-t.e);var w=T.screenInfo.curve;w.moveCtrlDueToRealPointMovement(p,M);var x=G.selections;if(x){var Z=0;x.forEach(function(y){var S=y.clone().add(M);isFinite(M.e)&&(S.e=(isFinite(y.e)?y.e:Y.getElevation()||0)+M.e),w.moveRealPoint(y,S),x[Z++]=S}),G.selections=x}}return!0},pp.prototype.setCurrentPoint=function(w,j){return this._setCurrentPointImpl(w,j)?(this._writeToHt(),!0):!1},pp.prototype._isEditEdgeSourceTarget=function(){var i=this,D=i.target;if(!(D instanceof R.Edge))return!1;var c=i.editing.point,e=i.screenInfo.curve._curves;return c===e[0]._p1?"source":c===e[e.length-1]._p4?"target":!1},pp.prototype._editEdgeSourceTarget=function(L,N,q){var M,o=this,c=o.target;if(M="source"===L?c.getSource():c.getTarget()){var i,I=o._interactor.gv,z=Sg.toWorldPosition(I,N),d=o._calcHostAnchor(c,L,z,M);if(i=d.index!==B||d.percent!==B?d.distance*I.getZoom()>o._interactor.getStyle("edgeHostEdgeMaxDistance"):o._interactor.getStyle("edgeHostDetectPerFrame")?!0:d.x<0||d.x>1||d.y<0||d.y>1?!0:!1){var v=I.getDataAt(z,function(z){return I.isSelectable(z)?I.isSourceTargetEditable(c,z,L)?c.canSetSourceTarget(z,L)?!0:!1:!1:!1});if(v){var t=o._calcHostAnchor(c,L,z,v);M=v,o._nextChangeEdgeHost={type:L,host:v},d=t}}var O,A,K;if(q||d.x===B)(d.percent!==B||d.index!==B)&&(A=d.point);else{var Q=o._interactor.getStyle("anchorRound"),y=o._interactor.getStyle("anchorSensitivity");O=I.calculateAttachPoint(M,z),O?d=O.info:(d.x=Sg.roundTo(d.x,Q,y),d.y=Sg.roundTo(d.y,Q,y)),A=Hg(I,M,0,d.offsetX||0,d.offsetY||0,d.x,d.y)}A&&(K=Sg.toScreenPosition(I,A),N.x=K.x,N.y=K.y),o._edgeHostGuideInfo={corners:Sg.getTargetCornersOnScreen(I,M),attach:O?O.index:-1,host:M};var w;return d.percent!==B?w="percent: "+d.percent.toFixed(2):d.index!==B?w="index: "+d.index:(w=""+d.x.toFixed(2)+", "+d.y.toFixed(2),(d.offsetX||d.offsetY)&&(w+=" offset: "+d.offsetX.toFixed(2)+", "+d.offsetY.toFixed(2))),{host:M,anchor:d,tipText:w}}},pp.prototype._guidingToEdit=function(d,V){var L,n,z=this;if(L=z.screenInfo.curve){n=L._curves;var B,Y,J,G,q,D,m,F,N=1/0,K=1/0,S=[];for(z.editing&&"realPoint"===z.editing.type&&(F=z.editing.point),q=0,D=2*n.length;D>q;q++)m=n[Math.floor(q/2)][q%2?"_p4":"_p1"],S.indexOf(m)>=0||(S.push(m),F&&F===m||(J=m.x-d.x,G=m.y-d.y,Math.abs(J)<Math.abs(N)?(N=J,B=[m]):J===N&&B.push(m),Math.abs(G)<Math.abs(K)?(K=G,Y=[m]):G===K&&Y.push(m)));var v=z._interactor.getStyle("smartGuideThreshold");if((Math.abs(N)>v||"y"===V)&&(B=null),(Math.abs(K)>v||"x"===V)&&(Y=null),B||Y){var k=!1,C={};if(B&&(k=!0,C.xList=B,C.x=N),Y&&(k=!0,C.yList=Y,C.y=K),k)return C}}},pp.prototype._46O=function(B){var j=this;j.editing&&(j.editing=null,j._interactor.fi({kind:"endEditPoint",event:B})),j._guideInfo=null,j._edgeHostGuideInfo=null,j._pan&&(j._pan=null,j._interactor.fi({kind:"endPan",event:B})),j._multiSelect&&(j._handleMultiSelect(j._multiSelect),j._multiSelect=null),j.tipInfo=null,j.edgeEditResult=null},pp.prototype._handleMultiSelect=function(G){if(G.startPoint&&G.endPoint){var D,h,Q,e,w,y=this,F=y._interactor,H=F.gv,Y=Sg.toScreenPosition(H,G.startPoint),J=Sg.toScreenPosition(H,G.endPoint),f=R.Default.unionPoint(Y,J),m=y.screenInfo.curve._curves,W=[],s=function(a){a.x>=f.x&&a.y>=f.y&&a.x<=f.x+f.width&&a.y<=f.y+f.height&&W.indexOf(a)<0&&W.push(a)};for(D=0,h=m.length;h>D;D++)w=m[D],s(w._p1),s(w._p4);if(W.length){var E=y.activing||{},i=E.selections||[];for(E.point&&i.push(E.point),D=0,h=i.length;h>D;D++)Q=i[D],e=W.indexOf(Q),e>=0?W[e]=B:W.push(Q);var X=W;for(W=[],D=0,h=X.length;h>D;D++)X[D]&&W.push(X[D]);h=W.length,0===h?y.activing=null:1===h?y.activing={point:W[0]}:(Q=W[h-1],y.activing={point:Q,selections:W.splice(0,h-1)}),F.redraw()}}},pp.prototype._canDeletePoint=function(m,j){var V=this.target;if(!(V instanceof R.Edge))return!0;var S=m._curves[0],w=m._curves[m._curves.length-1];return S._p1===j||w._p4===j?!1:!0},pp.prototype.handleDelete=function(){var K=this;if(K.activing&&K.screenInfo){var q=R.Default.isShiftDown(),j=K.screenInfo.curve;K._canDeletePoint(j,K.activing.point)&&j.deleteRealPoint(K.activing.point,q),K.activing.selections&&K.activing.selections.forEach(function(X){K._canDeletePoint(j,X)&&j.deleteRealPoint(X,q)}),K.activing=null,delete K.editing,delete K.tipInfo,delete K.edgeEditResult,delete K._pan,delete K._multiSelect,K._writeToHt(),K._interactor.fp("deleteShapePoint",!1,!0)}},pp.prototype.handleDoubleClick=function(P){var m=this,t=m._interactor._getLogicalPoint(P);if(m.screenInfo&&m._checkEditRealPoint(t)){var Q=m.getCurrentSelectintStatus(),p=Sg.Curve.PointType;return Q=Q===p.Mirrored?p.Straight:p.Mirrored,m._setCurrentSelectionStatus(Q),m._interactor._42(),!0}},pp.prototype._drawHighlight=function(N){var D=this,n=D.highlight;if(n){var C=n.bezier,y=D._interactor;C&&Sg.Icons.DrawIcon(y,N,Sg.Icons.ShapeHighlightCurve,[C._p1.x,C._p1.y,C._p2.x,C._p2.y,C._p3.x,C._p3.y,C._p4.x,C._p4.y]);var J=n.point;J&&"insertKnot"===n.type&&Sg.Icons.DrawIcon(y,N,Sg.Icons.ShapeHighlighPoint,J)}},pp.prototype._drawGuide=function(S){var v=this,N=v._guideInfo;if(N){var o,i,L,O,H=N.v;for(o=0;2>o;o++)if(O=0===o?N.xList:N.yList)for(i=0,L=O.length;L>i;i++)Sg.Icons.DrawIcon(v._interactor,S,Sg.Icons.ShapeGuideLine,[H.x,H.y,O[i].x,O[i].y])}},pp.prototype._drawCurrentPoint=function(P){var L=this;if(L.activing){var z=L.activing,_=L.getCurrentSelectintStatus(),g=L._interactor;if(_!==Sg.Curve.PointType.Straight){var T=z.pairs;z.hlpair,z.hltype;
var Q=z.selections,r=z.editingCtrl;if(T&&!Q){var U,x,h;for(x=0,h=T.length;h>x;x++)U=T[x],r&&x===r.pairId&&U[r.type]?Sg.Icons.DrawIcon(g,P,Sg.Icons.ShapeActivingCtrl,{point:U.point,c1:U.c1,c2:U.c2,hl:r.type}):Sg.Icons.DrawIcon(g,P,Sg.Icons.ShapeActivingCtrl,U)}}Sg.Icons.DrawIcon(g,P,Sg.Icons.ShapeHighlighRealPoint,L.activing.point),Q&&Q.forEach(function(y){Sg.Icons.DrawIcon(g,P,Sg.Icons.ShapeHighlighRealPoint,y)})}},pp.prototype.clear=function(){var J=this;J.editing=null,J._guideInfo=null,J.activing=null,J.highlight=null},pp.prototype._42=function(m){var K=this;K.info={},K.editing||(K.screenInfo=null);var u=K._interactor;if(!u.editDetail)return K.clear(),void 0;var z=u.gv;if(!K.target||!z.isSelected(K.target)||!z.isVisible(K.target))return u.editDetail=!1,K.clear(),void 0;if(K.gatherSingleTarget(z,K.target),Sg.Icons.DrawIcon(u,m,Sg.Icons.ShapeBgCurve,K.screenInfo),K._interactor.getStyle("curveElevationVisible")&&(K.target instanceof R.Polyline||K.target instanceof R.Edge&&K._interactor.getStyle("edgeElevationEditable"))&&K.activing){var P=K.activing.getCurrentEditingPoint();P&&"string"!=typeof P.e&&Sg.Icons.DrawIcon(u,m,Sg.Icons.EdgeElevationGuide,P)}if(K._drawHighlight(m),K._drawCurrentPoint(m),K._getRealPoint().forEach(function(b){Sg.Icons.DrawIcon(u,m,Sg.Icons.ShapePoint,b)}),K._drawGuide(m),K.tipInfo&&K._interactor.getStyle("curveTipVisible")&&Sg.Icons.DrawIcon(u,m,Sg.Icons.TipHelper,K.tipInfo),K._edgeHostGuideInfo&&u._drawHostGuide(K._edgeHostGuideInfo),K.edgeEditResult&&K._drawEdgeHostHighlight(m,K.edgeEditResult.host,K.edgeEditResult.anchor),K._multiSelect&&K._multiSelect.endPoint){var O=R.Default.unionPoint(Sg.toScreenPosition(z,K._multiSelect.startPoint),Sg.toScreenPosition(z,K._multiSelect.endPoint));O.color=z.getRectSelectBorderColor(),m.save(),m.setTransform(1,0,0,1,0,0);var H=l.devicePixelRatio,M=O.borderWidth=Math.round(H);M/=2,O.x=Math.round(O.x*H)+M,O.y=Math.round(O.y*H)+M,O.width=Math.round(O.width*H),O.height=Math.round(O.height*H),Sg.Icons.DrawIcon(u,m,Sg.Icons.SimpleRect,O),m.restore()}},pp.prototype._drawEdgeHostHighlight=function(l,Z,b){this.drawEdgeHostHighlight(l,Z,b),this._interactor.redraw()},pp.prototype.drawEdgeHostHighlight=function(Y,E,u){if(Jr(E)){var n,z,g,i,W=this,e=W._interactor,$=e.gv,h=$.getDataUI(E),N=el(h),U=[];for(g=0,i=N.points.length;i>g;g++)z=Sg.toScreenPosition($,N.points.get(g)),U.push(z.x,z.y);N.segments&&(n=N.segments.toArray());var M=e.getStyle("edgeHostHighlighPeriod"),k=e.getStyle("edgeHostEdgeHighlighColor");Sg.Icons.DrawIcon(e,Y,Sg.Icons.ShapeBgCurve,{P:U,S:n,color:k,dynamicVisible:u.index===B,dynamicPeriod:M}),k=e.getStyle("edgeHostPointHighlighColor");var X=Kp(h);for(g=0,i=X.length;i>g;g++){var r=X[g],f=Sg.toScreenPosition($,r);Sg.Icons.DrawIcon(e,Y,Sg.Icons.ShapePoint,{point:{x:f.x,y:f.y},color:k,size:12,dynamicVisible:g===u.index,dynamicPeriod:M})}}},pp.prototype._getRealPoint=function(){var f,m=this.screenInfo,v=m.P,i=m.S,C=-1,$=[],s=-1,d=i.length;return i.each(function(N){s++;var P=1;if(3===N)P=2;else if(4===N)P=3;else if(5===N)return;C+=P,f=s+1>=d?!0:1===i.get(s+1)?!0:!1,$.push({point:{x:v[2*C],y:v[2*C+1]},segmentIndex:s,pointIndex:C,isEnd:f})}),$},pp.prototype.getEditingPointsInfo=function(V){var Q=this,i=Q.activing;if(!i)return!1;var r=i.point;if(!r)return!1;var B=this._getRealPoint(),x=[{screen:r}];i.selections&&i.selections.forEach(function(W){x.push({screen:W})});var S,C,k=B.length;return x.forEach(function(f){for(S=0;k>S;S++)if(C=B[S],f.screen.isNearEnough(C.point)){f.segmentIndex=C.segmentIndex,f.pointIndex=C.pointIndex,f.point=Q.target.getPoints().get(C.pointIndex);break}}),V&&x.sort(function(j,I){return j.segmentIndex-I.segmentIndex}),x};var Oc=Sg.MoveHelper=function(Y){var l=this;l.catalog="Move",l._interactor=Y};Oc.prototype={},Oc.prototype.constructor=Oc,Oc.prototype.calcShift=function(K,L,n){var C,X,q=this,o=q._interactor.gv,Z=o.lp(L);if("beginMove"===K&&q._gatherGridInfo(n._lastLogicalPoint||Z),C=q._target){var k=C.downPosition;if(k){var I=q._interactor.getStyle("moveSensitivity")/o._zoom;if(k.distanceTo(Z)<I)return{x:0,y:0};delete C.downPosition}var B;X=R.Default.isShiftDown(L),X&&(Z=q._dealShiftDown(Z),B=C.shiftGuide.dir);var t,c=C.rawPos={x:C.pos.x+Z.x-C.lp.x,y:C.pos.y+Z.y-C.lp.y};if(R.Default.isCtrlDown(L)){if(t=q._calcShiftByAddon(),q._target.node instanceof Sg.Group){var M=q._target.node;M._position.x+=t.x,M._position.y+=t.y}return t}var z=q._interactor.rectGuide;if(C.node instanceof R.Data&&C.node.s("2d.attachable")){var D=q._calcAttachNodeShift(C.node,c);if(z.clear(),D)return D}for(var T,j=C.x+c.x,H=C.y+c.y,m={x:j,y:H},d={x:j+C.w/2,y:H+C.h/2},i={x:j+C.w,y:H+C.h},F=q._interactor.gridGuide,_=[z.findClosest(m,B),z.findClosest(d,B),z.findClosest(i,B),F.findClosest(m,B),F.findClosest(d,B),F.findClosest(i,B)],x=1/0,Y=1/0,O=0,l=_.length;l>O;O++)T=_[O],T&&(j=T.x,H=T.y,isFinite(j)&&Math.abs(j)<Math.abs(x)&&(x=j),isFinite(H)&&Math.abs(H)<Math.abs(Y)&&(Y=H));if(isFinite(x)||(x=0),isFinite(Y)||(Y=0),t=q._calcShiftByAddon(x,Y),q._target.node instanceof Sg.Group){var M=q._target.node;M._position.x+=t.x,M._position.y+=t.y}var a=C.node;if(!Yq(a,o)){var g=c.x+x,V=c.y+Y;q._interactor.rectGuide.gatherLines({node:a,x:C.x+g,y:C.y+V,w:C.w,h:C.h},B)}return t}},Oc.prototype._calcShiftByAddon=function(m,U){var f=this._target,l=f.rawPos,S=f.node.getPosition();return m=m||0,U=U||0,{x:l.x-S.x+m,y:l.y-S.y+U}},Oc.prototype._dealShiftDown=function(N){var M=this,n=M._target.shiftGuide,t=M._target.lp,v=Math.abs(N.x-t.x),B=Math.abs(N.y-t.y);v>B&&v>n.limit&&"y"===n.dir&&(n.dir="x"),B>v&&B>n.limit&&"x"===n.dir&&(n.dir="y");var o=n.dir;return"x"===o?(N.y=t.y,n.limit=Math.max(n.limit,v)):"y"===o&&(N.x=t.x,n.limit=Math.max(n.limit,B)),N},Oc.prototype._isAttachableLineShape=function(f){if(!f.getSegments)return!1;var C=f.getSegments();if(!C)return!0;C instanceof R.List&&(C=C.getArray());for(var X=1,V=C.length;V>X;X++)if(2!==C[X])return!1;return!0},Oc.prototype._calcAttachNodeShift=function(){var a=new ph,x=new ph,l=new ph,Z=new ph;return function(t,w){var J=this._interactor.gv,p=t.getHost(),W=J.getDataAt(w,function(f){return f.s("2d.hostable")?!0:!1});if(W&&p!==W&&t.setHost(W),!W)return this._edgeHostGuideInfo=null,t.setHost(null);var Y=this._edgeHostGuideInfo={corners:Sg.getTargetCornersOnScreen(J,W),host:W,attach:-1};if(this._isAttachableLineShape(W)){for(var H,S,d,D,T,c,C=W.getPoints(),P=C.size(),h=W.getPointsMatrix2d(),y=1/0,n=0;P>n&&(n!==P-1||W.isClosePath());n++)0!==n?x.copy(l):h.apply(C.get(n),x),h.apply(n===P-1?C.get(0):C.get(n+1),l),a.copy(w).sub(x),Z.copy(l).sub(x),H=Z.length(),Z.divideScalar(H),S=a.dot(Z),0>S?S=0:S>H&&(S=H),Z.multiplyScalar(S).add(x),d=a.copy(w).sub(Z).lengthSq(),y>d&&(y=d,c=n,D=S,T=H);return Math.sqrt(y)*J.getZoom()>this._interactor.getStyle("attachThreshold")?(t.s({"attach.index":-1}),t.setHost(null),void 0):(t.s("attach.offset.opposite")&&(D=T-D),t.s({"attach.index":c,"attach.offset":t.s("attach.offset.relative")?D/T:D}),{x:0,y:0})}var z=J.calculateAttachPoint(W,w);if(z){var Q=z.point;return Y.attach=z.index,this._calcShiftByAddon(Q.x-w.x,Q.y-w.y)}}}(),Oc.prototype._gatherGridInfo=function(l){var g,m=this,$=m._interactor,x=$._getValidSelection();if(x.length){if(1===x.length){if(g=x[0],!g.getRect)return m._target=null,void 0}else if(g=Sg.Group.findOrCreateGroup(x),!g)return m._target=null,void 0}else{var x=$.gv.sm().getSelection();if(x.length&&(g=x.get(0),!g.getRect))return m._target=null,void 0}if(g){var b=g.getPosition(),f=g.getRect();m._target={node:g,x:f.x-b.x,y:f.y-b.y,w:f.width,h:f.height,lp:{x:l.x,y:l.y},pos:{x:b.x,y:b.y},shiftGuide:{dir:"x",limit:0},downPosition:new Sg.Math.Vector2(l)},$.rectGuide.gatherRects()}},Oc.prototype.clear=function(){var D=this;D._edgeHostGuideInfo=null,D._interactor.rectGuide.clear(),D._interactor._42()},Oc.prototype._42=function(){var G=this._edgeHostGuideInfo;G&&this._interactor._drawHostGuide(G)};var uo=w.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),ho=function(){function d(e,c){var V=B;return function(){return V||(V=e.getExtension(c)),V}}function r(k,V){V==B&&(V={}),V.version=l&&(k instanceof WebGL2RenderingContext||w.prototype.toString.call(k)===D)?2:1,V.extensions=function(){for(var a={},b=k.getSupportedExtensions(),z=b.length;z--;)a[name]=d(k,b[z]);return a}();for(var Y=w.keys(Q),I=0,p=Y.length;p>I;++I){var g=Y[I];V[g]=k.getParameter(Q[g])}if(V.version>1){Y=w.keys(P);for(var I=0,p=Y.length;p>I;++I){var g=Y[I];V[g]=k.getParameter(P[g])}}return V}var l="undefined"!=typeof WebGL2RenderingContext,D="[object WebGL2RenderingContext]",Q={aliasedLineWidthRange:uo.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:uo.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:uo.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:uo.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:uo.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:uo.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:uo.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:uo.MAX_TEXTURE_SIZE,maxVaryingVectors:uo.MAX_VARYING_VECTORS,maxVertexAttribs:uo.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:uo.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:uo.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:uo.MAX_VIEWPORT_DIMS},P={max3DTextureSize:uo.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:uo.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:uo.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:uo.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:uo.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:uo.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:uo.MAX_DRAW_BUFFERS,maxElementIndex:uo.MAX_ELEMENT_INDEX,maxElementsIndices:uo.MAX_ELEMENTS_INDICES,maxElementsVertices:uo.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:uo.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:uo.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:uo.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:uo.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:uo.MAX_SAMPLES,maxTextureLODBias:uo.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:uo.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:uo.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:uo.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:uo.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:uo.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:uo.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:uo.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:uo.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:uo.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:uo.MIN_PROGRAM_TEXEL_OFFSET};return{"for":function(a){var j=a._info;return j||(a._info=j=r(a,j)),j}}}(),ld=function(){function T(r,S,j){return{def:r,getter:j?function(g){var G=ho.for(g);return G.version>1?g.getParameter(S):r}:function(t){return t.getParameter(S)},setter:j?function(L,P){var c=ho.for(L);c.version>1&&L.pixelStorei(S,P)}:function(R,m){R.pixelStorei(S,m)}}}function b(y){return"string"==typeof y?vg(y):y.r!==B?(N[0]=y.r,N[1]=y.g,N[2]=y.b,N[3]=y.a,N):y.red!==B?(N[0]=y.red,N[1]=y.green,N[2]=y.blue,N[3]=y.alpha,N):y}function Z(L){return o(L)?Array.prototype.slice.call(L,0):L}function h(Y,x,T){this.gl=x,this._record=T||{},this._branches={},this._leafSync={},this._struct=Y;for(var M=Y.children,l=M.length;l--;){var X=M[l],i=X.name;X.isLeaf?(this._leafSync[i]=!1,this._record[i]=Z(X.desc.def)):this._record[i]={}}}function x(L){function r(Q,C){h.call(this,L,Q,C);for(var i=u.length;i--;){var Z=u[i];this._branches[Z._name]=new Z._type(Q,this._record[Z._name])}}function W(t,B){function W(D,S){for(var R=H,K=!1;R--;)D[R]!==S[R]&&(D[R]=S[R],K=!0);return K}var Z=t.name,L=o(t.desc.def),H=L&&t.desc.def.length;if(t.isLeaf){var e=t.desc.setter,p=t.desc.parse;w.defineProperty(B,Z,{configurable:!1,enumerable:!0,get:function(){return this._record[Z]},set:L?function(V){p&&(V=p(V)),(W(this._record[Z],V)||!this._leafSync[Z])&&(e(this.gl,this._record[Z]),this._leafSync[Z]=!0)}:function(U){this._record[Z]===U&&this._leafSync[Z]||(e(this.gl,U),this._record[Z]=U,this._leafSync[Z]=!0)}})}else u.push({_name:Z,_type:x(t)}),w.defineProperty(B,Z,{configurable:!1,enumerable:!0,get:function(){return this._branches[Z]},set:function(W){this._branches[Z].apply(W)}})}var u=[];return F(r,h),L.forEach(W,r.prototype),r}var N="undefined"!=typeof Float32Array&&new Float32Array(4),I={viewport:{def:[0,0,0/0,0/0],getter:function(C){return C.getParameter(C.VIEWPORT)},setter:function(L,J){var Q=J[2]!==J[2]?L.drawingBufferWidth-J[0]:J[2],s=J[3]!==J[3]?L.drawingBufferHeight-J[1]:J[3];L.viewport(J[0],J[1],Q,s)}},dither:{def:!1,getter:function(q){return q.isEnabled(q.DITHER)},setter:function(M,g){g?M.enable(M.DITHER):M.disable(M.DITHER)}},rasterizerDiscard:{def:!1,getter:function(C){var T=ho.for(C);return T.version>1&&C.isEnabled(C.RASTERIZER_DISCARD)},setter:function(A,W){var o=ho.for(A);1!==o.version&&(W?A.enable(A.RASTERIZER_DISCARD):A.disable(A.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(d){return d.lineWidth?d.getParameter(d.LINE_WIDTH):1},setter:function(q,R){q.lineWidth&&q.lineWidth(R)}},color:{clear:{def:[0,0,0,0],getter:function(o){return o.getParameter(o.COLOR_CLEAR_VALUE)},setter:function(L,J){L.clearColor(J[0],J[1],J[2],J[3])},parse:b},mask:{def:[!0,!0,!0,!0],getter:function(M){return M.getParameter(M.COLOR_WRITEMASK)},setter:function(m,Y){m.colorMask(Y[0],Y[1],Y[2],Y[3])}}},blend:{enabled:{def:!1,getter:function(W){return W.isEnabled(W.BLEND)},setter:function(c,s){s?c.enable(c.BLEND):c.disable(c.BLEND)}},color:{def:[0,0,0,0],getter:function(c){return c.getParameter(c.BLEND_COLOR)},setter:function(L,S){L.blendColor(S[0],S[1],S[2],S[3])},parse:b},equation:{def:[uo.FUNC_ADD,uo.FUNC_ADD],getter:function(p){return[p.getParameter(p.BLEND_EQUATION_RGB),p.getParameter(p.BLEND_EQUATION_ALPHA)]},setter:function(j,A){j.blendEquationSeparate(A[0],A[1])},parse:function(n){var l=n.length;return l>1?n:1===l?(N[1]=N[0]=n[0],N):(N[1]=N[0]=n,N)}},func:{def:[uo.ONE,uo.ZERO,uo.ONE,uo.ZERO],getter:function(e){return[e.getParameter(e.BLEND_SRC_RGB),e.getParameter(e.BLEND_DST_RGB),e.getParameter(e.BLEND_SRC_ALPHA),e.getParameter(e.BLEND_DST_ALPHA)]},setter:function(C,S){C.blendFuncSeparate(S[0],S[1],S[2],S[3])},parse:function(r){var d=r.length;return d>3?r:(N[2]=N[0]=r[0],N[3]=N[1]=r[1],N)}}},cullFace:{enabled:{def:!1,getter:function(c){return c.isEnabled(c.CULL_FACE)},setter:function(t,n){n?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE)}},mode:{def:uo.BACK,getter:function(a){return a.getParameter(a.CULL_FACE_MODE)},setter:function(Z,u){Z.cullFace(u)}},frontFace:{def:uo.CCW,getter:function(H){return H.getParameter(H.FRONT_FACE)},setter:function($,H){$.frontFace(H)}}},scissor:{enabled:{def:!1,getter:function(I){return I.isEnabled(I.SCISSOR_TEST)},setter:function(B,t){t?B.enable(B.SCISSOR_TEST):B.disable(B.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(I){return I.getParameter(I.SCISSOR_BOX)},setter:function(Y,_){var z=_[2]!==_[2]?Y.drawingBufferWidth-_[0]:_[2],q=_[3]!==_[3]?Y.drawingBufferHeight-_[1]:_[3];Y.scissor(_[0],_[1],z,q)}}},depth:{enabled:{def:!1,getter:function(w){return w.isEnabled(w.DEPTH_TEST)},setter:function(L,A){A?L.enable(L.DEPTH_TEST):L.disable(L.DEPTH_TEST)}},clear:{def:1,getter:function(q){return q.getParameter(q.DEPTH_CLEAR_VALUE)},setter:function(B,b){B.clearDepth(b)}},mask:{def:!0,getter:function(m){return m.getParameter(m.DEPTH_WRITEMASK)},setter:function(U,W){U.depthMask(W)}},range:{def:[-1,1],getter:function(i){return i.getParameter(i.DEPTH_RANGE)},setter:function(s,$){s.depthRange($[0],$[1])}},func:{def:uo.LESS,getter:function(l){return l.getParameter(l.DEPTH_FUNC)},setter:function(k,o){k.depthFunc(o)}}},stencil:{enabled:{def:!1,getter:function(U){return U.isEnabled(U.STENCIL_TEST)},setter:function(s,A){A?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST)}},clear:{def:0,getter:function(H){return H.getParameter(H.STENCIL_CLEAR_VALUE)},setter:function(U,S){U.clearStencil(S)}},frontMask:{def:255,getter:function(k){return k.getParameter(k.STENCIL_WRITEMASK)},setter:function(a,q){a.stencilMaskSeparate(a.FRONT,q)}},frontOp:{def:[uo.KEEP,uo.KEEP,uo.KEEP],getter:function(J){return[J.getParameter(J.STENCIL_FAIL),J.getParameter(J.STENCIL_PASS_DEPTH_FAIL),J.getParameter(J.STENCIL_PASS_DEPTH_PASS)]},setter:function(N,l){N.stencilOpSeparate(N.FRONT,l[0],l[1],l[2])}},frontFunc:{def:[uo.ALWAYS,0,255],getter:function(G){return[G.getParameter(G.STENCIL_FUNC),G.getParameter(G.STENCIL_REF),G.getParameter(G.STENCIL_VALUE_MASK)]},setter:function(B,V){B.stencilFuncSeparate(B.FRONT,V[0],V[1],V[2])}},backMask:{def:255,getter:function(g){return g.getParameter(g.STENCIL_BACK_WRITEMASK)},setter:function(a,q){a.stencilMaskSeparate(a.BACK,q)}},backOp:{def:[uo.KEEP,uo.KEEP,uo.KEEP],getter:function(M){return[M.getParameter(M.STENCIL_BACK_FAIL),M.getParameter(M.STENCIL_BACK_PASS_DEPTH_FAIL),M.getParameter(M.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(M,w){M.stencilOpSeparate(M.BACK,w[0],w[1],w[2])}},backFunc:{def:[uo.ALWAYS,0,255],getter:function(O){return[O.getParameter(O.STENCIL_BACK_FUNC),O.getParameter(O.STENCIL_BACK_REF),O.getParameter(O.STENCIL_BACK_VALUE_MASK)]},setter:function(Z,x){Z.stencilFuncSeparate(Z.BACK,x[0],x[1],x[2])}}},hint:{generateMipmap:{def:uo.DONT_CARE,getter:function(b){return b.getParameter(b.GENERATE_MIPMAP_HINT)},setter:function(f,W){f.hint(f.GENERATE_MIPMAP_HINT,W)}},fragmentShaderDerivative:{def:uo.DONT_CARE,getter:function(I){var U=ho.for(I);return 1!==U.version||U.extensions.OES_standard_derivatives?I.getParameter(uo.FRAGMENT_SHADER_DERIVATIVE_HINT):uo.DONT_CARE},setter:function(O,A){var s=ho.for(O);return s.version>1||s.extensions.OES_standard_derivatives?(O.hint(uo.FRAGMENT_SHADER_DERIVATIVE_HINT,A),void 0):void 0}}},pixelStore:{packAlignment:T(4,uo.PACK_ALIGNMENT,!1),unpackAlignment:T(4,uo.UNPACK_ALIGNMENT,!1),unpackFlipY:T(!1,uo.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:T(!1,uo.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:T(uo.BROWSER_DEFAULT_WEBGL,uo.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:T(0,uo.PACK_ROW_LENGTH,!0),packSkipPixels:T(0,uo.PACK_SKIP_PIXELS,!0),packSkipRows:T(0,uo.PACK_SKIP_ROWS,!0),unpackRowLength:T(0,uo.UNPACK_ROW_LENGTH,!0),unpackImageHeight:T(0,uo.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:T(0,uo.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:T(0,uo.UNPACK_SKIP_ROWS,!0),unpackSkipImages:T(0,uo.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(t){return t.isEnabled(t.POLYGON_OFFSET_FILL)},setter:function(P,N){N?P.enable(P.POLYGON_OFFSET_FILL):P.disable(P.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(n){return[n.getParameter(n.POLYGON_OFFSET_FACTOR),n.getParameter(n.POLYGON_OFFSET_UNITS)]},setter:function(f,I){f.polygonOffset(I[0],I[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(T){return T.isEnabled(T.SAMPLE_COVERAGE)
},setter:function(h,r){r?h.enable(h.SAMPLE_COVERAGE):h.disable(h.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(B){return B.isEnabled(B.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(S,J){J?S.enable(S.SAMPLE_ALPHA_TO_COVERAGE):S.disable(S.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(w){return[w.getParameter(w.SAMPLE_COVERAGE_VALUE),w.getParameter(w.SAMPLE_COVERAGE_INVERT)]},setter:function(p,u){p.sampleCoverage(u[0],u[1])}}}},q=jn.create(I,function(S){return"def"in S});h.prototype.reset=function(){for(var I=this._struct.children,s=I.length;s--;){var o=I[s],x=o.name;o.isLeaf?this[x]=o.desc.def:this._branches[x].reset()}},h.prototype.save=function(H){H==B&&(H={});for(var W=this._struct.children,V=W.length;V--;){var m=W[V],$=m.name;if(m.isLeaf)H[$]=Z(this._record[$]);else{var X=H[$];X==B&&(H[$]=X={}),this._branches[$].save(X)}}return H},h.prototype.sync=function(H,K){for(var Q=this._struct.children,U=Q.length;U--;){var u=Q[U],a=u.name;u.isLeaf?(K||!this._leafSync[a])&&(H?(this._record[a]=u.desc.getter(this.gl),this._leafSync[a]=!0):(u.desc.setter(this.gl,this._record[a]),this._leafSync[a]=!0)):this._branches[a].sync(H,K)}},h.prototype.syncLoss=function(){for(var Y=this._struct.children,u=Y.length;u--;){var V=Y[u];V.isLeaf?this._leafSync[V.name]=!1:this._branches[V.name].syncLoss()}},h.prototype.apply=function(F){for(var q=this._struct.children,z=q.length;z--;){var O=q[z],y=O.name;y in F&&(O.isLeaf?this[y]=F[y]:this._branches[y].apply(F[y]))}},h.prototype.append=function(H){var B=this._struct.childMap;for(var u in H){var Y=B[u];Y&&(Y.isLeaf?this[u]=H[u]:this._branches[u].append(H[u]))}};var z=x(q);return function(K){var f=K._state;return f||(K._state=f=new z(K)),f}}(),al=function(){function z(K,Q,c,I){if(K){var q=K.length;if(q!=B)for(var m=0;I>m;++m)Q[c+m]=K[m];else K.toArray&&K.toArray(Q,c)}else for(var m=0;I>m;++m)Q[c+m]=0}function f(L,I,S){var w=L[0];if(0>=w||w>0)return L;var X=I*S,P=m[X];if(P==B&&(m[X]=new Float32Array(X)),0!==I){z(w,P,0,S);for(var W=1,g=0;W!==I;++W)g+=S,z(L[W],P,g,S)}return P}function H(H,$){H.uniform1f(this.addr,$)}function q(l,a){l.uniform1fv(this.addr,a)}function l(x,d){if(d.x!=B)x.uniform2f(this.addr,d.x,d.y);else{var v=m[2];v.set(d,0),x.uniform2fv(this.addr,v)}}function u(n,r){n.uniform2fv(this.addr,f(r,this.size,2))}function W(S,r){if(r.x!=B)S.uniform3f(this.addr,r.x,r.y,r.z);else if(r.r!=B)S.uniform3f(this.addr,r.r,r.g,r.b);else if(r.red!=B)S.uniform3f(this.addr,r.red,r.green,r.blue);else{var M=m[3];M.set(r,0),S.uniform3fv(this.addr,M)}}function V(m,b){m.uniform3fv(this.addr,f(b,this.size,3))}function a(q,x){if("string"==typeof x&&(x=vg(x)),x.x!=B)q.uniform4f(this.addr,x.x,x.y,x.z,x.w);else if(x.r!=B)q.uniform4f(this.addr,x.r,x.g,x.b,x.a);else if(x.red!=B)q.uniform4f(this.addr,x.red,x.green,x.blue,x.alpha);else{var J=m[4];J.set(x,0),q.uniform4fv(this.addr,J)}}function D(X,m){X.uniform4fv(this.addr,f(m,this.size,4))}function G(M,u){M.uniform1i(this.addr,u)}function b(X,L){X.uniform1iv(this.addr,L)}function n(e,t){e.uniform2iv(this.addr,t)}function j(U,d){U.uniform3iv(this.addr,d)}function k(A,d){A.uniform4iv(this.addr,d)}function $(S,p){S.uniform1i(this.addr,h[p?1:0])}function C(H,U){var t=m[4];t.set(U,0),H.uniformMatrix2fv(this.addr,!1,t)}function T(x,N){x.uniformMatrix2fv(this.addr,!1,f(N,this.size,4))}function K(J,F){var M=m[9];M.set(F,0),J.uniformMatrix3fv(this.addr,!1,M)}function O(c,W){c.uniformMatrix3fv(this.addr,!1,f(W,this.size,9))}function S(t,h){var y=m[16];y.set(h,0),t.uniformMatrix4fv(this.addr,!1,y)}function I(g,r){g.uniformMatrix4fv(this.addr,!1,f(r,this.size,16))}function X(y,$){y.uniform1i(this.addr,this.slots[0]),y.activeTexture(y.TEXTURE0+this.slots[0]),y.bindTexture(y.TEXTURE_2D,$||y._emptyTexture)}function d(t,N){t.uniform1iv(this.addr,this.slots);for(var B=this.slots.length;B--;)t.activeTexture(t.TEXTURE0+this.slots[B]),t.bindTexture(t.TEXTURE_2D,N[B]||t._emptyTexture)}function R(Y,G){Y.uniform1i(this.addr,this.slots[0]),Y.activeTexture(Y.TEXTURE0+this.slots[0]),Y.bindTexture(Y.TEXTURE_CUBE_MAP,G||Y._emptyCubeTexture)}function A(Q,J){Q.uniform1iv(this.addr,this.slots);for(var A=this.slots.length;A--;)Q.activeTexture(Q.TEXTURE0+this.slots[A]),Q.bindTexture(Q.TEXTURE_CUBE_MAP,J[A]||Q._emptyCubeTexture)}function J(J,L,M){y[J]=[L,M]}function g(O,Z,t){switch(O.type){case 35678:case 35680:if("uSampler"===t)return[0];if("uBlendSampler"===t)return[1];for(var A=O.size,x=new Int32Array(A),l=0;A>l;++l)x[l]=Z.usedTextureSlot++;return x}return B}function o(A,C,b,S,n){this.name=A,this.addr=C,this.size=S?b.size:0,this.activeInfo=b,this.setter=y[b.type][S?1:0],this.slots=g(b,n,A),od(this)}function M(Y,V,d,M){var D=Y.name,p=D.length;for(e.lastIndex=0;;){var k=e.exec(D),w=e.lastIndex,P=k[1],a="]"===k[2],Q=k[3];if(a&&(P=0|P),Q===B||"["===Q&&w+2===p){d[P]=new o(P,V,Y,Q!==B,M);break}var s=d[P];s==B&&(d[P]=s={}),d=s}}function r(r,V,N){this.gl=V,this._program=N,this._leaves={},this._branches={},this._struct=r}function i(E){function d(v,J){r.call(this,E,v,J);for(var U=x.length;U--;){var N=x[U];this._branches[N._name]=new N._type(v,J)}}function C(H,$){var n=H.name;if(H.isLeaf){var G=t("d.setter(this.gl, v);",["v"],["d"],[H.desc]);w.defineProperty($,n,{configurable:!1,enumerable:!0,get:function(){return G},set:G})}else x.push({_name:n,_type:i(H)}),w.defineProperty($,n,{configurable:!1,enumerable:!0,get:function(){return this._branches[n]},set:function(K){this._branches[n].apply(K)}})}var x=[];return F(d,r),E.forEach(C,d.prototype),d}function v(P,Z){for(var b=P.getProgramParameter(Z,P.ACTIVE_UNIFORMS),n={},f={usedTextureSlot:2};b--;){var T=P.getActiveUniform(Z,b),W=T.name,j=P.getUniformLocation(Z,W);M(T,j,n,f)}var q=jn.create(n,function(t){return"addr"in t}),x=i(q);return w.defineProperty(x.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:f.usedTextureSlot}),new x(P,Z)}var m=[];if("function"==typeof Float32Array)for(var Z=1;17>Z;++Z)m[Z]=new Float32Array(Z);var h=[0,1],y=[];J(uo.FLOAT,H,q),J(uo.FLOAT_VEC2,l,u),J(uo.FLOAT_VEC3,W,V),J(uo.FLOAT_VEC4,a,D),J(uo.INT,G,b),J(uo.INT_VEC2,n,n),J(uo.INT_VEC3,j,j),J(uo.INT_VEC4,k,k),J(uo.BOOL,$,b),J(uo.BOOL_VEC2,n,n),J(uo.BOOL_VEC3,j,j),J(uo.BOOL_VEC4,k,k),J(uo.FLOAT_MAT2,C,T),J(uo.FLOAT_MAT3,K,O),J(uo.FLOAT_MAT4,S,I),J(uo.SAMPLER_2D,X,d),J(uo.SAMPLER_CUBE,R,A);var e=/([\w\d_]+)(\])?(\[|\.)?/g;return r.prototype.apply=function(R){for(var M=this._struct.children,n=M.length;n--;){var C=M[n],T=C.name;T in R&&(C.isLeaf?this[T]=R[T]:this._branches[T].apply(R[T]))}},r.prototype.append=function(P){var _=this._struct.childMap;for(var g in P){var c=_[g];c&&(c.isLeaf?this[g]=P[g]:this._branches[g].append(P[g]))}},function(Y,T){var x=T._uniforms;return x||(T._uniforms=x=v(Y,T)),x}}(),pg=function(){function i(c,$,M){$.vertexAttrib1f(c.addr,M)}function e(e,$,H){if(H.x!=B)$.vertexAttrib2f(e.addr,H.x,H.y);else{var g=I[2];g.set(H,0),$.vertexAttrib2fv(e.addr,g)}}function E(G,D,l){if(l.x!=B)D.vertexAttrib3f(G.addr,l.x,l.y,l.z);else if(l.r!=B)D.vertexAttrib3f(G.addr,l.r,l.g,l.b);else if(l.red!=B)D.vertexAttrib3f(G.addr,l.red,l.green,l.blue);else{var a=I[3];a.set(l,0),D.vertexAttrib3fv(G.addr,a)}}function h(l,v,q){if("string"==typeof q&&(q=vg(q)),q.x!=B)v.vertexAttrib4f(l.addr,q.x,q.y,q.z,q.w);else if(q.r!=B)v.vertexAttrib4f(l.addr,q.r,q.g,q.b,q.a);else if(q.red!=B)v.vertexAttrib4f(l.addr,q.red,q.green,q.blue,q.alpha);else{var o=I[4];o.set(q,0),v.vertexAttrib4fv(l.addr,o)}}function s(x,U,u){u=u.el||u;for(var y=0,E=0;2>y;++y)U.vertexAttrib2f(x.addr,u[E++],u[E++])}function _(r,w,t){t=t.el||t;for(var a=0,c=0;3>a;++a)w.vertexAttrib3f(r.addr,t[c++],t[c++],t[c++])}function V(X,L,A){A=A.el||A;for(var f=0,n=0;4>f;++f)L.vertexAttrib4f(X.addr,A[n++],A[n++],A[n++],A[n++])}function Q(Q,H,C,x,z,J,u){H.bindBuffer(H.ARRAY_BUFFER,C),H.vertexAttribPointer(Q.addr,1,x||H.FLOAT,!!z,J||0,u||0),H.bindBuffer(H.ARRAY_BUFFER,null)}function G(s,I,p,V,w,c,W){I.bindBuffer(I.ARRAY_BUFFER,p),I.vertexAttribPointer(s.addr,2,V||I.FLOAT,!!w,c||0,W||0),I.bindBuffer(I.ARRAY_BUFFER,null)}function J(O,J,I,B,b,E,h){J.bindBuffer(J.ARRAY_BUFFER,I),J.vertexAttribPointer(O.addr,3,B||J.FLOAT,!!b,E||0,h||0),J.bindBuffer(J.ARRAY_BUFFER,null)}function P(r,s,E,g,W,Q,Z){s.bindBuffer(s.ARRAY_BUFFER,E),s.vertexAttribPointer(r.addr,4,g||s.FLOAT,!!W,Q||0,Z||0),s.bindBuffer(s.ARRAY_BUFFER,null)}function d(s,a,O,H,K,x,T){var x=x||4,T=T||0;a.bindBuffer(a.ARRAY_BUFFER,O),a.vertexAttribPointer(s.addr,2,H||a.FLOAT,!!K,x,T),a.vertexAttribPointer(s.addr+1,2,H||a.FLOAT,!!K,x,T+2),a.bindBuffer(a.ARRAY_BUFFER,null)}function o(K,A,n,s,Q,h,V){var h=h||9,V=V||0;A.bindBuffer(A.ARRAY_BUFFER,n),A.vertexAttribPointer(K.addr,3,s||A.FLOAT,!!Q,h,V),A.vertexAttribPointer(K.addr+1,3,s||A.FLOAT,!!Q,h,V+3),A.vertexAttribPointer(K.addr+2,3,s||A.FLOAT,!!Q,h,V+6),A.bindBuffer(A.ARRAY_BUFFER,null)}function H(z,$,y,B,m,r,x){var r=r||16,x=x||0;$.bindBuffer($.ARRAY_BUFFER,y),$.vertexAttribPointer(z.addr,4,B||$.FLOAT,!!m,r,x),$.vertexAttribPointer(z.addr+1,4,B||$.FLOAT,!!m,r,x+4),$.vertexAttribPointer(z.addr+2,4,B||$.FLOAT,!!m,r,x+8),$.vertexAttribPointer(z.addr+3,4,B||$.FLOAT,!!m,r,x+12),$.bindBuffer($.ARRAY_BUFFER,null)}function y(h,z,t){W[h]=function(S,r,K,F,u,U){this.addr==B||this.addr<0||(r==B||r===!1?S.disableVertexAttribArray(this.addr):ql(r)===p?(S.enableVertexAttribArray(this.addr),t(this,S,r,K,F,u,U)):(S.disableVertexAttribArray(this.addr),z(this,S,r)))}}function Y($,s,y){this.name=$,this.addr=s,this.activeInfo=y,this.setter=W[y.type],od(this)}function C(M,$,d){this.gl=$,this.program=d,this._branches={},this._struct=M}function m(p){function M(F,v){C.call(this,p,F,v);for(var w=_.length;w--;){var h=_[w];this._branches[h._name]=new h._type(F,v)}}function N(a,X){var U=a.name;if(a.isLeaf){var l=t("d.setter(this.gl, v);",["v"],["d"],[a.desc]);w.defineProperty(X,U,{configurable:!1,enumerable:!0,get:function(){return l},set:l})}else _.push({_name:U,_type:m(a)}),w.defineProperty(X,U,{configurable:!1,enumerable:!0,get:function(){return this._branches[U]},set:function(E){this._branches[U].apply(E)}})}var _=[];return F(M,C),p.forEach(N,M.prototype),M}function Z(A,p){for(var d=A.getProgramParameter(p,A.ACTIVE_ATTRIBUTES),x={};d--;){var Z=A.getActiveAttrib(p,d),E=Z.name,X=A.getAttribLocation(p,E);x[E]=new Y(E,X,Z)}var i=jn.create(x,function(R){return"addr"in R}),q=m(i);return new q(A,p)}for(var I=[],l=1;17>l;++l)I[l]=new _p(l);var W=[],p="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return y(uo.FLOAT,i,Q),y(uo.FLOAT_VEC2,e,G),y(uo.FLOAT_VEC3,E,J),y(uo.FLOAT_VEC4,h,P),y(uo.FLOAT_MAT2,s,d),y(uo.FLOAT_MAT3,_,o),y(uo.FLOAT_MAT4,V,H),C.prototype.disable=function(){for(var n=this._struct.children,J=n.length;J--;){var W=n[J],u=W.name;W.isLeaf?this.gl.disableVertexAttribArray(W.desc.addr):this._branches[u].disable()}},C.prototype.apply=function(i){for(var p=this._struct.children,R=p.length;R--;){var H=p[R],A=H.name;A in i&&(H.isLeaf?this[A]=i[A]:this._branches[A].apply(i[A]))}},C.prototype.append=function(J){var g=this._struct.childMap;for(var i in J){var $=g[i];$&&($.isLeaf?this[i]=J[i]:this._branches[i].append(J[i]))}},function(U,m){var a=m._attribs;return a||(m._attribs=a=Z(U,m)),a}}(),Ig=function(P){var u=this;w.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:P,writable:!1},glState:{configurable:!1,enumerable:!1,value:ld(P),writable:!1}}),u._currProgram=B,u._currUniforms=B,u._currAttribs=B,u._sync=!0};w.defineProperties(Ig.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(K){var d=this;d._sync&&K===d._currProgram||(d.gl.useProgram(K),d._currProgram=K,d._currUniforms=al(d.gl,K),d._currAttribs=pg(d.gl,K),d._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var v=this;return v._currProgram&&!v._sync&&(v.gl.useProgram(v._currProgram),v._sync=!0),v._currUniforms},set:function(g){var o=this;o._currUniforms&&(o._currProgram&&!o._sync&&(o.gl.useProgram(o._currProgram),this._sync=!0),o._currUniforms.apply(g))}},attribs:{configurable:!1,enumerable:!1,get:function(){var C=this;return C._currProgram&&!C._sync&&(C.gl.useProgram(C._currProgram),C._sync=!0),C._currAttribs},set:function(J){var $=this;$._currUniforms&&($._currProgram&&!$._sync&&($.gl.useProgram($._currProgram),this._sync=!0),$._currAttribs.apply(J))}}}),Ig.prototype.useProgram=function(I){var g=this;g._sync&&I===g._currProgram||(g.gl.useProgram(I),g._currProgram=I,g._currUniforms=al(g.gl,I),g._currAttribs=pg(g.gl,I),g._sync=!0)},Ig.prototype.directState=function(){return this.glState},Ig.prototype.directUniforms=function(){return this._currUniforms},Ig.prototype.directAttribs=function(){return this._currAttribs},Ig.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},Ig.for=function(j){var e=j._renderState;return e||(j._renderState=e=new Ig(j)),e};var gj="directional",Fh="point",zf="spot",nf="light.color",Jl={},wr=[],Xb=0,Gk=function(V,i){Ek(i)&&yh.test(i)?jc(V,i):xg(i)&&i.modelType?mn(V,i):i===B?delete Xm[V]:Xm[V]=i},$h=function(Q){return Q},ek=function(n){n=l.convertShape3dModelName(n);var U;if(xg(n)){if(n.modelType){if(n.uuid){if(U=Xm[n.uuid])return U}else n.uuid=R.Math.generateUUID();return U===B&&(Sm&&Sm[n.uuid]||mn(n.uuid,n)),B}return n}return U=Xm[n],n&&U===B&&yh.test(n)&&(Sm&&Sm[n]||jc(n,n)),U},hl=function(s,M){s.frameStack?s.frameStack.push(M):s.frameStack=[M],s.bindFramebuffer(s.FRAMEBUFFER,M)},Pj=function(r){var D=r.frameStack;if(D){if(D.pop(),D.length)return r.bindFramebuffer(r.FRAMEBUFFER,D[D.length-1]),void 0;r.frameStack=null}r.bindFramebuffer(r.FRAMEBUFFER,null)};sq(l,{graph3dViewAttributes:h,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:S/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:rs,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:S,graph3dViewRotateMinPhi:0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:S/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:Gk,getShape3dModel:ek,convertShape3dModelName:$h,getShape3dModelMap:function(){return Xm},getCachedShape3dModelMap:function(){return dm},createMatrix:function(j,T){Nl(j)||(j=[j]);for(var V=j.length-1;V>=0;V--){var Y=j[V];T=nm(Y.mat,Y.s3,Y.r3,Y.rotationMode,Y.t3,T)}return T},transformVec:function(o,i){return $e(o,i)},glBindFrame:hl,glUnbindFrame:Pj,createBoxModel:function(){return{vs:$f,ns:Dc,uv:qf,is:Pq}},createRoundRectModel:function(U,L){return ap.roundRect(U,L)},createStarModel:function(C,N){return ap.star(C,N)},createRectModel:function(o,A){return ap.rect(o,A)},createTriangleModel:function(g,L){return ap.triangle(g,L)},createRightTriangleModel:function(X,e){return ap.rightTriangle(X,e)},createParallelogramModel:function(k,K){return ap.parallelogram(k,K)},createTrapezoidModel:function(o,N){return ap.trapezoid(o,N)},createSmoothSphereModel:function(k,U,d,r,V,b,x){return wn(new _f(k,U,d,r,V,b,x))},createSphereModel:function(q,a,v,B,u,g,c){return q?Ae(q,a,v,B,u,g,c):l.createSmoothSphereModel()},createSmoothConeModel:function(I,j,e,U,Q){return ij(I,j,e,U,Q)},createConeModel:function(U,z,c,I,k,j,V,M){return U?El(U,z,c,I,k,j,V,M):ij(j)},createSmoothCylinderModel:function(f,J,V,a,_,D,y,l){return wn(new pe(f,J,V,a,_,D,y,l))},createCylinderModel:function(K,f,h,Z,b,q,v,V){return K?Oq(K,f,h,Z,b,q,v,V):Bo(q,v)},createSmoothTorusModel:function(s,h,l,P,$,N){return wn(new Sl(s,h,l,P,$,N))},createTorusModel:function(G,c,E,$,d,B,V,D){return G?iq(G,c,E,$,d,B,V,D):Hl(B,V)},createExtrusionModel:function(q,Q,S,d,Y,K,L,P){return dc(q,Q,S,d,Y,K,L,P)},createSmoothRingModel:function(I,Q,F,l,j,m){for(var W=[],S=0;S<I.length-1;S+=2)W.push({x:I[S],y:I[S+1]});for(I=xk(W,Q,F)[0],W=[],S=0;S<I.length;S++){var v=I[S];W.push(new Qb(v.x,0,v.y))}return wn(new lh(W,m,l,j))},createTextGeometry:function(Z,E){return wn(new lk(Z,E))},loadFontFace:function(H,s){l.xhrLoad(H,function(e){if(!e)return s();var D;try{D=JSON.parse(e)}catch(L){D=JSON.parse(e.substring(65,e.length-2))}Bj.loadFace(D),s&&s(D.familyName.toLowerCase())},s?null:{sync:!0})},getShaderErrorLog:function(){return wr.join("\n")},createRingModel:function(W,I,A,r,X,u,K,j,b,F){for(var $=[],v=0;v<W.length-1;v+=2)$.push({x:W[v],y:W[v+1]});u=u||l.shapeSide,K=K||0,j=j||u;var q,U,O,_,x,D,V,c,J,C,v,z,k,P,Y,g,m,w,M=[],p=[],T=b?[]:h,y=b?[]:h,n=F?[]:h,G=F?[]:h,f=r?[]:h,B=r?[]:h,t=X?[]:h,o=X?[]:h,W=xk($,I,A),L=tg(W),H=0,Q=2*Math.PI/u;return W.forEach(function(I){if(O=I.length,O>1){if(_=I[0],r)for(D=_.x,c=_.y,v=K;j>v;v++)z=v+1,k=v*Q,P=z*Q,Y=d(k),g=a(k),m=d(P),w=a(P),f.push(Y*D,c,-g*D,m*D,c,-w*D,0,c,0),B.push(.5-.5*Y,.5-.5*g,.5-.5*m,.5-.5*w,.5,.5);for(C=0;O>C;C++){for(x=I[C],D=_.x,V=x.x,c=_.y,J=x.y,q=H/L,H+=Jf(_,x),U=H/L,v=K;j>v;v++)z=v+1,k=v*Q,P=z*Q,Y=d(k),g=a(k),m=d(P),w=a(P),M.push(Y*V,J,-g*V,m*V,J,-w*V,Y*D,c,-g*D,m*V,J,-w*V,m*D,c,-w*D,Y*D,c,-g*D),p.push(v/u,U,z/u,U,v/u,q,z/u,U,z/u,q,v/u,q),b&&v===K&&(T.push(0,c,0,0,J,0,Y*V,J,-g*V,Y*V,J,-g*V,Y*D,c,-g*D,0,c,0),y.push(0,.5-c,0,.5-J,2*V,.5-J,2*V,.5-J,2*D,.5-c,0,.5-c)),F&&z===j&&(n.push(0,c,0,m*V,J,-w*V,0,J,0,m*V,J,-w*V,0,c,0,m*D,c,-w*D),G.push(1,.5-c,1-2*V,.5-J,1,.5-J,1-2*V,.5-J,1,.5-c,1-2*D,.5-c));_=x}if(X)for(D=_.x,c=_.y,v=K;j>v;v++)z=v+1,k=v*Q,P=z*Q,Y=d(k),g=a(k),m=d(P),w=a(P),t.push(m*D,c,-w*D,Y*D,c,-g*D,0,c,0),o.push(.5-.5*m,.5+.5*w,.5-.5*Y,.5+.5*g,.5,.5)}}),{vs:M,uv:p,bottom_vs:t,bottom_uv:o,top_vs:f,top_uv:B,from_vs:T,from_uv:y,to_vs:n,to_uv:G}}},!0),sq(D,{"3d.move.mode":B,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":B,"edge.gradient.color":B,"edge.source.t3":B,"edge.target.t3":B,"light.type":Fh,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":S/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":ag,"wf.short":!1,"wf.mat":B,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:B,"transparent.mask":!1,brightness:B,"select.brightness":.7,"repeat.uv.length":B,"shadow.cast":!0,"shadow.receive":!0,bloom:!1,envmap:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":B,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"label.face":Lr,"label.t3":B,"label.r3":B,"label.texture.scale":2,"label.rotationMode":hf,"label.light":!1,"label.blend":B,"label.reverse.flip":!1,"label.reverse.color":he,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Lr,"label2.t3":B,"label2.r3":B,"label2.texture.scale":2,"label2.rotationMode":hf,"label2.light":!1,"label2.blend":B,"label2.reverse.flip":!1,"label2.reverse.color":he,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Lr,"note.t3":B,"note.r3":B,"note.texture.scale":2,"note.rotationMode":hf,"note.light":!1,"note.blend":B,"note.reverse.flip":!1,"note.reverse.color":he,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Lr,"note2.t3":B,"note2.r3":B,"note2.texture.scale":2,"note2.rotationMode":hf,"note2.light":!1,"note2.blend":B,"note2.reverse.flip":!1,"note2.reverse.color":he,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:B,"shape3d.color":te,"shape3d.top.color":B,"shape3d.bottom.color":B,"shape3d.from.color":B,"shape3d.to.color":B,"shape3d.image":B,"shape3d.top.image":B,"shape3d.bottom.image":B,"shape3d.from.image":B,"shape3d.to.image":B,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":B,"shape3d.side.to":B,"shape3d.smooth":B,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":B,"shape3d.opacity":B,"shape3d.reverse.flip":!1,"shape3d.reverse.color":he,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":B,"shape3d.uv.scale":B,"shape3d.uv.rotation":B,"shape3d.top.uv.offset":B,"shape3d.top.uv.scale":B,"shape3d.top.uv.rotation":B,"shape3d.bottom.uv.offset":B,"shape3d.bottom.uv.scale":B,"shape3d.bottom.uv.rotation":B,"shape3d.from.uv.offset":B,"shape3d.from.uv.scale":B,"shape3d.from.uv.rotation":B,"shape3d.to.uv.offset":B,"shape3d.to.uv.scale":B,"shape3d.to.uv.rotation":B,"shape3d.top.cap":B,"shape3d.bottom.cap":B,"shape3d.start.angle":0,"shape3d.sweep.angle":Q,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.iterations":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"texture.mipmap.max":B,"texture.filter":B,"texture.filter.min":B,"texture.filter.mag":B,"texture.wrap":B,"points.image":B,"points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"all.light":!0,"all.visible":!0,"all.color":te,"all.image":B,"all.blend":B,"all.opacity":B,"all.reverse.flip":!1,"all.reverse.color":he,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":B,"all.uv.offset":B,"all.uv.scale":B,"all.uv.rotation":B,"all.discard.selectable":!0,mat:B,"left.mat":B,"right.mat":B,"top.mat":B,"bottom.mat":B,"front.mat":B,"back.mat":B,"edge.source.anchor.elevation":B,"edge.target.anchor.elevation":B},!0);var Qo,Hm=!1,Vh=[0,0,0,0],pn=function(T){return T instanceof Ki},fi=function(I){return[I.x,I.e||0,I.y]},cl=function(K,P,d){for(var P=vg(P||0),Y=P[0],w=P[1],M=P[2];d--;)K.push(Y,w,M)},Nh=function(t,X,e){for(var X=vg(X||0),o=X[0],T=X[1],G=X[2],d=X[3];e--;)t.push(o,T,G,d)},Ef=function(e,t,R){if(t)for(var L,k,X,j=t[0],y=t[1],W=t[2],l=t[4],i=t[5],F=t[6],T=t[8],r=t[9],h=t[10],Z=t[12],c=t[13],w=t[14],C=R.length,V=0,V=0;C>V;V+=3)L=R[V],k=R[V+1],X=R[V+2],e.push(j*L+l*k+T*X+Z,y*L+i*k+r*X+c,W*L+F*k+h*X+w);else Rg(e,R)},os=function(v,t){var T=t.s("light.intensity"),A=vg(t.s(nf)),g=A[0],Q=A[1],L=A[2];1!==T&&(g*=T,Q*=T,L*=T),v.push(g,Q,L,t.s("light.disabled")?1:0)},kg=function(Y,A){var o=Ig.for(A),y=o.directUniforms();y.uHeadlightRange=Y._headlightRange,y.uHeadlightAmbientIntensity=Y._headlightAmbientIntensity;var N=Y._headlightIntensity,r=vg(Y._headlightColor);1!==N&&(r=[r[0]*N,r[1]*N,r[2]*N]),y.uHeadlightColor=[r[0],r[1],r[2],Y._headlightDisabled?1:0];var s=Y._59O,j=Y._spots,L=Y._dirs;if(s.length){var v=[],h=[],l=[];s.forEach(function(k){os(v,k),Rg(h,Y._transformPointToViewSpace(k.p3())),l.push(k.s("light.range"))}),y.uPointColor=v,y.uPointRange=l,y.uPointPosition=h}if(j.length){var K=[],i=[],Z=[],J=[],F=[],V=[];j.forEach(function(m){os(K,m),Rg(i,Y._transformPointToViewSpace(m.p3())),Rg(F,Y._transformDirectionToViewSpace(m.p3(),m.s("light.center"))),Z.push(m.s("light.range")),J.push(d(m.s("light.angle")/2)),V.push(m.s("light.exponent"))}),y.uSpotColor=K,y.uSpotRange=Z,y.uSpotAngle=J,y.uSpotExponent=V,y.uSpotPosition=i,y.uSpotDirection=F}if(L.length){var q=[],M=[];L.forEach(function(h){os(q,h),Rg(M,Y._transformDirectionToViewSpace(h.p3()))}),y.uDirColor=q,y.uDirDirection=M}},yg=function(L,g){return Math.max(L.getRotateMinPhi()+Ji,Math.min(L.getRotateMaxPhi()-Ji,g))},Ff=function(){return.05+Kn()/2},Wb=function(R,P,N,B){var b,M=R.getEye();return R.isOrtho()?(b=il(R.getCenter(),M),b[0]+=B[0],b[1]+=B[1],b[2]+=B[2]):b=M,Sp(P,N,B,b)},Sp=function(k,j,v,K){var N=fe(k,j),T=il(K,v,!0),A=fe(T,j);if($(A)<Ji)return h;var o=(N-fe(v,j))/A;return[v[0]+T[0]*o,v[1]+T[1]*o,v[2]+T[2]*o]},Rk=function(U,M){return{x:2*U.x-M.x,y:2*U.y-M.y}},Zm=function(W,c,E,Y){var u,S;if(!W)return u=Mj(c.y-E.y,E.x-c.x),{x:c.x+Y*a(u),y:c.y+Y*d(u)};if(!E)return u=Mj(W.y-c.y,c.x-W.x),{x:c.x+Y*a(u),y:c.y+Y*d(u)};var k=il([W.x,W.y,0],[c.x,c.y,0],!0),z=il([E.x,E.y,0],[c.x,c.y,0],!0),g=-(k[0]+z[0])/2,q=-(k[1]+z[1])/2,f=m(g*g+q*q);if(Ji>f)return u=Mj(W.y-c.y,c.x-W.x),{x:c.x+Y*a(u),y:c.y+Y*d(u)};var L=W.x-c.x,l=W.y-c.y,v=E.x-c.x,R=E.y-c.y,y=m(L*L+l*l),$=m(v*v+R*R);u=s(fe(k,z))/2,S=k[1]*z[0]-k[0]*z[1]>0?-1:1,g/=f,q/=f;var T=Y/a(u),r=I(y,$)/d(u);f=Math.min(T,r);var K={x:c.x+S*f*g,y:c.y+S*f*q};return E.b&&T>$/d(u)&&(K.adjust=!0),K},$l=function($){var h=$[1],Q=$[2],v=$[3],C=$[6],G=$[7],P=$[11];$[1]=$[4],$[2]=$[8],$[3]=$[12],$[4]=h,$[6]=$[9],$[7]=$[13],$[8]=Q,$[9]=C,$[11]=$[14],$[12]=v,$[13]=G,$[14]=P},nb=function(r){var Y=r[0],j=r[1],e=r[2],n=r[3],k=r[4],K=r[5],v=r[6],U=r[7],V=r[8],b=r[9],u=r[10],C=r[11],R=r[12],i=r[13],L=r[14],I=r[15],f=Y*K-j*k,q=Y*v-e*k,t=Y*U-n*k,c=j*v-e*K,P=j*U-n*K,y=e*U-n*v,J=V*i-b*R,X=V*L-u*R,B=V*I-C*R,H=b*L-u*i,O=b*I-C*i,W=u*I-C*L,a=f*W-q*O+t*H+c*B-P*X+y*J;return a?(a=1/a,r[0]=(K*W-v*O+U*H)*a,r[1]=(e*O-j*W-n*H)*a,r[2]=(i*y-L*P+I*c)*a,r[3]=(u*P-b*y-C*c)*a,r[4]=(v*B-k*W-U*X)*a,r[5]=(Y*W-e*B+n*X)*a,r[6]=(L*t-R*y-I*q)*a,r[7]=(V*y-u*t+C*q)*a,r[8]=(k*O-K*B+U*J)*a,r[9]=(j*B-Y*O-n*J)*a,r[10]=(R*P-i*t+I*f)*a,r[11]=(b*t-V*P-C*f)*a,r[12]=(K*X-k*H-v*J)*a,r[13]=(Y*H-j*X+e*J)*a,r[14]=(i*q-R*c-L*f)*a,r[15]=(V*c-b*q+u*f)*a,void 0):h},ej=function(T,W){if(W){var i=W[0],G=W[1],m=W[2];T[12]=T[0]*i+T[4]*G+T[8]*m+T[12],T[13]=T[1]*i+T[5]*G+T[9]*m+T[13],T[14]=T[2]*i+T[6]*G+T[10]*m+T[14],T[15]=T[3]*i+T[7]*G+T[11]*m+T[15]}},Cg=function(m,K){if(K){var X=K[0],d=K[1],T=K[2];m[0]=m[0]*X,m[1]=m[1]*X,m[2]=m[2]*X,m[3]=m[3]*X,m[4]=m[4]*d,m[5]=m[5]*d,m[6]=m[6]*d,m[7]=m[7]*d,m[8]=m[8]*T,m[9]=m[9]*T,m[10]=m[10]*T,m[11]=m[11]*T}},Mh=function(r,w,Z){var h=w[0],l=w[1],g=w[2],x=w[3],p=w[4],L=w[5],y=w[6],m=w[7],S=w[8],F=w[9],U=w[10],c=w[11],C=w[12],Q=w[13],u=w[14],j=w[15],k=Z[0],X=Z[1],A=Z[2],n=Z[3];return r[0]=k*h+X*p+A*S+n*C,r[1]=k*l+X*L+A*F+n*Q,r[2]=k*g+X*y+A*U+n*u,r[3]=k*x+X*m+A*c+n*j,k=Z[4],X=Z[5],A=Z[6],n=Z[7],r[4]=k*h+X*p+A*S+n*C,r[5]=k*l+X*L+A*F+n*Q,r[6]=k*g+X*y+A*U+n*u,r[7]=k*x+X*m+A*c+n*j,k=Z[8],X=Z[9],A=Z[10],n=Z[11],r[8]=k*h+X*p+A*S+n*C,r[9]=k*l+X*L+A*F+n*Q,r[10]=k*g+X*y+A*U+n*u,r[11]=k*x+X*m+A*c+n*j,k=Z[12],X=Z[13],A=Z[14],n=Z[15],r[12]=k*h+X*p+A*S+n*C,r[13]=k*l+X*L+A*F+n*Q,r[14]=k*g+X*y+A*U+n*u,r[15]=k*x+X*m+A*c+n*j,r},kq=function(o,N,k,w){var Y,J,W,f,G,S,t,v,L,x,z=N[0],T=N[1],D=N[2],R=w[0],b=w[1],P=w[2],l=k[0],h=k[1],g=k[2];return $(z-l)<Ji&&$(T-h)<Ji&&$(D-g)<Ji?Om(o):(t=z-l,v=T-h,L=D-g,x=1/m(t*t+v*v+L*L),t*=x,v*=x,L*=x,Y=b*L-P*v,J=P*t-R*L,W=R*v-b*t,x=m(Y*Y+J*J+W*W),x?(x=1/x,Y*=x,J*=x,W*=x):(Y=0,J=0,W=0),f=v*W-L*J,G=L*Y-t*W,S=t*J-v*Y,x=m(f*f+G*G+S*S),x?(x=1/x,f*=x,G*=x,S*=x):(f=0,G=0,S=0),o[0]=Y,o[1]=f,o[2]=t,o[3]=0,o[4]=J,o[5]=G,o[6]=v,o[7]=0,o[8]=W,o[9]=S,o[10]=L,o[11]=0,o[12]=-(Y*z+J*T+W*D),o[13]=-(f*z+G*T+S*D),o[14]=-(t*z+v*T+L*D),o[15]=1,o)},qs=function(u,U,N,K,r){var L=1/qc(U/2),o=1/(K-r);return u[0]=L/N,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=L,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=(r+K)*o,u[11]=-1,u[12]=0,u[13]=0,u[14]=2*r*K*o,u[15]=0,u},on=function(_,c,o,K,E,j,h){var V=1/(c-o),d=1/(K-E),T=1/(j-h);return _[0]=-2*V,_[1]=0,_[2]=0,_[3]=0,_[4]=0,_[5]=-2*d,_[6]=0,_[7]=0,_[8]=0,_[9]=0,_[10]=2*T,_[11]=0,_[12]=(c+o)*V,_[13]=(E+K)*d,_[14]=(h+j)*T,_[15]=1,_},Mf=function(f,Q){var m=Q[0],F=Q[1],c=Q[2],G=Q[3],B=m*m+F*F+c*c+G*G,R=B?1/B:0;return f[0]=-m*R,f[1]=-F*R,f[2]=-c*R,f[3]=G*R,f},Bg=function(L,d){var x=d[0]+d[5]+d[10],g=0;return x>0?(g=2*Math.sqrt(x+1),L[3]=.25*g,L[0]=(d[6]-d[9])/g,L[1]=(d[8]-d[2])/g,L[2]=(d[1]-d[4])/g):d[0]>d[5]&d[0]>d[10]?(g=2*Math.sqrt(1+d[0]-d[5]-d[10]),L[3]=(d[6]-d[9])/g,L[0]=.25*g,L[1]=(d[1]+d[4])/g,L[2]=(d[8]+d[2])/g):d[5]>d[10]?(g=2*Math.sqrt(1+d[5]-d[0]-d[10]),L[3]=(d[8]-d[2])/g,L[0]=(d[1]+d[4])/g,L[1]=.25*g,L[2]=(d[6]+d[9])/g):(g=2*Math.sqrt(1+d[10]-d[0]-d[5]),L[3]=(d[1]-d[4])/g,L[0]=(d[8]+d[2])/g,L[1]=(d[6]+d[9])/g,L[2]=.25*g),L},Wn=function(s,i,d){var x=i[0],v=i[1],O=i[2],w=i[3],g=x+x,N=v+v,S=O+O,H=x*g,R=x*N,z=x*S,h=v*N,E=v*S,c=O*S,o=w*g,b=w*N,r=w*S;return s[0]=1-(h+c),s[1]=R+r,s[2]=z-b,s[3]=0,s[4]=R-r,s[5]=1-(H+c),s[6]=E+o,s[7]=0,s[8]=z+b,s[9]=E-o,s[10]=1-(H+h),s[11]=0,s[12]=d[0],s[13]=d[1],s[14]=d[2],s[15]=1,s},yr=function(M,L){if(M.isVREnabled()){var T=M.vr.getViewMatrix(L);if(T)return T}return kq(L?L:yo(),M._eye,M._center,M._up)},ed=function(l,F){if(l.isVREnabled()){var M=l.vr.getProjectMatrix();if(M)return M}if(!F&&l._computedProjectMatrix)return Dl(l._computedProjectMatrix);var x=l.getAspect(),H=l._near,e=l._far,k=yo();if(l._ortho){var n=l._orthoWidth/2,c=n/x;on(k,-n,n,-c,c,H,e)}else qs(k,l._fovy,x,H,e);return k},Ke=function(s,W){if(!s)return h;var R=0,p=1,$=2,T=[],A=0,w=s.length,O=w/3;if(W){for(;w>A;A++)T[A]=0;for(A=0;A<W.length;A+=3){var n=[],b=[],N=[];n[R]=s[3*W[A+1]+R]-s[3*W[A]+R],n[p]=s[3*W[A+1]+p]-s[3*W[A]+p],n[$]=s[3*W[A+1]+$]-s[3*W[A]+$],b[R]=s[3*W[A+2]+R]-s[3*W[A+1]+R],b[p]=s[3*W[A+2]+p]-s[3*W[A+1]+p],b[$]=s[3*W[A+2]+$]-s[3*W[A+1]+$],N[R]=n[p]*b[$]-n[$]*b[p],N[p]=n[$]*b[R]-n[R]*b[$],N[$]=n[R]*b[p]-n[p]*b[R];for(var k=0;3>k;k++)T[3*W[A+k]+R]+=N[R],T[3*W[A+k]+p]+=N[p],T[3*W[A+k]+$]+=N[$]}}else for(A=0;O>A;A+=3){var n=[],b=[],N=[];n[R]=s[3*(A+1)+R]-s[3*A+R],n[p]=s[3*(A+1)+p]-s[3*A+p],n[$]=s[3*(A+1)+$]-s[3*A+$],b[R]=s[3*(A+2)+R]-s[3*(A+1)+R],b[p]=s[3*(A+2)+p]-s[3*(A+1)+p],b[$]=s[3*(A+2)+$]-s[3*(A+1)+$],N[R]=n[p]*b[$]-n[$]*b[p],N[p]=n[$]*b[R]-n[R]*b[$],N[$]=n[R]*b[p]-n[p]*b[R];for(var k=0;3>k;k++)T[3*(A+k)+R]=N[R],T[3*(A+k)+p]=N[p],T[3*(A+k)+$]=N[$]}for(A=0;w>A;A+=3){var J=[];J[R]=T[A+R],J[p]=T[A+p],J[$]=T[A+$];var j=m(J[R]*J[R]+J[p]*J[p]+J[$]*J[$]);0===j&&(j=Ji),J[R]=J[R]/j,J[p]=J[p]/j,J[$]=J[$]/j,T[A+R]=J[R],T[A+p]=J[p],T[A+$]=J[$]}return new _p(T)},Zl=function(s,f,c,R){if(c||(c=s.createTexture()),f){var F=s.TEXTURE_2D,w=s.REPEAT,u=s.CLAMP_TO_EDGE,K=s.TEXTURE_MIN_FILTER;R=R||vm;var L=R.minFilter||R.filter||s.LINEAR,J=R.magFilter||R.filter||s.LINEAR;s.activeTexture(s.TEXTURE0),Lf(s,c),s.texImage2D(F,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,f),Fi(s,s.TEXTURE_MAG_FILTER,J);var x=f.naturalWidth||f.width,U=f.naturalHeight||f.height;Np.isPOT(x)&&Np.isPOT(U)&&!R.clampToEdge&&!f.clampToEdge?(Fi(s,s.TEXTURE_WRAP_S,w),Fi(s,s.TEXTURE_WRAP_T,w),Fi(s,K,L===s.NEAREST?s.NEAREST_MIPMAP_NEAREST:s.LINEAR_MIPMAP_LINEAR),R.mipmapMaxLevel!==B&&Fi(s,s.TEXTURE_MAX_LEVEL,R.mipmapMaxLevel),s.generateMipmap(F)):(Fi(s,s.TEXTURE_WRAP_S,u),Fi(s,s.TEXTURE_WRAP_T,u),Fi(s,K,L)),Lf(s,h)}return c},rn=function(Z,l){var y=new Uint8Array(4);return l=l||Z.createTexture(),Z.activeTexture(Z.TEXTURE0),Lf(Z,l),Fi(Z,Z.TEXTURE_MIN_FILTER,Z.LINEAR),Z.texImage2D(Z.TEXTURE_2D,0,Z.RGBA,1,1,0,Z.RGBA,Z.UNSIGNED_BYTE,y),l},jo=function(G,a){var x=new Uint8Array(4);return a=a||G.createTexture(),G.activeTexture(G.TEXTURE0),G.bindTexture(G.TEXTURE_CUBE_MAP,a),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_MAG_FILTER,G.LINEAR),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_MIN_FILTER,G.LINEAR),G.texImage2D(G.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,G.RGBA,1,1,0,G.RGBA,G.UNSIGNED_BYTE,x),G.texImage2D(G.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,G.RGBA,1,1,0,G.RGBA,G.UNSIGNED_BYTE,x),G.texImage2D(G.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,G.RGBA,1,1,0,G.RGBA,G.UNSIGNED_BYTE,x),G.texImage2D(G.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,G.RGBA,1,1,0,G.RGBA,G.UNSIGNED_BYTE,x),G.texImage2D(G.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,G.RGBA,1,1,0,G.RGBA,G.UNSIGNED_BYTE,x),G.texImage2D(G.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,G.RGBA,1,1,0,G.RGBA,G.UNSIGNED_BYTE,x),a
},ce=function(w){w._26I&&w._prg&&(w._26I.deleteProgram(w._prg),w._prg=h)},hr=function(W,J,b,C){var M=W.createShader(b);return W.shaderSource(M,C),W.compileShader(M),W.attachShader(J,M),M},Xo=function(_){return _.createBuffer()},Lf=function(l,d){l.bindTexture(l.TEXTURE_2D,d||l._emptyTexture)},Fi=function(s,J,V){s.texParameteri(s.TEXTURE_2D,J,V)},$b=function(R,u){var T=Ig.for(R).directState();T.polygonOffset.enabled=!0,T.polygonOffset.value=u},Ai=function($){var w=Ig.for($).directState();w.polygonOffset.enabled=!1},Zj=function(a,v){if(v){var x=Ig.for(a).directState();x.color.clear=vg(v)}},Qr=function(X){var K=Ig.for(X),g=K.directUniforms(),H=K.directAttribs();g.uFix=!0,H.aNormal=!1},We=function(O){var s=Ig.for(O),m=s.directUniforms();s.directAttribs(),m.uFix=!1},Kc=function(A,k,f,o,W,l,_,j){var I=Ig.for(A),U=I.directState(),c=I.directUniforms();A._picking||(f?(c.uBlend=!0,c.uBlendColor=f):c.uBlend=!1,c.uLight=o==h?!0:o,ih(W)&&1!==W&&(c.uPartOpacity=W),c.uReverseFlip=l==h?!1:l,c.uFixPickReverseColor=_||he),U.cullFace.enabled=j?!0:!1},Jg=function(t){if(!t._picking){var w=Ig.for(t),C=w.directUniforms();C.uPartOpacity=1}},ze=function(){var N=new R.Math.Matrix2d,B=[1,0,0,0,1,0,0,0,0];return function(d,E,o,F,K,I,R,O,q,y){var a=Ig.for(d),b=a.directUniforms(),C=a.directAttribs();return o?(b.uTexture=!0,b.uDiscardSelectable=He(F)?F:!0,C.aUv=zi(d,K,I,h,2),y?(b.uBlendTexture=!0,b.uBlendSampler=y):(b.uBlendTexture=!1,b.uBlendSampler=d._emptyBlendTexture),b.uSampler=o,b.uUvMatrix=R||O||q?qb(q,R,O,N).toArray9():B,void 0):(b.uSampler=d._emptyTexture,b.uBlendSampler=d._emptyBlendTexture,void 0)}}(),Yh=function($,_,s){var b=Ig.for($),X=b.directUniforms(),V=b.directAttribs();$.activeTexture($.TEXTURE0),Lf($,h),$.activeTexture($.TEXTURE1),Lf($,h),s&&(V.aUv=!1,X.uTexture=!1,X.uSampler=$._emptyTexture,X.uBlendTexture=!1,X.uBlendSampler=$._emptyBlendTexture)},mr=function(g,W,a,Y,V,c){var P=Ig.for(g),M=P.directUniforms(),u=P.directAttribs();!a||Sj||So||g.lineWidth(a),Y&&!g._picking&&(M.uFixPickReverseColor=Y),V&&(u.aPosition=zi(g,V,c,h))},Ko=function(y,o,f,p){Qo&&(p=y[Qo]),y.drawArrays(p==h?y.TRIANGLES:p,o,f);var i=y._renderInfo;i&&(i.calls++,i.vertices+=f,(p==h||p===y.TRIANGLES)&&(i.faces+=f/3),p===y.LINES&&(i.lines+=f/2),p===y.POINTS&&(i.points+=f))},go=function(Y,e,X,l,b){Qo&&(l=Y[Qo]),Y.drawElements(l==h?Y.TRIANGLES:l,X,b==h?Y.UNSIGNED_SHORT:b,e==h?0:2*e);var U=Y._renderInfo;U&&(U.calls++,U.vertices+=X,(l==h||l===Y.TRIANGLES)&&(U.faces+=X/3),l===Y.LINES&&(U.lines+=X/2),l===Y.POINTS&&(U.points+=X))},cj=function(r,g,x){var k=r.ARRAY_BUFFER;return r.bindBuffer(k,g),x&&r.bufferData(k,x,r.STATIC_DRAW),g},zi=function(h,m,O,j,w){return O?Kk(h,h.ARRAY_BUFFER,m,O):cj(h,m,O,j,w)},Yb=function(q,e,r){var k=q.ELEMENT_ARRAY_BUFFER;q.bindBuffer(k,e),r&&q.bufferData(k,r,q.STATIC_DRAW)},_j=function(h,c,r){Kk(h,h.ELEMENT_ARRAY_BUFFER,c,r)},Kk=function(x,y,u,I){var w=I._bufId;w||(w=I._bufId=R.Math.generateIncreasingID());var u,i=x._bufPool;return(u=i[w])&&u._buf?x.bindBuffer(y,u._buf):(u=i[w]={_buf:Xo(x)},x.bindBuffer(y,u._buf),x.bufferData(y,I,x.STATIC_DRAW)),u._fid=x._renderInfo.frame,u._buf},js=function(e,o){o!=h&&o>=0&&e.enableVertexAttribArray(o)},ff=function(x,Q){Q!=h&&Q>=0&&x.disableVertexAttribArray(Q)},Io=function(d,S){var s=d.getGL(),$=Ig.for(s),u=$.directUniforms();d._7O=d._8O.pop(),S&&(u.uMVMatrix=d._7O,d._6O=S,u.uNMatrix=S)},gn=function(V,R){return R||(R=yo()),hd(R,V),nb(R),$l(R),R},rr=function($,L){var g=$.getGL(),h=$._7O,O=Ig.for(g),W=O.directUniforms();L?($._8O.push(Dl(h)),W.uMMatrix=L,Mh(h,h,L),$._7O=h):W.uMMatrix=Fc,W.uMVMatrix=h,W.uNMatrix=gn(h,$._6O)},Di={body:0,label:1,label2:2,note:3,note2:4,symbol:5},cc=10,Yi=function(f,x,Z,w,V,t){var X;if(Z){var T=w._pickId;T||(T=w._pickId=x._pickIdUsed,x._pickIdUsed+=cc);var u,Q=Di[V];if(null!=Q)u=T+Q;else{var q=w._pickExtraPartMap;q||(q=w._pickExtraPartMap={}),(u=q[V])||(u=q[V]=x._pickIdUsed++)}x[u]||(x[u]={data:w,part:V}),X=Uf(u)}else X=Vh;if(!t){var e=Ig.for(f),v=e.directUniforms();v.uFixPickReverseColor=X}return X},bg=function(b,h,X){"target"!==X&&(X="source");var x="target"===X?h.getTargetAgent():h.getSourceAgent(),R="edge."+X+".";if(Tn(x)){var Z=h.s(R+"anchor.x"),p=h.s(R+"anchor.elevation"),J=h.s(R+"anchor.y"),m=Vl(x,b.getMat(x)),I=x.getAnchor3d();return $e([(Z===B?.5:Z)-I.x,(p===B?.5:p)-I.y,(J===B?.5:J)-I.z],m)}var y=h.s(R+"index"),w=b.getData3dUI(x);if(!w.info||!w.info.list)return!1;if(y>=0){var r,W,v,_,K,M=w.info._lastPointsSegments,t=M.points,D=M.segments,U=-1,q=-1;for(v=0,_=D?D.length:t.length;_>v;v++){if(W=D?D.get(v):1,3===W)K=2;else if(4===W)K=3;else{if(5===W)continue;K=1}if(U+=K,q++,q===y){r=t.get(U);break}}return r||(r=t.get(t.length-1)),[r.x,r.e||0,r.y]}var E=h.s(R+"percent")||.5;if(E=Math.max(0,Math.min(E,1)),!w||!w.getCache)return!1;var C=w.getCache(),_=C[C.length-1].length,M=b.getLineOffset(x,E*_),P=M.point;return[P.x,P.y,P.z]},we=function(){var Q={center:function(w,n,p,C,G){var R=-n[1]/2,J={x:-n[0]/2,y:R,width:n[0],height:n[1]},q=Fj(w,J,p);return[q.x+C,-q.y-G,Ff()]},front:function(U,i,v,h,w){var j=-i[1]/2,q={x:-i[0]/2,y:j,width:i[0],height:i[1]},V=Fj(U,q,v);return[V.x+h,-V.y-w,i[2]/2+Ff()]},back:function(L,X,z,M,n){var e=-X[0]/2,r=-X[1]/2,C={x:e,y:r,width:X[0],height:X[1]},l=Fj(L,C,z);return[-l.x-M,-l.y-n,-X[2]/2-Ff()]},left:function(R,G,C,W,w){var H=-G[1]/2,u={x:-G[2]/2,y:H,width:G[2],height:G[1]},P=Fj(R,u,C);return[-G[0]/2-Ff(),-P.y-w,P.x+W]},right:function(v,N,h,K,d){var o=-N[2]/2,w=-N[1]/2,O={x:o,y:w,width:N[2],height:N[1]},i=Fj(v,O,h);return[N[0]/2+Ff(),-i.y-d,-i.x-K]},top:function(K,g,D,B,S){var n={x:-g[0]/2,y:-g[2]/2,width:g[0],height:g[2]},E=Fj(K,n,D);return[E.x+B,g[1]/2+Ff(),E.y+S]},bottom:function(j,H,R,i,z){var p=-H[2]/2,X={x:-H[0]/2,y:p,width:H[0],height:H[2]},G=Fj(j,X,R);return[G.x+i,-H[1]/2-Ff(),-G.y-z]}};return function(E,U,C,K,k,i){return Q[K](E,U,C,k||0,i||0)}}(),Yd=function(p,Z,C,u,G,T,Q,j,B,z){if(G&&(Z[0]+=G[0],Z[1]+=G[1],Z[2]+=G[2]),ej(p,C),j){var e=yo();if(bb(e,B,z),$e(Z,e),ej(p,Z),p.auto=j,p.pos=$e([0,0,0],p),T){var i=p.mat2=yo();bb(i,T,Q)}}else bb(p,B,z),ej(p,Z),u===Se?jm(p,-xr):u===_d?jm(p,xr):u===Pi?vp(p,-xr):u===sp?vp(p,xr):u===Sf&&jm(p,S),bb(p,T,Q);return p},wl=function(f,M){var V=M.auto,X=M.mat2,g=f.gv;if(V){var c,y=yo(),n=[0,0,0,0];c="string"==typeof V?[V.indexOf("x")<0?g._eye[0]:g._center[0],V.indexOf("y")<0?g._eye[1]:g._center[1],V.indexOf("z")<0?g._eye[2]:g._center[2]]:g._eye,Bg(n,kq(yo(),c,g._center,g._up)),Wn(y,Mf(n,n),M.pos),X&&Mh(y,y,X),rr(g,y)}else rr(g,M)},bm=function(m,D,W,n,i){var a=m.s,K=m.gv,o=K.getGL(),e=K._prg,q=K._buffer,u=K._1O,X=Ig.for(o),$=X.directAttribs();Zl(o,nl,u),wl(m,W),Kc(o,e,a(D+".blend"),a(D+".light"),a(D+".opacity"),a(D+".reverse.flip"),a(D+".reverse.color"),a(D+".reverse.cull")),ze(o,e,u,i,q.uv,ao),$.aPosition=zi(o,q.vs,n,h),$.aNormal=zi(o,q.ns,Og,h),_j(o,q.is,jb),go(o,0,jb.length),Yh(o,e,u),Jg(o,e),Io(K)},Nj=function(l,P,n){var E=l.gv,a=l.data,D=l[P]={blend:E.getBodyColor(a)||E.getFaceBlend(a,P),light:E.getFaceLight(a,P),color:E.getFaceColor(a,P),opacity:E.getFaceOpacity(a,P),transparent:E.getFaceTransparent(a,P),reverseFlip:E.getFaceReverseFlip(a,P),reverseColor:E.getFaceReverseColor(a,P),reverseCull:E.getFaceReverseCull(a,P),texture:E.getFaceImage(a,P),blendTexture:E.getFaceBlendImage(a,P),discardSelectable:E.getFaceDiscardSelectable(a,P)};if("csg"!==P){D.uv=E.getFaceUv(a,P)||n&&n[P+"Uv"],D.uvScale=E.getFaceUvScale(a,P)||n&&n[P+"UvScale"],D.uvOffset=E.getFaceUvOffset(a,P)||n&&n[P+"UvOffset"],D.uvRotation=E.getFaceUvRotation(a,P)||n&&n[P+"uvRotation"];var U=E.getFaceMat(a,P);if(U){var g=Vl(a,U);a.appendAnchorMatrix3d(g),D.mat=g}}return D},hc=function(P,j,z,v,C){var H=P[v];if(H){if(!C(H.transparent))return;var p=P.data,o=P.gv,F=o._buffer,u=o.getTexture(H.texture,p,v),d=o.getTexture(H.blendTexture,p),_=Ig.for(j),r=_.directUniforms(),K=_.directAttribs();ze(j,z,u,H.discardSelectable,F.uv,H.tuv,H.uvOffset,H.uvScale,H.uvRotation,d),Kc(j,z,H.blend,H.light,H.opacity,H.reverseFlip,H.reverseColor,H.reverseCull),H.cs&&!o._batchColorDisabled?(r.uBatchColor=!0,K.aBatchColor=zi(j,F.batchColor,H.cs,z.aBatchColor,4)):r.uDiffuse=H.color||D["color.empty"],K.aPosition=zi(j,F.vs,H.vs,h),K.aNormal=zi(j,F.ns,H.ns,h),Ko(j,0,H.vs.length/3),H.cs&&!o._batchColorDisabled&&(r.uBatchColor=!1,ff(j,z.aBatchColor)),Jg(j,z),Yh(j,z,u)}},Nk=function(g,s,h){Nl(g)?g.forEach(function(E){Nk(E,s,h)}):Ek(g)?Nk(ni(s,g),s,h):xg(g)?g.shape3d?Nk(g.shape3d,s,h):h.push(g):h.push(g)},Rd=function(){for(var l=50,P=arguments.length,M=[],i=0;P>i;i++)M[i]=arguments[i];wr[Xb]="Time : "+(new Date).toLocaleString()+", Info :"+M.join(", "),Xb=(Xb+1)%l,console.error("Failed to create shader.")},qb=function(){var h=new Np.Matrix2d;return function(Q,k,D,v){v||(v=h);var w,Z,A,B;return k?(w=k[0],Z=k[1]):w=Z=0,D?(A=D[0],B=D[1]):A=B=1,v.setFromTransform(Q||0,w,Z,A,B)}}(),vd=function(w,Y,v,x,z,f){var K,s,B,k,Q,I,M,H,T,l,X,S=[x-Y,z-v],q=w?w.length:0;for(B=0;q>B;B++){for(k=2,K=w[B],Q=K[0],I=K[1];k+1<K.length;){if(M=K[k],H=K[k+1],s=As(Y,v,x,z,Q,I,M,H,!0)){T=[M-Q,H-I],l=Jf(T),T[0]/=l,T[1]/=l,l=fe(S,T),l=l>0?f:-f,X=[T[0]*l,T[1]*l];break}Q=M,I=H,k+=2}if(X)break}if(X)for(x=Y+X[0],z=v+X[1],B=0;q>B;B++)for(k=2,K=w[B],Q=K[0],I=K[1];k+1<K.length;){if(M=K[k],H=K[k+1],s=As(Y,v,x,z,Q,I,M,H,!0))return[0,0];Q=M,I=H,k+=2}return X?X:[x-Y,z-v]},Yo=function(H){return"nearest"===H?uo.NEAREST:"linear"===H?uo.LINEAR:H},jq=R.graph3d={},Xi=function(i,_,x){tr(z+".graph3d."+i,_,x)},ml="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!<*1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<esppDxpebit!5dfw!hojzsbw<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<yjsubNwVv!4ubn!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Wq="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!!<osvufs!<esbdtje!!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit!)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw<uvpldbmc!mppc!nspgjov~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!~!!!!!!!!gjeof$!!!!!!!!!!!!<*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!osvufs!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!qe!-*!z/f{jTmfyfu!-yyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!osvufs!!!!!!!!!!!!!!!!<z/f{jTmfyfu!+!tvjebSxpebit!+!*!2!-2!.!)3dfw!>!uftggp!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!}}!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!<*!opjujtpQpUuihjm!)f{jmbnspo!>!E4ec!4dfw!!!!!!!!!!!!<tbjCxpebit!>,!qe!!!!!!!!<*!sbfObsfnbDxpebit!.!sbGbsfnbDxpebit!)!0!*!sbfObsfnbDxpebit!.!*!opjujtpQpUuihjm!)iuhofm!)!>!qe!ubpmg!!!!!!!!!!!!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!!!!!!!!!!!!<*!*!1/3!-1/5!)3dfw!+!f{jTqbNxpebit!)!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!|!*!sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTuojpQufh!ubpmg!!!!!!!!~!!!!!!!!<*!68/1!-684/1!)3dfw!,!sbobmq!+!*!63/1!-632/1!)3dfw!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!!!!!!!!!!!!!!!!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!z/w!)ohjt!>!Zohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!z/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!y/w!)ohjt!>!Yohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!y/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<y/w!.!1/5!>!y/sbobmq!!!!!!!!!!!!!!!!!!!!*!1/1!?!{/w!)!gj!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!{/Wtcb!)!gj!!!!!!!!!!!!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!!!!!!!!!!!!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!!!!!!!!!!!!<zy/w!>!sbobmq!3dfw!!!!!!!!!!!!<*!Zf{jTmfyfu!+!1/3!.!1/2!)!+!fcvDpUfmbdt!>+!w!!!!!!!!!!!!<fcvDpUfmbdt!>+!Wtcb!!!!!!!!!!!!<*!*!{/Wtcb!-z/Wtcb!)ybn!-y/Wtcb!)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!!!!!!!!!!!!<*!w!)tcb!>!Wtcb!4dfw!!!!!!!!!!!!|!*!Zf{jTmfyfu!ubpmg!-w!4dfw!)WVpUfcvd!3dfw!!!!!!!!~!!!!!!!!<xpebit!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!gjeof$!!!!!!!!!!!!<*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!>!xpebit!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!gjmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!|!*!utfUnvutvsg!)!gj!!!!!!!!!!!!<*!dfWutfUnvutvsg!)mmb!>!utfUnvutvsg!mppc!!!!!!!!!!!!<*!1/2!>=!{/esppDxpebit!-nvutvsGoj!)3dfwc!>!dfWutfUnvutvsg!3dfwc!!!!!!!!!!!!<*!dfWnvutvsGoj!)mmb!>!nvutvsGoj!mppc!!!!!!!!!!!!<*!1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit!)!5dfwc!>!dfWnvutvsGoj!5dfwc!!!!!!!!!!!!<tbjCxpebit!>,!{/esppDxpebit!!!!!!!!!!!!<x/esppDxpebit!>0!{zy/esppDxpebit!!!!!!!!!!!!<1/2!>!xpebit!ubpmg!!!!!!!!!!!!|!*!esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTufh!ubpmg!!!!!!!!~!!!!!!!!<d!osvufs!!!!!!!!!!!!<*!y/g!-c!-b!)yjn!>!d!ubpmg!!!!!!!!!!!!<*!z/g!-us!-cs!)yjn!>!c!ubpmg!!!!!!!!!!!!<*!z/g!-um!-cm!)yjn!>!b!ubpmg!!!!!!!!!!!!<*!6/1!,!f{jt!+!wv!)udbsg!>!g!3dfw!!!!!!!!!!!!<*!fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!us!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cs!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!um!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cm!ubpmg!!!!!!!!!!!!<f{jt!0!*!6/1!,!f{jt!+!wv!)sppmg!>!WVejpsuofd!3dfw!!!!!!!!!!!!<f{jt!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!<*!1/2!-1/1!)3dfw!>!uftggp!3dfw!utopd!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt!)qsfMxpebiTE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!*!*!wv!-tiuqfe!)E3fsvuyfu!)iuqfEpUBCHSldbqov!-fsbqnpd!)qfut!osvufs!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt!)fsbqnpDE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!tspudbGldbqoV!-w!)upe!osvufs|!*!w!5dfw!oj!utopd!)iuqfEpUBCHSldbqov!ubpmg!!!!!!!!<*!/2!-tspudbGldbQ!)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!!!!!!!!<*!/763!!-/763!+!/763!-/763!+!/763!+!/763!)4dfw!>!tspudbGldbQ!4dfw!utopd!!!!!!!!<*2!hojevmdyf)!opjudbsg!?.!2//1!00!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!!!!!!!!<*2!hojevmdoj)!2//1!?.!opjudbsg!00!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!!!!!!!!<esppDxpebit!5dfw!hojzsbw<fwjfdfSxpebit!mppc!nspgjov<tvjebSxpebit!ubpmg!nspgjov<tbjCxpebit!ubpmg!nspgjov<zujtofuoJxpebit!ubpmg!nspgjov<f{jTxpebit!3dfw!nspgjov<qbNxpebit!E3sfmqnbt!nspgjov<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";sq(l,{setBatchInfo:function(l,B){Ze[l]=B},getBatchInfo:function(d){return Ze[d]},getBatchInfoMap:function(){return Ze},setBatchInfoMap:function(_){Ze=_}},!0);var yp=[1,1,1],Zp=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],mg=[1,0,0,0,0,1,0,1,1,1,1,0],mq=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],lq=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Ad=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Qc=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Pg=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],wj=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],ie=function(w,n){var Q=w._40Q;Q.each(function(v){v.ivBatch(n)})},xm=function(g,J,b){var G=b._id,x=J[G];if(x){var M=x.batch,Q=g[M],k=Q.ds,i=x.index;if(Q.invalidate=!0,delete J[G],k.splice(i,1),Oi(k))return delete g[M],void 0;for(var c=x.begin,j=x.size,U=3*c,$=3*j,n=4*c,I=4*j,D=Q.vs,S=Q.ps,L=Q.uv,t=Q.cs,h=Q.bs,o=Q.rs,T=Q.ns,P=Q.ls;i<k.length;i++)x=J[k[i]._id],x.index--,x.begin-=j;D.splice(U,$),S.splice(n,I),L&&L.splice(2*c,2*j),t&&t.splice(n,I),h&&h.splice(U,$),o&&o.splice(c,j),T&&T.splice(U,$),P&&P.splice(c,j)}},Kh=function(H,X,s,d,y){if(!d)return h;var T=X[d];if(!T){var C=y.getBatchInfo(d)||vm,I=C.image?[]:h;T=X[d]={vs:[],ns:[],uv:I,cs:I?h:C.color?h:[],bs:C.blend?[]:h,ps:[],rs:C.brightness?[]:h,ds:[]}}return T.invalidate=!0,H[s._id]={index:T.ds.length,begin:T.vs.length/3,batch:d},T.ds.push(s),T},Ip=function(C,i){return i!=h&&1!==i?[C[0]*i,C[1]*i,C[2]*i,C[3]]:C},qq=function(A){var m=A.shapeModel;m||(m=ni(A)),m&&(m._ctlineModel=[],m._lineModel=B)},Nd=function(){var K;return function(F,s,x){var c=F.getData3dUI(s),U=c.shapeModel;if(U||(U=ni(c)),U||!c.shapeName){var L,n=s.s("wf.combineTriangle");if(x.geometry){if(!U&&(s instanceof R.Node&&!(s instanceof R.Shape)?(K||(K={vs:$f,is:Pq,uv:qf}),U=K):U=[c.left,c.front,c.right,c.back,c.top,c.bottom],!U))return B;if(n){var v=s.s("wf.normEpsilon");isNaN(v)&&(v=2),n=0|Math.min(3,Math.max(1,isNaN(n)?1:n)),L=qo[n-1](U,c,180/(Math.PI*v))}else L=dk(U,c);if(!L||0===L.length)return}else L=x.short?Ob:hk;var i=F.getBrightness(s),P=s.s("bloom"),z=s.s("3d.reflectable"),k=vg(x.color||"white"),E=k[3]<1,e=Math.ceil(x.width)||1,G=(E?"T":"O")+(P?"_1":"_0")+(z?"1_":"0_")+e,g=s.getRenderLayer(),j=F._40Q.get(g),y=j.wireframeIndexMap,H=j.wireframeModelMap,D=H[G];D||(D=H[G]={vs:[],cs:[],ps:[],ds:[],T:E,B:P,reflectable:!!z,W:e}),D.invalidate=!0;var p=D.vs,T=D.cs,h=D.ds,o=y[s._id]={index:h.length,begin:p.length/3,batch:G};h.push(s);var Q=c.mat;s instanceof R.Edge||!(!Q||!x.geometry&&s instanceof R.Shape)||(Q=Vl(s,x.mat),s.appendAnchorMatrix3d(Q)),Ef(p,Q,L);var _=o.size=p.length/3-o.begin;Nh(T,Ip(k,i),_)}}}(),md=function(K,R,C,A,N,g,H,s,f){var Y=K.getBrightness(R);Y==h&&(Y=1);var b=Ip(vg(A),Y),x=b[3]<1;g=Math.ceil(g)||1;var c=(x?"T":"O")+g;if(H){var V=H[0],G=(H[1]||V)+V;c+="-"+V+"-"+G,f&&(c+="-"+gg(f)+"-"+Y,f=Ip(vg(f),Y))}var M=R.getRenderLayer(),r=K._40Q.get(M),o=r.polylineIndexMap,B=r.polylineModelMap,k=B[c];k||(k=B[c]={vs:[],cs:[],ps:[],ds:[],ls:H?[]:h,T:x,W:g},H&&(k.D=V,k.G=G,k.A=f)),k.invalidate=!0;var u,n=k.vs,e=k.cs,q=k.ds,X=k.ls,i=o[R._id]={index:q.length,begin:n.length/3,batch:c};q.push(R),Rg(n,C);var I,a=i.size=n.length/3-i.begin,t=C.length,Q=0,L=[];if(H||N)for(u=0;t>u;u+=6)I=Jf([C[u],C[u+1],C[u+2]],[C[u+3],C[u+4],C[u+5]]),L.push(I),Q+=I;if(Q&&N){var j,W=Ip(vg(N),Y),F=[W[0]-b[0],W[1]-b[1],W[2]-b[2],W[3]-b[3]],T=0;for(u=0;t>u;u+=6)j=T/Q,Nh(e,[b[0]+F[0]*j,b[1]+F[1]*j,b[2]+F[2]*j,b[3]+F[3]*j],1),T+=L[u/6],j=T/Q,Nh(e,[b[0]+F[0]*j,b[1]+F[1]*j,b[2]+F[2]*j,b[3]+F[3]*j],1)}else Nh(e,b,a);if(H)for(T=s||0,u=0;t>u;u+=6)X.push(T),T+=L[u/6],X.push(T)},ye=function(V,z,q){if(z){var j=4*z.begin,Z=q[z.batch].ps;if(Z[j]!==V[0]||Z[j+1]!==V[1]||Z[j+2]!==V[2]||Z[j+3]!==V[3]){for(var B=0;B<z.size;B++)Z[j++]=V[0],Z[j++]=V[1],Z[j++]=V[2],Z[j++]=V[3];Z._invalidateThisFrame=!0}}},ke=function(){var Y=new R.Math.Vector3,v=new R.Math.Vector3;return function(Q,X){var e=X+["32"],w=Q[X],z=Q[e];if(w){if(l.extractBatchTranslation&&"vs"===X){v.set(0,0,0);for(var P=w.length,k=0;P>k;k+=3)v.add(Y.fromArray(w,k));v.divideScalar(P/3);for(var H=v.x,Z=v.y,F=v.z,s=new Array(P),k=0;P>k;k+=3)s[k]=w[k]-H,s[k+1]=w[k+1]-Z,s[k+2]=w[k+2]-F;w=s,Q.translate=[H,Z,F]}z&&z.length===w.length?(z.set(w),z._bufId=null):Q[e]=new _p(w)}else delete Q[e]}}(),kn=function(x,Q,i,h,J,l,w,b,F){if(Nl(i))i.forEach(function(N){kn(x,Q,N,h,J,l,w,b,F)});else if(Ek(i))kn(x,Q,ni(h,i),h,J,l,w,b,F);else if(xg(i)){var Y,m=pk(i.mat,Q,x),D=pk(i.s3,Q,x),v=pk(i.t3,Q,x),E=pk(i.r3,Q,x);if((D||E||v||m)&&(Y=nm(m,D,E,pk(i.rotationMode,Q,x),v),l.push(Y)),i.shape3d)kn(x,Q,i.shape3d,h,J,l,w,b,i);else{var N=h.s;F=F||vm;var t=l[0],q=l.length,P=N("shape3d.color",i.color,F.color);if(J||(J=N("shape3d.blend",i.blend,F.blend)),q>1){t=Dl(t);for(var k=1;q>k;k++)Mh(t,t,l[k])}i.vs&&N(je,i.visible,F.visible)&&nr(t,w,b,i.vs,i.uv,i.is,J,P),i.top_vs&&N(ul,i.topVisible,F.topVisible)&&nr(t,w,b,i.top_vs,i.top_uv,i.top_is,J,N("shape3d.top.color",i.topColor,F.topColor)||P),i.bottom_vs&&N(Zo,i.bottomVisible,F.bottomVisible)&&nr(t,w,b,i.bottom_vs,i.bottom_uv,i.bottom_is,J,N("shape3d.bottom.color",i.bottomColor,F.bottomColor)||P),i.from_vs&&N(Uh,i.fromVisible,F.fromVisible)&&nr(t,w,b,i.from_vs,i.from_uv,i.from_is,J,N("shape3d.from.color",i.fromColor,F.fromColor)||P),i.to_vs&&N(kk,i.toVisible,F.toVisible)&&nr(t,w,b,i.to_vs,i.to_uv,i.to_is,J,N("shape3d.to.color",i.toColor,F.toColor)||P)}Y&&l.pop()}},nr=function(G,d,q,F,K,L,m,x){var $,p=d.cs,e=d.uv,C=d.bs;if(L){$=L.length;for(var o=0;$>o;o++){var Y=L[o];Ef(q,G,[F[3*Y],F[3*Y+1],F[3*Y+2]]),e&&Rg(e,[K[2*Y],K[2*Y+1]])}}else $=F.length/3,Ef(q,G,F),e&&Rg(e,K);p&&Nh(p,x,$),C&&(m?cl(C,m,$):Rg(C,yp,$))},xd=function(z,M,B,L){var S=[];L?kn(z.gv,z.data,L,z,z.getBodyColor(),[M],B,S):(Cj(z,Se,M,B,S),Cj(z,_d,M,B,S),Cj(z,Lr,M,B,S),Cj(z,Sf,M,B,S),Cj(z,Pi,M,B,S),Cj(z,sp,M,B,S),Cj(z,"csg",M,B,S)),S.length&&(Rg(B.vs,S),Rg(B.ns,Ke(S)))
},Cj=function(R,Y,x,k,J){var G=R[Y];if(G){var u=G.tuv;if(u){var m=G.uvScale,p=G.uvOffset,I=G.uvRotation;if(m||p||I){var A,N,c,s=qb(I,p,m),z=s.a,B=s.b,w=s.c,y=s.d,V=s.tx,W=s.ty,_=u.length;for(c=0;_>c;c+=2)A=u[c],N=u[c+1],u[c]=z*A+w*N+V,u[c+1]=B*A+y*N+W}}nr(x,k,J,G.vs,u,h,G.blend,G.color)}},$p=function(G,X,B,I,M,f,h,J){var e,d=B.cs,w=B.uv,Q=B.bs;if(G.getFaceVisible(X,f)){var i=G.getFaceMat(X,f);if(i&&(M=Vl(X,i)),Ef(h,M,J),d&&Nh(d,G.getFaceColor(X,f),6),w){var E=G.getFaceUv(X,f)||I[f+"Uv"],D=G.getFaceUvScale(X,f)||I[f+"UvScale"],r=G.getFaceUvOffset(X,f)||I[f+"UvOffset"],g=G.getFaceUvRotation(X,f)||I[f+"UvRotation"];E=E?[E[6],E[7],E[0],E[1],E[2],E[3],E[2],E[3],E[4],E[5],E[6],E[7]]:mg;var p=E[0],P=E[1],L=E[2],K=E[3],k=E[4],x=E[5],l=E[6],F=E[7],y=E[8],v=E[9],n=E[10],j=E[11];if(D||r||g){var c=qb(g,r,D),N=c.a,z=c.b,W=c.c,b=c.d,Z=c.tx,C=c.ty;p=N*p+W*P+Z,P=z*p+b*P+C,L=N*L+W*K+Z,K=z*L+b*K+C,k=N*k+W*x+Z,x=z*k+b*x+C,l=N*l+W*F+Z,F=z*l+b*F+C,y=N*y+W*v+Z,v=z*y+b*v+C,n=N*n+W*j+Z,j=z*n+b*j+C}w.push(p,P,L,K,k,x,l,F,y,v,n,j)}Q&&(e=G.getBodyColor(X)||G.getFaceBlend(X,f),e?cl(Q,e,6):Rg(Q,yp,6))}},rd=function(m,H,b,E){var b=m._picking?m.pickColorMap:null,p=m.getGL(),Z=m._prg,c=m._buffer;if(!Gi(H)){rr(m,Zp),Qr(p,Z);for(var L in H){var F=H[L];if(!(E&&!F.T||!E&&F.T||m.isReflecting(p)&&F.reflectable===!1)){F.invalidate?(F.invalidate=!1,ke(F,"vs"),ke(F,"cs"),ke(F,"ls"),ke(F,"ps")):b&&F.ps&&F.ps._invalidateThisFrame&&(F.ps._invalidateThisFrame=!1,ke(F,"ps"));var I=F.translate;I&&rr(m,[1,0,0,0,0,1,0,0,0,0,1,0,I[0],I[1],I[2],1]);var l=F.vs32,Q=b?F.ps32:F.cs32;mr(p,Z,F.W,h,c.vs,l);var r=Ig.for(p),i=r.directUniforms(),f=r.directAttribs(),U=F.D,S=!m._dashDisabled&&U;i.uAlphaTest=D.alphaTest,p._blooming&&!F.B&&(i.blackout=!0),S&&(i.uDash=!0,i.uDashDistance=U,i.uDashGapDistance=F.G,i.uDiffuse=F.A||D["color.empty"],f.aLineDistance=zi(p,c.lineDistance,F.ls32,h,1));var z=!m._batchColorDisabled;z&&Q.length?(i.uBatchColor=!0,f.aBatchColor=zi(p,c.batchColor,Q,h,4)):(i.uBatchColor=!1,f.aBatchColor=!1),ze(p),Ko(p,0,l.length/3,p.LINES),Yh(p),z&&(i.uBatchColor=!1,f.aBatchColor=!1),S&&(i.uDash=!1,f.aLineDistance=!1),p._blooming&&!F.B&&(i.blackout=!1),I&&Io(m)}}We(p,Z),Io(m)}},Ir=function(L){L.invalidate=!1,ke(L,"vs"),ke(L,"ns"),ke(L,"cs"),ke(L,"rs"),ke(L,"ps"),ke(L,"bs"),ke(L,"uv")},Ei=function(u,s,A,I,C){var b,f,E,y,d,F,e,w,R,a,c,v,A=u._picking?u.pickColorMap:null,k=u.getGL(),l=u._prg,W=Ig.for(k),S=W.directUniforms(),T=W.directAttribs(),Z=u._buffer;if(!Gi(s)&&!u.drawFilter){rr(u,Zp);for(b in s)if(f=u.getBatchInfo(b)||vm,f.visible!==!1&&!(I&&!f.transparent||!I&&f.transparent||u.isReflecting(k)&&f.reflectable===!1)){var n=f.renderLayerMask;if(n==h&&(n=Wk),C==h&&(C=Wk),ip(C,n)&&(E=s[b],A||!f.transparentMask)){var H=I&&f.autoSort===!0&&(u._33Q||E.invalidate);if(E.invalidate?Ir(E):A&&E.ps&&E.ps._invalidateThisFrame&&(E.ps._invalidateThisFrame=!1,ke(E,"ps")),d=E.vs32,F=A?E.ps32:E.cs32,R=E.uv32,e=E.bs32,w=E.rs32,c=d.length/3,H){var N=gp(d,u.getEye(),u);N?(E.is=N.is,E.elementTypeUint=N.useUint32):(E.is=null,E.elementTypeUint=null)}if(c){v=E.translate,v&&rr(u,[1,0,0,0,0,1,0,0,0,0,1,0,v[0],v[1],v[2],1]),y=f.light,a=u.getTexture(f.image),Kc(k,l,h,f.light,f.opacity,f.reverseFlip,f.reverseColor,f.reverseCull),F?u._batchColorDisabled?(S.uBatchColor=!1,T.aBatchColor=!1):(S.uBatchColor=!0,T.aBatchColor=zi(k,Z.batchColor,F,h,4)):(S.uBatchColor=!1,S.uDiffuse=f.color||D["color.empty"]);var G=f.alphaTest;S.uAlphaTest=G===B?D.alphaTest:G,S.shadowReceive=!A&&f.shadowReceive!==!1,k._blooming&&!f.bloom&&(S.blackout=!0),f.envmap!==B?(S.uUseEnvMap=!0,S.uReflectivity=f.envmap):(S.uUseEnvMap=!1,S.uReflectivity=0);var _=e&&!u._batchBlendDisabled;_&&(S.uBatchBlend=!0,T.aBatchBlend=zi(k,Z.batchBlend,e,h));var o=w&&!u._batchBrightnessDisabled;o&&(S.uBatchBrightness=!0,T.aBatchBrightness=zi(k,Z.batchBrightness,w,h,1)),R?ze(k,l,a,f.discardSelectable,Z.uv,R,f.uvOffset,f.uvScale,f.uvRotation):ze(k),T.aPosition=zi(k,Z.vs,d,h),T.aNormal=zi(k,Z.ns,E.ns32,h),E.is?(Yb(k,Z.is,E.is),go(k,0,c,null,E.elementTypeUint?k.UNSIGNED_INT:null)):Ko(k,0,c),R?Yh(k,l,a):Yh(k),F&&!u._batchColorDisabled&&(S.uBatchColor=!1,T.aBatchColor=!1),_&&(S.uBatchBlend=!1,T.aBatchBlend=!1),o&&(S.uBatchBrightness=!1,T.aBatchBrightness=!1),k._blooming&&!f.bloom&&(S.blackout=!1),Jg(k,l),v&&Io(u)}}}Io(u)}},gp=function(Z,L,b){var O=Z.length/3,f=O>65535,N=b._glCapabilities.elementTypeUint&&f;if(!N&&f)return null;for(var s=new Array(O),Y=O/3,h=new Array(Y),c=0;Y>c;c++)h[c]=c;h.sort(function(e,W){var K=9*e,r=[(Z[K]+Z[K+3]+2*Z[K+6])/4,(Z[K+1]+Z[K+4]+2*Z[K+7])/4,(Z[K+2]+Z[K+5]+2*Z[K+8])/4];K=9*W;var i=[(Z[K]+Z[K+3]+2*Z[K+6])/4,(Z[K+1]+Z[K+4]+2*Z[K+7])/4,(Z[K+2]+Z[K+5]+2*Z[K+8])/4],Y=Jf(L,r)-Jf(L,i);return Y>0?-1:0>Y?1:0});for(var c=0;Y>c;c++){var K=3*c,S=3*h[c];s[K]=S,s[K+1]=S+1,s[K+2]=S+2}return{useUint32:N,is:N?new Uint32Array(s):new Yr(s)}},Eh={obj:function(g,F){var v={mat:g.mat,s3:g.s3,r3:g.r3,rotationMode:g.rotationMode,t3:g.t3,cube:g.cube==h?!0:g.cube,center:g.center==h?!0:g.center,ignoreMtls:g.ignoreMtls,ignoreTransparent:g.ignoreTransparent,ignoreColor:g.ignoreColor,ignoreImage:g.ignoreImage,ignoreNormal:g.ignoreNormal,prefix:g.prefix,flipY:g.flipY,flipFace:g.flipFace,reverseFlipMtls:g.reverseFlipMtls,finishFunc:function(y,p){if(y){var p=[];for(var Q in y){var j=y[Q];p.rawS3=j.rawS3,j.center&&(p.center=j.center),p.push(j),g.eachModel&&g.eachModel(Q,j)}p.json=g,F(p)}else F()}};l.loadObj(g.obj,g.mtl,v)},bin:function(k,F){var J={finishFunc:function(A){A?F(A):F()}};l.loadBin(k.url,J)}};l.getModelTypeHandlers=function(){return Eh},l.setModelTypeHandler=function(A,$){Eh[A]=$},l.getModelTypeHandler=function(a){return Eh[a]},l.handleModelLoaded=function(){},l.handleUnfoundModel=function(){};var Sm=h,Ml=h,ts=function(X){Sm&&!X._loadingModelView_&&(Ml||(Ml={}),Ml[X._loadingModelView_=Jc()]=X)},jc=function(f,m){Sm||(Sm={});var S=Sm[f];if(S){if(S.url===m)return;S.request.onload=an,S.request.onerror=an}if(m.indexOf(".bin")===m.length-4)return mn(f,{modelType:"bin",url:m},m);if(m=l.beforeLoadURL(m),m.data){var y=l.parse(m.data);mn(f,y,m)}else{var D=new Md;Sm[f]={request:D,url:m},D.onload=function(){if(200===this.status||0===this.status){delete Sm[f];var L=l.parse(D.getResponseText());mn(f,L,m)}else Cr(f,l.handleUnfoundModel(f,m)||h)},D.onerror=function(){Cr(f,l.handleUnfoundModel(f,m)||h)};var e={};e.url=encodeURI(m),e.sync=!1,D.send(e)}},mn=function(n,H,A){var c=H.modelType;if(!c)return Cr(n,H),l.handleModelLoaded(n,H),void 0;var $=l.getModelTypeHandler(c);if($){if(Sm||(Sm={}),Sm[n])return;Sm[n]=!0;var K=function(b){b?(Cr(n,b),l.handleModelLoaded(n,b)):Cr(n,l.handleUnfoundModel(n,A,H)||h)};$(H,K)}else Cr(n,l.handleUnfoundModel(n,A,H)||h)},Cr=function(l,G){if(delete Sm[l],Ek(G)&&yh.test(G))return jc(l,G),void 0;if(Xm[l]=G,Gi(Sm)&&(Sm=h,Ml)){for(var y in Ml){var j=Ml[y];j.invalidateAll&&j.invalidateAll(B,"modelLoaded",l),j.redraw&&j.redraw(),j.iv(),delete j._loadingModelView_}Ml=h}if(G&&Ml)for(var y in Ml){var j=Ml[y];j.invalidateAll&&j.invalidateAll(B,"modelLoading",l),j.redraw&&j.redraw(),j.iv()}},ao=new _p([0,0,0,1,1,1,1,0]),Og=new _p([0,0,1,0,0,1,0,0,1,0,0,1]),jb=new Yr([0,1,2,2,3,0]),$f=new _p([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Pq=new Yr([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),qf=new _p([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Dc=Ke($f,Pq),ep=(new _p([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Yr([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Se,Lr,_d,Sf,Pi,sp]),hk=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Ob=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Ae=function(I,v,O,p,N,R,c){R=R||16,I=I||16,v=v||0,O=O||I;var s,g,C,y,m,B,H,T,t,U=.5,x=[],l=[],e=Q/I,M=S/R;for(s=0;R>s;s++)for(B=s+1,y=s*M,t=B*M,g=v;O>g;g++)H=g+1,C=g*e,T=H*e,x.push(U*a(y)*d(C),U*d(y),-U*a(y)*a(C),U*a(t)*d(T),U*d(t),-U*a(t)*a(T),U*a(y)*d(T),U*d(y),-U*a(y)*a(T),U*a(y)*d(C),U*d(y),-U*a(y)*a(C),U*a(t)*d(C),U*d(t),-U*a(t)*a(C),U*a(t)*d(T),U*d(t),-U*a(t)*a(T)),l.push(g/I,s/R,H/I,B/R,H/I,s/R,g/I,s/R,g/I,B/R,H/I,B/R);if(c){var o=[];for(s=0,m=x.length;m>s;s+=3)o.push(2*x[s],2*x[s+1],2*x[s+2])}if(p){var A=[],F=[];for(C=v*e,s=0;R>s;s++)B=s+1,y=s*M,t=B*M,A.push(0,0,0,U*a(t)*d(C),U*d(t),-U*a(t)*a(C),U*a(y)*d(C),U*d(y),-U*a(y)*a(C)),F.push(0,.5,v/I,B/R,v/I,s/R)}if(N){var Y=[],q=[];for(C=O*e,s=0;R>s;s++)B=s+1,y=s*M,t=B*M,Y.push(0,0,0,U*a(y)*d(C),U*d(y),-U*a(y)*a(C),U*a(t)*d(C),U*d(t),-U*a(t)*a(C)),q.push(1,.5,O/I,s/R,O/I,B/R)}var D={vs:x,uv:l,from_vs:A,from_uv:F,to_vs:Y,to_uv:q};return c&&(D.ns=o),D},Hl=function(v,m,X){v=v||.17,m=m||12,X=X||18,0>v?v=0:v>.25&&(v=.25);var A,f,J,I,n,h,E,T=.5,z=[],U=[],C=[],$=Q/X,R=Q/m,P=T-v;for(f=0;m>=f;f++)for(I=-S+f*R,h=d(I),n=a(I),A=0;X>=A;A++)J=A*$,E=P+v*h,z.push(d(J)*E,n*v,-a(J)*E),U.push(A/X,1-f/m);for(f=0;m>f;f++){var Z=f*(X+1),l=(f+1)*(X+1);for(A=0;X>A;A++)C.push(Z+A,l+A+1,l+A,Z+A,Z+A+1,l+A+1)}return{vs:z,uv:U,is:C}},iq=function(G,z,v,n,I,C,k,X){k=k||12,G=G||18,z=z||0,v=v||G,C=C||.17,0>C?C=0:C>.25&&(C=.25);var u,W,Z,U,j,F,M,Y,i,m,h=.5,r=[],D=[],g=Q/G,N=Q/k,J=h-C,p=X?[]:B;for(Z=0;k>Z;Z++)for(U=Z+1,M=-S+Z*N,Y=-S+U*N,u=z;v>u;u++)W=u+1,j=u*g,F=W*g,i=J+C*d(M),m=J+C*d(Y),r.push(d(j)*i,a(M)*C,-a(j)*i,d(F)*i,a(M)*C,-a(F)*i,d(F)*m,a(Y)*C,-a(F)*m,d(j)*i,a(M)*C,-a(j)*i,d(F)*m,a(Y)*C,-a(F)*m,d(j)*m,a(Y)*C,-a(j)*m),D.push(u/G,1-Z/k,W/G,1-Z/k,W/G,1-U/k,u/G,1-Z/k,W/G,1-U/k,u/G,1-U/k),X&&p.push(d(j)*d(M),a(M),-a(j)*d(M),d(F)*d(M),a(M),-a(F)*d(M),d(F)*d(Y),a(Y),-a(F)*d(Y),d(j)*d(M),a(M),-a(j)*d(M),d(F)*d(Y),a(Y),-a(F)*d(Y),d(j)*d(Y),a(Y),-a(j)*d(Y));if(n){var A=[],c=[];for(Z=0;k>Z;Z++)U=Z+1,M=-S+Z*N,Y=-S+U*N,j=z*g,i=J+C*d(M),m=J+C*d(Y),A.push(d(j)*i,a(M)*C,-a(j)*i,d(j)*m,a(Y)*C,-a(j)*m,d(j)*J,0,-a(j)*J),c.push(.5+.5*d(M),.5-.5*a(M),.5+.5*d(Y),.5-.5*a(Y),.5,.5)}if(I){var E=[],T=[];for(Z=0;k>Z;Z++)U=Z+1,M=-S+Z*N,Y=-S+U*N,j=v*g,i=J+C*d(M),m=J+C*d(Y),E.push(d(j)*i,a(M)*C,-a(j)*i,d(j)*J,0,-a(j)*J,d(j)*m,a(Y)*C,-a(j)*m),T.push(.5-.5*d(M),.5-.5*a(M),.5,.5,.5-.5*d(Y),.5-.5*a(Y))}var y={vs:r,uv:D,from_vs:A,from_uv:c,to_vs:E,to_uv:T};return X&&(y.ns=p),y},Bo=function(f,B){for(var Z,T,w,m=.5,S=16,C=[],j=[],i=[],L=Q/S,h=0;S>=h;h++)Z=h*L,T=d(Z)*m,w=a(Z)*m,C.push(T,-m,w,T,m,w),j.push(1-h/S,1,1-h/S,0);for(h=0;S>h;h++)i.push(2*h,2*h+1,2*h+3,2*h,2*h+3,2*h+2);if(B){var D=[],u=[],q=[];for(D.push(0,-m,0),u.push(.5,.5),h=0;S>=h;h++)Z=h*L,T=d(Z),w=a(Z),D.push(T*m,-m,-w*m),u.push(.5+.5*T,.5+.5*w);for(h=0;S>h;h++)q.push(0,h+2,h+1)}if(f){var e=[],k=[],U=[];for(e.push(0,m,0),k.push(.5,.5),h=0;S>=h;h++)Z=h*L,T=d(Z),w=a(Z),e.push(T*m,m,-w*m),k.push(.5+.5*T,.5-.5*w);for(h=0;S>h;h++)U.push(0,h+1,h+2)}return{vs:C,uv:j,is:i,bottom_vs:D,bottom_uv:u,bottom_is:q,top_vs:e,top_uv:k,top_is:U}},Oq=function(E,F,Z,G,j,y,T,J){E=E||12,F=F||0,Z=Z||E;for(var h,p,H,o,N,b,k,Y,q,C=.5,K=[],R=[],W=Q/E,I=F;Z>I;I++)h=I+1,p=I*W,H=h*W,o=d(p)*C,N=a(p)*C,b=d(H)*C,k=a(H)*C,K.push(o,-C,-N,b,-C,-k,o,C,-N,b,-C,-k,b,C,-k,o,C,-N),R.push(I/E,1,h/E,1,I/E,0,h/E,1,h/E,0,I/E,0);if(J){var t=[];for(I=0,q=K.length;q>I;I+=3)t.push(2*K[I],0,2*K[I+2])}if(T){var S=[],w=[];for(I=F;Z>I;I++)p=W*I,H=W*(I+1),o=d(p),N=a(p),b=d(H),k=a(H),S.push(o*C,-C,-N*C,0,-C,0,b*C,-C,-k*C),w.push(.5+.5*o,.5+.5*N,.5,.5,.5+.5*b,.5+.5*k)}if(y){var u=[],l=[];for(I=F;Z>I;I++)p=W*I,H=W*(I+1),o=d(p),N=a(p),b=d(H),k=a(H),u.push(o*C,C,-N*C,b*C,C,-k*C,0,C,0),l.push(.5+.5*o,.5-.5*N,.5+.5*b,.5-.5*k,.5,.5)}if(G){var r=[],c=[];p=W*F,o=d(p)*C,N=a(p)*C,Y=F/E,r.push(0,C,0,0,-C,0,o,-C,-N,o,-C,-N,o,C,-N,0,C,0),c.push(0,0,0,1,Y,1,Y,1,Y,0,0,0)}if(j){var O=[],$=[];p=W*Z,o=d(p)*C,N=a(p)*C,Y=Z/E,O.push(0,-C,0,0,C,0,o,C,-N,o,C,-N,o,-C,-N,0,-C,0),$.push(1,1,1,0,Y,0,Y,0,Y,1,1,1)}var P={vs:K,uv:R,bottom_vs:S,bottom_uv:w,top_vs:u,top_uv:l,from_vs:r,from_uv:c,to_vs:O,to_uv:$};return J&&(P.ns=t),P},ij=function(k,D,c,S,m){D=D||18,c=c||0,S=S==h?Q:S,m=m==h?.5:m;for(var G,C,B,O,I,V,$=[0,.5,.75,.875,.9375],U=[],b=[],E=[],Z=S/D,L=0;L<$.length;L++){var M=0===L%2?0:.5;for(G=0;D>=G;G++)C=(G+M)*Z+c,B=1-$[L],U.push(d(C)*m*B,-m+2*$[L]*m,-a(C)*m*B),b.push((G+M)/D,B)}for(L=0;L<$.length-1;L++){var K=L*(D+1),R=(L+1)*(D+1);for(G=0;D>G;G++)E.push(K+G,R+G+1,R+G,K+G,K+G+1,R+G+1)}for(V=U.length/3-(D+1),G=0;D>G;G++)U.push(0,m,0),b.push((G+.5)/D,0);for(G=0;D>G;G++)E.push(V+G,V+G+1,V+(D+1)+G);if(k){var N=[],Y=[],y=[];for(N.push(0,-m,0),Y.push(.5,.5),G=0;D>=G;G++)C=G*Z+c,O=d(C),I=a(C),N.push(O*m,-m,-I*m),Y.push(.5+.5*O,.5+.5*I);for(G=0;D>G;G++)y.push(0,G+2,G+1)}return{vs:U,uv:b,is:E,bottom_vs:N,bottom_uv:Y,bottom_is:y}},El=function(I,h,i,G,q,N,x,T){I=I||16,h=h||0,i=i||I,x=x||1;var A,c,$,K,E,e,Z,F=.5,M=[],P=[],H=Q/I,U=h,X=1/x,c=new qp,$=new qp,g=new qp,B=new qp,b=new qp,Y=new qp,f=new qp;for(T&&(A=[],E=new qp,e=new qp,Z=new qp);i>U;U++){var O=U+1,l=H*U,J=H*O;for(c.set(d(l)*F,-F,-a(l)*F),$.set(d(J)*F,-F,-a(J)*F),g.set(0,F,0),T&&(E.set(d(l),.5,-a(l)).normalize(),e.set(d(J),.5,-a(J)).normalize(),Z.copy(E).add(e).normalize()),B.lerpVectors(g,c,X),b.lerpVectors(g,$,X),M.push(B.x,B.y,B.z,b.x,b.y,b.z,g.x,g.y,g.z),P.push(U/I,X,O/I,X,(U+O)/2/I,0),T&&A.push(E.x,E.y,E.z,e.x,e.y,e.z,Z.x,Z.y,Z.z),K=1;x>K;K++)B.lerpVectors(g,c,X*(K+1)),b.lerpVectors(g,$,X*(K+1)),Y.lerpVectors(g,c,X*K),f.lerpVectors(g,$,X*K),M.push(B.x,B.y,B.z,b.x,b.y,b.z,Y.x,Y.y,Y.z,Y.x,Y.y,Y.z,b.x,b.y,b.z,f.x,f.y,f.z),P.push(U/I,X*(K+1),O/I,X*(K+1),U/I,X*K,U/I,X*K,O/I,X*(K+1),O/I,X*K),T&&A.push(E.x,E.y,E.z,e.x,e.y,e.z,E.x,E.y,E.z,E.x,E.y,E.z,e.x,e.y,e.z,e.x,e.y,e.z)}if(N){var S=[],m=[];for(U=h;i>U;U++){l=H*U,J=H*(U+1);var o=d(l),w=a(l),y=d(J),s=a(J);S.push(o*F,-F,-w*F,0,-F,0,y*F,-F,-s*F),m.push(.5+.5*o,.5+.5*w,.5,.5,.5+.5*y,.5+.5*s)}}if(G){var V=[],t=[];l=H*h,V.push(0,F,0,0,-F,0,d(l)*F,-F,-a(l)*F),t.push(0,0,0,1,h/I,1)}if(q){var r=[],v=[];l=H*i,r.push(0,-F,0,0,F,0,d(l)*F,-F,-a(l)*F),v.push(1,1,1,0,i/I,1)}var z={vs:M,uv:P,bottom_vs:S,bottom_uv:m,from_vs:V,from_uv:t,to_vs:r,to_uv:v};return T&&(z.ns=A),z},dc=function(_,m,Q,e,D,i,l,U){for(var n=[],Z=0;Z<_.length-1;Z+=2)n.push({x:_[Z],y:_[Z+1]});return rc(n,m,Q,e,D,i,l,U,!1)},ap={roundRect:function(k,r){return dc([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],k,r,3)},star:function(C,F){return dc([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],C,F)},rect:function(x,g){return dc([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],x,g)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(O,E){return dc([0,-.5,.5,.5,-.5,.5],[1,2,2,5],O,E)},rightTriangle:function(v,l){return dc([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],v,l)},parallelogram:function(r,Z){return dc([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],r,Z)},trapezoid:function(n,t){return dc([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],n,t)}},Kd={sphere:1,cylinder:1,cone:1,torus:1},Ab={torus:1,sphere:1,cone:1},yc=sq(lg(ap),{cylinder:1}),Rf=sq(lg(ap),{cylinder:1,cone:1}),mj=function(n,V,g){var e,w=pk(n.anchor3d,g,V),Q=pk(n.mat,g,V),D=pk(n.s3,g,V),y=pk(n.t3,g,V),m=pk(n.r3,g,V),A=D||m||y||Q;if(w||A){e=Dl(V._6O);var K=A?nm(Q,D,m,pk(n.rotationMode,g,V),y):yo();w&&ej(K,[.5-w[0],.5-w[1],.5-w[2]]),rr(V,K)}return e},aj=function(I,v,e,q,t,T,x){if(Nl(e))e.forEach(function(O){aj(I,v,O,q,t,T,x)});else if(Ek(e))aj(I,v,ni(q,e),q,t,T,x);else if(xg(e))if(e.shape3d){var E=mj(e,I,v);aj(I,v,e.shape3d,q,t,T,e),E&&Io(I,E)}else Rc(I,v,e,q.s,t,T,x)},Rc=function(O,q,t,v,b,V,f){if(f=f||vm,!V||V(v("shape3d.transparent",t.transparent,f.transparent))){var l=mj(t,O,q);if(Jk(t)){var L=O.getData3dUI(q);L.dispatchBoundingBoxChanged()}var T=O._26I,p=O._prg,U=O._buffer,E=v("shape3d.color",t.color,f.color);b||(b=v("shape3d.blend",t.blend,f.blend));var g,I=t.opacity==h?f.opacity:t.opacity,D=v("shape3d.opacity");g=D!=h&&I!=h?I*D:I!=h?I:D,Kc(T,p,b,v("shape3d.light",t.light,f.light),g,v("shape3d.reverse.flip",t.reverseFlip,f.reverseFlip),v("shape3d.reverse.color",t.reverseColor,f.reverseColor),v("shape3d.reverse.cull",t.reverseCull,f.reverseCull));var N=v("polygonOffset",t.polygonOffset,f.polygonOffset);t.vs&&v(je,t.visible,f.visible)&&Yj(T,p,U,E,O.getTexture(v("shape3d.image",t.image,f.image),q),v("shape3d.discard.selectable",t.discardSelectable,f.discardSelectable),t.vs,t.uv,t.ns,t.is,v("shape3d.uv.offset",t.uvOffset,f.uvOffset),v("shape3d.uv.scale",t.uvScale,f.uvScale),v("shape3d.uv.rotation",t.uvRotation,f.uvRotation),N),t.top_vs&&v(ul,t.topVisible,f.topVisible)&&Yj(T,p,U,v("shape3d.top.color",t.topColor,f.topColor)||E,O.getTexture(v("shape3d.top.image",t.topImage,f.topImage),q,"top"),v("shape3d.top.discard.selectable",t.topDiscardSelectable,f.topDiscardSelectable),t.top_vs,t.top_uv,t.top_ns,t.top_is,v("shape3d.top.uv.offset",t.topUvOffset,f.topUvOffset),v("shape3d.top.uv.scale",t.topUvScale,f.topUvScale),v("shape3d.top.uv.rotation",t.topUvRotation,f.topUvRotation),N),t.bottom_vs&&v(Zo,t.bottomVisible,f.bottomVisible)&&Yj(T,p,U,v("shape3d.bottom.color",t.bottomColor,f.bottomColor)||E,O.getTexture(v("shape3d.bottom.image",t.bottomImage,f.bottomImage),q,"bottom"),v("shape3d.bottom.discard.selectable",t.bottomDiscardSelectable,f.bottomDiscardSelectable),t.bottom_vs,t.bottom_uv,t.bottom_ns,t.bottom_is,v("shape3d.bottom.uv.offset",t.bottomUvOffset,f.bottomUvOffset),v("shape3d.bottom.uv.scale",t.bottomUvScale,f.bottomUvScale),v("shape3d.bottom.uv.rotation",t.bottomUvRotation,f.bottomUvRotation),N),t.from_vs&&v(Uh,t.fromVisible,f.fromVisible)&&Yj(T,p,U,v("shape3d.from.color",t.fromColor,f.fromColor)||E,O.getTexture(v("shape3d.from.image",t.fromImage,f.fromImage),q,"from"),v("shape3d.from.discard.selectable",t.fromDiscardSelectable,f.fromDiscardSelectable),t.from_vs,t.from_uv,t.from_ns,t.from_is,v("shape3d.from.uv.offset",t.fromUvOffset,f.fromUvOffset),v("shape3d.from.uv.scale",t.fromUvScale,f.fromUvScale),v("shape3d.from.uv.rotation",t.fromUvRotation,f.fromUvRotation),N),t.to_vs&&v(kk,t.toVisible,f.toVisible)&&Yj(T,p,U,v("shape3d.to.color",t.toColor,f.toColor)||E,O.getTexture(v("shape3d.to.image",t.toImage,f.toImage),q,"to"),v("shape3d.to.discard.selectable",t.toDiscardSelectable,f.toDiscardSelectable),t.to_vs,t.to_uv,t.to_ns,t.to_is,v("shape3d.to.uv.offset",t.toUvOffset,f.toUvOffset),v("shape3d.to.uv.scale",t.toUvScale,f.toUvScale),v("shape3d.to.uv.rotation",t.toUvRotation,f.toUvRotation),N),Jg(T,p),l&&Io(O,l)}},Yj=function(E,w,C,m,U,v,Y,d,F,I,k,q,e,p){if(Y){p&&$b(E,p);var o=Ig.for(E),i=o.directUniforms(),R=o.directAttribs();i.uDiffuse=m||D["color.empty"],d?ze(E,w,U,v,C.uv,d,k,q,e):ze(E),R.aPosition=zi(E,C.vs,Y,h),R.aNormal=zi(E,C.ns,F,h),I?(_j(E,C.is,I),go(E,0,I.length,null,I instanceof Uint32Array?E.UNSIGNED_INT:null)):Ko(E,0,Y.length/3),d?Yh(E,w,U):Yh(E),p&&Ai(E)}},ni=function(C,u){var H=C.s;if(u||(u=H(pl)),!u)return h;var N=ek(u);if(N)return N;if("text"===u){var P={amount:H("shape3d.text.amount"),size:H("shape3d.text.size"),font:H("shape3d.text.font"),style:H("shape3d.text.style"),weight:H("shape3d.text.weight"),fill:H("shape3d.text.fill"),curveSegments:H("shape3d.text.curveSegments"),spacing:H("shape3d.text.spacing")},d=C.gv.getShape3dText(C.data),b=d;for(var S in P)b+="_"+(P[S]===B?"U":P[S]);return C._cachedTextKey===b?C._cachedTextGeometry:(C._cachedTextKey=b,C._cachedTextGeometry=l.createTextGeometry(d,P))}var S=u;if(Kd[u]){var g=H("shape3d.side"),n=H("shape3d.side.from"),m=H("shape3d.side.to"),F=H(Uh),c=H(kk);3>g?(g=0,n=0,m=0,F=!1,c=!1):((n==h||0>n)&&(n=0),(m==h||m>g)&&(m=g),0===n&&m===g&&(F=!1,c=!1));var Z=H("shape3d.smooth");S+="-"+g+"-"+n+"-"+m+"-"+F+"-"+c+(Z?1:0)}if(yc[u]){var _=H(ul);S+="-"+_}if(Rf[u]){var K=H(Zo);S+="-"+K}if("torus"===u){var y=H("shape3d.torus.radius");0>y?y=0:y>.25&&(y=.25),S+="-"+y}if(Ab[u]){var w=H(dd);S+="-"+w}return N=dm[S],N||("box"===u?N=l.createBoxModel():ap[u]?N=ap[u](_,K):"sphere"===u?N=l.createSphereModel(g,n,m,F,c,w,Z):u===gi?N=l.createCylinderModel(g,n,m,F,c,_,K,Z):"cone"===u?N=l.createConeModel(g,n,m,F,c,K,w,Z):"torus"===u&&(N=l.createTorusModel(g,n,m,F,c,y,w,Z)),dm[S]=N),N},Jk=function(){var D=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],P=["is","top_is","bottom_is","from_is","to_is"];return f=vh(ml.substr(ml.indexOf("^#")+2)),Ak(l[Mm(as+D[15]+"n"+D[16])]())&&Er()?function(y){return y&&!y._complete_?(y._complete_=!0,y.vs&&Oi(y.ns)&&(y.ns=Ke(y.vs,y.is),y.boundingBox=B),y.top_vs&&Oi(y.top_ns)&&(y.top_ns=Ke(y.top_vs,y.top_is),y.top_boundingBox=B),y.bottom_vs&&Oi(y.bottom_ns)&&(y.bottom_ns=Ke(y.bottom_vs,y.bottom_is),y.bottom_boundingBox=B),y.from_vs&&Oi(y.from_ns)&&(y.from_ns=Ke(y.from_vs,y.from_is),y.from_boundingBox=B),y.to_vs&&Oi(y.to_ns)&&(y.to_ns=Ke(y.to_vs,y.to_is),y.to_boundingBox=B),D.forEach(function(c){var U=y[c];Nl(U)&&(y[c]=new _p(U))}),P.forEach(function(_){var U=y[_];Nl(U)&&(y[_]=new Yr(U))}),!0):!1}:void 0}(),Gn=function(Z,J){var R=Z[J];Nl(R)&&(Z[J]=new _p(R))};sq(jl,{_25Q:function(k){k._16O=function(f,h,$,R,b,v,r,Q,F){var g=this.info;if(g){var a,n,_,N,w,S,t=yo();if(Ql[h]?(a=g.p3,n=g.c1,_=g.c2):pb[h]?(n=g.s1||g.c1,_=g.s2||g.c2):(n=g.t1||g.c1,_=g.t2||g.c2),a)S=we(h,uf,$,R,Q,F);else{var B=il(_,n),X=Jf(n,_);N=[0,-Mj(B[2],B[0]),p(B[1]/X)],w="zyx",a=[(n[0]+_[0])/2,(n[1]+_[1])/2,(n[2]+_[2])/2],S=we(h,[X,0,0],$,R,Q,F)}return Yd(t,S,a,R,b,v,r,f,N,w)}return Fc},k._80o=function(w,t,E){var i=this,k=i.shapeModel;if(k){var q=i.gv;rr(q),aj(q,i.data,k,i,i.getBodyColor(),E)}},k.createLineModel=function(B,l,Y,A,x){var w=this,H=w.s,U=lr(B,l,H(dd)),V=H(A+".color");if(V){for(var m=[],j=0;j<U.length;j++){var Q=U[j],r=Q.length;if(r>1){var G=Q[0];m.push(G.x,G.y,G.z);for(var f=1;r-1>f;f++)G=Q[f],m.push(G.x,G.y,G.z),m.push(G.x,G.y,G.z);G=Q[r-1],m.push(G.x,G.y,G.z)}}var $,v,o,K=H(x),k=0;K&&(v=H(x+".color"),$=H(x+".pattern"),k=H(x+".offset"),o=V),md(w.gv,w.data,m,v||V,o?h:H(A+".gradient.color"),Y,$||H(A+".pattern"),k,o)}return U},k.createTubeModel=function(G,$,z,K){for(var p=this,j=p.s,d=j("shape3d.side")||dh,F=j("shape3d.start.angle"),w=j("shape3d.sweep.angle"),b=j(ul)?j("shape3d.top.cap"):h,Z=j(Zo)?j("shape3d.bottom.cap"):h,t="flat"===b,E="flat"===Z,X=t&&(K?K.uv:j("shape3d.top.image")),s=E&&(K?K.uv:j("shape3d.bottom.image")),a=K?K.uv:j("shape3d.image"),f=j("shape3d.smooth"),S={vs:[],uv:a?[]:h,ns:f?[]:h,top_vs:t?[]:h,top_uv:X?[]:h,bottom_vs:E?[]:h,bottom_uv:s?[]:h},x=lr(G,$,j(dd),z),l=0,U=x.length;U>l;l++)Tg(S,x[l],j(Ni),z,d,F,w,b,Z);if(K){var o=[];kn(p.gv,p.data,S,p,p.getBodyColor(),p.mat?[p.mat]:[],K,o),o.length&&(Rg(K.vs,o),Rg(K.ns,Ke(o)))}else p.shapeModel=S;return p.lineShapeModel=S,x},k.getCache=function(){var T=this.info;if(T){var G=T.list;if(G){var V=T.cache;return V||(V=T.cache=Ld(G)),V}}return h}}});var Sc=function(s,Y){for(var W,P=0,R=s.length,m=0,T=R-1;T>=m;)if(P=c(m+(T-m)/2),W=s[P].length-Y,0>W)m=P+1;else{if(!(W>0)){T=P;break}T=P-1}P=T;var K=s[P],q=K.point;return P===R-1||K.length===Y||(q=(new Qb).subVectors(s[P+1].point,q).normalize().multiplyScalar(Y-K.length).add(q)),{point:q,tangent:K.tangent}},Ld=function(A){for(var B,J,w=[],T=0,F=0;F<A.length;F++){for(var c=A[F],Y=0;Y<c.length;Y++){B=c[Y],J&&(T+=J.distanceTo(B));var h=new Qb,R=c[Y+1];R?h.subVectors(R,B):J?h.subVectors(B,J):h.x=1,h.normalize(),w.push({point:B,length:T,tangent:h}),J=B}J=null}return w},lr=function(Y,W,f,E){f=f||Bc;for(var A=[],p=0,H=Y.size();H>p;p++){var j=Y.get(p);A.push(new Qb(j.x,j.e||0,j.y))}W&&(so(W)&&(W=W._as),W.length||(W=null));for(var G,O,d,S,s,k=[],u=[],C=0,T=0,e=W?W.length:H;e>T;T++){if(s=W?W[T]:0===T?1:2,1===s)k.push(d=[]),d.push(A[C++]);else if(2===s||5===s)if(S=2===s?A[C++]:d[0],E){var w=W?W[T+1]:e>T+1?2:h;if(2===w||5===w){var F=d[d.length-1],m=2===w?A[C]:d[0],l=(new Qb).subVectors(F,S),c=(new Qb).subVectors(m,S),n=l.length(),R=c.length();if(n&&R)if(E>n/2&&E>R/2)d.push(S);else for(l.multiplyScalar(v(E,n/2)/n).add(S),c.multiplyScalar(v(E,R/2)/R).add(S),G=new oh(l,S,c).getPoints(f),O=0;f>=O;O++)d.push(G[O])}else d.push(S)}else d.push(S);else if(3===s)for(G=new oh(d[d.length-1],A[C++],A[C++]).getPoints(f),O=1;f>=O;O++)d.push(G[O]);else if(4===s)for(G=new to(d[d.length-1],A[C++],A[C++],A[C++]).getPoints(f),O=1;f>=O;O++)d.push(G[O]);u.push(k.length,d.length)}return k.indexMark=u,k},ei=function(W){for(var P,$,z=new Qb,L=[],y=[],e=[],O=0,u=W.length;u>O;O++)P=W[O],$=W[O+1],$?z.subVectors($,P):z.subVectors(P,W[O-1]),L.push(z.normalize().clone());var o,D=new Qb,f=new Qb,x=new Jb,q=1e-4,N=L[0],K=y[0]=new Qb,Q=e[0]=new Qb;for(Math.abs(Math.abs(N.y)-1)<q?D.set(1,0,0):D.set(0,1,0),f.crossVectors(N,D).normalize(),K.crossVectors(N,f),Q.crossVectors(N,K),O=1;u>O;O++)y[O]=y[O-1].clone(),e[O]=e[O-1].clone(),f.crossVectors(L[O-1],L[O]),f.length()>q&&(f.normalize(),o=s(Pc(L[O-1].dot(L[O]),-1,1)),y[O].applyMatrix4(x.makeRotationAxis(f,o))),e[O].crossVectors(L[O],y[O]);return{B:e,T:L,N:y}},Tg=function(){var L=function(q){for(var k=1;k<arguments.length;k++){var O=arguments[k];q.push(O.x,O.y,O.z)}},$=function(U){for(var Z=1;Z<arguments.length;Z++){var O=arguments[Z].uv;U.push(O[0],O[1])}},S=function(T){for(var v=1;v<arguments.length;v++){var I=arguments[v].ns;T.push(I[0],I[1],I[2])}},E=function(V,o,$,W,D){var P=-W*d(D),k=W*a(D);return new Qb(V.x+P*$.x+k*o.x,V.y+P*$.y+k*o.y,V.z+P*$.z+k*o.z)},M=function(A,v,j,n,w,R,T,l,M){T=T||Q;for(var W,i=[],b=T/w,W=M?new qp:h,$=0;w>=$;$++){var c=E(A,v,j,n,$*b+R);i.push(c),l!=h&&(c.uv=[l,1-$/w]),M&&(c.ns=W.subVectors(c,A).normalize().toArray())}return i},Y=function($,M,n,k,B,W,r,b,S){S=S||Q;var N=M?$.top_vs:$.bottom_vs;if(N)for(var z=M?$.top_uv:$.bottom_uv,D=S/r,u=0;r>u;u++){var T,U;M?(T=u*D+b,U=(u+1)*D+b):(U=u*D+b,T=(u+1)*D+b),L(N,E(n,k,B,W,T),E(n,k,B,W,U),n),z&&z.push(.5-.5*d(T),.5-.5*a(T),.5-.5*d(U),.5-.5*a(U),.5,.5)}};return function(k,l,J,f,d,r,p,v,i){var e=l.length;if(e>1){var V,s,D,E,F,Q,U,N=ei(l),Z=N.T,y=N.N,W=N.B;"flat"===v&&Y(k,!0,l[0],W[0],y[0],f,d,r,p),"flat"===i&&Y(k,!1,l[e-1],W[e-1],y[e-1],f,d,r,p);var O,G,P=[],K=g(d/2),w="round"===v,A="round"===i,t=l[0],R=Z[0],c=W[0],T=y[0],n=l[e-1],H=Z[e-1],x=W[e-1],q=y[e-1];if(w){for(D=1;K>=D;D++)y.splice(0,0,T),W.splice(0,0,c),Z.splice(0,0,R),G=-D/K*f,l.splice(0,0,R.clone().multiplyScalar(G).add(t)),P[K-D]=m(f*f-G*G);e+=K}if(A){for(D=1;K>=D;D++)y.push(q),W.push(x),Z.push(H),G=D/K*f,l.push(H.clone().multiplyScalar(G).add(n)),P[l.length-1]=m(f*f-G*G);e+=K}if(k.uv){var I=0,_=0,o=[];for(J&&(I=J),F=l[0],o[0]=0,D=1;e>D;D++)E=l[D],o[D]=F.distanceTo(E),F=E,J||(I+=o[D]);for(O=[],D=0;e>D;D++)_+=o[D],O[D]=I?_/I:0}var b=k.ns?!0:!1;for(D=0;e>D;D++){if(E=l[D],Q=W[D],U=y[D],V=M(E,Q,U,P[D]===B?f:P[D],d,r,p,O?O[D]:h,b),s)for(var j=0;d>j;j++){var C=s[j],a=s[j+1]||s[0],u=V[j],z=V[j+1]||V[0];L(k.vs,a,C,u,u,z,a),k.uv&&$(k.uv,a,C,u,u,z,a),b&&S(k.ns,a,C,u,u,z,a)}s=V}}}}();sq(l,{getLineLength:function(y){return y[y.length-1].length},getLineOffset:function(Z,U){return Sc(Z,U)},getLineCacheInfo:function(g,j,G,b){return Ld(lr(g,j,G,b))}});var lp=R.graph3d.RenderLite={},Jd=new Array(0),eg=lp.Buffer=function(j,g,Y,L){this.gl=j,this.buffer=j.createBuffer(),this.type=g||j.ARRAY_BUFFER,this.drawType=L||j.STATIC_DRAW,this.data=Jd,Y&&this.upload(Y)};eg.prototype.upload=function(I,z,t){t||this.bind();var i=this.gl;I=I||this.data,z=z||0,this.data.byteLength>=I.byteLength?i.bufferSubData(this.type,z,I):i.bufferData(this.type,I,this.drawType),this.data=I},eg.prototype.bind=function(){var d=this.gl;d.bindBuffer(this.type,this.buffer)},eg.createVertexBuffer=function(B,s,i){return new eg(B,B.ARRAY_BUFFER,s,i)},eg.createIndexBuffer=function(Q,g,a){return new eg(Q,Q.ELEMENT_ARRAY_BUFFER,g,a)},eg.create=function(E,s,e,X){return new eg(E,s,X)},eg.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Uk=lp.Shader=function(c,T,M){this.gl=c,this.program=Wr(c,T,M),this.attributes=Pr(c,this.program);var j=Rn(c,this.program);this.uniforms=Te(c,j)};Uk.prototype.bind=function(){this.gl.useProgram(this.program)},Uk.prototype.destroy=function(){this.gl};var Wr=function(T,q,W){var K=Lh(T,T.VERTEX_SHADER,q),C=Lh(T,T.FRAGMENT_SHADER,W),u=T.createProgram();return T.attachShader(u,K),T.attachShader(u,C),T.linkProgram(u),T.getProgramParameter(u,T.LINK_STATUS)||(Rd("LINK","LITE",T.getProgramParameter(u,T.VALIDATE_STATUS),T.getError(),T.getProgramInfoLog(u)),T.deleteProgram(u),u=null),T.deleteShader(K),T.deleteShader(C),u},Lh=function(e,N,r){var n=e.createShader(N);return e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(Rd("COMPILE","LITE",N,e.getError(),e.getShaderInfoLog(n)),null)},Rn=function(N,Q){for(var k={},O=N.getProgramParameter(Q,N.ACTIVE_UNIFORMS),c=0;O>c;c++){var y=N.getActiveUniform(Q,c),m=y.name.replace(/\[.*?\]/,""),p=rk(N,y.type);k[m]={type:p,size:y.size,location:N.getUniformLocation(Q,m),value:Pb(p,y.size)}}return k},Pr=function(S,Q){for(var w={},Z=S.getProgramParameter(Q,S.ACTIVE_ATTRIBUTES),X=0;Z>X;X++){var W=S.getActiveAttrib(Q,X),B=rk(S,W.type);w[W.name]={type:B,size:rp(B),gl:S,location:S.getAttribLocation(Q,W.name),pointer:km}}return w},km=function(l,D,v,Y,W){var g=this.gl;g.enableVertexAttribArray(this.location),l instanceof lp.Buffer||(l=lp.Buffer.createVertexBuffer(g,l)),g.bindBuffer(l.type,l.buffer),g.vertexAttribPointer(this.location,this.size,D||g.FLOAT,v||!1,Y||0,W||0)},rp=function(Y){return Im[Y]},Im={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},rk=function(l,j){if(!Yc){var B=w.keys(sk);Yc={};for(var O=0;O<B.length;++O){var G=B[O];Yc[l[G]]=sk[G]}}return Yc[j]},Yc=null,sk={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Pb=function(m,E){switch(m){case"float":return 0;case"vec2":return new Float32Array(2*E);case"vec3":return new Float32Array(3*E);case"vec4":return new Float32Array(4*E);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*E);case"ivec3":return new Int32Array(3*E);case"ivec4":return new Int32Array(4*E);case"bool":return!1;case"bvec2":return Sd(2*E);case"bvec3":return Sd(3*E);case"bvec4":return Sd(4*E);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Sd=function(S){for(var Z=new Array(S),b=0;b<Z.length;b++)Z[b]=!1;return Z},Te=function(z,_){var x={data:{}};x.gl=z;for(var X=w.keys(_),R=0;R<X.length;R++){var j=X[R],t=j.split("."),C=t[t.length-1],T=Eq(t,x),S=_[j];T.data[C]=S,T.gl=z,w.defineProperty(T,C,{get:eo(C),set:Xk(C,S)})}return x},eo=function(i){var I=Ch.replace("%%",i);return new Function(I)},Xk=function(z,O){var L,n=ck.replace(/%%/g,z);return L=1===O.size?Lj[O.type]:vr[O.type],L&&(n+="\nthis.gl."+L+";"),new Function("value",n)},Eq=function(Q,g){for(var d=g,E=0;E<Q.length-1;E++){var U=d[Q[E]]||{data:{}};d[Q[E]]=U,d=U}return d},Ch=["return this.data.%%.value;"].join("\n"),ck=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Lj={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},vr={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},Kj=function(H){function K(a){if("string"!=typeof a)return 0|a;
switch(a){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}var x=this;x.enable=!1;var _,E,L=l.graph3dViewShadowType,b=l.graph3dViewShadowIntensity,S=l.graph3dViewShadowBias,t=l.graph3dViewShadowQuality,v=l.graph3dViewShadowRadius,r=l.graph3dViewShadowDegreeX,p=l.graph3dViewShadowDegreeZ,i=1,w=K(t),j=!1,T=new R.Math.Matrix4,u=new R.Math.Matrix4,M=x.pvMatrix=new R.Math.Matrix4;x.render=function(){if(!H._picking&&x.enable){var b=H.getGL();if(b){j&&x.setupShadowCamera(),H._glCapabilities&&(w=Math.min(w,H._glCapabilities.maxTextureSize)),x.map?_.setSize(w,w):_=x.map=new yj(H,H.getGL(),0,0,{samples:1,minFilter:uo.NEAREST,magFilter:uo.NEAREST,width:w,height:w}),b._shadowShader||(b._shadowShader=new lp.Shader(b,Kj.shaderSrc.vs,Kj.shaderSrc.fs));var k=H._frameState,r=k.renderState.glState;r.blend.enabled=!1,r.depth.enabled=!0,r.depth.mask=!0;var Z=r.color.clear.slice(0);Zj(b,[1,1,1,1]),k.renderState.useProgram(b._shadowShader.program),Y(),Zj(b,Z)}}},x.getShadow=function(){var q={degreeX:r,degreeZ:p,intensity:b,quality:t,type:L,radius:v,bias:S};return 1!==i&&(q.boundExtend=i),q},x.setShadow=function(k,O){k=!!k;var V=x.enable!==k;x.enable=k,"object"==typeof O&&(O.intensity!==B&&(b=O.intensity),O.bias!==B&&(S=O.bias),O.radius!==B&&(v=O.radius),O.degreeX!==B&&(r=O.degreeX),O.degreeZ!==B&&(p=O.degreeZ),O.quality!==B&&(t=O.quality),O.type!==B&&L!==O.type&&(L=O.type,V=!0),w=K(t),O.boundExtend!==B&&(i=O.boundExtend)),k&&x.setupShadowCamera(),V&&ce(H),H.iv()},x.refresh=function(){this.enable&&(this.setupShadowCamera(),H.iv())},x.tryUpdateBounding=function(k){var z=this.boundingSphere;if(z){var F=(new Jb).fromArray(Vl(k,H.getMat(k))),t=k.getAnchor3d(),w=new qp;z.containsPoint(w.set(0-t.x,0-t.y,0-t.z).applyMatrix4(F))&&z.containsPoint(w.set(0-t.x,0-t.y,1-t.z).applyMatrix4(F))&&z.containsPoint(w.set(0-t.x,1-t.y,0-t.z).applyMatrix4(F))&&z.containsPoint(w.set(0-t.x,1-t.y,1-t.z).applyMatrix4(F))&&z.containsPoint(w.set(1-t.x,0-t.y,0-t.z).applyMatrix4(F))&&z.containsPoint(w.set(1-t.x,0-t.y,1-t.z).applyMatrix4(F))&&z.containsPoint(w.set(1-t.x,1-t.y,0-t.z).applyMatrix4(F))&&z.containsPoint(w.set(1-t.x,1-t.y,1-t.z).applyMatrix4(F))||x.setupShadowCamera()}},x.createShadow=function(c){c||(c=H._frameState.renderState.directUniforms()),c.shadowMatrix=M.toArray(),c.shadowMap=_.texture,c.shadowSize=[_.width,_.height],c.shadowIntensity=b,c.shadowBias=S,c.shadowRadius=v},x.genShaderDefine=function(){var l="#define USE_SHADOWMAP\n";return"hard"===L?l+="#define SHADOWMAP_TYPE_PCF\n":"soft"===L&&(l+=H.isGLTempRegisterLimited()?"#define SHADOWMAP_TYPE_PCF\n":"#define SHADOWMAP_TYPE_PCF_SOFT\n"),l};var U;x.setupShadowCamera=function(){E||(E=x.boundingSphere=new R.Math.Sphere),j=!1;var t,g,b=H.getBoundingBox(H.dm().toDatas(function(d){return d.s("shadow.cast")&&H.isVisible(d)}));b?(t=new qp(b.min),g=new qp(b.max)):(t=new qp(-256,-256,-256),g=new qp(256,256,256),j=!0),E.set(t.clone().add(g).multiplyScalar(.5),.5*t.distanceTo(g)*i);var u,N=E.radius,d=H.getBoundingBox(H.dm().toDatas(function(Y){return(Y.s("shadow.cast")||Y.s("shadow.receive"))&&H.isVisible(Y)}));if(d){t.copy(d.min),g.copy(d.max);var D=.5*t.distanceTo(g);u=D+Math.min(D,N+E.center.distanceTo(t.add(g).multiplyScalar(.5)))}else u=2*N;U=on(yo(),-N,N,-N,N,u/1e3,u),M.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),M.multiply(T.fromArray(U));var C=Math.tan(-r*Math.PI/180),Z=Math.tan(-p*Math.PI/180),n=N/Math.sqrt(C*C+Z*Z+1),B=new qp(n*C,n,n*Z);T.lookAt(B,new qp(0,0,0),new qp(0,1,0)).setPosition(B.add(E.center)),T.getInverse(T),M.multiply(T)};var Y=function(){var N=H.getGL(),r=w,B=w;_.setSize(N,r,B),_.bind(N),N.clear(uo.COLOR_BUFFER_BIT|uo.DEPTH_BUFFER_BIT);var L=H._frameState,h=L.renderState,$=h.directUniforms(),o=h.directAttribs(),g=h.directState();$.projectionMatrix=U;var S=H._viewport;H.setViewport(N,0,0,r,B);var C,j,A,K;for(C=0,j=Ve.length;j>C;C++)if(A=Ve[C],!sc[A].ignore&&(K=H._40Q.get(A))){var u=K.batchIndexMap;x.renderItems(N,$,o,g,K.opaque,u),x.renderItems(N,$,o,g,K.transparent,u),x.renderBatch(N,$,o,g,K.batchModelMap,u)}_.unbind(N),H.setViewport(N,S[0],S[1],S[2],S[3])};x._renderDirect=function(U,S,Z,g){Z&&Z.length&&(S.position=zi(U,H._buffer.vs,Z,h),g?(_j(U,H._buffer.is,g),go(U,0,g.length,null,g instanceof Uint32Array?U.UNSIGNED_INT:null)):Ko(U,0,Z.length/3))},x.renderShapeModel=function(U,$,g,v){var P,H,N;if(Nl(g))for(H=0,N=g.length;N>H;H++)P=g[H],P&&x.renderShapeModel(U,$,P,v);else Ek(g)?x.renderShapeModel(U,$,ni(v,g),v):xg(g)&&(g.shape3d?x.renderShapeModel(U,$,g.shape3d,v):x.renderShapeModelImpl(U,$,g))},x.renderShapeModelImpl=function(h,l,j){Jk(j),x._renderDirect(h,l,j.vs,j.is),x._renderDirect(h,l,j.top_vs,j.top_is),x._renderDirect(h,l,j.bottom_vs,j.bottom_is),x._renderDirect(h,l,j.from_vs,j.from_is),x._renderDirect(h,l,j.to_vs,j.to_is)},x.renderBatch=function(j,U,L,Z,t){if(!Gi(t)&&!H.drawFilter){U.modelViewMatrix=u.identity().premultiply(T).toArray();var g,w,h;for(g in t)h=H.getBatchInfo(g)||vm,h.visible!==!1&&h.shadowCast!==!1&&(w=t[g],w.invalidate&&Ir(w),x._renderDirect(j,L,w.vs32,w.is))}},x.renderItems=function(Y,B,C,h,y,s){var z,t,O,F,V,e=y.length;for(z=0;e>z;z++)if(t=y[z],F=t.ui,O=t.data,!pn(O)&&O.s("shadow.cast")&&H.isVisible(O)&&!s[O._id]){var X=F.s("3d.clip.direction");if(X){var v=F.s("3d.clip.percentage");if(0===v)continue;var r=F._formatClipUniforms(X,v,O);B.uClipPercent=r[1],B.uClipDirection=r[0]}else B.uClipDirection=0;V=F.shapeModel||ni(F),V||(V=O instanceof R.Node&&!(O instanceof R.Shape)?{vs:$f,is:Pq}:[F.left,F.front,F.right,F.back,F.top,F.bottom]),B.modelViewMatrix=(F.mat?u.fromArray(F.mat):u.identity()).premultiply(T).toArray(),h.cullFace.enabled=!!O.s("shape3d.reverse.cull"),x.renderShapeModel(Y,C,V,F)}}};Kj.shaderSrc={vs:["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","varying vec3 vPosition;","void main() {","vec3 transformed = vec3( position );","vPosition = vec3(position);","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","varying vec3 vPosition;","uniform int uClipDirection;","uniform float uClipPercent;","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","if (uClipDirection > 0) {","vec3 dir = vec3(0.0, 0.0, 0.0);","if (uClipDirection < 2) { dir.x = 1.0; }","else if (uClipDirection < 3) { dir.x = -1.0; }","else if (uClipDirection < 4) { dir.y = 1.0; }","else if (uClipDirection < 5) { dir.y = -1.0; }","else if (uClipDirection < 6) { dir.z = 1.0; }","else if (uClipDirection < 7) { dir.z = -1.0; }","if (dot(dir, vPosition) > dot(vec3(uClipPercent), dir)) { discard; }","}","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},Kj.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z"];var Ki=R.Light=function(){_l(Ki,this),this.s(nf,D[nf]),this.s(pl,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};Dj("Light",Qp,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(K,U,Q){Ki.superClass.onStyleChanged.apply(this,arguments),K===nf&&this.s("shape3d.color",Q)}});var Pl=jq.FrameState=function(a,h){this.renderState=Ig.for(h),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=B,this.projectMatrix=B,this.viewMatrix=B,this.view=a,this.defaultProgram=B,this.pickColorMap=B,this._pvStack=[],this._renderStateStack=[]};Pl.prototype.savePV=function(){var z=this.view;this._pvStack.push([Dl(this.projectMatrix),Dl(this.viewMatrix),z._18Q,Dl(z._7O)])},Pl.prototype.restorePV=function(){var X=this._pvStack.pop();if(X){var M=this.view;this.projectMatrix=M._projectMatrix=X[0],this.viewMatrix=M._viewMatrix=X[1],M._18Q=X[2],M._7O=X[3]}},Pl.prototype.setPV=function(y,C){var z=this.view,P=!1;if(y&&(this.projectMatrix=z._projectMatrix=y,P=!0),C&&(this.viewMatrix=z._viewMatrix=C,z._7O=Dl(C),P=!0),P){var b=z.getWidth(),H=z.getHeight(),r=Dl(this.projectMatrix);z._18Q=Mh(r,r,C),z._18Q._wh=b/H}},Pl.prototype.syncEnv=function(K){var H=this,v=H.view;H.envmapReflectivity=v._envmapReflectivity||.5,H.cameraPosition=v.getEye(),H.projectMatrix=v._projectMatrix,H.viewMatrix=v._viewMatrix,H.pickColorMap=K,H.picking=v.getGL()._picking},Pl.prototype.setGLState=function(){var G=[0,0,0,0],C=[!0,!0,!0,!0],z=[-1,1],n=[uo.FUNC_ADD,uo.FUNC_ADD],v=[uo.SRC_ALPHA,uo.ONE_MINUS_SRC_ALPHA,uo.ONE,uo.ONE_MINUS_SRC_ALPHA];return function(a,e){var U=this,K=U.renderState.gl,N=U.renderState.glState;N.dither=!1,e?N.color.mask=C:N.color.reset(),N.pixelStore.reset(),N.blend.color=G,N.blend.equation=n,N.blend.func=v,N.cullFace.enabled=!1,N.scissor.enabled=!1,N.depth.enabled=!0,N.depth.clear=1,N.depth.func=K.LEQUAL,N.depth.range=z,N.stencil.enabled=!1,N.polygonOffset.enabled=!1,a?(N.depth.mask=!1,N.blend.enabled=!0):(N.depth.mask=!0,N.blend.enabled=!1)}}(),Pl.prototype.setUniforms=function(P){var N=this,v=N.view,G=N.renderState,s=G.gl,u=G.uniforms;u.uBrightness=1,u.uOpacity=1,u.uPartOpacity=1,u.uPick=N.picking,u.uTexture=!1,u.uBlendTexture=!1,u.uAlphaTest=D.alphaTest,u.uTransparent=!!P,u.uFix=!1,u.uBatchColor=!1,u.uBatchBlend=!1,u.uBatchBrightness=!1,u.uReflectivity=N.envmapReflectivity||.5,u.uCameraPosition=N.cameraPosition,u.uPMatrix=N.projectMatrix,u.uViewMatrix=N.viewMatrix,v.bindEnvMap(s),N.picking||(kg(v,s,B),v._fogDisabled||(u.uFogColor=v._fogColor,u.uFogDensity=v._fogDensity,u.uFogNear=v._fogNear,u.uFogFar=v._fogFar))},Pl.prototype.drawLayer=function(n){return this.view.renderLayers(n,!0)},Pl.prototype.drawData=function(s,R,K){var G=this.view;if(G.isVisible(s)){var q=this.renderState,d=q.uniforms,A=G.getData3dUI(s);if(A){var Z=q.gl,o=Z._picking,B=G._picking,M=s._pickId;K&&(s._pickId=K),d.uPick=Z._picking=G._picking=!!K,d.uTransparent=!!R,A._42(q.gl,q.program,R?X:Y),d.uPick=Z._picking=o,G._picking=B,s._pickId=M}}};var ti=jq.Graph3dView=function(I,f){var C=this;C._webGLVersion=1,C._attributes=f||l.graph3dViewAttributes,C._25I={},C._view=fl(1,C);var L=C._canvas=Mb(C._view);e(L,"webglcontextlost",function(r){r.preventDefault(),ce(C),C._26I&&C._doBufferGC(C._26I,!0),C._26I=h,C._1o.onContextLost(),C._35O=!0}),e(L,"webglcontextrestored",function(){C._35O=!1,C.iv()}),C._40Q=new Ph,C._43Q={},C._44Q=-1,C._batchIndexMap={},C._batchModelMap={},C._wireframeIndexMap={},C._wireframeModelMap={},C._wireframeIndexMapSwap={},C._wireframeModelMapSwap={},C._polylineIndexMap={},C._polylineIndexMap={},C._polylineIndexMapSwap={},C._polylineIndexMapSwap={},C._8O=[],C._7O=yo(),C._6O=yo(),C._1o=new ak(C),C._30O=new Rh(C),C._31O=new fb(C),C._32O=new Zf(C),C._raycaster=new Hs(C),C._highlightHelper=new mo(C),C._postProcessing=new Rs(C),C._41Q=[],C._42Q=0,C._frameRenderOptionStack=[],jq.VR?(C.vr=new jq.VR(C),C.isVREnabled=function(){return this.vr.enable},C.isVRPresenting=function(){return this.vr.isPresenting()}):(C.vr={enable:!1,isPresenting:u},C.isVREnabled=u,C.isVRPresenting=u),C.shadowMap=new Kj(C),C._33Q=!0,C._eye=lg(l.graph3dViewEye),C._center=lg(l.graph3dViewCenter),C._up=lg(l.graph3dViewUp),C._lightChanged=!1,C._59O=[],C._spots=[],C._dirs=[],C._frameId=0,C._batchInfoMap={},C.overlappingBox=new Fg(C),C.dm(I?I:new Ge),C._coreInteractor=new ds(this),C.setInteractors([new Kf(C)]),C._initView()},$i={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},ys=0;Xi("Graph3dView",w,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",Gb,_i,"firstPersonMode",nk,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Bl,Xf,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay","batchInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:l.graph3dViewSortable,_editHelperDisabled:l.graph3dViewEditHelperDisabled,_blockSelectable:l.graph3dViewBlockSelectable,_devicePixelRatio:B,_boundaries:B,_moveStep:l.graph3dViewMoveStep,_rotateStep:l.graph3dViewRotateStep,_rotateMinPhi:l.graph3dViewMinPhi===B?l.graph3dViewRotateMinPhi:l.graph3dViewMinPhi,_rotateMaxPhi:l.graph3dViewMaxPhi===B?l.graph3dViewRotateMaxPhi:l.graph3dViewMaxPhi,_pannable:l.graph3dViewPannable,_rotatable:l.graph3dViewRotatable,_walkable:l.graph3dViewWalkable,_resettable:l.graph3dViewResettable,_zoomable:l.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:l.graph3dViewFirstPersonMode,_mouseRoamable:l.graph3dViewMouseRoamable,_gridVisible:l.graph3dViewGridVisible,_gridSize:l.graph3dViewGridSize,_gridGap:l.graph3dViewGridGap,_gridColor:l.graph3dViewGridColor,_originAxisVisible:l.graph3dViewOriginAxisVisible,_centerAxisVisible:l.graph3dViewCenterAxisVisible,_axisXColor:l.graph3dViewAxisXColor,_axisYColor:l.graph3dViewAxisYColor,_axisZColor:l.graph3dViewAxisZColor,_ortho:l.graph3dViewOrtho,_orthoWidth:l.graph3dViewOrthoWidth,_fovy:l.graph3dViewFovy,_near:l.graph3dViewNear,_far:l.graph3dViewFar,_headlightColor:l.graph3dViewHeadlightColor,_headlightIntensity:l.graph3dViewHeadlightIntensity,_headlightRange:l.graph3dViewHeadlightRange,_headlightAmbientIntensity:l.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:l.graph3dViewHeadlightDisabled,_rectSelectable:l.graph3dViewRectSelectable,_rectSelectBackground:l.graph3dViewRectSelectBackground,_editSizeColor:l.graph3dViewEditSizeColor,_autoMakeVisible:ws,_fogDisabled:l.graph3dViewFogDisabled,_fogMode:l.graph3dViewFogMode,_fogDensity:l.graph3dViewFogDensity,_fogColor:l.graph3dViewFogColor,_fogNear:l.graph3dViewFogNear,_fogFar:l.graph3dViewFogFar,_pickerResolution:l.graph3dViewPickerResolution,_dashDisabled:l.graph3dViewDashDisabled,_batchColorDisabled:l.graph3dViewBatchColorDisabled,_batchBlendDisabled:l.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:l.graph3dViewBatchBrightnessDisabled,addCamera:function(n){var x=this,r=w.freeze({id:x._42Q++,priority:n.priority||0,ignoreInPick:!!n.ignoreInPick,render:n.render});n.switch3DStatus&&(x._43Q[r.id]=!0),x._41Q.push(r),x._41Q.sort(function(B,V){return B.priority!==V.priority?B.priority-V.priority:B.id-V.id})},setEye:function(B,C,J){1===arguments.length&&(C=B[1],J=B[2],B=B[0]);var W=this._eye;W[0]=B,W[1]=C,W[2]=J,this.fp(Bl,h,W)},setCenter:function(P,p,t){1===arguments.length&&(p=P[1],t=P[2],P=P[0]);var x=this._center;x[0]=P,x[1]=p,x[2]=t,this.fp(Xf,h,x)},setUp:function(T,a,W){1===arguments.length&&(a=T[1],W=T[2],T=T[0]);var X=this._up;X[0]=T,X[1]=a,X[2]=W,this.fp("up",h,X)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||Tp},isTransparentMask:function(J){return J.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var e=this,G=e._aspect;return G?G:(G=e.getWidth()/e.getHeight(),G||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(u){var I=this,H=I._dataModel,g=I._selectionModel;H!==u&&(H&&(H.ump(I.handleDataModelPropertyChange,I),H.umm(I.handleDataModelChange,I),H.umd(I.handleDataPropertyChange,I),g||H.sm().ums(I.handleSelectionChange,I)),I._dataModel=u,u.mp(I.handleDataModelPropertyChange,I),u.mm(I.handleDataModelChange,I),u.md(I.handleDataPropertyChange,I),g?g._21I(u):u.sm().ms(I.handleSelectionChange,I),I._postProcessing.handleDataModleChange(H,u),I.invalidateAll(!0),I.invalidateLight(),I.fp(br,H,u),I._canvas.style.background=u.getBackground()||"")},handleDataModelPropertyChange:function(H){if("background"===H.property){var R=this._canvas.style.background,i=H.newValue||"";this._canvas.style.background=i,this.fp("canvasBackground",R,i)}else"envmap"===H.property?this.iv():"cubicEnvmap"===H.property&&(this._lastEnvMap=B,this.iv())},handleDataPropertyChange:function(X){var N=X.data;this.invalidateData(N),pn(N)&&"s:light.type"===X.property?this.invalidateLight():"s:shadow.cast"===X.property&&this.shadowMap.tryUpdateBounding(N)},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(p){var T=this,W=p.property;T.iv(),T._18Q=h,"eye"===W?T._33Q=!0:"devicePixelRatio"===W?T._42(T.getDevicePixelRatio()):$i[W]&&ce(T)},_5O:function(X){var n=X._22Q();return n?new n(this,X):h},getData3dUI:function(n){var W=this._25I[n._id];return W===B&&(W=this._5O(n),this._25I[n._id]=W),W},invalidateAll:function(l){var K=this;if(l){for(var I in K._25I){var U=K._25I[I];U&&U.dispose()}K._25I={},K.iv(),ie(K)}else ie(K),K.dm().each(function(Y){K.invalidateData(Y)})},invalidateSelection:function(){var h=this;h.sm().each(function(J){h.invalidateData(J)})},invalidateData:function(L){var b=this,_=b.getData3dUI(L);_&&(_.iv(),b.iv()),ie(b,L)},getShape3dText:function(x){return x.getStyle("shape3d.text")||this.getLabel(x)},invalidateBatch:function(n){var b=this,f=b._40Q;f.each(function(E){b._invalidateBatch(E.batchModelMap,E.batchIndexMap,E.polylineModelMap,E.polylineIndexMap,E.wireframeModelMap,E.wireframeIndexMap,n),E.markBatchInvalid()})},_invalidateBatch:function(y,O,m,r,E,M,J){var g=this,U=y[J],n=[],x={};if(U){U.ds.forEach(function(d){var h=g.getData3dUI(d);h&&h.iv(),delete O[d._id],n.push(d._id)}),delete y[J];for(var o,T,s,q,F,$,k,C,j,i=[E,m],d=[M,r],H=0;H<i.length;H++){var Z=i[H],u=d[H];for(x={},C=0;C<n.length;C++){var t=u[n[C]];if(t){delete u[n[C]],j=t.batch,o=Z[j];var R=t.begin,G=t.size,W=3*R,w=3*G,V=4*R,c=4*G;for(T=o.ds,s=o.vs,q=o.cs,F=o.ps,$=o.ls,k=t.index,o.invalidate=!0,T[k]=B,k=W;W+w>k;k++)s[k]=B;for(k=V;V+c>k;k++)q[k]=B;for(k=V;V+c>k;k++)F[k]=B;if($)for(k=W;W+w>k;k++)$[k]=B;x[j]=!0}}for(j in x){o=Z[j],T=o.ds,s=o.vs,q=o.cs,F=o.ps,$=o.ls;var e=[];for(k=0;k<T.length;k++)T[k]!==B&&e.push(T[k]);if(0===e.length)delete Z[j];else{for(o.ds=e,e=[],k=0;k<s.length;k++)s[k]!==B&&e.push(s[k]);for(o.vs=e,e=[],k=0;k<q.length;k++)q[k]!==B&&e.push(q[k]);for(o.cs=e,e=[],k=0;k<F.length;k++)F[k]!==B&&e.push(F[k]);if(o.ps=e,$){for(e=[],k=0;k<$.length;k++)$[k]!==B&&e.push($[k]);o.ls=e}}}}g.iv()}},handleDataModelChange:function(w){var Z=this,U=w.kind,C=w.data;if("add"===U)Z.invalidateData(C),Jr(C)&&C.getEdgeGroup()&&C.getEdgeGroup().eachSiblingEdge(Z.invalidateData,Z),pn(C)&&Z.invalidateLight();else if(U===Sb){var k=C._id,l=Z._25I[k];l&&(l.dispose(),delete Z._25I[k],Z.iv()),C===Z._currentSubGraph&&Z.setCurrentSubGraph(h),ie(Z,C),pn(C)&&Z.invalidateLight()}else U===Oe&&(Z.invalidateAll(!0),Z.setCurrentSubGraph(h),ie(Z),Z.invalidateLight())},toCanvas:function(V,P,K){var k=this,F=k.getGL();if(k.validate(),V){var o=F.getParameter(F.COLOR_CLEAR_VALUE);Zj(F,V)}k._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var C=k.getWidth()||1,H=k.getHeight()||1,O=new Uint8Array(4*C*H),M=Mb(),Z=M.getContext("2d");F.readPixels(0,0,C,H,F.RGBA,F.UNSIGNED_BYTE,O),qh(M,C,H,1);for(var f=Z.getImageData(0,0,C,H),D=f.data,t=0;t<D.length;t+=4){var $=t/4,Q=c($/C),y=$-Q*C;$=4*((H-1-Q)*C+y),D[$]=O[t],D[$+1]=O[t+1],D[$+2]=O[t+2],D[$+3]=O[t+3]}if(Z.putImageData(f,0,0),V&&Zj(F,o),k._42(k.getDevicePixelRatio()),P&&K){var J=Mb(),S=J.getContext("2d");return qh(J,P,K,1),l.drawImage(S,M,0,0,P,K),J}return M},toDataURL:function(B,X){var j=this,R=j.getGL();if(j.validate(),B){var I=R.getParameter(R.COLOR_CLEAR_VALUE);Zj(R,B)}j._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var S=j._canvas.toDataURL(X||"image/png",1);return B&&Zj(R,I),j._42(j.getDevicePixelRatio()),S},getGL:function(){var H=this._26I;if(H)return this.acquireProgram(),H;if(!this._35O){var G=this,t=G._canvas,C=G._attributes;if(!C||C.requestWebGL2!==!1)try{H=t.getContext("webgl2",C)||t.getContext("experimental-webgl2",C),H&&(G._webGLVersion=2,G._26I=H)}catch(B){}if(!H)try{H=t.getContext("webgl",C)||t.getContext("experimental-webgl",C)}catch(B){throw new Error("WebGL not supported")}if(!H)throw new Error("WebGL not supported");G._26I=H;var n=G._frameState=new Pl(this,H);G._glExtensions=new y(H),G._glCapabilities=new K(H,G._glExtensions),G._2O={},H._emptyCubeTexture=jo(H),H._compiledShader={},H._emptyTexture=rn(H),H._emptyBlendTexture=rn(H),H._bufPool={},H._id=++ys,n.setGLState(),G._buffer={vs:Xo(H),ns:Xo(H),is:Xo(H),uv:Xo(H),batchColor:Xo(H),batchBlend:Xo(H),batchBrightness:Xo(H),lineDistance:Xo(H)},G._1O=Zl(H);var R=G._cube={vs:Xo(H),ns:Xo(H),is:Xo(H),uv:Xo(H)};return cj(H,R.vs,$f),cj(H,R.ns,Dc),cj(H,R.uv,qf),Yb(H,R.is,Pq),G.acquireProgram(),H._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,frame:0,cacheTimeCost:0},H}},getGLCapabilities:function(){var d=this.getGL();return d?this._glCapabilities:void 0},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<l.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},acquireProgram:function(){var k=this,Y=k._26I;if(Y){var E=l.getImage(k.getEnvmap()),D=E&&E.tagName?!0:!1,c=k._prg&&k._prg.envMapFlag?!0:!1;if(!k._prg||D!==c){var b=k._prg=Y.createProgram();if(!b)return h;b.envMapFlag=D;var g=k._dirs.length,n=k._spots.length,j=k._59O.length,q=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];g&&q.push("uDirColor","uDirDirection"),n&&q.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),j&&q.push("uPointColor","uPointRange","uPointPosition"),Hm||(ml=vh(ml.substring(0,ml.indexOf("^#"))),Wq=vh(Wq),Hm=!0);var H=["#define MAX_DIR "+g,"#define MAX_SPOT "+n,"#define MAX_POINT "+j,k._fogDisabled?"":"#define FOG","exp2"===k.getFogMode()?"#define FOG_EXP2":"",k._dashDisabled?"":"#define DASH",D?"#define USE_ENVMAP":"",k.isOrtho()?"#define ORTHOGRAPHIC":"",k._batchColorDisabled?"":"#define BATCHCOLOR",k._batchBlendDisabled?"":"#define BATCHBLEND",k._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",k.shadowMap.enable?k.shadowMap.genShaderDefine():"",""].join("\n"),e=hr(Y,b,Y.VERTEX_SHADER,ml.replace("PREFIX",H));Y.getShaderParameter(e,Y.COMPILE_STATUS)||Rd("COMPILE",Y.VERTEX_SHADER,Y.getError(),Y.getShaderInfoLog(e));var N=hr(Y,b,Y.FRAGMENT_SHADER,Wq.replace("PREFIX",H));if(Y.getShaderParameter(N,Y.COMPILE_STATUS)||Rd("COMPILE",Y.FRAGMENT_SHADER,Y.getError(),Y.getShaderInfoLog(N)),Sj?q.push("aPosition"):(b.aPosition=0,Y.bindAttribLocation(b,0,"aPosition")),Y.linkProgram(b),!Y.getProgramParameter(b,Y.LINK_STATUS)){var i=Y.getProgramInfoLog(b);return k._prg=h,i.indexOf("maximum temp register")>=0&&!k._glTempRegisterLimited?(k._glTempRegisterLimited=!0,Y.deleteProgram(b),k.acquireProgram()):(Rd("LINK",Y.getProgramParameter(b,Y.VALIDATE_STATUS),Y.getError(),i),Y.deleteProgram(b),h)}q.forEach(function(z){b[z]=/^u/.test(z)?Y.getUniformLocation(b,z):Y.getAttribLocation(b,z)});var m=k._frameState;m.renderState.program=m.defaultProgram=b,Y.deleteShader(e),Y.deleteShader(N)}}},isGLTempRegisterLimited:function(){return this._glTempRegisterLimited},getBrightness:function(j){var p=j.s("brightness"),M=this.isSelected(j)?j.s("select.brightness"):h;return p==h?M:M==h?p:p*M},setHighlightMode:function(Z){var d;d="selection"===Z||"selected"===Z?mo.Mode.Selection:"mouseover"===Z||"hover"===Z?mo.Mode.MouseOver:"style"===Z?mo.Mode.Style:mo.Mode.Disable;var I=this._highlightHelper.mode;this._highlightHelper.mode=d,this.firePropertyChange("highlightMode",I,d)},getHighlightMode:function(){var P=this._highlightHelper.mode;return P===mo.Mode.Selection?"selected":P===mo.Mode.MouseOver?"hover":P===mo.Mode.Style?"style":"disabled"},getDataHighlightMode:function(t){return t.s("highlight.mode")},getHighlightColor:function(){return this._highlightHelper.color||D["highlight.color"]},setHighlightColor:function(L){var $=this._highlightHelper.color;this._highlightHelper.color=L,this.firePropertyChange("highlightColor",$,L)},getHighlightWidth:function(){return this._highlightHelper.width||D["highlight.width"]},setHighlightWidth:function(f){var i=this._highlightHelper.width;this._highlightHelper.width=f,this.firePropertyChange("highlightWidth",i,f)},bindEnvMap:function(I){var S=this,a=Ig.for(I),i=a.directUniforms(),g=S.getEnvmap(),t=l.getImage(g);if(t&&t.tagName){if(g!==S._lastEnvMap){var R={};if(S.dm().isCubicEnvmap()){var H=sm(t),F=wq(t);if(0===H||0===F)return;var J=H/4,u=F/3,h={top:{x:J,y:0},left:{x:0,y:u},front:{x:J,y:u},right:{x:2*J,y:u},back:{x:3*J,y:u},bottom:{x:J,y:2*u}};["top","left","front","right","back","bottom"].forEach(function(C){var z=h[C],e=R[C]=Mb();qh(e,J,u,1);var T=hb(e);T.drawImage(t,z.x,z.y,J,u,0,0,J,u),T.restore(),R[C]=l.resizeImagePOT(e,!0)})}else t=l.resizeImagePOT(t,!0);S._envMapTexture&&I.deleteTexture(S._envMapTexture);var q=S._envMapTexture=I.createTexture();I.activeTexture(I.TEXTURE0),I.bindTexture(I.TEXTURE_CUBE_MAP,q),I.texParameteri(I.TEXTURE_CUBE_MAP,I.TEXTURE_MAG_FILTER,I.LINEAR),I.texParameteri(I.TEXTURE_CUBE_MAP,I.TEXTURE_MIN_FILTER,I.LINEAR),I.texImage2D(I.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,R.right||t),I.texImage2D(I.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,R.left||t),I.texImage2D(I.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,R.top||t),I.texImage2D(I.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,R.bottom||t),I.texImage2D(I.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,R.front||t),I.texImage2D(I.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,R.back||t),I.bindTexture(I.TEXTURE_CUBE_MAP,I._emptyCubeTexture),S._lastEnvMap=g}i.uEnvMap=S._envMapTexture}},getWireframe:function(K){var U=K.s("wf.visible"),d=K.s("wf.width");return U===!0||d>0&&"selected"===U&&this.isSelected(K)?{color:K.s("wf.color"),width:d,"short":K.s("wf.short"),mat:K.s("wf.mat")}:void 0},_transformPointToViewSpace:function(K){var T=[K[0],K[1],K[2]];return $e(T,this._viewMatrix),T},_transformDirectionToViewSpace:function(m,r){var K=[m[0],m[1],m[2]];$e(K,this._viewMatrix);var Y=r?[r[0],r[1],r[2]]:[0,0,0];$e(Y,this._viewMatrix);var c=Y[0]-K[0],Z=Y[1]-K[1],f=Y[2]-K[2],_=Math.sqrt(c*c+Z*Z+f*f);return _?[c/_,Z/_,f/_]:[c,Z,f]},getWireframeGeometry:function(U){return U.s("wf.geometry")?{color:U.s("wf.color"),width:U.s("wf.width"),mat:U.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(I){return I.s("body.color")},getMat:function(x){return x.getMat?x.getMat():x.s("mat")},getFaceMat:function(X,o){return X.getFaceMat?X.getFaceMat(o):X.s(o+".mat")},getFaceBlend:function(A,h){return A.s(h+".blend")||A.s("all.blend")},getFaceColor:function(u,n){return u.s(n+".color")||u.s("all.color")},getFaceImage:function(H,l){return H.s(l+".image")||H.s("all.image")},getFaceBlendImage:function(p,$){return p.s($+".blend.image")||p.s("all.blend.image")},getFaceDiscardSelectable:function(k,C){var a=k.s(C+".discard.selectable");return a==h?k.s("all.discard.selectable"):a},getFaceUv:function(q,I){return q.s(I+".uv")||q.s("all.uv")},getFaceUvOffset:function(g,w){return g.s(w+".uv.offset")||g.s("all.uv.offset")},getFaceUvScale:function(P,G){return P.s(G+".uv.scale")||P.s("all.uv.scale")},getFaceUvRotation:function(L,n){return L.s(n+".uv.rotation")||L.s("all.uv.rotation")},getFaceLight:function(N,k){var P=N.s(k+".light");return P==h?N.s("all.light"):P},getFaceVisible:function($,H){var d=$.s(H+".visible");return d==h?$.s("all.visible"):d},getFaceOpacity:function(g,D){var q=g.s(D+".opacity");return q==h?g.s("all.opacity"):q},getFaceTransparent:function(e,y){var j=e.s(y+".transparent");return j==h?e.s("all.transparent"):j},getFaceReverseColor:function(Z,N){return Z.s(N+".reverse.color")||Z.s("all.reverse.color")},getFaceReverseFlip:function(A,s){var m=A.s(s+".reverse.flip");return m==h?A.s("all.reverse.flip"):m},getFaceReverseCull:function(q,d){var X=q.s(d+".reverse.cull");return X==h?q.s("all.reverse.cull"):X},getTextureMap:function(){return this._2O},deleteTexture:function(U){var K=this;if(K._2O){var O=K._2O[U];O&&(delete K._2O[U],K.getGL().deleteTexture(O))}},renderPickScene:function(){var f=this.getGL();this.syncRenderState(),this._picking=f._picking=!0,this.renderScene(),this._picking=f._picking=!1},invalidateCachedTexture:function($){var C=this.getData3dUI($);C.invalidateCachedTexture(this.getGL()),this.invalidateData($)},invalidateShape3dCachedImage:function(V){this.invalidateCachedTexture(V)},invalidateCachedGeometry:function(g){var y=this.getData3dUI(g);y.invalidateCachedGeometry(),this.invalidateData(g)},isInteractive:function($){return $.s("interactive")},getTexture:function(K,j,Q){if(!K)return h;var F=this,O=F.getGL(),e=F._2O[K];if(!e){var A=vo(K),Z={};if(!A)return O._emptyTexture;if(j){Z.mipmapMaxLevel=j.s("texture.mipmap.max");var t=j.s("texture.wrap");Z.clampToEdge="clampToEdge"===t?!0:"repeat"===t?!1:B}if(A.uuid||(A.uuid=R.Math.generateUUID()),A.tagName){if(A.dynamic)return Zl(O,A,F._1O,Z);e=F._2O[K]=Zl(O,A,B,Z)}else{var Y,$=j&&(j.s("texture.cache")||j.s("shape3d.image.cache")||A.textureCache),k=F.isVRPresenting();if(k&&(j._textureUpdateFrame===O._renderInfo.frame?$=!0:j._textureUpdateFrame=O._renderInfo.frame),$&&(Y=F.getData3dUI(j),e=Y.getCachedTexture(Q),e&&Y.interactiveInfo&&e.interactiveInfo&&(Y.interactiveInfo[e.interactiveInfo.key]=e.interactiveInfo.info)),!e){var U=O._renderInfo.textureCache;if($){if(U.time>l.graph3dMaxVectorCacheTime)return F.redraw(),O._emptyTexture;if(!On(A,j))return O._emptyTexture}var G;j&&(1!==j.s("texture.scale")?G=j.s("texture.scale"):1!==j.s("shape3d.texture.scale")&&(G=j.s("shape3d.texture.scale"))),G||(G=1);var T=j&&(j.s("fixSizeOnScreen")||j.s("shape3d.fixSizeOnScreen")),y=T?O.NEAREST:O.LINEAR;T?"number"==typeof T&&(G*=0>T?1:T):j&&(j.s("vector.dynamic")||j.s("shape3d.vector.dynamic"))&&(Y||(Y=F.getData3dUI(j)),T=Y.getVectorDynamicSize());var x,L,g,r=j&&j.s("shape3d");"billboard"===r?g=j.getTall()/j.getWidth():"plane"===r&&(g=j.getHeight()/j.getWidth());var X=sm(A,j);if(T){var N;N=$?F._devicePixelRatio||Tp:F.getDevicePixelRatio(),x=T[0]>0?T[0]*N:G*X*N,L=T[1]>0?T[1]*N:G*(g?wq(A,j,F,Math.min(4096,X*g)):wq(A,j))*N}else x=G*X,L=G*(g?wq(A,j,F,Math.min(4096,X*g)):wq(A,j));if(x>=1&&L>=1){var d=0;($||k)&&(d=Date.now());var H=F._glCapabilities.maxTextureSize;x=Math.min(x,H),L=Math.min(L,H);var J=ac(x,L);if(!Y&&j&&(Y=F.getData3dUI(j)),Y&&Y.interactiveInfo){var n=K;"object"==typeof n&&(n=n.uuid||(n.uuid=R.Math.generateUUID()));var S=Y.interactiveInfo[n]={};J.interactiveInfo=S.bodyInfo={compInfos:[],matrix:new lj,rect:{x:0,y:0,width:x,height:L}}}If(J,A,0,0,x,L,j,F),J.interactiveInfo&&(J.interactiveInfo=null),J.restore(),U.count++,U.pixels+=x*L,j?(Z.minFilter=Yo(j.s("texture.filter.min")||j.s("texture.filter"))||y,Z.magFilter=Yo(j.s("texture.filter.mag")||j.s("texture.filter"))||y):Z.minFilter=Z.magFilter=y,$||k?(e=Zl(O,nl,null,Z),Y.setCachedTexture(e,Q),U.time+=Date.now()-d,S&&(e.interactiveInfo={key:n,info:S}),nl=null):e=Zl(O,nl,F._1O,Z)}}}}return e},redraw:function(){this.iv()},validateImpl:function(){var R=this;if(R._lightChanged){R._lightChanged=!1;var j=[],X=[],g=[];R.dm().each(function(s){if(pn(s)){var i=s.s("light.type");
i===Fh?j.push(s):i===zf?X.push(s):i===gj&&g.push(s)}}),(j.length!==R._59O.length||X.length!==R._spots.length||g.length!==R._dirs.length)&&ce(R),R._59O=j,R._spots=X,R._dirs=g}R._42(),R._1o.iv()},getRenderInfo:function(){var w=this.getGL();return w?w._renderInfo:void 0},getDebugTip:function(){var F=this,D=F.getRenderInfo();if(D){var E=F.getGL()._validBufCount||0,X="Draw Calls: "+D.calls+"<br/>"+"Vertices: "+D.vertices+"<br/>"+"Faces: "+D.faces+"<br/>"+"Lines: "+D.lines+"<br/>"+(D.points?"Points: "+D.points+"<br/>":"")+"Buffers: "+E+"<br/>"+"Cache Models: "+w.keys(dm).length+"<br/>"+"Shape3d Models: "+w.keys(Xm).length;if(F.isVRPresenting()&&(X+="<br/>VR fps: "+F.vr.getFps()),D.textureCache){var n=D.textureCache.count;if(X+="<br/>2D Dynamic Textures: "+D.textureCache.count,n>0){var q,L=D.textureCache.pixels;q=L>1e6?Math.round(L/1e6)+"M":L>1e3?Math.round(L/1e3)+"K":Math.round(L),X+="<br/>2D Dynamic pixels: "+q}}return X}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var o=new R.Math.Box3,U=new R.Math.Matrix4;return function(x){var z=x;if(z instanceof R.Data&&(z=this.getData3dUI(z)),!z.mat)return!0;var T=z.getBoundingBox();o.copy(T).applyMatrix4(U.fromArray(z.mat));var Z=this.getFrustum();return Z.intersectsBox(o)}}(),updateScene:function(){var a=this;a._81O=h,a.overlappingBox.clear();var y=a._40Q;y.init();var f=a.getGL(),c=a.dm();if(c.isHierarchicalRendering())c.eachByHierarchical(function(O){var T=a.getData3dUI(O);T&&T.update(a,f,y)});else{var S,k,W,C=c.getDatas().getArray(),E=C.length;for(S=0;E>S;S++)k=C[S],W=a.getData3dUI(k),W&&W.update(a,f,y)}y.onUpdated()},_pushFrameRenderOptions:function(E){this._frameRenderOptionStack.push(this._currentFrameRenderOptions),this._currentFrameRenderOptions=E},_popFrameRenderOptions:function(){this._currentFrameRenderOptions=this._frameRenderOptionStack.pop()},_getFrameRenderOptions:function(o){var B=this._currentFrameRenderOptions;return B&&B[o]},renderScene:function(G){function U(Z,$){m.setGLState(Z,$),m.setUniforms(Z),m.renderState.attribs.disable(),H=J.directUniforms(),Q=J.directAttribs(),Q.disable()}function P(s){for(;n>I;I++){var b=Y[I];if(!t||!b.ignoreInPick){if(b.priority>=s)break;(!F._43Q[F._44Q=b.id]||uj[th.length])&&(b.render(g,F,m),U())}}}var F=this;F._pushFrameRenderOptions(G),F.shadowMap.render(),F._44Q=-1;var Q,m=F._frameState,J=m.renderState,N=J.glState,H=J.directUniforms(),g=F.getGL(),W=F._prg;F._projectMatrix=ed(F),yr(F,F._7O),F._viewMatrix=Dl(F._7O),Mh(F._projScreenMatrix=yo(),F._projectMatrix,F._viewMatrix),m.syncEnv(this._picking?this.pickColorMap:B),J.useProgram(W),U(!1,!0),g.clear(g.DEPTH_BUFFER_BIT);var t=F._picking,Y=this._41Q,I=0,n=Y.length;if(P(l.cameraPriority.skybox),t){var K=N.color.clear.slice(0);Zj(g,[0,0,0,0])}else Zj(g,[0,0,0,0]),N.blend.enabled=!1,N.depth.enabled=!1,N.depth.mask=!1,F.drawSky(g,W),F.drawReflectors(g)&&(F._projectMatrix=ed(F),yr(F,F._7O),F._viewMatrix=Dl(F._7O),m.syncEnv(),U()),N.blend.enabled=!1,N.depth.enabled=!0,N.depth.mask=!0,H.uTransparent=!1,F._getFrameRenderOptions("renderGrid")!==!1&&F._31O._42(g,W);if(!g.textureBatch||uj[(ONE_FRAME_TIME-6)/2]){!t&&F.shadowMap.enable&&F.shadowMap.createShadow(H);for(var w=0,E=Ve.length;E>w;w++){var _=Ve[w],e=sc[_];if(!e.ignore){var f=e.priority;P(f),this.renderLayer(_)}}P(l.cameraPriority.infinity),N.depth.enabled=!1,H.uTransparent=!1,H.shadowReceive=!1,t?F.drawFilter||F._30O._42(g,W):(F._highlightHelper._42(g,W),this._renderAxisAndEditHelper(F._getFrameRenderOptions("renderAxis")!==!1,F._getFrameRenderOptions("renderEdit")!==!1),N.blend.enabled=!1,N.depth.mask=!0),N.depth.enabled=!0,t&&Zj(g,K),cj(g,h),Yb(g,h),F._44Q=-1,F._popFrameRenderOptions(null)}},_renderAxisAndEditHelper:function(z,i){if(z||i){var S=this,f=S.getGL(),B=S._prg,m=S._frameState,U=m.renderState,u=U.glState,M=U.directUniforms();m.renderState.attribs.disable(),u.depth.enabled=!1,M.uTransparent=!1,M.shadowReceive=!1,u.blend.enabled=!1,u.depth.mask=!0,M.uPick=S._picking,z&&S._32O._42(f,B),i&&S._30O._42(f,B),cj(f,h),Yb(f,h)}},renderLayers:function(E,F){F&&(E=Tl(E));for(var h=0,v=E.length;v>h;h++)this.renderLayer(E[h])},addRenderLayerListener:function(M,R,O){var K=this;K._renderLayerNotifier||(K._renderLayerNotifier=new $m),K._renderLayerNotifier.add(M,R,O)},removeRenderLayerListener:function(L,h){this._renderLayerNotifier&&this._renderLayerNotifier.remove(L,h)},fireRenderLayerEvent:function(W,t){var u=this._renderLayerNotifier;u&&u.fire({layer:W,phase:t})},renderLayer:function(P){var m=this,$=m._picking,Z=m._40Q.get(P);if(Z){m.fireRenderLayerEvent(P,"prepare");var p=m.getGL(),E=sc[P],W=m._frameState,j=W.renderState,o=j.glState,l=j.directUniforms();!$&&m.isSortable()&&Z.sort(m._sortFunc,m._projScreenMatrix);var x,J,G,K=Z.opaque,I=Z.transparent,t=Z.batchModelMap,s=Z.polylineModelMap,k=Z.wireframeModelMap,p=m.getGL(),q=m._prg;$||(o.blend.enabled=!1,o.depth.enabled=!0,o.depth.mask=!0),l.uTransparent=!1,E.clearDepth!==!1&&p.clear(p.DEPTH_BUFFER_BIT);var g=this.drawFilter;if(g)for(G=K,x=0,J=G.length;J>x;x++)g(G[x].data)!==!0&&G[x].ui._42(p,q,Y);else{for(G=K,x=0,J=G.length;J>x;x++)G[x].ui._42(p,q,Y);if($)for(G=I,x=0,J=G.length;J>x;x++)G[x].ui._46Q(p);Ei(m,t),rd(m,s),rd(m,k)}if($||(o.blend.enabled=!0,o.depth.mask=!1),m._45Q=l.uTransparent=!0,g)for(G=I,x=0,J=G.length;J>x;x++)g(G[x].data)!==!0&&G[x].ui._42(p,q,X);else{for(G=I,x=0,J=G.length;J>x;x++)G[x].ui._42(p,q,X);Ei(m,t,null,!0),rd(m,s,null,!0),rd(m,k,null,!0)}m._45Q=null,m.fireRenderLayerEvent(P,"post")}},_42:function(S,V){var D=this;if(!D._35O&&(!Tb||uj(Tb))){var l=D.getWidth(),B=D.getHeight();if(l&&B){var O=D.getGL();if(O){var c,L=D._canvas;if(S?c=!0:S=D.getDevicePixelRatio(),!D._picking&&(c||l!==L.clientWidth||B!==L.clientHeight)){qh(L,l,B,S);var Y=S;l&&Math.abs(O.drawingBufferWidth-l*S)>1&&(Y=Math.min(Y,O.drawingBufferWidth/l)),B&&Math.abs(O.drawingBufferHeight-B*S)>1&&(Y=Math.min(Y,O.drawingBufferHeight/B)),Y!==S&&(D.setDevicePixelRatio(S=Y),qh(L,l,B,S)),D._18Q=null}O.clear(O.COLOR_BUFFER_BIT);var R=O._renderInfo;R.calls=0,R.vertices=0,R.faces=0,R.lines=0,R.points=0,R.textureCache={time:0,count:0,pixels:0},R.frame=++D._frameId,R.cacheTimeCost=0,R.reflectDepth=0,l*=S,B*=S,this.syncRenderState();do{if(D.isVREnabled()&&D.vr.render(O,l,B,V))break;if(D.updateScene(),D._postProcessing.render(O,l,B,V))break;D.setViewport(O,0,0,l,B),D.renderScene(V)}while(!1);D._33Q=!1,D.countFrame(),D._doBufferGC(O)}}}},syncRenderState:function(){var z,q;(z=this._frameState)&&(q=z.renderState)&&q.syncLoss()},drawReflectors:function(l){l._renderInfo.reflectDepth++;var t,M,G,D=this,u=D._dataModel.getReflectors(),v=!1;for(t in u)M=u[t],D.isVisible(M)&&(G=D.getData3dUI(M),G&&G.drawReflector(l)&&(v=!0));return l._renderInfo.reflectDepth--,v},isReflecting:function(r){return r._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(O,o){return this._postProcessing.enableModule(O,o)},getPostProcessingModule:function(y){return this._postProcessing.getModule(y)},getPostProcessingValue:function(T,M){var e=this._postProcessing.getModule(T);return e?e[M]:B},setPostProcessingValue:function(C,J,q){var e=this.getPostProcessingValue(C,J),c=this._postProcessing.getModule(C);c&&e!==q&&("enable"===J?this.enablePostProcessing(C,q):c[J]=q,this.firePropertyChange("postProcessing."+C+"."+J,e,q))},setViewport:function(H,$,r,g,L){this._viewport=[$,r,g,L],Ig.for(H).directState().viewport=this._viewport},getRenderState:function(){return Ig.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(E){this._bufferGCInterval=E},_doBufferGC:function(A,K){var H,M,D=A._bufPool,E=0,v=0,W=A._renderInfo.frame,j=this._bufferGCInterval||10;for(H in D)E++,M=D[H],M&&(K||W-M._fid>j?(A.deleteBuffer(M._buf),M._buf=null,D[H]=null):v++);if(E/2>v&&E>128){var V={};for(H in D)D[H]&&(V[H]=D[H]);A._bufPool=V}A._validBufCount=v},_swapLineMap:function(){var d=this;bf=d._polylineModelMap,d._polylineModelMap=d._polylineModelMapSwap,d._polylineModelMapSwap=bf,bf=d._wireframeModelMap,d._wireframeModelMap=d._wireframeModelMapSwap,d._wireframeModelMapSwap=bf,bf=d._polylineIndexMap,d._polylineIndexMap=d._polylineIndexMapSwap,d._polylineIndexMapSwap=bf,bf=d._wireframeIndexMap,d._wireframeIndexMap=d._wireframeIndexMapSwap,d._wireframeIndexMapSwap=bf},_updateSkybox:function(w){if(this._skybox&&w){var E=w.property,M=!1,J=this._skybox;if("eye"===E||"forceUpdate"===E){var W=this._eye;J.p3(W[0],W[1],W[2]),M=!0}if("near"===E||"far"===E||"forceUpdate"===E){var e=J.getFinalScale3d(),r=Math.sqrt(3),f=[],F=[];e.forEach(function(U,x){f[x]=U/2,F[x]=f[x]*r});var A=this._near,o=this._far,I=1;if(f[0]<=A||f[1]<=A||f[2]<=A){var z=Math.tan(this.getFovy()/2)*A,p=this.getAspect()*z,x=Math.sqrt(p*p+z*z+A*A),q=Math.min(f[0],f[1],f[2]);I=x/q}else if(F[0]>=o||F[1]>=o||F[2]>=o){var x=o*o/(A+o),Q=Math.max(F[0],F[1],F[2]);I=x/Q}if(1!==I){var T=J.getScale3d().map(function(A,K){return A*I*e[K]});J.s3(T),J.setScale3d(1,1,1),M=!0}}M&&this.invalidateData(J)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(G){return this.setSkybox(G)},getSkybox:function(){return this._skybox},setSkybox:function(s){var b=this._skybox;return b===s?(s&&this._updateSkybox({property:"forceUpdate"}),void 0):(b&&(this._skyboxStyleMap&&b.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&b.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&b.p3(this._skyboxP3),this._skyboxP3=null),this._skybox=s,this.ump(this._updateSkybox,this),s&&(s.dm()&&s.dm().remove(s),this._skyboxStyleMap=R.Default.clone(s.getStyleMap()),this._skyboxAnchor3d=s.getAnchor3d(),s.setAnchor3d(.5,.5,.5),this._skyboxP3=s.p3().slice(0),s.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})),this.fp("skybox",b,s),void 0)},drawSky:function(e,L){var W=this,f=W._skybox;if(f){var Y=Ig.for(e).directUniforms(),t=W._headlightIntensity,C=vg(W._headlightColor),L=W._prg;1!==t&&(C=[C[0]*t,C[1]*t,C[2]*t]),Y.uHeadlightColor=[C[0],C[1],C[2],1];var c=W.getData3dUI(f);if(c){var v=W.isOrtho(),E=v||this._computedProjectMatrix;if(E){var T=W._projectMatrix;v&&(W._ortho=!1),Y.uPMatrix=W._projectMatrix=ed(W,!0)}var z=f.p3(),g=this._eye;(z[0]!==g[0]||z[1]!==g[1]||z[2]!==g[2])&&(f._position.x=g[0],f._54O=g[1],f._position.y=g[2]),c.validate(),c._42(e,L,U),E&&(v&&(W._ortho=!0),Y.uPMatrix=W._projectMatrix=T)}e.clear(e.DEPTH_BUFFER_BIT),Y.uHeadlightColor=[C[0],C[1],C[2],W._headlightDisabled?1:0]}},getLogicalPoint:function(H){return ug(H,this._canvas)},isRectOverlapping:function(h){var w=this.getData3dUI(h);return w._rectOverlapping},getHitFaceInfo:function(i){i.target&&(i=this.lp(i));var V=this.getDataInfoAt(i);if(V){var I=this.intersectObject(i,V.data);if(I)return{data:V.data,face:I.part}}return h},unproject:function(D,L){var n=this,h=n.getWidth(),M=n.getHeight(),S=D.target?n.lp(D):D,w=S.x-h/2,x=S.y-M/2,N=2*(w/h),T=2*(-1*x/M);L=L||0;var V=yo(),H=ed(n),R=yr(n);Mh(V,H,R),nb(V);var I=Qq([N,T,L,1],V);return[I[0]/I[3],I[1]/I[3],I[2]/I[3]]},getDataAt:function(X){var u=this.getDataInfoAt(X);return u?u.data:h},getDataInfoAt:function(o,Z,H){return o.target&&(o=this.lp(o)),this._1o.get(Qh(o.x,o.y,Z),!0,H)},getDatasInRect:function(Y,i){return this._1o.get(Y,!1,i)},setEditable:function(k){var C=this,W=C._editable;C._editable=k,this.fp(Vg,W,k)},isEditable:function(b){var M=this;return b?M._editable?Tn(b)?b.s("3d.editable")?M._editableFunc?M._editableFunc(b):!0:!1:!1:!1:M._editable},isSelectable:function(f){return f.s("3d.selectable")&&this.sm().isSelectable(f)},isMovable:function(Y){var h=this;return Jr(Y)&&Y.getStyle(Vd)!==ki?!1:Y.s("3d.movable")?h._movableFunc?h._movableFunc(Y):!0:!1},isSizeEditable:function(_){return Tn(_)?this._sizeEditableFunc?this._sizeEditableFunc(_):!0:!1},isRotationEditable:function(F){return Tn(F)&&F.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(F):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function($){this.setZoom(rq,$)},zoomOut:function(t){this.setZoom(1/rq,t)},setZoom:function(){var Y=new qp,v=new qp,A=new qp,C=new qp;return function(X,n){if(1!==X){var _=this;_._14o&&_._14o.stop(!0);var M,k=1/X;Y.copy(_.getCenter()),v.copy(_.getEye());var W=_._ortho;if(W){if(M=_._orthoWidth,M<_._moveStep&&X>1)return}else if(Y.distanceTo(v)<_._moveStep&&1>k)return;var O=!1;if(_._zoomToCenter===!1&&_._lastZoomLP&&(A.copy(v).sub(Y).normalize(),_._81O=null,C.copy(_.getHitPosition(_._lastZoomLP,Y.toArray(),A.toArray())),O=!0,_._lastZoomHit=C),n=Mg(n))return n.action=function(B){_.fi({kind:_._zooming?"betweenZoom":"beginZoom"}),_._zooming=1;var q=(k-1)*B+1;if(W){_.setOrthoWidth(M*q);var e=_.getOrthoWidth()/_.getAspect(),f=e/2/qc(_.getFovy()/2);A.copy(v).sub(Y).setLength(f).add(Y),_.setEye(v.toArray())}O?(_.setEye(A.lerpVectors(C,v,q).toArray()),_.setCenter(A.lerpVectors(C,Y,q).toArray())):W||_.setEye(A.lerpVectors(Y,v,q).toArray())},n._37o=function(){delete _._14o,delete _._zooming,_.fi({kind:"endZoom"}),_.onZoomEnded()},_._14o=ll(n);if(W){_.setOrthoWidth(M*k);var r=_.getOrthoWidth()/_.getAspect(),e=r/2/qc(_.getFovy()/2);A.copy(v).sub(Y).setLength(e).add(Y),_.setEye(A.toArray())}O?(_.setEye(A.lerpVectors(C,v,k).toArray()),_.setCenter(A.lerpVectors(C,Y,k).toArray())):W||_.setEye(A.lerpVectors(Y,v,k).toArray())}}}(),setOrthoZoom:function($,t){return this.setZoom($,t)},getPositionInfo:function(w){var i=this,a=i._eye,g=i._center,I=i.getAspect(),B=w?fe(il(g,a,!0),il(w,a)):Jf(a,g);if(i._ortho){var _=i._orthoWidth;return{length:B,height:_/I,width:_}}var h=2*qc(i._fovy/2)*B;return{length:B,height:h,width:h*I}},getCenterInfo:function(){var L=this;return L._81O||(L._81O=L.getPositionInfo()),lg(L._81O)},rotate:function(A,X,O,e){var c=this;if(A||X){e==h&&(e=c._firstPersonMode),c._88O&&c._88O.stop(!0);var Y=c._center,H=c._eye,w=c.getCenterInfo().length,y=e?Y:H,Z=e?H:Y,T=il(y,Z),k=Mj(T[0],T[2]),f=Mj(m(T[0]*T[0]+T[2]*T[2]),T[1]),E=e?Xf:Bl;return e&&(X=-X),(O=Mg(O))?(O.action=function(u){c.fi({kind:c._rotating?"betweenRotate":"beginRotate"}),c._rotating=1;var G=k+A*u,H=f+X*u;H=e?S-yg(c,S-H):yg(c,H),T[0]=w*a(H)*a(G),T[1]=w*d(H),T[2]=w*a(H)*d(G),y[0]=Z[0]+T[0],y[1]=Z[1]+T[1],y[2]=Z[2]+T[2],c.fp(E,h,y)},O._37o=function(){delete c._88O,delete c._rotating,c.fi({kind:"endRotate"}),c.onRotateEnded()},c._88O=ll(O)):(k+=A,f+=X,f=e?S-yg(c,S-f):yg(c,f),T[0]=w*a(f)*a(k),T[1]=w*d(f),T[2]=w*a(f)*d(k),y[0]=Z[0]+T[0],y[1]=Z[1]+T[1],y[2]=Z[2]+T[2],c.fp(E,h,y),void 0)}},pan:function(z,F,d,g){if(z||F){var c=this;g==h&&(g=c._firstPersonMode),c._89O&&c._89O.stop(!0);var w=yr(c),x=[w[0]*z,w[4]*z,w[8]*z],E=[w[1]*F,w[5]*F,w[9]*F],O=x[0]+E[0],e=x[1]+E[1],f=x[2]+E[2],n=c._center,M=c._eye;if(g){var P=vd(c.getBoundaries(),M[0],M[2],M[0]+O,M[2]+f,m(O*O+f*f));O=P[0],f=P[1]}if(d=Mg(d)){var u=lg(M),W=lg(n);return d.action=function(w){c.fi({kind:c._panning?"betweenPan":"beginPan"}),c._panning=1,n[0]=W[0]+O*w,n[1]=W[1]+e*w,n[2]=W[2]+f*w,M[0]=u[0]+O*w,M[1]=u[1]+e*w,M[2]=u[2]+f*w,c.fp(Bl,h,M),c.fp(Xf,h,n)},d._37o=function(){delete c._89O,delete c._panning,c.fi({kind:"endPan"}),c.onPanEnded()},c._89O=ll(d)}n[0]+=O,n[1]+=e,n[2]+=f,M[0]+=O,M[1]+=e,M[2]+=f,c.fp(Bl,h,M),c.fp(Xf,h,n)}},walk:function(b,m,Q){if(b){var l=this;Q==h&&(Q=l._firstPersonMode),l._90O&&l._90O.stop(!0);var B=l._center,f=l._eye,K=il(B,f,!0);if(Q){var Y=vd(l.getBoundaries(),f[0],f[2],f[0]+K[0]*b,f[2]+K[2]*b,$(b));if(b=Jf(Y),!b)return;K=[Y[0]/b,0,Y[1]/b]}if(m=Mg(m)){var i=lg(f),s=lg(B);return m.action=function(q){l.fi({kind:l._walking?"betweenWalk":"beginWalk"}),l._walking=1;var R=b*q;f[0]=i[0]+K[0]*R,f[1]=i[1]+K[1]*R,f[2]=i[2]+K[2]*R,B[0]=s[0]+K[0]*R,B[1]=s[1]+K[1]*R,B[2]=s[2]+K[2]*R,l.fp(Bl,h,f),l.fp(Xf,h,B)},m._37o=function(){delete l._90O,delete l._walking,l.fi({kind:"endWalk"}),l.onWalkEnded()},l._90O=ll(m)}f[0]+=K[0]*b,f[1]+=K[1]*b,f[2]+=K[2]*b,B[0]+=K[0]*b,B[1]+=K[1]*b,B[2]+=K[2]*b,l.fp(Bl,h,f),l.fp(Xf,h,B)}},handleScroll:function(U,o){jr(U);var W=this,b=W._moveStep,x=W.getDataInfoAt(U);if(x){var M=x.data;if(M&&W.isInteractive(M)){var u=W.intersectObject(U,M);if(u){var H=u.part,e=vo(M.s(H+".image")||M.s("shape3d."+H+".image")||M.s("all.image")||M.s("shape3d.image"));if(e&&pk(e.scrollable,M,W))return}}}return W.isFirstPersonMode()?(W.isPannable()&&W.pan(0,o>0?b:-b),void 0):(W.isZoomable()&&(W._lastZoomLP=W.lp(U),W.setZoom(0>o?1/im:im),W._lastZoomLP=W._lastZoomHit=null),void 0)},handlePinch:function(j,N){if(this.isZoomable()){if(Math.abs(j-N)<l.pinchZoomThreshold)return;this.setZoom(N>j?1/jg:jg)}},reset:function(v){this.setUp(l.graph3dViewUp),this.moveCamera(l.graph3dViewEye,l.graph3dViewCenter,v)},moveSelection:function(J,x,v){var a=this;a.dm().beginTransaction(),Wg(this.sm().toSelection(this.isMovable,this),J,x,v),a.dm().endTransaction()},getMoveMode:function(L,t){var f=t.s("3d.move.mode");if(f)return f;var g="88",D="89",S="90";return sh(L)||Mk[g]&&Mk[D]&&Mk[S]?"xyz":Mk[g]&&Mk[D]?"xy":Mk[g]&&Mk[S]?"xz":Mk[D]&&Mk[S]?"yz":Mk[g]?"x":Mk[D]?"y":Mk[S]?"z":"xz"},handleTick:function(){var s=this,J=!1,o=s._moveStep,H=o,R=!1,w=!0,t=s._rotateStep*(w?-1:1);if(s.isWalkable()||(H=0),s.isPannable()||(o=0),s.isRotatable()||(t=0),s._32Q){var q=(Yl()-s._32Q)/50;H*=q,o*=q,t*=q}s._31Q&&(rj(s._31Q),delete s._31Q,delete s._32Q),Lg()&&(J=!0,s.pan(-o,0,R,w)),zl()&&(J=!0,s.pan(o,0,R,w)),En()&&(J=!0,sh()?s.pan(0,o,R,w):s.walk(H,R,w)),Ep()&&(J=!0,sh()?s.pan(0,-o,R,w):s.walk(-H,R,w)),bq()&&(J=!0,s.rotate(-t,0,R,w)),jh()&&(J=!0,s.rotate(t,0,R,w)),Gh()&&(J=!0,s.rotate(0,-t/2,R,w)),di()&&(J=!0,s.rotate(0,t/2,R,w)),J&&(s._32Q=Yl(),s._31Q=Qe(s.handleTick,s))},handleKeyDown:function(t){var r=this;!Nq(t)&&Tq[t.keyCode]?r.handleTick():id(t)?r.selectAll():Ej(t)?r.handleDelete(t):fr(t)&&this.isResettable()&&r.reset()},checkDoubleClickOnNote:function(R,Y,q){var N=this;if(q===Am){if(Y.s("note.toggleable"))return Y.s(np,!Y.s(np)),N.fi({kind:"toggleNote",event:R,data:Y,part:q}),!0}else if(q===Um&&Y.s("note2.toggleable"))return Y.s(Af,!Y.s(Af)),N.fi({kind:"toggleNote2",event:R,data:Y,part:q}),!0;return!1},checkDoubleClickOnRotation:function(O,J,Z){return Z===Pn?(J.setRotationX(0),!0):Z===Ag?(J.setRotationY(0),!0):Z===vs?(J.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(h){var z=this;if(z.isOrtho())return z.getWidth()/z.getOrthoWidth();var H=z.getCenter(),o=z.getHeight(),U=z.getEye(),F=[H[0]-U[0],H[1]-U[1],H[2]-U[2]],P=[h[0]-U[0],h[1]-U[1],h[2]-U[2]],s=Math.sqrt(F[0]*F[0]+F[1]*F[1]+F[2]*F[2]),Z=1/Math.tan(z.getFovy()/2);return o*s*Z/(P[0]*F[0]+P[1]*F[1]+P[2]*F[2])},inViewSpace:function(T){var s,x=this,V=x._transformPointToViewSpace(T),H=x.getAspect(),j=x.getNear(),y=x.getFar();return-V[2]<j||-V[2]>y?!1:x.isOrtho()?(s=x.getOrthoWidth()/2,Math.abs(V[0])<=s&&Math.abs(V[1]*H)<=s):(s=Math.sqrt(V[0]*V[0]+V[1]*V[1]+V[2]*V[2])*Math.tan(x.getFovy()/2),Math.abs(V[1]<=s)&&Math.abs(V[0])<=s*H)},getPVMatrix:function(){var a,r=this;return(a=r._18Q)||(a=ed(r),r._18Q=Mh(a,a,yr(r)),r._18Q._wh=r.getWidth()/2/r.getHeight()),a},getFrustum:function(){var o=new Jb,_=new Ck,O=new Array(16);return function(){for(var i=this.getPVMatrix(),r=!1,W=0;16>W;W++)i[W]!==O[W]&&(r=!0,O[W]=i[W]);return r&&_.setFromMatrix(o.fromArray(i)),_}}(),toViewPosition:function(h){var Q=this,C=Q.getWidth()/2,J=Q.getHeight()/2,E=Q.getPVMatrix();return h=Qq([h[0],h[1],h[2],1],E),{x:C+C*h[0]/h[3],y:J-J*h[1]/h[3],z:h[2]/h[3]}},getHitPosition:function(F,r,c){var N=this,D=N.getWidth(),A=N.getHeight(),f=F.target?N.lp(F):F,l=f.x-D/2,p=f.y-A/2,R=N.getCenterInfo(),M=yr(N);r=r?r:[0,0,0],c=c?c:[0,1,0],l=l/D*R.width,p=-1*p/A*R.height;var x=[M[0]*l,M[4]*l,M[8]*l],G=[M[1]*p,M[5]*p,M[9]*p],n=[x[0]+G[0],x[1]+G[1],x[2]+G[2]],$=N.getCenter(),B=Wb(N,r,c,[n[0]+$[0],n[1]+$[1],n[2]+$[2]]);return B?B:[0,0,0]},intersectObject:function(R,F){return this._raycaster.intersectObject(R,F)},intersectObjects:function(K,L,v){return this._raycaster.intersectObjects(K,L,v)},getLineLength:function(d){this.validate();var g=this.getData3dUI(d);if(g&&g.getCache){var C=g.getCache();if(C)return C[C.length-1].length}return 0},getLineOffset:function(q,G){var S=this.getData3dUI(q);if(S&&S.getCache){var z=S.getCache();if(z){var x=Sc(z,G);if(!q.r3)return x;var M=q.r3();if(0===M[0]&&0===M[1]&&0===M[2])return x;var Z=new qp(q.p3()),O=new qp(x.point).sub(Z),c=new qp(x.tangent).add(O),i=(new wh).setFromEuler(new Lo(M,q.getRotationMode(),!0));return O.applyQuaternion(i),c.applyQuaternion(i),{point:O.add(Z),tangent:c.sub(O).normalize()}}}return h},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(A,T,H){var F=this,h=F.getEye();h=[h[0],h[1],h[2]];var d=F.getCenter();if(d=[d[0],d[1],d[2]],A||(A=h),T||(T=d),F._flyAnim&&F._flyAnim.stop(!0),H=Mg(H),!H)return F.setEye(A[0],A[1],A[2]),F.setCenter(T[0],T[1],T[2]),delete F._flyAnim,!0;var j=[A[0]-h[0],A[1]-h[1],A[2]-h[2]],n=[T[0]-d[0],T[1]-d[1],T[2]-d[2]];return H.action=function(L){F.setCenter(d[0]+n[0]*L,d[1]+n[1]*L,d[2]+n[2]*L),F.setEye(h[0]+j[0]*L,h[1]+j[1]*L,h[2]+j[2]*L)},H._37o=function(){delete F._flyAnim},F._flyAnim=ll(H)},flyTo:function(){function l(V,H,i){if(i instanceof R.Node){v.fromArray(Vl(i,H.getMat(i)));var o=i.getAnchor3d();V.push((new qp).set(0-o.x,0-o.y,0-o.z).applyMatrix4(v)),V.push((new qp).set(0-o.x,0-o.y,1-o.z).applyMatrix4(v)),V.push((new qp).set(0-o.x,1-o.y,0-o.z).applyMatrix4(v)),V.push((new qp).set(0-o.x,1-o.y,1-o.z).applyMatrix4(v)),V.push((new qp).set(1-o.x,0-o.y,0-o.z).applyMatrix4(v)),V.push((new qp).set(1-o.x,0-o.y,1-o.z).applyMatrix4(v)),V.push((new qp).set(1-o.x,1-o.y,0-o.z).applyMatrix4(v)),V.push((new qp).set(1-o.x,1-o.y,1-o.z).applyMatrix4(v))}}var G=new qp,e=new qp,q=new qp,u=new qp,v=new Jb,P=new R.Math.Quaternion,K=new Lo,k=new Lb;return function(E,N,h){var z=this;if(h!==B)N={animation:N,ratio:h};else{var t=typeof N;("boolean"===t||"object"===t&&N.duration)&&(N={animation:N})}N=N||{},G.fromArray(z.getEye()),e.fromArray(z.getCenter());var s,L,Y=[],U=N.center,I=N.distance===B;if(U&&q.fromArray(U),E instanceof R.Node)U||q.fromArray(E.p3()),I&&(l(Y,z,E),s=Y.length);else{if(E||(E=z.dm().getDatas()),!E.length)return;if((I||!U)&&(Y=[],E.forEach(function(w){l(Y,z,w)}),s=Y.length,!s))return;U||(k.setFromPoints(Y),q.copy(k.min).add(k.max).multiplyScalar(.5))}if(z.setCenter(q.x,q.y,q.z),u.subVectors(G,e),N.direction||N.worldDirection){!N.worldDirection&&E instanceof R.Node?P.setFromEuler(K.set(E.r3(),E.getRotationMode(),!0)):P.set(0,0,0,1);var M=u.length();u.fromArray(N.worldDirection||N.direction).applyQuaternion(P).setLength(M)}var V=0;if(I){var y,A,D,h=N.ratio||.8,d=N.xRatio||h,W=N.yRatio||h;if(z.isOrtho()){var _=-1/0;for(z._eye[0]=u.x+q.x,z._eye[1]=u.y+q.y,z._eye[2]=u.z+q.z,y=ed(z),Mh(y,y,yr(z)),L=0;s>L;L++)D=Y[L],A=Qq([D.x,D.y,D.z,1],y),_=Math.max(_,Math.max(Math.abs(A[0])/d,Math.abs(A[1])/W));V=z.getOrthoWidth()*_,u.add(q)}else{for(var b,C,r=z.getNear(),J=10;J--;){for(z._eye[0]=u.x+q.x,z._eye[1]=u.y+q.y,z._eye[2]=u.z+q.z,y=ed(z),Mh(y,y,yr(z)),b=!0,C=-1/0,L=0;s>L;L++){if(D=Y[L],A=Qq([D.x,D.y,D.z,1],y),A[3]<r&&J){u.multiplyScalar(2),b=!1;break}C=Math.max(C,Math.max(Math.abs(A[0])/d,Math.abs(A[1])/W)-A[3])}if(b)break}u.setLength(C+u.length()).add(q)}}else u.setLength(N.distance).add(q);z._flyAnim&&z._flyAnim.stop(!0);var w=Mg(N.animation);if(w){z.setEye(G.x,G.y,G.z),z.setCenter(e.x,e.y,e.z);var a=(new qp).subVectors(u,G),x=(new qp).subVectors(q,e);if(V)var H=z.getOrthoWidth();var m=new qp,O=new qp,f=w.action,c=w._37o,T=G.clone(),p=e.clone();return w.action=function(k,s){m.copy(T).addScaledVector(a,k),O.copy(p).addScaledVector(x,k),z.setCenter(O.x,O.y,O.z),z.setEye(m.x,m.y,m.z),V&&z.setOrthoWidth((V-H)*k+H),f&&f(k,s)},w._37o=function(){delete z._flyAnim,c&&c()},{lastEye:G,lastCenter:e,eye:u,center:q,orthoWidth:V,animation:z._flyAnim=ll(w)}}return z.setEye(u.x,u.y,u.z),V&&z.setOrthoWidth(V),delete z._flyAnim,{lastEye:G,lastCenter:e,eye:u,center:q,orthoWidth:V}}}(),getBoundingBox:function(){function Z(M,u,y){n.fromArray(Vl(y,u.getMat(y)));var J=y.getAnchor3d();M.push((new qp).set(0-J.x,0-J.y,0-J.z).applyMatrix4(n)),M.push((new qp).set(0-J.x,0-J.y,1-J.z).applyMatrix4(n)),M.push((new qp).set(0-J.x,1-J.y,0-J.z).applyMatrix4(n)),M.push((new qp).set(0-J.x,1-J.y,1-J.z).applyMatrix4(n)),M.push((new qp).set(1-J.x,0-J.y,0-J.z).applyMatrix4(n)),M.push((new qp).set(1-J.x,0-J.y,1-J.z).applyMatrix4(n)),M.push((new qp).set(1-J.x,1-J.y,0-J.z).applyMatrix4(n)),M.push((new qp).set(1-J.x,1-J.y,1-J.z).applyMatrix4(n))}var n=new Jb;return function(v){if(v=v||this.sm().getSelection(),v instanceof R.Node&&(v=[v]),0===v.length)return h;var K=[];v.forEach(function(I){Tn(I)&&Z(K,this,I)},this);var X=[1/0,1/0,1/0],y=[-1/0,-1/0,-1/0];return K.forEach(function(h){X[0]=Math.min(h.x,X[0]),X[1]=Math.min(h.y,X[1]),X[2]=Math.min(h.z,X[2]),y[0]=Math.max(h.x,y[0]),y[1]=Math.max(h.y,y[1]),y[2]=Math.max(h.z,y[2])}),{min:X,max:y}}}(),setBatchInfo:function(u,I){var o=this._batchInfoMap[u];this._batchInfoMap[u]=I,this.fp("batchInfo",o,I)},getBatchInfo:function(Y){return this._batchInfoMap[Y]||Ze[Y]}}),jq.RenderEnv=function(X){this.gv=X,this.enable=!1},w.defineProperties(jq.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(j){this._debugOn=j,this.capture&&this.capture()}}}),w.assign(jq.RenderEnv.prototype,{renderEnvToCube:function(n,S,d,j){var u=this,B=u.gv;if(!n||!S||!d)return u.enable=!1,u._42=null,void 0;u.enable=!0;var E=Math.floor(j/n*S),c=B.getGL(),U=u._renderTargets;U?U.length<d&&(U=u._renderTargets=U.concat(new Array(d-U.length))):U=u._renderTargets=new Array(d);for(var o=0;d>o;o++)U[o]?U[o].setSize(c,j,E):U[o]=new jq.RenderTarget(B,c,j,E);var l=!1;u.capture=function(){l=!0,B._42(),l=!1};var w=new qp,s=new qp,y=new qp,Q=new qp,A=(new qp).setY(0),C=2*Math.PI/d,e=n/2/Math.tan(Math.PI/d),Y=2*Math.atan2(S/2,e),x=n/S;u._42=function(P,K,L,n){var N=u._debugOn;if(!l&&!N)return!1;w.copy(B.getEye()),Q.copy(B.getCenter()).sub(w);var T=Math.atan2(Q.z,Q.x),t=B.getNear(),j=B.getFovy(),c=B.getAspect();s.copy(B.getCenter());for(var I,r=0;d>r;r++)if(I=U[r],A.setZ(Math.cos(T)).setX(Math.sin(T)).multiplyScalar(e),T-=C,y.addVectors(w,A),B.setNear(e),B.setCenter([y.x,y.y,y.z]),B.setFovy(Y),B.setAspect(x),N){var W=Math.round(K/d);Ig.for(P).glState.viewport=[W*r,0,W,L],n()}else hl(P,I.frame),Ig.for(P).glState.viewport=[0,0,I.width,I.height],P.clear(P.COLOR_BUFFER_BIT),n(),Pj(P),I.assureTexture();return B.setNear(t),B.setCenter([s.x,s.y,s.z]),B.setFovy(j),B.setAspect(c),!0},u.capture()},getTextureInfo:function(m){var l=this._renderTargets;if(!l)return null;var I=this._renderTargets[m];return I?{index:m,texture:I.texture,textureName:I.uuid}:null}}),w.assign(jq.Graph3dView.prototype,{renderEnvToCube:function(X,w,u,L){var z=this;z.envRenderer||(z.envRenderer=new jq.RenderEnv(z)),z.envRenderer.renderEnvToCube(X,w,u,L)}});var Pk=["left","front","right","back","top","bottom"],Ar=jq._RenderList=function(){function c(){C.length=0,w.length=0,$={}}function I(G){var f,N,j,b,i=G.gv,R=G.data,z=G.shapeModel;if(z){var y,K,l,L=R.s("shape3d.transparent")||R.s("points.transparent");for(Nl(z)||(y=pk(z.transparent,R,i),z=[z]),j=0,b=z.length;b>j;j++)l=z[j],K=pk(l.transparent,R,i),K===B&&(K=y),K===B&&(K=L),K?N=!0:f=!0}for(j=0,b=Pk.length;b>j;j++){var Q=G[Pk[j]];Q&&(Q.transparent?N=!0:f=!0)}i.isLabelVisible(R)&&(G.labelInfo&&(R.s(Cn+".transparent")?N=!0:f=!0),G.label2Info&&(R.s(Xq+".transparent")?N=!0:f=!0)),i.isNoteVisible(R)&&(G.noteInfo&&(R.s(Am+".transparent")?N=!0:f=!0),G.note2Info&&(R.s(Um+".transparent")?N=!0:f=!0)),G._38o&&(N=f=!0),N||(f=!0),G._renderParams={opaque:f,transparent:N}}function N(M,D){D&&I(M);var z=M.data,i=z._id;if(!$[i]){$[i]=!0;var c=M._renderParams;c&&c.visible!==!1&&(M={ui:M,data:z,z:0,id:i},c.opaque&&C.push(M),c.transparent&&w.push(M))}}function J(M,Y){if(w.length>1){for(var V,E=0,m=w.length;m>E;E++)V=w[E].data.p3(),w[E].z=$e(V,Y)[2];w.sort(M||L)}}function U(I){I?(xm(D,x,I),xm(E,A,I),xm(P,O,I)):(D=this.batchModelMap={},x=this.batchIndexMap={},E=this.polylineModelMap={},A=this.polylineIndexMap={},P=this.wireframeModelMap={},O=this.wireframeIndexMap={}),this.markBatchInvalid()}function V(P){P?xm(D,x,P):(D=this.batchModelMap={},x=this.batchIndexMap={}),this.markBatchInvalid()}function u(Z){Z?xm(E,A,Z):(E=this.polylineModelMap={},A=this.polylineIndexMap={}),this.markBatchInvalid()}function g(m){m?xm(P,O,m):(P=this.wireframeModelMap={},O=this.wireframeIndexMap={}),this.markBatchInvalid()}function Y(){return this._batchInvalid}function r(){this._batchInvalid=!0}function j(){this._batchInvalid=null}var C=[],w=[],D={},x={},E={},A={},P={},O={},$={};return{opaque:C,transparent:w,init:c,push:N,batchModelMap:D,batchIndexMap:x,polylineModelMap:E,polylineIndexMap:A,wireframeModelMap:P,wireframeIndexMap:O,ivBatch:U,ivModelBatch:V,ivPolylineBatch:u,ivWireframeBatch:g,markBatchInvalid:r,isBatchInvalid:Y,onUpdated:j,sort:J}},Ph=jq._RenderLists=function(){function _(){for(var H in P)P[H].init()}function f(){for(var L in P)P[L].onUpdated()}function X(T,X){T=T||"main";var r=P[T];return!r&&X&&(r=P[T]=new Ar),r}function S(u,o){var L=u.data.getRenderLayer(),t=X(L,!0);t.push(u,o)}function D(q){for(var H in P)q(P[H])}var P={};return{init:_,onUpdated:f,get:X,push:S,each:D,lists:P}},yj=jq.RenderTarget=function(X,s,M,z,H){var G=this;H=H||{},H.samples=Math.min(X._glCapabilities.maxSamples,H.samples&&H.samples>1&&2===X._webGLVersion?H.samples:0),G.options=H,G.uuid=R.Math.generateUUID(),G.gv=X,G.init(X,s,H),H.samples&&!X._glCapabilities._maxSamplesChecked?G.setSize(s,M||1,z||1):G.setSize(s,M,z)};w.assign(jq.RenderTarget.prototype,{bind:function(P){hl(P,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(L){Pj(L),this.options.samples&&(L.bindFramebuffer(L.READ_FRAMEBUFFER,this._MSAAFbo),L.bindFramebuffer(L.DRAW_FRAMEBUFFER,this.frame),L.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,L.COLOR_BUFFER_BIT,L.NEAREST),L.bindFramebuffer(L.READ_FRAMEBUFFER,null),L.bindFramebuffer(L.DRAW_FRAMEBUFFER,null))},init:function(Q,R,T){var D=this,m=D.texture=R.createTexture();R.activeTexture(R.TEXTURE0),Lf(R,m);var f=T.samples,P=f?R.NEAREST:R.LINEAR;R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MIN_FILTER,T.minFilter||P),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MAG_FILTER,T.magFilter||P),Lf(R,null),D.render=R.createRenderbuffer(),D.frame=R.createFramebuffer(),Q._2O[D.uuid]=m},assureTexture:function(){var K=this,l=K.uuid,V=K.gv._2O;V[l]||(V[l]=K.texture)},setSize:function(T,g,A){var Y=this;if(g&&A&&(Y.width!==g||Y.height!==A)){var Q=T.RGBA,Z=T.TEXTURE_2D,U=T.RENDERBUFFER,M=T.FRAMEBUFFER,l=Y.options.samples;if(T.activeTexture(T.TEXTURE0),Lf(T,Y.texture),T.texImage2D(Z,0,Q,g,A,0,Q,T.UNSIGNED_BYTE,h),Np.isPOT(g)&&Np.isPOT(A)&&!Y.options.clampToEdge?(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.REPEAT),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.REPEAT)):(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE)),T.bindRenderbuffer(U,Y.render),l){var s=Y.gv._glCapabilities;if(s._maxSamplesChecked)T.renderbufferStorageMultisample(U,l,T.DEPTH_COMPONENT16,g,A);else{for(T.getError();l>1&&(T.renderbufferStorageMultisample(U,l,T.DEPTH_COMPONENT16,g,A),T.getError());)l=Math.floor(l>>1);1>=l&&(l=0,T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,Y.options.minFilter||T.LINEAR),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,Y.options.magFilter||T.LINEAR),T.renderbufferStorage(U,T.DEPTH_COMPONENT16,g,A)),s._maxSamplesChecked=!0,s.maxSamples=Y.options.samples=l}}else T.renderbufferStorage(U,T.DEPTH_COMPONENT16,g,A);l&&!Y._MSAAFbo&&(Y._MSAAFbo=T.createFramebuffer(),Y._MSAARbO=T.createRenderbuffer()),hl(T,Y.frame),T.framebufferTexture2D(M,T.COLOR_ATTACHMENT0,Z,Y.texture,0),l||T.framebufferRenderbuffer(M,T.DEPTH_ATTACHMENT,U,Y.render),Pj(T),l&&(T.bindRenderbuffer(T.RENDERBUFFER,Y._MSAARbO),T.renderbufferStorageMultisample(T.RENDERBUFFER,l,T.RGBA8,g,A),hl(T,Y._MSAAFbo),T.framebufferRenderbuffer(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.RENDERBUFFER,Y._MSAARbO),T.framebufferRenderbuffer(M,T.DEPTH_ATTACHMENT,U,Y.render),Pj(T)),Lf(T,h),T.bindRenderbuffer(U,h),Y.width=g,Y.height=A
}},toCanvas:function(){var p=this,I=p.gv.getGL();hl(I,p.frame);var A=p.width,e=p.height,k=new Uint8Array(4*A*e);I.readPixels(0,0,A,e,I.RGBA,I.UNSIGNED_BYTE,k),Pj(I);var V=N.createElement("canvas");V.width=A,V.height=e;var z=V.getContext("2d"),X=z.createImageData(A,e);return X.data.set(k),z.putImageData(X,0,0),V}});var tc=jq.Interactor=function(s){this.gv=this.g3d=s};Xi("Interactor",w,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(J){this.gv.fi(J)},startDragging:function(l){Vc(this,l)}});var Kf=jq.DefaultInteractor=function(Z){_l(Kf,this,[Z])};Xi("DefaultInteractor",tc,{getState:function(){return this._62O},setState:function(E){this._62O=E},getDataInfoAt:function(H,m){var N=this.gv,E=N.getDataInfoAt(H);if(!N.isBlockSelectable()||!E||!E.data)return E;if(!m&&N.isSelected(E.data))return E;for(var S=E.data;(S=S.getParent())&&S instanceof R.Block&&N.isSelectable(S);){var n=N.isSelected(S);if(n&&m)break;if(E={data:S,part:E.part},n&&!m)break}return E},handle_contextmenu:function(Z){jr(Z)},handle_mousewheel:function(Z){this.gv.handleScroll(Z,Z.wheelDelta/40)},handle_DOMMouseScroll:function(X){2===X.axis&&this.gv.handleScroll(X,-X.detail)},handle_keydown:function(U){this.gv.handleKeyDown(U)},handle_mousedown:function(i){this.handle_touchstart(i)},handle_touchstart:function(m){jr(m);var A=this,$=A.gv,v=Pd(m),x=A.getDataInfoAt(m),W=x?x.data:h,S=x?x.part:h,k=$.sm(),X=nj(m),j=uh(m);$.setFocus(m)&&(A._62O=h,A._57I=h,A.pendingClickThrough=h,A.__lastClientPoint__=Cd(m),W?Nq(m)?k.co(W)?k.rs(W):k.as(W):k.co(W)?W instanceof Ho&&W.isClickThroughEnabled()&&Pd(m)&&(A.pendingClickThrough=Cd(m)):k.ss(W):v&&(Nq(m)?$.isRectSelectable()&&(A._62O=lm):A._57I=Cd(m)),A._31Q&&(rj(A._31Q),delete A._31Q,delete A._32Q),A._62O||($.isFirstPersonMode()&&(sh(m)||$q(m)||j>2?A._62O="pan":$.isMouseRoamable()||Le(m)?(A._62O="roaming",A.foward=X&&Pd(m),A._32Q=Yl(),A._31Q=Qe(A.tick,A)):v||(A._62O="roaming")),A._62O||(v&&X&&Gs[S]?(A._62O=S,A.p3=W.p3()):v&&X&&Tn(W)&&$.isSelected(W)?$.isMovable(W)?(A._62O="move",A.p3=W.p3(),A.movedata=W):$._39Q(W)&&(A._62O="none"):Le(m)&&(j>2?A._62O="pan":2===j&&(A.dist=Mc(m),A._62O="pinch")))),A.point=$.lp(m),Vc(A,m),xi(m)?$.handleDoubleClick(m,W,S):$.handleClick(m,W,S))},tick:function(){var V=this,j=V.gv,n=j._moveStep;V.point&&j.isWalkable()&&(V._32Q&&(n*=(Yl()-V._32Q)/50),j.walk(V.foward?n:-n),V._32Q=Yl(),V._31Q=Qe(V.tick,V))},handle_mouseup:function(U){this.handle_touchend(U)},handle_touchend:function(T){var K=this._57I;if(K&&(Jf(K,Cd(T))<=1&&this.gv.sm().cs(),this._57I=h),K=this.pendingClickThrough){if(Jf(K,Cd(T))<=1){var F=this.getDataInfoAt(T);F&&F.data instanceof Ho&&F.data.isClickThroughEnabled()&&(F=this.getDataInfoAt(T,!0),F&&(T.clickThrough=!0,this.gv.sm().ss(F.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(m){this.handleWindowTouchMove(m)},handleWindowTouchMove:function(V){var S,O,C=this,A=C.gv,F=C._62O,b=C.point,X=A.dm(),w=A.lp(V),n=w.x-b.x,o=w.y-b.y,P=A.getWidth(),y=A.getHeight();if(P&&y){var r=Cd(V),u=cm(A,r,C.__lastClientPoint__),G=Jf({x:0,y:0},u),p=-Q*n/P,Y=-Q*o/y;if("roaming"===F)C.rotate(V,p/2,Y/2);else if(F===Pn||F===Ag||F===vs)A._86O||X.beginTransaction(),A.fi({kind:A._86O?"betweenEditRotation":"beginEditRotation",event:V}),A._86O=1,A.sm().each(function(i){if(Tn(i)&&A.isRotationEditable(i)){var s=$(p)>$(Y)?p:Y;F===Pn?i.setRotationX(i.getRotationX()+s):F===Ag?i.setRotationY(i.getRotationY()+s):F===vs&&i.setRotationZ(i.getRotationZ()+s)}});else if("move"===F||Gs[F]){if(F===Ds||F===Es||F===Fs)A._87O||X.beginTransaction(),A.fi({kind:A._87O?"betweenEditScale":"beginEditScale",event:V}),A._87O=1;else{if(!A._moving){if(G<l.touchMoveThreshold)return;X.beginTransaction()}A.fi({kind:A._moving?"betweenMove":"beginMove",event:V}),A._moving=1}var i,_=C.p3,N=A.getPositionInfo(_),m=yr(A);i=F===Bi?"x":F===me?"y":F===Gj?"z":F===Ds?"sx":F===Es?"sy":F===Fs?"sz":A.getMoveMode(V,C.movedata),n=n/P*N.width,o=-1*o/y*N.height;var k,j,t=[m[0]*n,m[4]*n,m[8]*n],h=[m[1]*o,m[5]*o,m[9]*o],q=t[0]+h[0],I=t[1]+h[1],H=t[2]+h[2],J=[_[0]+q,_[1]+I,_[2]+H],R=il(A.getEye(),J,!0);if("xyz"===i?(k=J,A.moveSelection(q,I,H)):"xz"===i?(k=Wb(A,_,[0,1,0],J),k&&A.moveSelection(k[0]-_[0],0,k[2]-_[2])):"xy"===i?(k=Wb(A,_,[0,0,1],J),k&&A.moveSelection(k[0]-_[0],k[1]-_[1],0)):"yz"===i?(k=Wb(A,_,[1,0,0],J),k&&A.moveSelection(0,k[1]-_[1],k[2]-_[2])):"x"===i||"sx"===i?(R[0]=0,k=Wb(A,_,R,J),k&&(j=k[0]-_[0],"x"===i?A.moveSelection(j,0,0):A.sm().each(function(H){Tn(H)&&A.isSizeEditable(H)&&(S=H.getScaleX()+j/100,O=S/H.getScaleX(),H.setScaleX(S),sh(V)&&(H.setScaleY(H.getScaleY()*O),H.setScaleTall(H.getScaleTall()*O)))}))):"y"===i||"sy"===i?(R[1]=0,k=Wb(A,_,R,J),k&&(j=k[1]-_[1],"y"===i?A.moveSelection(0,j,0):A.sm().each(function(y){Tn(y)&&A.isSizeEditable(y)&&(S=y.getScaleTall()+j/100,O=S/y.getScaleTall(),y.setScaleTall(S),sh(V)&&(y.setScaleY(y.getScaleY()*O),y.setScaleX(y.getScaleX()*O)))}))):("z"===i||"sz"===i)&&(R[2]=0,k=Wb(A,_,R,J),k&&(j=k[2]-_[2],"z"===i?A.moveSelection(0,0,j):A.sm().each(function(T){Tn(T)&&A.isSizeEditable(T)&&(S=T.getScaleY()+j/100,O=S/T.getScaleY(),T.setScaleY(S),sh(V)&&(T.setScaleX(T.getScaleX()*O),T.setScaleTall(T.getScaleTall()*O)))}))),!k)return;C.p3=k}else if(F===lm){var Z=C.div;Z||(Z=C.div=Xl(),vk(C.getView(),Z),Z.op=b,Z.style.background=A.getRectSelectBackground()),A.fi({kind:A._rectSelecting?"betweenRectSelect":"beginRectSelect",event:V}),A._rectSelecting=1,Z.rect=oj(Z.op,w),cn(Z,Z.rect)}else if("pinch"===F&&2===uh(V)){A.fi({kind:A._pinching?"betweenPinch":"beginPinch",event:V}),A._pinching=1;var j=Mc(V);A._lastZoomLP||(A._lastZoomLP=tb(V)),A.handlePinch(j,C.dist),C.dist=j}else"pan"===F||sh(V)||$q(V)?C.pan(V,n,o):"none"===F||A.isFirstPersonMode()||C.rotate(V,p,Y);C.point=w}},pan:function(U,i,k){var V=this.gv;if(V.isPannable()){var c=V.getWidth(),K=V.getHeight();if(!c||!K)return;var r=V.getCenterInfo(),Z=i/c*r.width,G=-1*k/K*r.height;V.fi({kind:V._panning?"betweenPan":"beginPan",event:U}),V._panning=1,V.pan(-Z,-G)}},rotate:function(L,W,d){var p=this.gv;p.isRotatable()&&(p.fi({kind:p._rotating?"betweenRotate":"beginRotate",event:L}),p._rotating=1,p.rotate(W,d))},handleWindowMouseUp:function(t){this.handleWindowTouchEnd(t)},handleWindowTouchEnd:function(x){var S=this,f=S.gv,X=f.dm(),Z=S.div;if(Z){var U=f.getDatasInRect(Z.rect);if(!U.isEmpty()){var R=f.sm(),J=R.toSelection();U.each(function(L){R.co(L)?J.remove(L):J.add(L)}),R.ss(J)}sn(Z)}f._moving&&(delete f._moving,f.fi({kind:"endMove",event:x}),f.onMoveEnded(),X.endTransaction()),f._panning&&(delete f._panning,f.fi({kind:"endPan",event:x}),f.onPanEnded()),f._rotating&&(delete f._rotating,f.fi({kind:"endRotate",event:x}),f.onRotateEnded()),f._86O&&(delete f._86O,f.fi({kind:"endEditRotation",event:x}),X.endTransaction()),f._87O&&(delete f._87O,f.fi({kind:"endEditScale",event:x}),X.endTransaction()),f._pinching&&(delete f._pinching,f.fi({kind:"endPinch",event:x}),f.onPinchEnded()),f._rectSelecting&&(delete f._rectSelecting,f.fi({kind:"endRectSelect",event:x}),f.onRectSelectEnded()),f._walking&&(delete f._walking,f.fi({kind:"endWalk",event:x}),f.onWalkEnded()),f._lastZoomLP=f._lastZoomHit=null,S.dist=S.point=S._62O=S.p3=S.movedata=S.div=S._57I=S.pendingClickThrough=S._32Q=S._31Q=S.foward=h,S.__lastClientPoint__=h}});var xj=jq.MapInteractor=function(u){_l(xj,this,[u]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this._minPhi=0,this._maxPhi=5*Math.PI/12};Xi("MapInteractor",tc,{setUp:function(){xj.superClass.setUp.call(this);var A=this.gv;this.__oldMinPhi__=A.getRotateMinPhi(),this.__oldMaxPhi__=A.getRotateMaxPhi(),A.setRotateMinPhi(this._minPhi),A.setRotateMaxPhi(this._maxPhi)},tearDown:function(){xj.superClass.tearDown.call(this);var L=this.gv;L.setRotateMinPhi(this.__oldMinPhi__),L.setRotateMaxPhi(this.__oldMaxPhi__),delete this.__oldMinPhi__,delete this.__oldMaxPhi__},handle_contextmenu:function(I){jr(I)},handle_mousewheel:function(R){this.gv.handleScroll(R,R.wheelDelta/40)},handle_DOMMouseScroll:function(O){2===O.axis&&this.gv.handleScroll(O,-O.detail)},handle_keydown:function(t){this.gv.handleKeyDown(t)},handle_mousedown:function(b){this.handle_touchstart(b)},handle_touchstart:function(U){jr(U);var K=this,Z=K.gv;if(Z.setFocus(U)){var C=Z.getDataInfoAt(U),w=C?C.data:h,d=C?C.part:h,x=K.editing={point:Z.lp(U)};Le(U)?x.touch=!0:(x.touch=!1,x.clickLeft=Pd(U),x.pan=$q(U)?!0:"left"===this.panButton===x.clickLeft),w&&Z._39Q(w)&&(x.preventDefault=!0),Vc(K,U),xi(U)?Z.handleDoubleClick(U,w,d):Z.handleClick(U,w,d)}},handle_mouseup:function(X){this.handle_touchend(X)},handle_touchend:function(){},handleWindowMouseMove:function(K){this.handleWindowTouchMove(K)},handleWindowTouchMove:function(B){var i=this,D=i.gv,L=i.editing;if(L){var C=D.lp(B),G=L.point,b=C.x-G.x,N=C.y-G.y;if(!L.moved){if(Math.abs(b)<i.threshold&&Math.abs(N)<i.threshold&&!(B.touches&&B.touches.length>1))return;L.moved=!0}if(!L.preventDefault)if(L.point=C,L.touch){var v=B.touches.length;if(2!==v)i.pan(B,b,N);else{if(1>=v)return;var q=B.touches,y={x:q[0].clientX,y:q[0].clientY},n={x:q[1].clientX,y:q[1].clientY},s={x:n.x-y.x,y:n.y-y.y},V=L.lastCenter,M=Math.atan2(s.y,s.x),f=L.theta,p=0;f==h?f=L.theta=M:(p=M-f,L.thetaStarted||Math.abs(p)>i.touchRotateThreshold?(L.thetaStarted=!0,L.theta=M):p=0);var c=S*(y.y+n.y)/2/D.getHeight(),J=L.phi,e=0;J==h?J=L.phi=c:(e=c-J,L.phiStarted||Math.abs(e)>i.touchRotateThreshold?(L.phiStarted=!0,L.phi=c):e=0);var x,$=Math.sqrt(s.x*s.x+s.y*s.y),g=L.vlen;if(g){var K=y.x-V.x,k=y.y-V.y,l=n.x-V.x,t=n.y-V.y,X=Math.sqrt(K*K+k*k),R=Math.sqrt(l*l+t*t),W=g/2,Y=i._sign2(X-W),O=i._sign2(R-W);0>Y*O||0===Y&&0===O?(x=1,L.vlen=$):(x||(x=$/g),L.scaleStarted||Math.abs(x-1)>i.touchScaleThreshold?(L.vlen=$,L.scaleStarted=!0):x=1)}else g=L.vlen=$,x=1;1!==x&&D.setZoom(x),(e||p)&&i.rotate(B,p,-e),L.lastCenter={x:(n.x+y.x)/2,y:(n.y+y.y)/2}}}else if(L.pan)i.pan(B,b,N);else{var u=D.getWidth(),d=D.getHeight();if(!u||!d)return;var H=-Q*b/u,F=-Q*N/d;i.rotate(B,H,F)}}},_sign2:function(Y){return Math.abs(Y)<this._touchScaleCheckAccuracy?0:Y>0?1:-1},handleWindowMouseUp:function(H){this.handleWindowTouchEnd(H)},getDataInfoAt:function(U,x){var $=this.gv,v=$.getDataInfoAt(U);if(!$.isBlockSelectable()||!v||!v.data)return v;if(!x&&$.isSelected(v.data))return v;for(var n=v.data,X=v.part;(n=n.getParent())&&n instanceof R.Block&&$.isSelectable(n);){var z=$.isSelected(n);if(z&&x)break;if(v={data:n,part:X},z&&!x)break}return v},handleWindowTouchEnd:function(b){var u=this,g=u.editing;if(u.editing=null,g){var X=u.gv;if(g.moved||!g.clickLeft&&!g.touch)X._panning=null,X._rotating=null,X.fi({kind:g.pan?"endPan":"endRotate",event:b});else{var q=u.getDataInfoAt(b),V=q&&q.data;V instanceof Ho&&V.isClickThroughEnabled()&&(q=u.getDataInfoAt(b,!0),q&&(V=q.data)),V?X.sm().setSelection([V]):X.sm().clearSelection()}}},pan:function(b,l,C){var A=this,N=A.gv;if(N.isPannable()){var y=N.getWidth(),D=N.getHeight();if(y&&D){var W=N.getCenterInfo(),p=-l/y*W.width,c=1*C/D*W.height;N.fi({kind:N._panning?"betweenPan":"beginPan",event:b}),N._panning=1;var o=A.keepHorizon,u=A.editing.touch;if((u&&b.touches&&b.touches.length>1||!u&&sh(b))&&(o=!o),!o)return N.pan(p,c);if(p||c){var F=yr(N),n=[F[0]*p,F[4]*p,F[8]*p],S=[F[1],0,F[9]],U=Math.sqrt(S[0]*S[0]+S[2]*S[2]);U&&(S=[S[0]/U*c,0,S[2]/U*c]);var E=n[0]+S[0],j=n[1]+S[1],Z=n[2]+S[2],k=N._center,g=N._eye;k[0]+=E,k[1]+=j,k[2]+=Z,g[0]+=E,g[1]+=j,g[2]+=Z,N.fp(Bl,h,g),N.fp(Xf,h,k)}}}},rotate:function(e,Q,h){var F=this,C=F.gv;if(C.isRotatable()){var j=C._center,w=C._eye,v=il(w,j),s=Mj(m(v[0]*v[0]+v[2]*v[2]),v[1]),b=yg(C,s+h);h=b-s,C.fi({kind:C._rotating?"betweenRotate":"beginRotate",event:e}),C._rotating=1,C.rotate(Q,h)}}}),w.defineProperties(xj.prototype,{panButton:{get:function(){return this._panButton},set:function(u){this._panButton=u}},minPhi:{get:function(){return this._minPhi},set:function(u){this.gv.setRotateMinPhi(this._minPhi=u)}},maxPhi:{get:function(){return this._maxPhi},set:function(B){this.gv.setRotateMaxPhi(this._maxPhi=B)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(G){this._keepHorizon=G}},threshold:{get:function(){return this._threshold},set:function(v){this._threshold=v}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(z){this._touchScaleThreshold=z}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(S){this._touchRotateThreshold=S}}});var se,Rr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",Aq=32,_g=jq.GlobeInteractor=function(G,y){_l(_g,this,[G]);var u,Y=y.radius||6378137,E=this,K=null;se||(se=Xl(),se.style.border="",se.style.backgroundImage="url("+Rr+")");var S=new wh,j=new qp,i=new qp,x=new qp,q=new tl,X="number"==typeof Y?{x:Y,y:Y,z:Y}:Y,d={center:new qp(0,0,0),radius:X},_=function(c){G._81O=null;var E=G.getHitPosition(c,G.getCenter(),j.copy(G.getEye()).sub(i.copy(G.getCenter())).toArray());return q.origin.copy(G.getEye()),q.direction.copy(E).sub(q.origin).normalize(),q.intersectEllipsoid(d)},L=function(z,g){G._81O=null,q.origin.copy(G.getEye());for(var J,n,H=G.getCenter(),Z=j.copy(G.getEye()).sub(i.copy(G.getCenter())).toArray(),D=1,t=16,P=0,C=1,W={x:0,y:0};t--;){if(W.x=g.x+(z.x-g.x)*D,W.y=g.y+(z.y-g.y)*D,J=G.getHitPosition(W,H,Z),q.direction.copy(J).sub(q.origin).normalize(),n=q.intersectEllipsoid(d),n&&1===D)return{hit:n};n?P=D:C=D,D=(P+C)/2}return{hit:n,out:1>D}},f=function(H,D){if(K){var F=Date.now();K.deltaTime=K.lastTime?F-K.lastTime:1e3,K.lastTime=F,K.lastAxis=H,K.lastAngle=D}D&&(S.setFromAxisAngle(H,D),G.setEye(j.copy(G.getEye()).applyQuaternion(S).toArray()),G.setCenter(j.copy(G.getCenter()).applyQuaternion(S).toArray()),G.setUp(j.copy(G.getUp()).applyQuaternion(S).toArray()))};E._showCrossIcon=function(D){vk(E.getView(),se),cn(se,{x:D.clientX-Aq/2,y:D.clientY-Aq/2,width:Aq,height:Aq})},E._hideCrossIcon=function(){sn(se)},E._scrollImpl=function(m,C){K={point:G.lp(m),screen:Cd(m),hit:_(m),type:"right"},K.hitNormalize=K.hit?K.hit.clone().normalize():new qp;var N={clientX:K.screen.x,clientY:K.screen.y+10*C};E._handleMoveImpl(N),E._endMoveImpl(N)},E._startMoveImpl=function(g){u&&(u.stop(!0),u=null),K={point:G.lp(g),screen:Cd(g),hit:_(g)},K.hitNormalize=K.hit?K.hit.clone().normalize():new qp,Le(g)?1===g.touches.length?K.hit&&(K.type="left"):2===g.touches.length&&(K.type="touch2"):(Pd(g)?K.hit&&(K.type="left"):db(g)?K.type="right":$q(g)&&K.hit&&(K.type="middle"),!K.hit||"right"!==K.type&&"middle"!==K.type||E._showCrossIcon(g)),K.type&&Vc(E,g)},E._handleMoveImpl=function(B){if(K)switch(K.type){case"left":return E._handleLeft(B);case"right":return E._handleRight(B);case"middle":return E._handleMiddle(B);case"touch2":return E._handleTouch2(B)}},E._endMoveImpl=function(){if(K){if(this._hideCrossIcon(),"left"===K.type||"middle"===K.type){var L=1e3*(K.lastAngle/(K.deltaTime||30)),O=K.lastAxis,I=K.lastTime,P=function(){var B=Date.now(),p=(B-I)/1e3;return I=B,L*=Math.pow(Math.abs(E.decelerationRate),3*p),Math.abs(L)<.01?(L=0,u&&u.stop(),void 0):(f(O,L*p),void 0)};u=ll({action:function(){P(arguments)},duration:5e3})}K=null}},E._handleLeft=function(U){if(!K.finished){var b=Cd(U),$=L(b,K.lastScreen||K.screen);if(K.lastScreen=b,!$.hit)return K.finished=!0,E._endMoveImpl(U),void 0;var V=$.hit;V.normalize();var i=K.hitNormalize,C=Math.acos(V.dot(i)),q=V.cross(i).normalize();f(q,C),$.out&&(K.finished=!0,E._endMoveImpl(U))}},E._handleRight=function(A){var c=K.lastScreen||K.screen,h=c.y;c=K.lastScreen=Cd(A);var w=c.y,o=w-h;if(o){var J=Math.min(.5,o*E.scaleSpeed);j.copy(G.getEye());var R=K.hit;R||(R=j.clone().divide(X).normalize().multiply(X)),i.copy(j).lerp(R,J),G.setEye(i.toArray()),j.copy(G.getUp()),i.normalize();var L=j.clone().cross(i).normalize();if(x.copy(G.getCenter()),x.sub(L.multiplyScalar(x.dot(L))),G.setCenter(x.toArray()),K.hit){var e=_(K.screen),I=K.hitNormalize;if(e){e.normalize();var Q=Math.acos(e.dot(I)),r=e.cross(I).normalize();Q&&f(r,Q)}}}};var F=function(H){return Math.abs(H)<.01?0:H>0?1:-1};E._handleTouch2=function(x){var O=x.touches.length;if(2===O){var _=x.touches,R={x:_[0].clientX,y:_[0].clientY},J={x:_[1].clientX,y:_[1].clientY},E={x:J.x-R.x,y:J.y-R.y},T=K.lastCenter,j=Math.atan2(E.y,E.x),o=K.theta,D=0;o==h?o=K.theta=j:(D=j-o,K.thetaStarted||Math.abs(D)>.03?(K.thetaStarted=!0,K.theta=j):D=0);var k,U=Math.sqrt(E.x*E.x+E.y*E.y),r=K.vlen;if(r){var c=R.x-T.x,d=R.y-T.y,l=J.x-T.x,n=J.y-T.y,v=Math.sqrt(c*c+d*d),P=Math.sqrt(l*l+n*n),s=r/2,b=F(v-s),$=F(P-s);0>b*$||0===b&&0===$?(k=1,K.vlen=U):(k||(k=U/r),K.scaleStarted||Math.abs(k-1)>.05?(K.vlen=U,K.scaleStarted=!0):k=1)}else r=K.vlen=U,k=1;var E=i.copy(G.getEye()).clone();1!==k&&G.setEye(E.setLength((E.length()-Y)/k+Y).toArray()),D&&f(E.normalize(),D),K.lastCenter={x:(J.x+R.x)/2,y:(J.y+R.y)/2}}},E._handleMiddle=function(h){var e=Cd(h),W=K.screen;K.screen=e;var Y=(e.y-W.y)/180*Math.PI*E.rollSpeed;i.copy(G.getCenter()).sub(j.copy(G.getEye())).normalize(),j.copy(G.getUp()).cross(i).normalize(),i.copy(G.getEye()).sub(K.hit).applyAxisAngle(j,Y).add(K.hit);var Q=i.clone();i.copy(G.getCenter()).sub(K.hit).applyAxisAngle(j,Y).add(K.hit);var m=i.clone(),w=i.copy(G.getUp()).applyAxisAngle(j,Y).clone(),k=!1;Y>0&&(x.copy(w),i.copy(m).sub(Q).normalize(),j.copy(Q).multiplyScalar(-1).normalize(),j.dot(x)-i.dot(x)>0&&(k=!0)),k||x.copy(K.hit).sub(Q).dot(K.hitNormalize)>=0&&(k=!0),k||(G.setEye(Q.toArray()),G.setCenter(m.toArray()),G.setUp(w.toArray()));var v=-(e.x-W.x)/180*Math.PI*E.rotateSpeed;f(K.hitNormalize,v)}};Xi("GlobeInteractor",tc,{handle_contextmenu:function(i){jr(i)},handle_mousewheel:function(V){this._scrollImpl(V,V.wheelDelta/40)},handle_DOMMouseScroll:function(o){2===o.axis&&this._scrollImpl(o,-o.detail)},handle_keydown:function(O){this.gv.handleKeyDown(O)},handle_mousedown:function(J){this.handle_touchstart(J)},handle_touchstart:function(C){jr(C);var q=this.gv;if(q.setFocus(C)){var F=q.getDataInfoAt(C),W=F?F.data:h;W&&q.isInteractive(W)||this._startMoveImpl(C);var R=F?F.part:h;xi(C)?q.handleDoubleClick(C,W,R):q.handleClick(C,W,R)}},handle_mouseup:function(x){this.handle_touchend(x)},handle_touchend:function(){},handleWindowMouseMove:function(M){this.handleWindowTouchMove(M)},handleWindowTouchMove:function(o){this._handleMoveImpl(o)},handleWindowMouseUp:function(m){this.handleWindowTouchEnd(m)},handleWindowTouchEnd:function(F){this._endMoveImpl(F)}}),w.defineProperties(_g.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(H){this._rotateSpeed=H}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(u){this._rollSpeed=u}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(K){this._scaleSpeed=K}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(L){this._decelerationRate=L}}});var Uf=function(j){var S=2147483648|j;return[(255&S>>16)/255,(255&S>>8)/255,(255&S)/255,(255&S>>24)/255]},ak=function(s){this.gv=s,this.gv.pickColorMap={_pickIdUsed:1e3}};tr(ak,w,{_iv:!0,iv:function(){this._iv=!0},get:function(b,T,o){this.validate();var U=this,z=U.gv.getGL();if(!z)return h;var i,Z,n=U._resolution,K=Math.round(b.x*n),l=Math.ceil(b.width*n),q=Math.ceil(b.height*n),W=U.height-Math.round(b.y*n)-q,H=c(l/2),E=new Uint8Array(4*l*q),m=0,O=E.length,X=T?h:new bp,$=T?h:{};if(hl(z,U.frame),z.readPixels(K,W,l,q,z.RGBA,z.UNSIGNED_BYTE,E),Pj(z),T){for(;H>=m;m++)for(var A=H-m,Y=H+m,d=A;Y>=d;d++)for(var C=A;Y>=C;C++)if((d===A||d===Y||C===A||C===Y)&&(i=U.info(E,4*(d*l+C)))){if(o&&o(i)===!1)continue;return i}}else for(;O>m;m+=4)if(i=U.info(E,m)){if(o&&o(i)===!1)continue;Z=i.data,$[Z._id]||(X.add(Z),$[Z._id]=Z)}return X},info:function(_,u){return this.gv.pickColorMap[(_[u]<<16)+(_[u+1]<<8)+_[u+2]+((127&_[u+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var I=this,x=I.gv,o=x.getGL();if(o){var r=I._resolution=x._pickerResolution*x.getDevicePixelRatio(),c=Math.round(r*x.getWidth()),Y=Math.round(r*x.getHeight()),A=o.RGBA,q=o.TEXTURE_2D,R=o.RENDERBUFFER,n=o.FRAMEBUFFER;if(I.texture||(I.texture=Zl(o),I.render=o.createRenderbuffer(),I.frame=o.createFramebuffer()),(I.width!==c||I.height!==Y)&&(o.activeTexture(o.TEXTURE0),Lf(o,I.texture),o.texImage2D(q,0,A,c,Y,0,A,o.UNSIGNED_BYTE,h),Fi(o,o.TEXTURE_MIN_FILTER,o.LINEAR),o.bindRenderbuffer(R,I.render),o.renderbufferStorage(R,o.DEPTH_COMPONENT16,c,Y),hl(o,I.frame),o.framebufferTexture2D(n,o.COLOR_ATTACHMENT0,q,I.texture,0),o.framebufferRenderbuffer(n,o.DEPTH_ATTACHMENT,R,I.render),Lf(o,h),o.bindRenderbuffer(R,h),Pj(o),I.width=c,I.height=Y),I._iv){I._iv=!1;var P=!1;x._40Q.each(function(V){!P&&V.isBatchInvalid()&&(P=!0)}),P&&x.updateScene(),hl(o,I.frame),o.clear(o.COLOR_BUFFER_BIT),x.overlappingBox.clear(),x.setViewport(o,0,0,c,Y),x.renderPickScene(),Pj(o)}}}});var fb=function(g){this.gv=g};tr(fb,w,{gap:0,size:0,_42:function(p,n){var A=this,Y=A.gv,O=Y._gridGap,I=Y._gridSize;if(Y._gridVisible){if(A.gap!==O||A.size!==I){for(var R=[],q=Y._gridSize/2,D=O*q,c=0;2*q+1>c;c++){var y=6*c,o=6*(2*q+1)+y;R[y]=-D,R[y+1]=0,R[y+2]=-D+c*O,R[y+3]=D,R[y+4]=0,R[y+5]=-D+c*O,R[o]=-D+c*O,R[o+1]=0,R[o+2]=-D,R[o+3]=-D+c*O,R[o+4]=0,R[o+5]=D}A.vs=new _p(R),A.gap=O,A.size=I}rr(Y),Qr(p,n),ze(p),mr(p,n,1,Y._gridColor,Y._buffer.vs,A.vs),Ko(p,0,A.vs.length/3,p.LINES),Yh(p),We(p,n)}else A.vs=A.gap=A.size=h}});var Zf=function(J){this.gv=J};tr(Zf,w,{_42:function(M,K){var o=this.gv,m=o._buffer.vs,C=o._axisXColor,V=o._axisYColor,g=o._axisZColor,c=o._originAxisVisible,r=o._centerAxisVisible;if(c||r){var i=Sj?M.TRIANGLES:M.TRIANGLE_FAN,X=M.LINES;if(rr(o),Qr(M,K),ze(M),c){var I=o.getCenterInfo(),k=v(I.width,I.height)/5,y=.8*k,$=.05*k;mr(M,K,1.5,C,m,new _p([0,0,0,k,0,0,y,$,0,y,0,$,y,-$,0,y,0,-$,y,$,0,0,0,0,0,k,0,$,y,0,0,y,$,-$,y,0,0,y,-$,$,y,0,0,0,0,0,0,k,$,0,y,0,$,y,-$,0,y,0,-$,y,$,0,y])),Ko(M,0,2,X),Ko(M,1,6,i),mr(M,K,h,V),Ko(M,7,2,X),Ko(M,8,6,i),mr(M,K,h,g),Ko(M,14,2,X),Ko(M,15,6,i)}if(r){var q=o._center,e=q[0],N=q[1],n=q[2],I=o.getPositionInfo(q);k=v(I.width,I.height)/20,mr(M,K,1.5,C,m,new _p([e,N,n,e+k,N,n,e,N,n,e,N+k,n,e,N,n,e,N,n+k])),Ko(M,0,2,X),mr(M,K,h,V),Ko(M,2,2,X),mr(M,K,h,g),Ko(M,4,2,X)}Yh(M),We(M,K)}}});var mo=function(j){this.gv=j,this.onMouseOver=this.onMouseOver.bind(this),this.mode=mo.Mode.Style,this.color=B,this.width=B};mo.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},tr(mo,w,{onMouseOver:function(x){l.preventDefault(x);var L=this.gv.getDataAt(x);L!==this.mouseOverData&&(this.mouseOverData=L,this.gv.iv())},setFetchTargetFunc:function($){this.fetchTargetFunc=$},_42:function(E,F){var A,M,T=this,u=T._mode,L=T.gv;if(!E._renderInfo.reflectDepth&&u!==mo.Mode.Disable){if(u===mo.Mode.Selection?A=L.sm().getSelection().toArray(function(j){return j.s("highlight.visible")}):u===mo.Mode.MouseOver&&T.mouseOverData&&T.mouseOverData.s("highlight.visible")&&(A=[T.mouseOverData]),T.fetchTargetFunc&&(A=T.fetchTargetFunc(A)),u===mo.Mode.Style)A=A||[],M=function(d){if(A.indexOf(d)>=0)return!1;var f=L.getDataHighlightMode(d);return f===!1?!0:f===!0?!1:"selected"===f?L.isSelected(d)?!1:!0:"hover"===f?d===T.mouseOverData?!1:!0:!0};else{if(!A||!A.length)return;M=function(F){return A.indexOf(F)<0?!0:void 0}}var x=L.isVRPresenting(),N=L.getWidth();if(x){var n=L.getWidth;N/=2,L.getWidth=function(){return N};var Z=L.getViewport()}var O,s=L.getDevicePixelRatio(),S=N*s,h=L.getHeight()*s;(O=T._renderTarget)?O.setSize(E,S,h):T._renderTarget=O=new jq.RenderTarget(L,E,S,h),hl(E,O.frame),E.clear(E.COLOR_BUFFER_BIT),L.setViewport(E,0,0,S,h),L.drawFilter=M,L.renderPickScene(),L.drawFilter=null,Pj(E),Sj&&ff(E,F.aPosition),ff(E,F.aNormal),x&&(L.getWidth=n,L.setViewport(E,Z[0],Z[1],Z[2],Z[3]));var _=E._compiledShader.highlight;_||(_=E._compiledShader.highlight=new lp.Shader(E,ne.vs,ne.fs)),_.bind();var t=Ig.for(E),V=t.directState();V.blend.enabled=!0,V.depth.enabled=!1,E.activeTexture(E.TEXTURE0+0),Lf(E,O.texture),_.uniforms.image=0,_.uniforms.textureSize=[S,h],_.uniforms.edgeWidth=L.getHighlightWidth();var f=L.getHighlightColor();if(T._lastHighlightColor!==f){var W=gg(T._lastHighlightColor=f);T._highlightColorData=[W[0]/255,W[1]/255,W[2]/255,W[3]/255]}return _.uniforms.edgeColor=T._highlightColorData,T.ibuffer?(T.ibuffer.upload(),T.vbuffer.upload()):(T.ibuffer=lp.Buffer.createIndexBuffer(E,new Uint16Array([0,2,1,1,2,3])),T.vbuffer=lp.Buffer.createVertexBuffer(E,new Float32Array([0,0,1,0,0,1,1,1]))),_.attributes.pos.pointer(T.vbuffer),E.drawElements(E.TRIANGLES,6,E.UNSIGNED_SHORT,0),V.blend.enabled=!1,V.depth.enabled=!0,Lf(E,null),E.useProgram(F),Sj&&js(E,F.aPosition),!0}}}),w.defineProperties(mo.prototype,{mode:{get:function(){return this._mode},set:function(A){var m=this._mode;if(A!==m){this._mode=A;var F=m===mo.Mode.MouseOver||m===mo.Mode.Style,n=A===mo.Mode.MouseOver||A===mo.Mode.Style;n&&F||(F&&J(this.gv.getView(),"mousemove",this.onMouseOver),n&&e(this.gv.getView(),"mousemove",this.onMouseOver))}}}});var ne={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Rh=function(F){this.gv=F},Bi="edit_tx",me="edit_ty",Gj="edit_tz",Pn="edit_rx",Ag="edit_ry",vs="edit_rz",Ds="edit_sx",Es="edit_sy",Fs="edit_sz",Gs={};Gs[Bi]=101,Gs[me]=102,Gs[Gj]=103,Gs[Pn]=104,Gs[Ag]=105,Gs[vs]=106,Gs[Ds]=107,Gs[Es]=108,Gs[Fs]=109,tr(Rh,w,{_42:function(x,o,k){var U=this,A=U.gv,N=A.sm().ld();if(N&&A.isEditable(N)&&!A.isEditHelperDisabled()&&Tn(N)&&(!A.isFirstPersonMode()||!A.isMouseRoamable()&&!An)){rr(A);var l,s=A.isMovable(N),Y=A.isRotationEditable(N),n=A.isSizeEditable(N),K=A._axisXColor,I=A._axisYColor,Q=A._axisZColor,W=A._editSizeColor,y=N.p3();if(A.isOrtho()){var S=A.getCenterInfo();l=v(S.width,S.height)/8}else l=Jf(A.getEye(),y)/10;var H,M,$=l/(k?5:10),m=.7*l,w=.4*m,T=y[0],u=y[1],t=y[2];H=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],s&&U._17O(x,o,N,k,Bi,K,H,[T,u-$,t,T+m,u-$,t,T+m,u,t,T+m,u,t,T,u,t,T,u-$,t,T,u-$,t+$,T+m,u-$,t+$,T+m,u-$,t,T+m,u-$,t,T,u-$,t,T,u-$,t+$]),M=T+m,n&&U._17O(x,o,N,k,Ds,W,H,[M,u-$,t,M+w,u-$,t,M+w,u,t,M+w,u,t,M,u,t,M,u-$,t,M,u-$,t+$,M+w,u-$,t+$,M+w,u-$,t,M+w,u-$,t,M,u-$,t,M,u-$,t+$]),M+=w,Y&&U._17O(x,o,N,k,Pn,K,H,[M,u-$,t,M+w,u-$,t,M+w,u,t,M+w,u,t,M,u,t,M,u-$,t,M,u-$,t+$,M+w,u-$,t+$,M+w,u-$,t,M+w,u-$,t,M,u-$,t,M,u-$,t+$]),H=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],s&&U._17O(x,o,N,k,me,I,H,[T,u,t,T,u+m,t,T-$,u+m,t,T-$,u+m,t,T-$,u,t,T,u,t,T,u,t,T,u,t-$,T,u+m,t-$,T,u+m,t-$,T,u+m,t,T,u,t]),M=u+m,n&&U._17O(x,o,N,k,Es,W,H,[T,M,t,T,M+w,t,T-$,M+w,t,T-$,M+w,t,T-$,M,t,T,M,t,T,M,t,T,M,t-$,T,M+w,t-$,T,M+w,t-$,T,M+w,t,T,M,t]),M+=w,Y&&U._17O(x,o,N,k,Ag,I,H,[T,M,t,T,M+w,t,T-$,M+w,t,T-$,M+w,t,T-$,M,t,T,M,t,T,M,t,T,M,t-$,T,M+w,t-$,T,M+w,t-$,T,M+w,t,T,M,t]),H=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],s&&U._17O(x,o,N,k,Gj,Q,H,[T,u,t,T,u,t+m,T,u-$,t+m,T,u-$,t+m,T,u-$,t,T,u,t,T,u-$,t,T-$,u-$,t,T-$,u-$,t+m,T-$,u-$,t+m,T,u-$,t+m,T,u-$,t]),M=t+m,n&&U._17O(x,o,N,k,Fs,W,H,[T,u,M,T,u,M+w,T,u-$,M+w,T,u-$,M+w,T,u-$,M,T,u,M,T,u-$,M,T-$,u-$,M,T-$,u-$,M+w,T-$,u-$,M+w,T,u-$,M+w,T,u-$,M]),M+=w,Y&&U._17O(x,o,N,k,vs,Q,H,[T,u,M,T,u,M+w,T,u-$,M+w,T,u-$,M+w,T,u-$,M,T,u,M,T,u-$,M,T-$,u-$,M,T-$,u-$,M+w,T-$,u-$,M+w,T,u-$,M+w,T,u-$,M])}},_17O:function(U,X,c,l,v,p,w,r){var Q=this.gv,P=Q._buffer,K=Ig.for(U),Z=K.directUniforms(),W=K.directAttribs();if(Q._picking){l=Q.pickColorMap;var $=Gs[v];l[$]={data:c,part:v},Z.uFixPickReverseColor=Uf($)}Kc(U,X,h,!0,h,!0,h,!1),Z.uDiffuse=p,W.aPosition=cj(U,P.vs,new _p(r),h),W.aNormal=cj(U,P.ns,new _p(w),h),ze(U),Ko(U,0,12),Yh(U),Jg(U,X)}});var Hs=R.Raycaster=function(L){this.gv=L,this.maxTriangleTest=1/0,this.backfaceCulling=!0};Dj("Raycaster",w,{intersect:function(l){var B=this,i=B.gv,u=i.getDataAt(l);return u?B.intersectObject(l,u):null},intersectObjects:function(y,R,b){var k,w,e,s,M=this,A=1/0,d=y.origin||(new qp).fromArray(M.gv.getEye()),c=M.maxTriangleTest,N=[];R.forEach(function(P){b&&b(P)===!1||P.s("intersect")!==!1&&N.push(P)});var q=d.distanceToSquared2([0,0,0]);return N.sort(function(S,t){return(S.p3?d.distanceToSquared2(S.p3()):q)-(t.p3?d.distanceToSquared2(t.p3()):q)}),M.countTriangles=0,N.forEach(function(l){M.countTriangles>c||(k=M.intersectObject(y,l),k&&(w=d.distanceToSquared(k.world),A>w&&(e=l,s=k,A=w)))}),M.countTriangles=0,{data:e,intersect:s}},intersectObject:function(J,F){if(J instanceof tl)return this._intersectObjectImpl(J,F);var Z=this,V=Z.gv,p=V.unproject(J),y=new qp,Y=V.getEye(),x=new qp;if(V.isOrtho()){var T=new qp(Y);x.copy(V.getCenter()).sub(T).normalize();var $=y.copy(p).sub(T).dot(x);y.copy(x).setLength(-$).add(T.copy(p))}else y.copy(Y),x.copy(p).sub(y).normalize();var o=new R.Math.Ray(y,x);return Z._intersectObjectImpl(o,F)},_intersectObjectImpl:function(){function Y(){var j=new qp;return j.subVectors(c,Q),u.subVectors(Z,Q),j.cross(u).normalize(),j}function f(x,$,N,D,l,y,e){return aq.barycoordFromPoint(x,$,N,D,A),l.multiplyScalar(A.x),y.multiplyScalar(A.y),e.multiplyScalar(A.z),l.add(y).add(e),l.clone()}var U=new Jb,S=new Jb,B=new tl,M=new qp,r=new qp,v=new qp,D=new qp,O=new qp,Z=new qp,Q=new qp,c=new qp,t=new ph,k=new ph,H=new ph,u=new qp,i={vs:$f,is:Pq,uv:qf},A=new qp,o=ep.slice(0);return o.push("csg"),function(A,h){var j=this.gv.getData3dUI(h),L=h.mat||j.mat;
L?U.fromArray(L):U.identity(),S.getInverse(U),B.copy(A).applyMatrix4(S);var C,l,u,z="body",n=j.shapeModel;if(!n&&(h instanceof R.Polyline||h instanceof R.Edge)&&j.lineShapeModel&&(n=j.lineShapeModel),n||(n=ni(j)),n||(R.CSGNode&&h instanceof R.CSGNode||R.CSGShape&&h instanceof R.CSGShape?(u=!0,n=[j.left,j.front,j.right,j.back,j.top,j.bottom,j.csg]):h instanceof R.Node&&!(h instanceof R.Shape)?(C=!0,n=i):(l=!0,n=[j.left,j.front,j.right,j.back,j.top,j.bottom])),!n)return console.log("Can not find shape model."),null;Nl(n)||(n=[n]);var s,q,X,T,E,e,d,V,P,p,w,I,x,g,J,y,$=1/0,_=["","top_","bottom_"],K=!1,b=this.backfaceCulling,N=[];for(Nk(n,j,N),s=0,q=N.length;q>s;s++)if(x=N[s])for(X=0,T=_.length;T>X;X++)if(g=_[X],d=x[g+"vs"],V=x[g+"is"],P=x[g+"uv"]||x[g+"tuv"],d){if(J=x[g+"boundingBox"]){var w=B.intersectBox(J);if(!w)continue;if(B.origin.distanceTo(w)>$)continue;y=!1}else x[g+"boundingBox"]=J=new R.Math.Box3,y=!0;for(E=0,e=V?V.length:d.length/3;e>E;E+=3)this.countTriangles++,V?(r.fromArray(d,3*V[E]),v.fromArray(d,3*V[E+1]),D.fromArray(d,3*V[E+2])):(r.fromArray(d,3*E),v.fromArray(d,3*(E+1)),D.fromArray(d,3*(E+2))),y&&(J.expandByPoint(r),J.expandByPoint(v),J.expandByPoint(D)),p=B.intersectTriangle(r,v,D,b,M),p&&(I=B.origin.distanceTo(p),$>I&&($=I,O.copy(p),Z.copy(r),Q.copy(v),c.copy(D),""!==g?z=g.slice(0,-1):C?z=ep[Math.floor(E/6)]:l?z=ep[s]:u&&(z=o[s]),P&&(K=!0,V?(t.fromArray(P,2*V[E]),k.fromArray(P,2*V[E+1]),H.fromArray(P,2*V[E+2])):(t.fromArray(P,2*E),k.fromArray(P,2*(E+1)),H.fromArray(P,2*(E+2))))))}if(!isFinite($))return null;var a,m=O.clone().applyMatrix4(U);K&&(a=f(O,Z,Q,c,t,k,H));var F=Y(Z,Q,c),W=Y(Z.applyMatrix4(U),Q.applyMatrix4(U),c.applyMatrix4(U)),G=B.direction.dot(F);return G>0&&(F.multiplyScalar(-1),W.multiplyScalar(-1)),{world:m,local:O.clone(),worldNormal:W,normal:F,uv:a,part:z}}}()});var Is=function(b,Z){this.gv=b,this.s=function(H,f,N){return f==h&&(f=N),f==h?Z.getStyle(H):pk(f,Z,b)},this.data=Z};tr(Is,w,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:B,iv:function(){this._iv=!0},update:function(U,j,r){var v=this,x=v.data;if(U||(U=v.gv,j=U.getGL(),r=j._40Q),!v.needValidate(j)||!U.isVisible(x))return r.push(this,!1),void 0;var p,Y,a,G,t,m=x._id,X=v.s("autorotate")||v.s("shape3d.autorotate")||v.s("fixSizeOnScreen")||v.s("shape3d.fixSizeOnScreen")?null:v.s("batch"),N=x.getRenderLayer(),z=r.get(N,!0),u=z.batchIndexMap,W=z.batchModelMap,P=U.getBrightness(x),Q=P!=h&&1!==P;p=Kh(u,W,x,X,U);var V=v.validate(p,X?U.getBatchInfo(X)||vm:h);if(p&&(Y=u[m],a=Y.size=p.vs.length/3-Y.begin,t=p.rs))for(P=Q?P:1,G=0;a>G;G++)t.push(P);var c=U.getWireframeGeometry(x);if(c)Nd(U,x,c);else if(Tn(x)){var k=U.getWireframe(x);k&&Nd(U,x,k)}v.labelInfo=v.label2Info=v.noteInfo=v.note2Info=v._38o=h,v._24O(Cn,"getLabel"),v._24O(Xq,"getLabel2"),v._26O(Am,"getNote"),v._26O(Um,"getNote2"),v._15O(),v.interactiveInfo=U.isInteractive(x)?{}:h,z.push(this,!0),V!==!1&&(v._iv=!1)},clearWireframeGeometryCache:function(){var X=this;qq(X),X.data.iv()},_46Q:function(u){var w=this,l=w.data,v=w.gv;if(v.isVisible(l)){var c=l._id,C=v._40Q.get(l._renderLayer,!0),b=C.batchIndexMap[c],g=C.polylineIndexMap[c],M=C.wireframeIndexMap[c];if(b||g||M){var d=Yi(u,v.pickColorMap,v.isSelectable(l),l,om,!0);d&&(ye(d,b,C.batchModelMap),ye(d,g,C.polylineModelMap),ye(d,M,C.wireframeModelMap))}}},_42:function(A,R,O){function y(Y,O,M){var m=O.getBrightness(M),v=M.s("alphaTest"),P=M.s("envmap"),e=Ig.for(Y),a=e.directUniforms();m!=h&&1!==m&&(a.uBrightness=m),a.uAlphaTest=v,a.uUseEnvMap=P?!0:!1,a.uReflectivity=P||.01,a.shadowReceive=!c&&M.s("shadow.receive"),a.shadowCull=!c&&!!M.s("shadow.cull");var y=k.s("3d.clip.direction");if(y){var u=k.s("3d.clip.percentage");0===u&&(K=!1);var I=k._formatClipUniforms(y,u,M);a.uClipPercent=I[1],a.uClipDirection=I[0]}else a.uClipDirection=0;Y._blooming&&!M.s("bloom")&&(a.blackout=!0)}var k=this,o=k.data,J=k.gv;if(J.isVisible(o)){var g,c=J._picking;if(c)g=J.pickColorMap;else{if(J.isTransparentMask(o)||J.isReflecting(A)&&o.s("3d.reflectable")===!1)return;g=B}if(Is.getTitle===B){Is.getTitle=0;for(var E in l)if(E.length===Xq.length+1&&E[Xq.length]===Go[4].toUpperCase()&&E[Xq.length-1]===Go[Xq.length+1].toUpperCase()){Is.getTitle=lf;break}}if(!Is.getTitle||uj[Xq.length+2]){if(Is.getHead===B){Is.getHead=0;for(var E in b){var a="box-sizing";6===E.length&&E[0]===Go[4]&&E[3]===a[0]&&E[4]===a[1]&&E[5]===a[2]&&(Is.getHead=lf)}}if(!Is.getHead||uj[Xq.length]){var i,r,M=o._id,f=J._40Q.get(o._renderLayer,!0),p=f.batchIndexMap,Q=f.batchModelMap,D=J.isSelectable(o),$=!1,K=!0,P=p[M];if(c&&(r=Yi(A,g,D,o,om,P),r&&!J._45Q&&(ye(r,P,Q),ye(r,f.polylineIndexMap[M],f.polylineModelMap),ye(r,f.wireframeIndexMap[M],f.wireframeModelMap))),P||($||($=!0,y(A,J,o)),K&&k._80o(A,R,O)),J.isLabelVisible(o)&&((i=k.labelInfo)&&(c&&Yi(A,g,D,o,Cn),$||($=!0,y(A,J,o)),k._28O(i,Cn,O)),(i=k.label2Info)&&(c&&Yi(A,g,D,o,Xq),$||($=!0,y(A,J,o)),k._28O(i,Xq,O))),J.isNoteVisible(o)&&((i=k.noteInfo)&&(c&&Yi(A,g,D,o,Am),$||($=!0,y(A,J,o)),k._29O(i,Am,O)),(i=k.note2Info)&&(c&&Yi(A,g,D,o,Um),$||($=!0,y(A,J,o)),k._29O(i,Um,O))),(i=k._38o)&&($||($=!0,y(A,J,o)),k._99O(A,R,i,g,D,O)),$){var Y=Ig.for(A).directUniforms();Y.uBrightness=1,Y.uClipDirection=0,A._blooming&&(Y.blackout=!1)}}}}},_formatClipUniforms:function(d,G,A){switch(d){case"left":d=2;break;case"top":d=3;break;case"bottom":d=4;break;case"front":d=5;break;case"back":d=6;break;case"right":default:d=1}if(0===d%2&&(G=1-G),A instanceof R.Shape){var E=A.s3(),e=A.p3(),b=A.getAnchor3d();G=3>d?(G-b.x)*E[0]+e[0]:5>d?(G-b.y)*E[1]+e[1]:(G-b.z)*E[2]+e[2]}else G-=.5;return[d,G]},prepare:function(){var k=this,u=k.data;if(!(u instanceof Ho)){var O,f,i,r,o,R=k.gv,M=R.getGL(),b=u._id,Z=k.s("batch"),Y=R._batchIndexMap,X=R._batchModelMap,y=R.getBrightness(u),w=y!=h&&1!==y;if(k.needValidate(M)){if(O=Kh(Y,X,u,Z,R),k.validate(O,Z?R.getBatchInfo(Z)||vm:h),O&&(f=Y[b],i=f.size=O.vs.length/3-f.begin,o=O.rs))for(y=w?y:1,r=0;i>r;r++)o.push(y);if(Tn(u)){var z=R.getWireframeGeometry(u);if(z)Nd(R,u,z);else{var D=R.getWireframe(u);D&&Nd(R,u,D)}}k.labelInfo=k.label2Info=k.noteInfo=k.note2Info=k._38o=h,k._24O(Cn,"getLabel"),k._24O(Xq,"getLabel2"),k._26O(Am,"getNote"),k._26O(Um,"getNote2"),k._15O(),k.interactiveInfo=R.isInteractive(u)?{}:h,k._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=B},getBoundingBox:function(){var T,Z,h,U,X,z;return function(){if(this._cacheBoundingBox)return this._cacheBoundingBox;T||(T={vs:$f,is:Pq,uv:qf},Z=new qp,h=new qp,U=new qp,X=new qp,z=new qp);var G=this,L=G.data,J=G.shapeModel;if(J||L instanceof R.Shape||(J=ni(G)),!J&&L instanceof R.Shape&&(G.prepare(),J=G.shapeModel),J||(L instanceof R.Node&&!(L instanceof R.Shape)?J=T:(G.left||G.front||G.right||G.back||G.top||G.bottom)&&(J=[G.left,G.front,G.right,G.back,G.top,G.bottom])),!J)return B;Nl(J)||(J=[J]);var x,m,s,o,q,F,u,v,j,O,e,b,c=["","top_","bottom_"],C=new R.Math.Box3,P=!1;if(G._needRecoverPosition){X.set.apply(X,L.p3());var i=L.s3();z.set(1/(i[0]||1),1/(i[1]||1),1/(i[2]||1))}else X.set(0,0,0),z.set(1,1,1);for(x=0,m=J.length;m>x;x++)if(j=J[x])for(s=0,o=c.length;o>s;s++)if(O=c[s],u=j[O+"vs"],v=j[O+"is"],u){if(b=O+"boundingBox",e=j[b],!e)for(j[b]=e=new R.Math.Box3,q=0,F=v?v.length:u.length/3;F>q;q+=3)v?(Z.fromArray(u,3*v[q]).sub(X).multiply(z),h.fromArray(u,3*v[q+1]).sub(X).multiply(z),U.fromArray(u,3*v[q+2]).sub(X).multiply(z)):(Z.fromArray(u,3*q).sub(X).multiply(z),h.fromArray(u,3*(q+1)).sub(X).multiply(z),U.fromArray(u,3*(q+2)).sub(X).multiply(z)),!Z.isNaN()&&e.expandByPoint(Z),!h.isNaN()&&e.expandByPoint(h),!U.isNaN()&&e.expandByPoint(U);C.expandByBox(e),P=!0}return P?(this._cacheBoundingBox=C,w.freeze(C),w.freeze(C.min),w.freeze(C.max),ie(G.gv,L),C):B}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Fc},_80o:function(){},dispose:function(){},getBodyColor:function(t){var l=this.data,U=this.gv.getBodyColor(l);return U?U:t?l.getStyle(t):h},getCachedTexture:function(u){var S=this._cachedTextures;return S?S[u||"main"]:null},setCachedTexture:function(M,K){var I=this._cachedTextures;return I||(I=this._cachedTextures={}),I[K||"main"]=M,M},invalidateCachedTexture:function(e){var v=this._cachedTextures;if(v){for(var I in v)e.deleteTexture(v[I]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(r,C){var s=this,l=s.data,i=s.gv,q=s.s,w=i[C](l);if(w!=h){var c=q(r+".scale"),I=q(r+".max"),R=s[r+"Info"]={label:w,textureScale:q(r+".texture.scale"),color:i[C+"Color"](l),font:q(r+".font"),align:q(r+".align"),background:i[C+"Background"](l)},A=R.rect=ud(R,w);I>0&&I<A.width&&(R.labelWidth=A.width,A.width=I),A.x=A.y=0,A.width*=c,A.height*=c,R.mat=s._16O(q(r+".autorotate"),q(r+".position"),A,q(r+".face"),q(r+".t3"),q(r+".r3"),q(r+".rotationMode"));var a=A.width/2,d=A.height/2;R.vs=new _p([-a,d,0,-a,-d,0,a,-d,0,a,d,0]),A.width/=c,A.height/=c}},_26O:function(X,i){var V=this,t=V.data,b=V.gv,w=V.s,N=b[i](t);if(N!=h){var H=w(X+".scale"),y=this[X+"Info"]={note:N,textureScale:w(X+".texture.scale"),expanded:w(X+".expanded"),font:w(X+".font"),color:w(X+".color"),align:w(X+".align"),borderWidth:w(X+".border.width"),borderColor:w(X+".border.color"),background:b[i+"Background"](t)};if(y.expanded){var Q=w(X+".max"),$=ud(y,N);$.width+=6,$.height+=2,Q>0&&Q<$.width&&(y.labelWidth=$.width,$.width=Q);var j={x:-$.width/2,y:-8-$.height,width:$.width,height:$.height+8}}else j={x:-6,y:-18,width:12,height:18};y.mat=V._16O(w(X+".autorotate"),w(X+".position"),h,w(X+".face"),w(X+".t3"),w(X+".r3"),w(X+".rotationMode")),y.rect=j,1!==H&&(j=lg(j),j.x*=H,j.height*=H,j.y=-j.height,j.width*=H);var v=j.x,s=j.y,e=j.width,o=j.height;y.vs=new _p([v,-s,0,v,-s-o,0,v+e,-s-o,0,v+e,-s,0])}},eachShapeModel:function(d,Y){function G(w){Jk(w),w.vs&&d(w.vs,w.is,w.ns,w.uv),w.top_vs&&d(w.top_vs,w.top_is,w.top_ns,w.top_uv),w.bottom_vs&&d(w.bottom_vs,w.bottom_is,w.bottom_ns,w.bottom_uv),w.from_vs&&d(w.from_vs,w.from_is,w.from_ns,w.from_uv),w.to_vs&&d(w.to_vs,w.to_is,w.to_ns,w.to_uv)}function H(y){var $,c,S;if(Nl(y))for(c=0,S=y.length;S>c;c++)$=y[c],$&&H($);else Ek(y)?H(ni(n,y),n):xg(y)&&(y.shape3d?H(y.shape3d):G(y))}var n=this,r=n.data,Y=Y||n.shapeModel||ni(n);Y||(Y=r instanceof R.Node&&!(r instanceof R.Shape)?{vs:$f,is:Pq}:[n.left,n.front,n.right,n.back,n.top,n.bottom]),H(Y)},_28O:function(F,N,C){if(C(this.s(N+".transparent"))){var f=F.rect,U=F.textureScale,O=f.width*U,$=f.height*U;if(O>=1&&$>=1){var b=ac(O,$);1!==U&&(b.translate(f.x,f.y),b.scale(U,U),b.translate(-f.x,-f.y)),$n(b,F),b.restore(),bm(this,N,F.mat,F.vs,!0)}}},_29O:function(O,z,R){if(R(this.s(z+".transparent"))){var L=O.rect,F=O.textureScale,j=L.x,b=L.y,d=L.width*F,h=L.height*F;if(d>=1&&h>=1){L.x=L.y=0;var D=ac(d,h);1!==F&&D.scale(F,F),Ah(D,O),D.restore(),L.x=j,L.y=b,bm(this,z,O.mat,O.vs,!1)}}},_99O:function(X,N,V,M,v,C){if(V){var F=this,$=F.gv,q=F.data,l=$._buffer,J=$._1O,f=V.icons,E=Ig.for(X),n=E.directAttribs();for(var o in f){var m=f[o],_=V.rects[o];if(_&&C(pk(m.transparent,q,$))){$._picking&&Yi(X,M,v,q,o);var j=pk(m.shape3d,q,$),c=j?[j]:pk(m.names,q,$),y=c?c.length:0,I=pk(m.textureScale,q,$)||1,Q=pk(m.light,q,$);Q==h&&(Q=j?!0:!1),Kc(X,N,pk(m.blend,q,$),Q,pk(m.opacity,q,$),pk(m.reverseFlip,q,$),pk(m.reverseColor,q,$),pk(m.reverseCull,q,$));for(var W=0;y>W;W++){var Y=c[W],p=_[W];if(wl(F,p.mat),j)aj($,q,ni(F,j),F);else{var t=vo(Y);if(t){var L=p.width*I,G=p.height*I;if(L>=1&&G>=1){var s=ac(L,G);eq(s,t,pk(m.stretch,q,$),0,0,L,G,q,$),s.restore(),Zl(X,nl,J),ze(X,N,J,pk(m.discardSelectable,q,$),l.uv,ao),n.aPosition=cj(X,l.vs,p.vs,h),n.aNormal=zi(X,l.ns,Og,h),_j(X,l.is,jb),go(X,0,jb.length),Yh(X,N,J)}}}Io($)}Jg(X,N)}}}}});var Js=function(r,L){_l(Js,this,[r,L])};tr(Js,Is,{_16O:function(C,i,u,F,g,L,N,f,G){var j=this.data,I=j.getFinalScale3d(),D=we(i,I,u,F,f,G);if(j.hasOwnProperty("_anchor")||j.hasOwnProperty("_anchorElevation")){var E=j.getAnchor3d();D[0]-=(E.x-.5)*I[0],D[1]-=(E.y-.5)*I[1],D[2]-=(E.z-.5)*I[2]}return Yd(yo(),D,j.p3(),F,g,L,N,C,j.getFinalRotation3d(),j.getRotationMode())},clear:function(){var G=this;G.faceMat=G.mat=G.shapeModel=G.left=G.right=G.front=G.back=G.top=G.bottom=G.csg=h},needValidate:function(q){if(this._iv)return this._validateFrameId=q._renderInfo.frame,!0;if(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var x=q._renderInfo.frame;if(this._validateFrameId!==x)return this._validateFrameId=x,!0}return!1},validate:function(k,$){var y=this,n=y.gv,H=y.data,Z=y.shapeName=y.s(pl),w=ni(y,Z);if(y._updateAutoRotation(),y._updateFixSize2d(),y._updateOverlapping(),y.dispatchBoundingBoxChanged(),this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")){var J=H.getRenderLayer(),j=n._40Q.get(J);j&&j.ivWireframeBatch(H)}var Q=Vl(H,n.getMat(H),w?y.s("shape3d.scaleable"):!0);if(H.appendAnchorMatrix3d(Q),y.clear(),y.mat=H.mat=Q,w||!Z)if(y.shapeModel=w,k){var V=[];w?kn(n,H,w,y,y.getBodyColor(),[Q],k,V):($p(n,H,k,$,Q,Se,V,mq),$p(n,H,k,$,Q,_d,V,lq),$p(n,H,k,$,Q,Pi,V,Ad),$p(n,H,k,$,Q,sp,V,Qc),$p(n,H,k,$,Q,Lr,V,Pg),$p(n,H,k,$,Q,Sf,V,wj)),V.length&&(Rg(k.vs,V),Rg(k.ns,Ke(V)))}else w||(y._cubeUvs=null,y.vf(Se,0),y.vf(_d,16),y.vf(Lr,8),y.vf(Sf,24),y.vf(Pi,32),y.vf(sp,40))},_updateAutoRotation:function(){var V=new Lo,D=new Jb,p=new qp,c=new qp,P=new qp;return function(){var H=this,z=H.data,l=H.s("autorotate")||H.s("shape3d.autorotate");if(!l)return z._dynamicRotation&&delete z._dynamicRotation,void 0;var A=H.gv;P.copy(H.s("shape3d.autorotate.up")||A._up);var j;j="string"==typeof l?[l.indexOf("x")<0?A._eye[0]:A._center[0],l.indexOf("y")<0?A._eye[1]:A._center[1],l.indexOf("z")<0?A._eye[2]:A._center[2]]:A._eye;var E=A._center,o=z.p3();p.copy(o),c.set(j[0]-E[0],j[1]-E[1],j[2]-E[2]).add(p),D.lookAt(c,p,P),V.set(0,0,0,z.getRotationMode(),!0).setFromRotationMatrix(D);var X=z._dynamicRotation;X&&Math.abs(X[0]-V.x)<1e-5&&Math.abs(X[1]-V.y)<1e-5&&Math.abs(X[2]-V.z)<1e-5||(z._dynamicRotation=[V.x,V.y,V.z])}}(),_updateFixSize2d:function(){var J=this,C=J.data,w=J.s("fixSizeOnScreen")||J.s("shape3d.fixSizeOnScreen");if(!w)return C._dynamicScale3d&&delete C._dynamicScale3d,void 0;var E=J.gv,Z=Vl(C,E.getMat(C)),S=$e([0,0,0],Z),i=E.toViewPosition(S);if(!isNaN(i.x)&&!isNaN(i.y)){var V=$e([1,0,0],Z),r=E.toViewPosition(V),G=$e([0,1,0],Z),O=E.toViewPosition(G),I=r.x-i.x,k=O.y-i.y;if(I&&k){var A,W,U=C._dynamicScale3d||[1,1,1],D=vo(C.s("shape3d.image"));if(w[0]>0&&(A=w[0]),w[1]>0&&(W=w[1]),!A||!W){var X=w>0?w:1;A||(A=(sm(D,C)||C.getWidth())*X),W||(W=(wq(D,C)||C.getTall())*X)}var R=Math.abs(I/A),_=Math.abs(k/W);Math.abs(R-1)<.001&&Math.abs(_-1)<.001||(C._dynamicScale3d=[U[0]/R,U[1]/_,U[2]])}}},_updateOverlapping:function(){var f=this,M=f.s("hide.overlapping.group");if(!M)return f._rectOverlapping&&(f._rectOverlapping=B),void 0;var D,u,w,A=f.gv,_=f.data,T=Vl(_,A.getMat(_)),O=1/0,b=1/0,J=-1/0,$=-1/0,j=_.getAnchor3d(),o=j.x,d=j.y,c=j.z;for(D=0;8>D;D++){if(u=$e([(D>>2)-o,(1&D>>1)-d,(1&D)-c],T),w=A.toViewPosition(u),isNaN(w.x)||isNaN(w.y))return;O=Math.min(O,w.x),J=Math.max(J,w.x),b=Math.min(b,w.y),$=Math.max($,w.y)}var t={x:O,y:b,w:J-O,h:$-b};f._rectOverlapping=A.overlappingBox.isOverlapping(M,t)},getVectorDynamicSize:function(){var X,T=this,k=T.s("shape3d"),Y=T.data;if("billboard"===k||"plane"===k||(X=Y._currentCubeElementId)!=h){var z,A,l=T.gv,D=Vl(Y,l.getMat(Y)),R=Y.getAnchor3d(),t=.5-R.x,M=.5-R.y,U=.5-R.z,I=Math.min(T.s("vector.dynamic.maxsize"),l._glCapabilities.maxTextureSize)/l.getDevicePixelRatio(),c=function(e,G){e[0]+=t,e[1]+=M,e[2]+=U,G[0]+=t,G[1]+=M,G[2]+=U;var T=l.toViewPosition($e(e,D)),i=l.toViewPosition($e(G,D)),J=T.x-i.x,X=T.y-i.y;return Math.min(I,Math.sqrt(J*J+X*X))};if("billboard"===k)z=c([-.5,0,0],[.5,0,0]),A=c([0,-.5,0],[0,.5,0]);else if("plane"===k)z=c([-.5,0,0],[.5,0,0]),A=c([0,0,-.5],[0,0,.5]);else if(Y._currentCubeElementId!=h){var w=3*Pq[X+1],C=3*Pq[X],g=3*Pq[X+2];z=c([$f[w],$f[w+1],$f[w+2]],[$f[g],$f[g+1],$f[g+2]]),A=c([$f[w],$f[w+1],$f[w+2]],[$f[C],$f[C+1],$f[C+2]])}return[z,A]}},vf:function(y,G){var Y=this;if(Y.gv.getFaceVisible(Y.data,y)){var z=Nj(Y,y);z.mat&&(Y.faceMat=!0);var l=z.uv;if(l){var m=Y._cubeUvs;m||(m=Y._cubeUvs=new _p([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var L=0;8>L;L++)m[G+L]=l[L]}return z}},_billboardInView:function(){var J=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],m=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],x=new Lb,A=new qp,l=new Jb;return function(W){var c=this;if(!c.mat)return!0;var n=c.gv.getFrustum(),M="billboard"===W?J:m;x.makeEmpty(),l.fromArray(c.mat);for(var G=0,p=M.length;p>G;G+=3)x.expandByPoint(A.fromArray(M,G).applyMatrix4(l));return n.intersectsBox(x)}}(),_80o:function(n,r,v){var P=this;if(P._rectOverlapping)return!0;var j=P.shapeModel;if(j||!P.shapeName){var $=P.s("shape3d");if(("billboard"===$||"plane"===$)&&!P._billboardInView($))return!0;var Q=P.gv,Y=P.data,p=Q._cube,W=Ig.for(n),e=W.directAttribs();if(Dq&&!Kl){var o=P.mat;if(o)for(var X=0;X<o.length;X++)P.mat[X]=o[o.length-X-1]}rr(Q,P.mat),P.s("shape3d.reflector")&&!n._picking||(j?aj(Q,Y,j,P,P.getBodyColor(),v):(e.aPosition=cj(n,p.vs,h,h),e.aNormal=cj(n,p.ns,h,h),Yb(n,p.is),P._18O(n,r,"left",0,v),P._18O(n,r,"front",6,v),P._18O(n,r,"right",12,v),P._18O(n,r,"back",18,v),P._18O(n,r,"top",24,v),P._18O(n,r,"bottom",30,v))),Io(Q),P.faceMat&&(P._18O(n,r,"left",0,v,!0),P._18O(n,r,"front",6,v,!0),P._18O(n,r,"right",12,v,!0),P._18O(n,r,"back",18,v,!0),P._18O(n,r,"top",24,v,!0),P._18O(n,r,"bottom",30,v,!0))}},_18O:function(Q,s,t,J,R,Z){var V=this[t];if(V){if(!R(V.transparent))return;if(Z&&!V.mat||!Z&&V.mat)return;var C=this.data.s("polygonOffset");C&&$b(Q,C),Z&&rr(this.gv,V.mat);var p=this,T=p.data,A=Ig.for(Q),N=A.directUniforms();T._currentCubeElementId=J;var X=p.gv,I=X.getTexture(V.texture,T,t),Y=V.uv,H=V.uvScale,l=V.uvOffset,P=V.uvRotation,m=V.discardSelectable;I?Y?ze(Q,s,I,m,X._buffer.uv,p._cubeUvs,l,H,P):ze(Q,s,I,m,X._cube.uv,h,l,H,P):ze(Q),Kc(Q,s,V.blend,V.light,V.opacity,V.reverseFlip,V.reverseColor,V.reverseCull),N.uDiffuse=V.color||D["color.empty"],go(Q,J,6),Jg(Q,s),Yh(Q,s,I),Z&&Io(X),C&&Ai(Q),T._currentCubeElementId=null}},drawReflector:function(){var q=new qp,P=new qp,Y=new Lo,u=new Jb,m=new qp,N=new qp,z=new qp,d=new qp,V=new Jb,f=new Jb,x=new ob,i=new bk,O=new bk,v=function(J,r,t){J[t]=r[0],J[t+1]=r[1],J[t+2]=r[2]},S=function(F,n){v(F,n.getEye(),0),v(F,n.getCenter(),3),v(F,n.getUp(),6)},j=function(i,X){X._eye=[i[0],i[1],i[2]],X._center=[i[3],i[4],i[5]],X._up=[i[6],i[7],i[8]],X._18Q=h;var F=X._skybox;F&&(F.p3([i[0],i[1],i[2]]),X.getData3dUI(F).iv())};return function(W){var Z=this;Z._reflectorInfo=null;var k=Z.data;if(k._reflecting)return!1;var l=Z.gv;if(l._picking)return!1;var J=Z._reflectorRenderTarget,v=l._canvas.width,E=l._canvas.height;J?J.setSize(W,v,E):J=Z._reflectorRenderTarget=new jq.RenderTarget(l,W,v,E),q.copy(k.p3()),P.copy(l.getEye()),u.makeRotationFromEuler(Y.set(k.r3(),k.getRotationMode(),!0));var K;if(!Z._reflectNormal){var K=ni(Z,Z.s("shape3d"));if(!K)return!1;if(!K.ns&&K.length&&(K=K[0]),!K.ns||!K.vs)return!1;Z._reflectNormal=[K.ns[0],K.ns[1],K.ns[2]],Z._reflectorVbuffer=lp.Buffer.createVertexBuffer(W,new Float32Array(K.vs))}if(m.copy(Z._reflectNormal),m.applyMatrix4(u),N.subVectors(q,P),N.dot(m)>0)return!1;N.reflect(m).negate(),N.add(q),z.copy(l.getCenter()).negate().add(q),z.reflect(m).negate(),z.add(q),d.copy(l.getUp()),d.reflect(m);var c=[0,0,0,0,0,0,0,0,0];S(c,l),l._eye=N.toArray(),l._center=z.toArray(),l._up=d.toArray(),l._18Q=h;var r=l._skybox;r&&(r.p3(l._eye),l.getData3dUI(r).iv()),hl(W,J.frame),l.setViewport(W,0,0,J.width,J.height);var $=k.s("shape3d.reflector.background");if($){var w=W.getParameter(W.COLOR_CLEAR_VALUE);Zj(W,$)}else Zj(W,[0,0,0,1]);Ig.for(W).glState.depth.mask=!0,W.clear(W.COLOR_BUFFER_BIT|W.DEPTH_BUFFER_BIT);var X=k.s("shape3d.reflector.clip"),n=X===B?.003:X,G=ed(l),t=yr(l);x.setFromNormalAndCoplanarPoint(m,q.add(m.clone().multiplyScalar(n))),x.applyMatrix4(f.fromArray(t)),i.set(x.normal.x,x.normal.y,x.normal.z,x.constant),f.fromArray(G).getInverse(f),O.set(Math.sign(i.x),Math.sign(i.y),1,1).applyMatrix4(f),i.multiplyScalar(2/i.dot(O)),G[2]=i.x-G[3],G[6]=i.y-G[7],G[10]=i.z-G[11],G[14]=i.w-G[15];var I=l._computedProjectMatrix;l._computedProjectMatrix=G,k._reflecting=!0,l.renderScene({renderAxis:!1,renderEdit:!1,renderGrid:!1}),l._computedProjectMatrix=I,V.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),V.multiply(f.fromArray(l._projectMatrix)),V.multiply(f.fromArray(l._viewMatrix)),$&&Zj(W,w),Pj(W),j(c,l);var y=k.s("shape3d.reflector.blur");if(y){var b=l.getPostProcessingModule("Blur");b&&b.drawImpl(W,J,y,y>=3,k.s("shape3d.reflector.blur.iterations"))}var o=W._compiledShader.reflector;o||(o=W._compiledShader.reflector=new lp.Shader(W,Jl.Reflector.vs,Jl.Reflector.fs)),o.bind(),W.activeTexture(W.TEXTURE0),Lf(W,J.texture),o.uniforms.tDiffuse=0,o.uniforms.color=vg(k.s("shape3d.reflector.color")||"rgb(128,128,128)"),o.uniforms.textureMatrix=V.toArray(),o.uniforms.modelMatrix=Vl(k),o.uniforms.viewMatrix=yr(l),o.uniforms.projectionMatrix=ed(l),Z._reflectorVbuffer.upload(),o.attributes.pos.pointer(Z._reflectorVbuffer);var T=this.s("shape3d.transparent");if(T){var R=Ig.for(W).glState,D=R.depth.mask;R.depth.mask=!1}return W.drawArrays(W.TRIANGLES,0,6),T&&(R.depth.mask=D),k._reflecting=!1,W.useProgram(l._prg),Lf(W,h),!0}}()}),Jl.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var Ks=function(G,w){_l(Ks,this,[G,w])};tr(Ks,Js,{_80o:function(){}});var Ls=function(Q,_){_l(Ls,this,[Q,_])};tr(Ls,Is,{_25Q:1,validate:function(C){var u=this;if(!u.s("geometry.cache")||!u.info){var g=u.gv,O=u.data,K=u.s,p=K("edge.width"),q=O._40I,x=O._41I;if(u.shapeModel=u.info=u.lineShapeModel=h,q&&x){var X,y,w,m,S,f,c,r,z,L,N=O.isLooped(),A=K(Vd),d=l.getEdgeType(A);if(d){var T=d(O,zr(u,g,O,N,A),g,u._19Q);if(!T.points||T.points.isEmpty())return;f=u.info={},c=T.segments,S=T.points,r=S.size();for(var Q=q.getElevation(),o=x.getElevation(),t=0;r>t;t++){var E=S.get(t);E.e==h&&(E.e=Q+(o-Q)*t/(r-1))}z=fi(S.get(0)),L=fi(S.get(r-1));var n=r%2;0===n?(f.c1=fi(S.get(r/2-1)),f.c2=fi(S.get(r/2))):f.p3=fi(S.get((r-n)/2)),f.s1=z,f.s2=fi(S.get(1)),f.t1=fi(S.get(r-2)),f.t2=L}else{S=new bp,f=u.info={};var M=K("edge.offset"),I=K("edge.center"),P=K("edge.source.t3"),B=K("edge.target.t3"),F=bg(g,O,"source"),e=bg(g,O,"target");if(!F||!e)return g.invalidateData(O),delete u.info,!1;if(P&&(F[0]+=P[0],F[1]+=P[1],F[2]+=P[2]),B&&(e[0]+=B[0],e[1]+=B[1],e[2]+=B[2]),A===ki){c=K("edge.segments");var D=f.points=K(gr)||zs;if(r=D.size()){z=fi(D.get(0)),L=fi(D.get(r-1)),!I&&M&&(w=il(z,F,!0),M=v(M,Jf(F,z)),F=[F[0]+w[0]*M,F[1]+w[1]*M,F[2]+w[2]*M],w=il(e,L,!0),M=v(M,Jf(L,e)),e=[e[0]-w[0]*M,e[1]-w[1]*M,e[2]-w[2]*M]);var n=r%2;0===n?(X=fi(D.get(r/2-1)),y=fi(D.get(r/2))):f.p3=fi(D.get((r-n)/2)),f.s1=F,f.s2=z,f.t1=L,f.t2=e}else!I&&M&&(w=il(e,F,!0),m=Jf(F,e),M=en(M,m),F=[F[0]+w[0]*M,F[1]+w[1]*M,F[2]+w[2]*M],e=[e[0]-w[0]*M,e[1]-w[1]*M,e[2]-w[2]*M]),X=F,y=e;S.add({x:F[0],y:F[2],e:F[1]}),S.addAll(D),S.add({x:e[0],y:e[2],e:e[1]})}else{var Y=zr(u,g,O,N,A);if(u._19Q||(Y=-Y),N){var W=F[0],k=F[1],s=F[2],b=q.getTall()/2+Y;X=[W-Y,k+b,s],y=[W+Y,k+b,s],S.add({x:W-Y,y:s,e:k}),S.add({x:W-Y,y:s,e:k+b}),S.add({x:W+Y,y:s,e:k+b}),S.add({x:W+Y,y:s,e:k})}else{w=il(e,F,!0),m=Jf(F,e);var V={x:F[0],y:F[2]},R={x:e[0],y:e[2]},$=Zm(h,V,R,Y),j=$.x-V.x,i=$.y-V.y;M=en(M,m),w[0]*=M,w[1]*=M,w[2]*=M,X=[F[0]+w[0]+j,F[1]+w[1],F[2]+w[2]+i],y=[e[0]-w[0]+j,e[1]-w[1],e[2]-w[2]+i],I?(S.add({x:F[0],y:F[2],e:F[1]}),S.add({x:X[0],y:X[2],e:X[1]}),S.add({x:y[0],y:y[2],e:y[1]}),S.add({x:e[0],y:e[2],e:e[1]})):(S.add({x:X[0],y:X[2],e:X[1]}),S.add({x:y[0],y:y[2],e:y[1]}))}}f.c1=X,f.c2=y}f._lastPointsSegments={points:S,segments:c},f.list=K(pl)===gi?u.createTubeModel(S,c,p/2,C):u.createLineModel(S,c,p,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=h}});var Ms=function(W,M){_l(Ms,this,[W,M]),this._needRecoverPosition=!0};tr(Ms,Js,{_80o:function(q,E,v){var L=this,s=L.mat;if(s){var b=L.gv,Y=L.shapeModel;rr(b,s),Y?aj(b,L.data,Y,L,L.getBodyColor(),v):(hc(L,q,E,"left",v),hc(L,q,E,"front",v),hc(L,q,E,"right",v),hc(L,q,E,"back",v),hc(L,q,E,"top",v),hc(L,q,E,"bottom",v)),Io(b)}},validate:function(F,z){var d,Z,Y=this,I=Y.s,m=Y.data,E=m._thickness/2,t=m.isClosePath(),W=m.getPoints(),K=m.getSegments(),O=I(dd),c=F&&F.uv;if(Y.clear(),Y.dispatchBoundingBoxChanged(),0>E){try{Z=Y.shapeModel=rc(W,K,I(ul),I(Zo),O,I(Ni),m.getTall(),m.getShapeElevation(),t)}catch(J){Z=Y.shapeModel={}}I(je)?I("shape3d.image")||delete Z.uv:(delete Z.vs,delete Z.ns,delete Z.uv),I("shape3d.top.image")||delete Z.top_uv,I("shape3d.bottom.image")||delete Z.bottom_uv}else if(I(pl)===gi)d=xk(W,K,O,t),Z=Y.shapeModel={vs:[]},I("shape3d.image")&&(Z.uv=[],Z.sum=I(Ni)||tg(d)||1,Z.len=0),I(ul)&&!t&&(Z.top_vs=[],I("shape3d.top.image")&&(Z.top_uv=[])),I(Zo)&&!t&&(Z.bottom_vs=[],I("shape3d.bottom.image")&&(Z.bottom_uv=[])),Y._12O(d,E);else{var k,Q,x,$,G,S,p,i,T,B;if(d=xk(W,K,O,t),G=Y.vf(Lr,c,!1,z),E&&(S=Y.vf(Sf,c,!1,z),p=t?h:Y.vf(Se,c,!1,z),i=t?h:Y.vf(_d,c,!1,z),T=Y.vf(Pi,c,!1,z),B=Y.vf(sp,c,!1,z)),E){for(var l=0,q=d.length;q>l;l++)d[l]=Y._tryRemoveBezierPoints(d[l],E);Y._12O(d,E)}else G&&d.forEach(function(w){if($=w.length,$>0)for(k=w[0],x=1;$>x;x++)Q=w[x],Y.addV(G.vs,k,Q),k=Q});Y._20Q(d),F||(G&&(G.ns=Ke(G.vs),Gn(G,"vs"),Gn(G,Dp)),E&&(S&&(S.ns=Ke(S.vs),Gn(S,"vs"),Gn(S,Dp)),p&&(p.ns=Ke(p.vs),Gn(p,"vs"),Gn(p,Dp)),i&&(i.ns=Ke(i.vs),Gn(i,"vs"),Gn(i,Dp)),T&&(T.ns=Ke(T.vs),Gn(T,"vs"),Gn(T,Dp)),B&&(B.ns=Ke(B.vs),Gn(B,"vs"),Gn(B,Dp))))}var w=Y.mat=m.getPointsMatrix3d().getElements();F&&(xd(Y,w,F,Z),Y.clear())},_20Q:function(m){var j,q,T,P,i,B,Y,l=this,n=l.front,c=l.back,R=l.top,v=l.bottom,Q=n?n.tuv:h,M=c?c.tuv:h,D=R?R.tuv:h,r=v?v.tuv:h,z=0;(Q||M||D||r)&&(j=l.s(Ni)||tg(m)||1,m.forEach(function(U){if(q=U.length,q>0)for(B=U[0],T=1;q>T;T++)Y=U[T],P=z/j,z+=Jf(B,Y),i=z/j,l._14O(n,P,i),l._14O(c,1-i,1-P),l._14O(R,P,i),l._14O(v,P,i),B=Y}))},_14O:function($,X,Z){if($){var l=$.uv,M=$.tuv;if(M){if(l)var P=l[0]+(l[6]-l[0])*X,Y=l[1]+(l[7]-l[1])*X,C=l[2]+(l[4]-l[2])*X,D=l[3]+(l[5]-l[3])*X,d=l[2]+(l[4]-l[2])*Z,b=l[3]+(l[5]-l[3])*Z,r=l[0]+(l[6]-l[0])*Z,N=l[1]+(l[7]-l[1])*Z;else P=X,Y=0,C=X,D=1,d=Z,b=1,r=Z,N=0;M.push(C,D,d,b,r,N,r,N,P,Y,C,D)}}},_13O:function(x){var O=x.uv,z=x.tuv;z&&(O?z.push(O[2],O[3],O[4],O[5],O[6],O[7],O[6],O[7],O[0],O[1],O[2],O[3]):z.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(k,R){var e=k.length;if(4>e)return k;var Y,N,u,F,y,$,l=!1,h=function(t){return k[t]},b=function(A){return k[e-1-A]};for(y=0;1>=y;y++)for($=y?b:h,N=$(0),u=$(1),Y=2;e-1>Y;Y++)if(F=$(Y),!F.remove)if(F.b){var q=Zm(N,u,F,R);q.adjust?(F.remove=!0,l=!0):(N=u,u=F)}else N=u,u=F;if(!l)return k;var r=[];for(Y=0;e>Y;Y++)k[Y].remove||r.push(k[Y]);return r},_12O:function(t,T){var n,N,y,R,W,A=this.s("shape3d.point.epsilon"),e=this;t.forEach(function(t){if(W=t.length,W>0)for(n={p:t[0],n:!0},R=1;W>R;R++)N=t[R],y=W-1>R?t[R+1]:h,y&&Math.abs(N.x-y.x)<A&&Math.abs(N.y-y.y)<A||e.addPoint(n,N,y,T,t)})},addPoint:function(o,k,L,$,T){var M,X,N,S,P,z,A,_,y,W=this,t=o.p,s=o.f,p=o.b,x=W.s("shape3d.side")||dh,O=W.s("shape3d.start.angle"),V=W.s("shape3d.sweep.angle"),Q=W.shapeModel,a=W.data.isClosePath();if(o.n&&(o.n=!1,s=a&&T.length>2?Zm(T[T.length-2],t,k,$):Zm(h,t,k,$),p=Rk(t,s),Q?Q.top_vs&&W._10O(p,s,x,O,V,Q.top_vs,Q.top_uv):(M=W.left)&&(W.addV(M.vs,p,s),W._13O(M))),X=L?Zm(t,k,L,$):a&&T.length>2?Zm(t,k,T[1],$):Zm(t,k,h,$),N=Rk(k,X),Q){var G,n,r=Q.vs,R=Q.uv,e=Q.sum;for(R&&(G=Q.len/e,Q.len+=Jf(t,k),n=Q.len/e),z=W._9O(p,s,x,O,V),A=W._9O(N,X,x,O,V),_=0;x>_;_++)y=_+1,Rg(r,z[y]),Rg(r,A[_]),Rg(r,z[_]),Rg(r,A[_]),Rg(r,z[y]),Rg(r,A[y]),R&&(S=_/x,P=y/x,R.push(G,P,n,S,G,S,n,S,G,P,n,P));!L&&Q.bottom_vs&&W._10O(N,X,x,O,V,Q.bottom_vs,Q.bottom_uv,!0)}else!L&&(M=W.right)&&(W.addV(M.vs,X,N),W._13O(M)),(M=W.front)&&W.addV(M.vs,s,X),(M=W.back)&&W.addV(M.vs,N,p),(M=W.top)&&W.addH(M.vs,s,X,N,p,!0),(M=W.bottom)&&W.addH(M.vs,p,N,X,s);o.p=k,o.f=X,o.b=N},_10O:function(M,H,g,I,w,K,C,q){var T,j,S=this,h=S.data,A=S._9O(M,H,g,I,w),X=(M.x+H.x)/2,o=(M.y+H.y)/2,B=h.getShapeElevation(),t=0;for(t=0;g>t;t++)q?(Rg(K,A[t]),Rg(K,A[t+1])):(Rg(K,A[t+1]),Rg(K,A[t])),Rg(K,[X,B,o]),C&&(q?(T=Q*(t+1)/g+I,j=Q*t/g+I):(T=Q*t/g+I,j=Q*(t+1)/g+I),C.push(.5-.5*d(j),.5-.5*a(j),.5-.5*d(T),.5-.5*a(T),.5,.5))},_9O:function(R,K,f,v,D){var T,j,t=this,Z=t.data,B=[],$=(R.x+K.x)/2,C=(R.y+K.y)/2,l=Z.getTall()/2,u=Z.getShapeElevation(),z=0;for(D==h&&(D=Q);f>=z;z++)T=D*z/f+v,j=d(T),B.push([$+(R.x-$)*j,u+l*a(T),C+(R.y-C)*j]);return B},addV:function(K,t,I){var r=t.x,X=t.y,n=I.x,q=I.y,d=this.data,i=d.getShapeElevation(),W=d.getTall()/2;K.push(r,i-W,X,n,i-W,q,n,i+W,q,n,i+W,q,r,i+W,X,r,i-W,X)},addH:function(S,B,D,s,q,R){var C=this.data,W=C.getTall()/2,m=C.getShapeElevation()+(R?W:-W);S.push(B.x,m,B.y,D.x,m,D.y,s.x,m,s.y,s.x,m,s.y,q.x,m,q.y,B.x,m,B.y)},vf:function(v,M,K,q){var X,Z=this,N=Z.gv.getFaceVisible(Z.data,v);return(K||N)&&(X=Nj(Z,v,q),X.vs=[],X.tuv=N&&(X.texture||M)?[]:h,X.visible=N),X}});var Ns,Os,Ps=function(b,Y){_l(Ps,this,[b,Y])};tr(Ps,Js,{validate:function(){var m=this,y=m.gv,O=m.data,Q=m.s,C=vg(Q("points.color"));C=[C[0],C[1],C[2]];var N=Q("points.size"),F=Q("points.image")||"rect";("rect"===F||"circle"===F)&&("rect"===F?(Ns||(Ns=m._createCachedImage(F)),F=Ns):(Os||(Os=m._createCachedImage(F)),F=Os));var E,M,W=Q("points.model");if(W){if(m._lastShapeModel!==W||!m.shapeModel){var h=ni(m,W);if(!h)return;var t=[],d={};m.eachShapeModel(function(w){for(var i=0,k=w.length;k>i;i+=3){var Z=w[i],l=w[i+1],P=w[i+2],K=""+Z+"_"+l+"_"+P;d[K]||(d[K]=!0,t.push(Z,l,P))}},h),m.shapeModel={vs:new _p(t)},O._pointsDirty=!0,m._lastShapeModel=W}E=m.shapeModel.vs.length}else{var I=O.getPoints();if(E=I.length,O._pointsDirty||!m.shapeModel){var L=new _p(I);m.shapeModel={vs:L},O._pointsDirty=!1,m._lastShapeModel=null}}if(M=E/3,m.info={mat:Vl(O),size:N,diffuse:C,opacity:Q("points.opacity"),texture:F,alphaTest:Q("points.transparent")?0:Q("alphaTest"),uvScale:Q("points.uv.scale"),discardSelectable:Q("points.discard.selectable")},O._colorsDirty){for(var e,S,R,w=[],b=!1,J=O.colors,D=0;E>D;D+=3)e=J[D],S=J[D+1],R=J[D+2],e===B||S===B||R===B?w.push(C[0],C[1],C[2]):(b=!0,w.push(e,S,R));m.shapeModel.cs=b?new _p(w):null,O._colorsDirty=!1}if(O._sizesDirty){for(var l=[],g=!1,_=O.sizes,D=0;M>D;D++)_[D]?(l.push(_[D]),g=!0):l.push(N);m.shapeModel.ss=g?new _p(l):null,O._sizesDirty=!1}if(O._offsetsDirty){for(var p,u,U=[],T=!1,P=O.offsets,D=0;M>D;D++)p=P[2*D],u=P[2*D+1],p!==B&&u!==B?(U.push(p,u),T=!0):U.push(0,0);m.shapeModel.os=T?new _p(U):null,O._offsetsDirty=!1}if(m._lastPointNumber!==M){var f=y.pickColorMap,s=f._pickIdUsed;f._pickIdUsed=s+M;for(var K=[],D=0;M>D;D++){var z=s+D,H=Uf(z);K.push(H[0],H[1],H[2],H[3]),f[z]||(f[z]={data:O,part:D})}m.shapeModel.ps=new _p(K),m._lastPointNumber=M}this.dispatchBoundingBoxChanged()},_createCachedImage:function(j){var k=128,c=Mb(),i=c.getContext("2d");qh(c,k,k,1),If(i,{width:k,height:k,comps:[{type:j,background:"white",borderWidth:0,rect:[0,0,k,k]}]},0,0,k,k);var l=R.Math.generateUUID();return Lc[l]=c,l},_80o:function(K,J){var A=this,n=A.gv,S=A.shapeModel,v=A.info;if(S&&S.vs&&S.vs.length){var e=Ig.for(K);e.useProgram(A._asureProgram(K)),e.directState();var N=e.directUniforms(),o=e.directAttribs();
N.modelMatrix=v.mat,N.modelViewMatrix=Mh([],n._viewMatrix,v.mat),N.projectionMatrix=n._projectMatrix,N.viewMatrix=n._viewMatrix,N.scale=n.getHeight()/2,N.size=v.size,N.diffuse=v.diffuse,N.opacity=v.opacity,N.map=n.getTexture(v.texture,A.data),N.alphaTest=v.alphaTest,N.resolution=n.getDevicePixelRatio(),N.discardSelectable=v.discardSelectable,N.uvScale=v.uvScale,!n._picking&&S.os?(N.useOffset=!0,o.uvOffset=zi(K,n._buffer.os,S.os,h)):(N.useOffset=!1,o.uvOffset=null),N.blackout=K._blooming&&!A.data.s("bloom"),o.position=zi(K,n._buffer.vs,S.vs,h),n._picking?(N.picking=!0,o.pickColor=zi(K,n._buffer.ps,S.ps,h),N.useColor=!1,o.color=null):(N.picking=!1,o.pickColor=null,S.cs?(N.useColor=!0,o.color=zi(K,n._buffer.cs,S.cs,h)):(N.useColor=!1,o.color=null)),S.ss?(N.useSizeArray=!0,o.sizeArray=zi(K,n._buffer.ss,S.ss,h)):(N.useSizeArray=!1,o.sizeArray=null),Ko(K,0,S.vs.length/3,K.POINTS),e.useProgram(J)}},_asureProgram:function(D){return D._pointsShader||(D._pointsShader=this.gv._postProcessing.createShader(D,Ps.shaderSrc)),D._pointsShader.program}}),Ps.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj4t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vv)o!jggjp!sn<!ocppjpumj!tvptQfwPng!g+t!fyuj<su!bbNuoupsjjucdvfukfp!swqf!d>3!!ovpwjPugjgttpfQu`<mh!!wb<sozpjjouhj!twpfQdw3n!!w+P!gygjtsfuub<Nxf!jvWomjfgeppsnn!!>c!poppmj!uqjjtdplQjwonh!<<!*b!u1u/s2j!c-veuffn!swpfgdt5o!bqsjud!l)D5pdmfpws!<>!o!pvjoujjgtppsQnw!ng!m5pdbfuw!!tj<{*f!<op!jvuojjtgppqs!n)!4gdmfpwb!u>!!sefftnpsmpvgutjopbos<u!!4vdofjwg!ps~n!!c<p*pumf!tvgtgfPTwjv{)f3Bdsfswb!z><!u!fbtugugsPjwc!vu|f!!*gumfptbgug!Ptfjt{vf)B!sgsjb!z<~!!<c*p1p/m2!!j-tsQpfmsptdq)f5ddufjww!f>N!bsupsmjpyD)w!!nb|u!5*!snp!m*p!D|ft!vs)f!ugvjs!of!tnm]f!!3!~^!]!<4s!p^m!p>D>l!d.j!q2!/>1!<sp!m~pDw!!wp|j!e*!hnobjjlod)j*q!)|!g!j^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!4>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*jwdvl!j-oqhb<n!!)vEo3jfgspvsuny!fcup!p>m+!!esjptmdpbDsfetTvfgmgfjdeu!bc<muff<tgg!Pvwo!j>g,p!swnv!!c*pupfmt!gcgmPbfdtlvp)v!ug<j!!<vfomjbgdpTswnv!!w+f!de3s!pvpwDTudobjmpfQ<`m!hv!o>j!gwpvs!n3!dcfpwp!m!|v!t*ffPmgcgbtufduf<mf!Twebssbzdjtojhe!aw!f}d}3!!hwoPjglgdtjfqua<)!g$jj!g!*e!fQgBjNo`fFeT)V!!V)TeFf`oNjBgQf!e*!g!jv$o!jg~p!sn<!*t!bznuqjmdfbsq3pE!!-nfbtqv<gg$jfeo!e)j5gdfww!p>j!es!pnmbpjDof)t*v!g|gj!ej!g!|)!cfmtbmdfl!p~v!u*<!*|!!zhumj`dGbsqbph!D-p{mzpys/!s>p!mwpfDdw5!))15/d1f-w!!1>/!1s-p!m1p/D1f-t!v2g/g1j*e<!!s|f!u*vsspom<p!D~ftv!!w%f%d!5h!oejjlgdgjvqtaf)D!pgmjp!s<";var Qs=function(S,D){_l(Qs,this,[S,D]),this._needRecoverPosition=!0};tr(Qs,Is,{_25Q:1,validate:function(S){var _=this,k=_.data,V=_.s,R=k.getPoints(),W=R.size();_.dispatchBoundingBoxChanged();var v=k.p3(),Q=_.mat=yo();ej(Q,v),bb(Q,k.getFinalRotation3d(),k.getRotationMode());var Z=k.getScale3d(),U=k._dynamicScale3d;if(U&&(Z[0]*=U[0],Z[1]*=U[1],Z[2]*=U[2]),Cg(Q,Z),ej(Q,kd(v)),(!_.s("geometry.cache")||!_.shapeModel)&&(_.shapeModel=_.info=_.lineShapeModel=h,W>1)){var z=_.info={},e=k.getSegments(),d=k.getThickness(),l=fi(R.get(0)),M=fi(R.get(W-1)),q=W%2;0===q?(z.c1=fi(R.get(W/2-1)),z.c2=fi(R.get(W/2))):z.p3=fi(R.get((W-q)/2)),z.s1=l,z.s2=fi(R.get(1)),z.t1=fi(R.get(W-2)),z.t2=M,z.list=V(pl)===gi?_.createTubeModel(R,e,d/2,S):_.createLineModel(R,e,d,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=h},_80o:function(z,p,C){var U=this,g=U.shapeModel;if(g){var _=U.gv;rr(_,U.mat),aj(_,U.data,g,U,U.getBodyColor(),C),Io(_)}}});var Rs=R.graph3d.PostProcessing=function(v){function P(){if(!a){var q=v.getGL();a=new jq.RenderTarget(v,q,null,null,{samples:D.renderTextureSamples||1}),V=new lp.Shader(q,i.vs,i.fs),C=lp.Buffer.createIndexBuffer(q,new Uint16Array([0,2,1,1,2,3])),e=lp.Buffer.createVertexBuffer(q,new Float32Array([0,0,1,0,0,1,1,1]))}}var a,V,C,e,X=this,E={},Y=!1;!function(){w.keys(Rs).forEach(function(s){E[s]=new Rs[s](v)})}(),X.getModule=function(K){return K?E[K]:X},X.getModuleList=function(){return w.keys(E)},X._serializable=!0,X.handleDataModleChange=function(b,I){b&&(X._serializable&&b.setPostProcessingData(X.serialize()),b.removeSerializeListener(X.onDataModelSerialize,X)),I&&(I.addSerializeListener(X.onDataModelSerialize,X),X.deserialize(I))},X.onDataModelSerialize=function(p){"serialize"===p.type?X._serializable&&(v.dm()._postProcessingData=X.serialize()):"deserialize"===p.type&&X.deserialize(v.dm())},X.isDeserializeDisabled=function(b){return!X._serializable||b.a("sceneBloom")!==B},X.isSerializable=function(){return X._serializable},X.setSerializable=function(J){X._serializable=J,J||v.dm().setPostProcessingData(B)},X.serialize=function(){var P,G,z,O,d={};for(G in E)if(z=E[G],O=z.serializeProperties){P={},z.enable&&(P.enable=!0);for(var e in O){var c=z[e];c!=O[e]&&(P[e]=c)}w.keys(P).length&&(d[G.toLowerCase()]=P)}return d},X.deserialize=function(j){var m,p,W,D,k,J={},z={};for(m in E){W=E[m],D=W.serializeProperties;var r={},n="scene"+m,l=j.a(n);l!==B&&(r.enable=l);for(var k in D)l=j.a(n+k[0].toUpperCase()+k.slice(1)),l!==B&&l!==D[k]&&(r[k]=l);Gi(r)||(z[m[0].toLowerCase()+m.slice(1)]=r)}if(Gi(z)&&(z=j.getPostProcessingData()),z)for(p in z)if(p&&(m=p[0].toUpperCase()+p.slice(1),W=E[m])){J[m]=!0,D=z[p];var c=!!D.enable;X.enableModule(m,c),m="scene"+m,j.a(m,c),W.resetProperties&&W.resetProperties();for(k in D)if("enable"!==k){var l=D[k];W[k]=l,j.a(m+k[0].toUpperCase()+k.slice(1),l)}}for(m in E)J[m]||(W=E[m],W.enable=!1,W.resetProperties&&W.resetProperties())},X.getRenderTarget=function(){return a},X.blitScreen=function(b,W,Y,G){var _=v.getGL();if(_){b&&(b.bind(_),v.setViewport(_,0,0,b.width,b.height)),_.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT),P(),Y||(Y=V),Y.bind(),_.activeTexture(_.TEXTURE0+0),Lf(_,W);var L=Y.uniforms;if(L.image=0,G)for(var R in G)L[R]=G[R];C.upload(),e.upload(),Y.attributes.pos.pointer(e),_.drawElements(_.TRIANGLES,6,_.UNSIGNED_SHORT,0),Lf(_,null),b&&b.unbind(_)}},X.decodeShader=function(l){var e,u,D,S="",A="";for(D=0;D<l.length;D++)e=l[D],"%"===e?e="'":"a"===e?e='"':"]"===e&&(e="\\"),u=String.fromCharCode(e.charCodeAt(0)-1),D%2?A+=u:S=u+S;return A+S},X.createShader=function(Q,V,U){var $,J;if("string"==typeof V){var A=V.indexOf("^#");$=X.decodeShader(V.substr(0,A)),J=X.decodeShader(V.substr(A+2))}else $=V.vs,J=V.fs;if(U){var O=U($,J);O&&O.vs&&($=O.vs),O&&O.fs&&(J=O.fs)}return new lp.Shader(Q,$,J)},X.enableModule=function(A,m){var D,N,U,K=A.split(",");for(D=0,N=K.length;N>D;D++)U=K[D].trim(),E[U]&&(E[U].enable=m);Y=!1;for(U in E)if(E[U].enable){Y=!0;break}Y&&P()};var i={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};X.render=function(z,D,X,p){if(Y){a.setSize(z,D,X),a.bind(z);var u=z.getParameter(z.COLOR_CLEAR_VALUE);u&&0===u[0]&&0===u[1]&&0===u[2]&&0===u[3]?u=null:Zj(z,[0,0,0,0]),z.clear(z.COLOR_BUFFER_BIT|z.DEPTH_BUFFER_BIT),v.setViewport(z,0,0,D,X),p=p||{};var $=p.renderAxis!==!1,h=p.renderEdit!==!1;p.renderAxis=p.renderEdit=!1,v.renderScene(p),a.unbind(z);for(var b=0,A=v._glCapabilities.maxAttributes;A>b;b++)z.disableVertexAttribArray(b);var r,T=a;for(r in E)T=E[r]._42(z,T)||T;return v.setViewport(z,0,0,D,X),u&&Zj(z,u),z.clear(z.COLOR_BUFFER_BIT|z.DEPTH_BUFFER_BIT),V.bind(),z.activeTexture(z.TEXTURE0+0),Lf(z,T.texture),V.uniforms.image=0,C.upload(),e.upload(),V.attributes.pos.pointer(e),z.drawElements(z.TRIANGLES,6,z.UNSIGNED_SHORT,0),Lf(z,null),z.useProgram(v._prg),v._renderAxisAndEditHelper($,h),!0}}},Ss=R.graph3d.PostProcessing.HueSaturation=function(P){function t(){E=!0;var h=P.getGL();v=new jq.RenderTarget(P,h),N=P._postProcessing.createShader(h,Ss.hueSaturationShader),Z=lp.Buffer.createIndexBuffer(h,new Uint16Array([0,2,1,1,2,3])),b=lp.Buffer.createVertexBuffer(h,new Float32Array([0,0,1,0,0,1,1,1]))}var Z,b,N,v,o=this,T=!1,E=!1,d=[],F=[],V=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var u=this.serializeProperties;for(var b in u)this[b]=u[b]},this.resetProperties(),w.defineProperties(o,{enable:{get:function(){return T},set:function(L){!!T!=!!L&&(T=L,L&&!E&&t(),P.iv())}},hue:{get:function(){return d.map(function(Q){return c(180*Q)})},set:function(r){if(d!==r&&7===r.length){for(var e=0;7>e;e++)d[e]=r[e]/180;P.iv()}}},saturation:{get:function(){return F.map(function(F){return c(100*F)})},set:function(l){if(F!==l&&7===l.length){for(var C=0;7>C;C++)F[C]=l[C]/100;P.iv()}}},lightness:{get:function(){return V.map(function(O){return c(100*O)})},set:function(S){if(V!==S&&7===S.length){for(var G=0;7>G;G++)V[G]=S[G]/100;P.iv()}}}}),o._42=function(J,x){if(T){E||t();var X=x.width,G=x.height;if(X&&G){v.setSize(J,X,G),hl(J,v.frame),P.setViewport(J,0,0,v.width,v.height),J.clear(J.COLOR_BUFFER_BIT|J.DEPTH_BUFFER_BIT),N.bind(),J.activeTexture(J.TEXTURE0+0),Lf(J,x.texture);var l=N.uniforms;return l.image=0,l.hue=d,l.saturation=F,l.lightness=V,Z.upload(),b.upload(),N.attributes.pos.pointer(b),J.drawElements(J.TRIANGLES,6,J.UNSIGNED_SHORT,0),Lf(J,null),Pj(J),v}}}};Ss.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";var Ts=R.graph3d.PostProcessing.Bloom=function(z){function y(){var g=z.getGL();if(g)for(var r=z._postProcessing,f=0;i>f;f++)K[f]=r.createShader(g,Ts._35Q,function(a,J){return{fs:J.replace(/DEFINE_VALUE/g,X[f]).replace("%OVERRIDE_ALPHA_DEFINE%",L?"#define OVERRIDE_ALPHA":"")}})}function x(){var d=z.getWidth(),n=z.getHeight();if(d&&n){r=[d,n],D=!0;var l,t=z.getGL(),X=Math.round(r[0]/2),k=Math.round(r[1]/2);for(B=new jq.RenderTarget(z,t,X,k),l=0;i>l;l++)f.push(new jq.RenderTarget(z,t,X,k)),m.push(new jq.RenderTarget(z,t,X,k)),X=Math.round(X/2),k=Math.round(k/2);var e=z._postProcessing;p=e.createShader(t,Ts._34Q),y(),S=e.createShader(t,Ts._36Q,function(A,K){return{fs:K.replace(/NUM_MIPS/g,i)}}),b=e.createShader(t,Ts.finalShader),H=lp.Buffer.createIndexBuffer(t,new Uint16Array([0,2,1,1,2,3])),T=lp.Buffer.createVertexBuffer(t,new Float32Array([0,0,1,0,0,1,1,1]))}}var G,F,Y,L,j,H,T,d,k=this,U=!1,D=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var S=this.serializeProperties;for(var H in S)this[H]=S[H]},w.defineProperties(k,{enable:{get:function(){return U},set:function(T){!!U!=!!T&&(U=T,T&&!D&&x(),z.iv())}},strength:{get:function(){return G},set:function(Q){G!==Q&&(G=Q,z.iv())}},threshold:{get:function(){return F},set:function(v){F!==v&&(F=v,z.iv())}},radius:{get:function(){return Y},set:function(f){Y!==f&&(Y=f,z.iv())}},overrideAlpha:{get:function(){return L},set:function(b){!!L!=!!b&&(L=b,D&&y(),z.iv())}},selective:{get:function(){return j},set:function(s){!!j!=!!s&&(j=!!s,z.iv())}}}),this.resetProperties();var B,p,S,b,r=[256,256],f=[],m=[],i=5,X=[3,5,7,9,11],K=[];k._42=function(y,c){function h(W,e,f,v){hl(y,e.frame),z.setViewport(y,0,0,e.width,e.height),v?v(y):y.clear(y.COLOR_BUFFER_BIT|y.DEPTH_BUFFER_BIT),t!==W&&W.bind();var B=0;for(var K in f){var U=f[K];U instanceof WebGLTexture&&(y.activeTexture(y.TEXTURE0+B),Lf(y,U),U=B,B++),W.uniforms[K]=U}for(t!==W&&(H.upload(),T.upload(),W.attributes.pos.pointer(T),t=W),y.drawElements(y.TRIANGLES,6,y.UNSIGNED_SHORT,0);B--;)y.activeTexture(y.TEXTURE0+B),Lf(y,null);Pj(y)}if(U&&(D||(x(),D))){var t;if(j){d||(d=new jq.RenderTarget(z,y)),d.setSize(y,c.width,c.height),d.bind(y);var n=y.getParameter(y.COLOR_CLEAR_VALUE);n&&0===n[0]&&0===n[1]&&0===n[2]&&1===n[3]?n=null:Zj(y,[0,0,0,1]),y.clear(y.COLOR_BUFFER_BIT|y.DEPTH_BUFFER_BIT),z.setViewport(y,0,0,c.width,c.height),y._blooming=!0,z.syncRenderState(),z.renderScene(),y._blooming=!1,n&&Zj(y,n),d.unbind(y)}h(p,B,{smoothWidth:.01,luminosityThreshold:F,tDiffuse:j?d.texture:c.texture});var A,X=B,R=Math.round(r[0]/2),P=Math.round(r[1]/2);for(A=0;i>A;A++)h(K[A],f[A],{colorTexture:X.texture,direction:[1,0],texSize:[R,P]}),h(K[A],m[A],{colorTexture:f[A].texture,direction:[0,1],texSize:[R,P]}),R=Math.round(R/2),P=Math.round(P/2),X=m[A];return h(S,f[0],{blurTexture1:m[0].texture,blurTexture2:m[1].texture,blurTexture3:m[2].texture,blurTexture4:m[3].texture,blurTexture5:m[4].texture,bloomStrength:G,bloomRadius:Y,bloomTintColor:[1,1,1]}),h(b,c,{image:f[0].texture},function(h){Ig.for(h).glState.blend.apply({enabled:!0,equation:h.FUNC_ADD,func:[h.SRC_ALPHA,h.ONE]})}),Ig.for(y).glState.blend.apply({equation:y.FUNC_ADD,func:[y.SRC_ALPHA,y.ONE_MINUS_SRC_ALPHA,y.ONE,y.ONE_MINUS_SRC_ALPHA]}),c}}};Ts._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",Ts._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",Ts._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",Ts.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var Us=R.graph3d.PostProcessing.Dof=function(O){function c(){T=!0;var o=O.getGL();S=new jq.RenderTarget(O,o),h=O._postProcessing.createShader(o,Us._38Q),$=lp.Buffer.createIndexBuffer(o,new Uint16Array([0,2,1,1,2,3])),y=lp.Buffer.createVertexBuffer(o,new Float32Array([0,0,1,0,0,1,1,1]))}var S,h,$,y,e,Z,i,Q,x=this,V=!1,T=!1,H=Np.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var w=this.serializeProperties;for(var Z in w)this[Z]=w[Z]},w.defineProperties(x,{enable:{get:function(){return V},set:function(p){!!V!=!!p&&(V=p,p&&!T&&c(),O.iv())}},image:{get:function(){return Z},set:function(h){Z!==h&&(Z=h,e&&(O.deleteTexture(H),e=null),O.iv())}},maxblur:{get:function(){return i},set:function(e){i!==e&&(i=e,O.iv())}},aperture:{get:function(){return Q},set:function(j){Q!==j&&(Q=j,O.iv())}}}),this.resetProperties(),x._42=function(v,k){function C(F,X,j,H){hl(v,X.frame),O.setViewport(v,0,0,X.width,X.height),H?H(v):v.clear(v.COLOR_BUFFER_BIT|v.DEPTH_BUFFER_BIT),m!==F&&F.bind();var q=0;for(var _ in j){var T=j[_];T instanceof WebGLTexture&&(v.activeTexture(v.TEXTURE0+q),Lf(v,T),T=q,q++),F.uniforms[_]=T}for(m!==F&&($.upload(),y.upload(),F.attributes.pos.pointer(y),m=F),v.drawElements(v.TRIANGLES,6,v.UNSIGNED_SHORT,0);q--;)v.activeTexture(v.TEXTURE0+q),Lf(v,null);Pj(v)}if(V){T||c();var m;if(!e){var K=vo(this.image);if(!K||!K.comps&&!K.tagName)return k;R.Default.setImage(H,K),e=O.getTexture(H)}var a=k.width,q=k.height;if(a&&q)return S.setSize(v,a,q),C(h,S,{tColor:k.texture,tDepth:e,aspect:a/q,aperture:this.aperture,maxblur:this.maxblur}),S}}};Us._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E";var Vs=R.graph3d.PostProcessing.Blur=function(v){function Y(){t=!0;var P=v.getGL();B=new jq.RenderTarget(v,P),O=v._postProcessing.createShader(P,Vs.hBlurShader),s=v._postProcessing.createShader(P,Vs.vBlurShader)}var O,s,B,r,A,z,q,_,J,M=this,x=!1,t=!1;this.serializeProperties={value:0,downSample:!1,iterations:1,layer:"main"},this.resetProperties=function(){var F=this.serializeProperties;for(var f in F)this[f]=F[f]},w.defineProperties(M,{enable:{get:function(){return x},set:function(u){!!x!=!!u&&(x=u,u?v.addRenderLayerListener(g,this):v.removeRenderLayerListener(g,this),u&&!t&&Y(),v.iv())}},downSample:{get:function(){return q},set:function(p){q!==p&&(q=p,v.iv)}},value:{get:function(){return z},set:function(Z){z!==Z&&(z=Z,v.iv())}},iterations:{get:function(){return _},set:function(h){_!==h&&(_=h,v.iv())}},layer:{get:function(){return J},set:function(K){J!==K&&(J=K,v.iv())}}}),this.resetProperties();var g=function(r){if(x&&r.layer===J&&"post"===r.phase){var j=v.getGL();if(!v._picking&&!v.isReflecting(j)){var E=v._postProcessing.getRenderTarget();E.unbind(j);for(var p=0,c=v._glCapabilities.maxAttributes;c>p;p++)j.disableVertexAttribArray(p);M.drawImpl(j,E),E.bind(j),j.useProgram(v._prg)}}};M._42=function(){},M.drawImpl=function(u,M,D,V,L){t||Y();var E,x;if(M?(E=M.width,x=M.height):(E=v._viewport[2],x=v._viewport[3]),E&&x){var j=v._postProcessing;"boolean"!=typeof V&&(V=q),D==h&&(D=z),L==h&&(L=_),L=Math.max(1,Math.round(L));var g=Ig.for(u).glState.depth,c=g.enabled;if(g.enabled=!1,V){D/=2;var U=[E,x];E/=2,x/=2,r||(r=new jq.RenderTarget(v,u),A=j.createShader(u,Vs.downSampleShader)),r.setSize(u,E,x),j.blitScreen(r,M.texture,A,{texelSize:[1/U[0],1/U[1]]}),M.setSize(u,E,x)}else r&&r.setSize(0,0);B.setSize(u,E,x);for(var X=[],F=0;L>F;F++)X.push(D),D=Math.max(1,Math.floor(D/2));for(var F=0;L>F;F++){var a=X[L-F-1],W=V&&0===F?r.texture:M.texture;j.blitScreen(B,W,O,{value:a/E}),V&&F===L-1&&M.setSize(u,U[0],U[1]),j.blitScreen(M,B.texture,s,{value:a/x})}return g.enabled=c,M}}};Vs.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",Vs.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",Vs.downSampleShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j1t/j5p!o0!!i*j*h*i1q/!2g!m-p1b/u1<)3!dvfowj!g+p!sfn{!jtTbmnfqymffus!3,E!!wjVnwb!h-ff<hb!nwjb)sEz3jfoshv!uwyffdu3!!w,V!w*<*1!/v2o.j!g-p1s/n1!)w3fddf3w!!u+f!yff{mjTTjm{ffy<fu!!,w!pwjVew!!n-bfjhob)n*j)!E|3f!shvmu`yGfsub!hD,p!m*p*s1!/>1!!)-u1f/y2u.v)s3fd3fEw)!j+n!bfh{fj-T!mwfVywf!u,!!,u!fwyVfwm!T-jf{hfb!n+j!)wEf3df3s)v2u/y1f-u!!1/,1!**",sq(l,{accordionViewExpandIcon:yl(Vr),accordionViewCollapseIcon:yl(Vr,!0),accordionViewLabelColor:zo,accordionViewLabelFont:Zr,accordionViewTitleBackground:bd,accordionViewSelectBackground:ag,accordionViewSelectWidth:3,accordionViewSeparatorColor:B,splitViewDividerSize:1,splitViewDividerBackground:bd,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:ve,rect:[2,2,12,12],background:Vr}]},propertyViewLabelColor:Si,propertyViewLabelSelectColor:zo,propertyViewLabelFont:Zr,propertyViewExpandIcon:yl(fp),propertyViewCollapseIcon:yl(fp,!0),propertyViewBackground:Ed,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:gq,propertyViewColumnLineColor:gq,propertyViewSelectBackground:ag,listViewLabelColor:Si,listViewLabelSelectColor:zo,listViewLabelFont:Zr,listViewRowLineVisible:!1,listViewRowLineColor:gq,listViewSelectBackground:ag,treeViewLabelColor:Si,treeViewLabelSelectColor:zo,treeViewLabelFont:Zr,treeViewExpandIcon:yl(Wh),treeViewCollapseIcon:yl(Wh,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:gq,treeViewSelectBackground:ag,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Si,tableViewLabelSelectColor:zo,tableViewLabelFont:Zr,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:gq,tableViewColumnLineColor:gq,tableViewSelectBackground:ag,treeTableViewLabelColor:Si,treeTableViewLabelSelectColor:zo,treeTableViewLabelFont:Zr,treeTableViewExpandIcon:yl(Wh),treeTableViewCollapseIcon:yl(Wh,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:gq,treeTableViewColumnLineColor:gq,treeTableViewSelectBackground:ag,tableHeaderLabelColor:Si,tableHeaderLabelFont:Zr,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:qk,tableHeaderBackground:Ed,tableHeaderMoveBackground:xl,tableHeaderInsertColor:ag,tableHeaderSortDescIcon:Hi(fp,!0),tableHeaderSortAscIcon:Hi(fp),tabViewTabGap:1,tabViewLabelColor:zo,tabViewLabelFont:Zr,tabViewTabBackground:bd,tabViewSelectWidth:3,tabViewSelectBackground:ag,tabViewMoveBackground:xl,tabViewInsertColor:ag,toolbarLabelColor:Si,toolbarLabelSelectColor:zo,toolbarLabelFont:Zr,toolbarBackground:Ed,toolbarSelectBackground:ag,toolbarItemGap:8,toolbarSeparatorColor:Ik},!0);
var Ws={translateX:1,sortColumn:1},Xs={sortable:1,sortOrder:1,sortFunc:1},Ys={focusData:1},Zs={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},$s={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},_s=function(M,o){o.add(M),M.hasChildren()&&M.eachChild(function(E){_s(E,o)})},at=function(N,E,f,q,p,T,P,t,W,Y,V){var k,G=f.getValueType(Y),y=f.getAlign(Y);if(f.getEnumValues(Y)){var A=f.toEnumLabel(E,Y),j=xs||0,m=0,J=T,u=l.getTextSize(q,A).width;return k=vo(f.toEnumIcon(E,Y)),k&&(m=T+xs/2,"center"===y?m+=(t-(j+u))/2:"right"===y&&(m=m+t-(j+u)),Do(N,k,m,P+W/2,Y,V),J=m+xs/2),A!=h&&(k?dn(N,A,q,p,J,P,t-(J-T),W):dn(N,A,q,p,T,P,t,W,y)),void 0}return E=f.formatValue(E),E!=h?G===xn?(Tj(N,T,P,t,W,E),void 0):G===qg||!G&&He(E)?(k=vo(E?Hq:hn),Do(N,k,T+t/2,P+W/2,Y,V),void 0):(dn(N,E,q,p,T,P,t,W,y),void 0):void 0},bt=function(S,c){var y=c.view,u=Sq(S),T=c.column||c.property;y.getDataModel().beginTransaction(),c.editor=S,S.info=c,y.setCurrentEditor(S),y.getView().insertBefore(u,y._79O),cn(S,c.editorRect),S.setFocus?S.setFocus():gc(S),S.commitValue=function(m,U){S._17Q&&(S=S._17Q),U||y.setValue(c.data,T,S.getValue?S.getValue():S.value),S.close&&S.close(),sn(u)},T.onEditorCreated&&T.onEditorCreated(c)},ct=function(q,L,$,C,a){var F=Ol(q,$),p=L.value,M=L.view,J=a.getValueType(L.data);return F.onblur=F.onchange=function(){M.endEditing()},"input"===q?(p=a.formatValue(p),p!=h&&(F.value=p),F.onkeydown=function(p){er(p)?M.endEditing():oo(p)&&M.endEditing(!0)},(J===as||J===qr)&&e(F,dq,l.numberListener)):q===lm&&C.forEach(function(e){var l=N.createElement("option");l.innerHTML=a.toEnumLabel(e),l.value=e,a.isEnumEqual(p,e)&&(l.selected=!0),vk(F,l)}),bt(F,L),F},dt=R.widget={},et=function(J,h,f){tr(z+".widget."+J,h,f)};sq(jl,{ms_value:function(H){H.getValue=function(i){var X=this.getItemById(i),t=X.element;return Ek(t)?t:t?t.getValue?t.getValue():t.value:X.selected},H.setValue=function(i,J){var D=this.getItemById(i);if(D){var c=D.element;c&&!Ek(c)?c.setValue?c.setValue(J):c.value=J:He(J)?(D.selected=J,this.iv()):(D.element=J,this.iv())}},H.v=function(q,e){var W=this;if(2===arguments.length)W.setValue(q,e);else{if(!xg(q))return W.getValue(q);for(var p in q)W.setValue(p,q[p])}return W}},_46o:function(b){b._icon=h,b._accessType=h,b._valueType=h,b._editable=!1,b._batchEditable=!0,b._align=Se,b._nullable=!0,b._emptiable=!1,b.setParent=zm,b.formatValue=function(z){var w=this,_=w._valueType;return w.getEnumValues()?w.toEnumLabel(z):_===qg?!!z:z!=h&&_===as?A(z):z},b.setEnum=function(n,K,I,r,R,Z,S){var m=this;n&&!Nl(n)&&n.values&&(r=n.editable,I=n.icons,K=n.labels,R=n.strict,Z=n.maxHeight,S=n.dropDownWidth,n=n.values),so(n)&&(n=n._as),so(K)&&(K=K._as),so(I)&&(I=I._as),m._enumValues=n,m._enumLabels=K,m._enumIcons=I,m._enumEditable=r,m._enumStrict=R==h?!0:R,m._enumMaxHeight=Z,m._enumDropDownWidth=S,n&&n.length&&ih(n[0])&&(m._valueType=qr),m.fp("enum",!1,!0)},b.getEnumDropDownWidth=function(){return this._enumDropDownWidth},b.getEnumMaxHeight=function(){return this._enumMaxHeight},b.isEnumEditable=function(){return this._enumEditable},b.getEnumValues=function(){return this._enumValues},b.getEnumLabels=function(){return this._enumLabels},b.getEnumIcons=function(){return this._enumIcons},b.isEnumStrict=function(){return this._enumStrict},b.isEnumEqual=function(b,w){return this._enumStrict?b===w:b==w},b.toEnumLabel=function(q,D){var R=this,I=R.getEnumValues(D),Z=R.getEnumLabels(D);if(I&&Z)for(var Q=0;Q<I.length;Q++)if(R.isEnumEqual(q,I[Q]))return Z[Q];return q},b.toEnumIcon=function(Q,z){var R=this,o=R.getEnumValues(z),w=R.getEnumIcons(z);if(o&&w)for(var t=0;t<o.length;t++)if(R.isEnumEqual(Q,o[t]))return w[t];return B}},_45o:function(s){s._87o=function(o,p,S,W,g,l){if(o){var H=this,E=H._90I,j=Xl(1);H._columnLineVisible&&(g-=1),H._rowLineVisible&&(l-=1),0>=g||0>=l||(H._90I||(E=H._90I={}),E[p]||(E[p]=new bp),cn(j,H.tx()+S,H.ty()+W,g,l),vk(j,o),H._view.insertBefore(j,H._79O),o.onParentAdded&&o.onParentAdded(j),E[p].add(j))}},s._76o=function(){var z=this,D=z._90I;if(D){for(var n in D)D[n].each(function(O){sn(O)});delete z._90I}},s._77o=function(Y){var t=this;if(t._90I){var o=t._90I[Y];o&&(o.each(function(K){sn(K)}),delete t._90I[Y])}}},_47o:function(c){c.getValue=function(D,y){return y.getValue?y.getValue(D,y,this):lf(D,y.getAccessType(),y.getName())},c.setValue=function(s,J,x){if(J.isEmptiable(s)||""!==x||(x=B),J.isNullable(s)||x!=h){var X=this,o=J.getName(s),O=J.getAccessType(s),H=J.getValueType(s);H===as&&Ek(x)?x=Bn(x):H===qr&&Ek(x)?x=parseFloat(x):H===qg&&Ek(x)&&(x="true"===x),X._batchEditable&&J._batchEditable&&X.isSelected(s)?X.sm().each(function($){J.setValue?J.setValue($,J,x,X):uq($,O,o,x)}):J.setValue?J.setValue(s,J,x,X):uq(s,O,o,x)}},c.setCurrentEditor=function(x){this.endEditing(),this._currentEditor=x,this.redraw()},c.isEditing=function(F,p){var c=this,i=c._currentEditor;if(!i)return!1;if(p){var d=i.info;return d?(d.column||d.property)===p&&d.data===F:!1}return!0},c.endEditing=function(i){var y=this,c=y._currentEditor;c&&(delete y._currentEditor,c.commitValue&&c.commitValue(c.info,i),y.redraw(),y.getDataModel().endTransaction())},c.beginEditing=function(i){this.endEditing();var T=this,o=i.column||i.property;if(o.beginEditing)o.beginEditing(i);else{var W=i.data,K=i.value,S=T.getSelectBackground(W),z=o.getEnumValues(W),M=o.getSlider(W),p=o.getColorPicker(W);if(M){var B=ui(dt.Slider,M);return B.setValue(K),B.getView().onblur=function(){T.endEditing()},B.isInstant()&&(B.onValueChanged=function(){T.setValue(W,o,B.getValue())}),bt(B,i),void 0}if(p||o.getValueType(W)===xn){var k=ui(dt.ColorPicker,p);return k.setValue(K),k.onClosed=function(){T.endEditing()},k.isInstant()&&(k.onValueChanged=function(J,O){T.setValue(W,o,O)}),bt(k,i),k.open(),void 0}if(z){if(dt.ComboBox){var r=new dt.ComboBox;r.setValue(K),r.setValues(z),r.setLabels(o.getEnumLabels(W)),r.setIcons(o.getEnumIcons(W)),r.setEditable(o.isEnumEditable(W)),r.setStrict(o.isEnumStrict(W)),r.setMaxHeight(o.getEnumMaxHeight(W)),r.setDropDownWidth(o.getEnumDropDownWidth(W)),r.onClosed=function(){T.endEditing()},bt(r,i),r.open()}else ct(lm,i,S,z,o);return}var Z=o.getValueType(W);if(Z===qg||He(K))return T.setValue(W,o,!K),void 0;if(o.getItemEditor(W)){var y=zq(o.getItemEditor(W)),J=new y(W,o,T,i),N=J.getView();return N._17Q=J,J.setValue(K),Sh(N),bt(N,i),J.editBeginning&&J.editBeginning(),void 0}ct("input",i,S,h,o)}}},_44o:function(_){_.init=function(u){var b=this,z=b.th=new tt(u),r=b._view=fl(1,b);b.tv=b._tableView=u,vk(r,z.getView()),vk(r,u.getView()),z.mp(function(o){o.property===Qd&&b.iv()}),b.iv()},_.getTableView=function(){return this.tv},_.getTableHeader=function(){return this.th},_.getDataModel=function(){return this.tv.dm()},_.getColumnModel=function(){return this.tv.getColumnModel()},_.setColumns=function(O){this.tv.setColumns(O)},_.addColumns=function(R){this.tv.addColumns(R)},_.endEditing=function(){this.tv.endEditing()},_.validateImpl=function(){var A=this,y=A.th,F=Rm(y),w={x:0,y:0,width:A.getWidth(),height:F};cn(y,w),w.y=F,w.height=I(0,A.getHeight()-F),cn(A.tv,w)}},ms_vs:function(D){D._41o=function(){return this._29I.height<this._59I},D._43o=function(){var A=this;A._41o()&&(A._58I||(kl(function(){A._94O()},fj),A.iv()),A._58I=new Date)},D._94O=function(){var p=this;if(p._58I){var w=new Date;w.getTime()-p._58I.getTime()>=fj?(delete p._58I,p.iv()):kl(function(){p._94O()},fj)}},D._93I=function(){var P=this,l=P._27I;if(P._58I||!P._autoHideScrollBar){l||vk(P._79O,l=P._27I=Xl());var M=P._29I,W=M.height,E=P._59I,O=P.getScrollBarSize(),Y=M.width-O-2,z=W*(-P.ty()/E),r=W*(W/E),T=l.style;E>W?(Gl>r&&(z=z+r/2-Gl/2,0>z&&(z=0),z+Gl>W&&(z=W-Gl),r=Gl),T.visibility=$r,T.background=P.getScrollBarColor(),T.borderRadius=O/2+Ee,cn(l,Y,z,O,r)):T.visibility=Ce}else l&&(l.style.visibility=Ce)}},ms_hs:function(n){n._40o=function(){return this._29I.width<this._91I},n._42o=function(){var Y=this;Y._40o()&&(Y._95O||(kl(function(){Y._94I()},fj),Y.iv()),Y._95O=new Date)},n._94I=function(){var o=this;if(o._95O){var p=new Date;p.getTime()-o._95O.getTime()>=fj?(delete o._95O,o.iv()):kl(function(){o._94I()},fj)}},n._92I=function(){var h=this,e=h._28I;if(h._95O||!h._autoHideScrollBar){e||vk(h._79O,e=h._28I=Xl());var E=h._29I,B=E.width,z=h._91I,d=h.getScrollBarSize(),u=E.height-d-2,U=B*(-h.tx()/z),I=B*(B/z),s=e.style;z>B?(Gl>I&&(U=U+I/2-Gl/2,0>U&&(U=0),U+Gl>B&&(U=B-Gl),I=Gl),s.visibility=$r,s.background=h.getScrollBarColor(),s.borderRadius=d/2+Ee,cn(e,U,u,I,d)):s.visibility=Ce}else e&&(e.style.visibility=Ce)}}}),vf(Hq,dr(16,16,[{type:Kq,rect:[1,1,14,14],background:ag},{type:Ri,rect:[1,1,14,14],width:1,color:hm},{type:Cq,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),vf(hn,dr(16,16,{type:Ri,rect:[1,1,14,14],width:1,color:hm})),vf(Ub,dr(16,16,[{type:ln,rect:[2,2,12,12],borderWidth:1,borderColor:hm,background:"#FFF"},{type:ln,rect:[4,4,8,8],background:ag}])),vf(Ap,dr(16,16,{type:ln,rect:[2,2,12,12],borderWidth:1,borderColor:hm})),jl._15Q=function(a){a._29I=zn,a._59I=0,a._91I=0,a._5o=function(H){var g=this;g._30I=new bp,g._rows=new bp,g._rowMap={},g._31I=0,g._14I=0,g._view=fl(1,g),g._canvas=Mb(g._view),vk(g._view,g._79O=Xl()),g.dm(H?H:new Ge)},a.getCheckIcon=function(i){var P=this.sm(),u=P.co(i);return P.sg()?vo(u?Ub:Ap):vo(u?Hq:hn)},a.checkData=function(n){var V=this.sm(),_=V.co(n);V.sg()&&_||(this._32o=1,_?V.rs(n):V.as(n),delete this._32o)},a.getDataAt=function(t){t.target&&(t=this.lp(t));var b=c(t.y/this._rowHeight),o=this._rows;return 0>b||b>=o.size()?h:o.get(b)},a.onDataDoubleClicked=function(){},a.onDataClicked=function(){},a.adjustTranslateX=function(){return 0},a.adjustTranslateY=function(b){var R=this.getHeight()-this._59I;return R>b&&(b=R),b>0?0:A(b)},a.onPropertyChanged=function(O){var G=this,J=O.property;Zs[J]?G.ivm():Ys[J]||G.redraw(),J===Fo?G._42o():J===Yf&&G._43o()},a.getLabel=function($){return $.toLabel()},a.getLabelFont=function(){return this._labelFont},a.getLabelColor=function(G){var s=this;if(s.isCheckMode()){if(s._focusData===G)return s._labelSelectColor}else if(s.isSelected(G))return s._labelSelectColor;return s._labelColor},a.getStartRowIndex=function(){return this._31I},a.getEndRowIndex=function(){return this._14I},a.getRowDatas=function(){return this._rows},a.getRowIndex=function(q){return this._rowMap[q._id]},a.getRowSize=function(){return this._rows.size()},a.getViewRect=function(){return lg(this._29I)},a.isVisible=function(_){return this._visibleFunc?this._visibleFunc(_):!0},a.getCurrentSortFunc=function(){return this._sortFunc},a.setDataModel=function(e){var Z=this,g=Z._dataModel,L=Z._selectionModel;g!==e&&(g&&(g.umm(Z.handleDataModelChange,Z),g.umd(Z.handleDataPropertyChange,Z),g.umh(Z.handleHierarchyChange,Z),L||g.sm().ums(Z.handleSelectionChange,Z)),Z._dataModel=e,e.mm(Z.handleDataModelChange,Z),e.md(Z.handleDataPropertyChange,Z),e.mh(Z.handleHierarchyChange,Z),L?L._21I(e):e.sm().ms(Z.handleSelectionChange,Z),Z.fp("dataModel",g,e))},a.validateModel=function(){var X=this;X._rows.clear(),X._rowMap={},X.buildChildren(X._dataModel._roots);var f=X._rows=X._rows.toList(X.isVisible,X),F=0,S=X.getCurrentSortFunc(),t=f.size();for(S&&f.sort(S);t>F;F++)X._rowMap[f.get(F)._id]=F},a.buildChildren=function(u){var t=this;u.each(function(B){t._rows.add(B),t.buildChildren(B._children)})},a.handleDataModelChange=function(){this.ivm()},a.handleDataPropertyChange=function(I){"parent"===I.property?this.ivm():this.invalidateData(I.data)},a.handleHierarchyChange=function(){this.ivm()},a.handleSelectionChange=function(X){X.datas.each(this.invalidateData,this),this.onSelectionChanged(X)},a.onSelectionChanged=function(n){var L=this,M=L.sm();!L.isAutoMakeVisible()||1!==M.size()||"set"!==n.kind&&"append"!==n.kind||L._32o||L.makeVisible(M.ld())},a.handleBackgroundClick=function(W){Pd(W)&&!this.isCheckMode()&&this.sm().cs()},a.makeVisible=function(I){I&&(this._23I=I,this.iv())},a.scrollToIndex=function(t){var r=this,$=r._29I,P=$.height,k=r._rowHeight,T=k*t;t>=0&&t<r._rows.size()&&P>0&&(T+k>$.y+P?r.ty(-T+P-k):T<$.y&&r.ty(-T))},a.autoScroll=function(s,l){var O=this,K=O._rowHeight,I=K,u=K/4,t=O._29I,N=O.lp(s),k={x:O.tx(),y:O.ty()};return K>0&&t&&(N.x-t.x<I?O.translate(u,0):t.x+t.width-N.x<I&&O.translate(-u,0),N.y-t.y<I?O.translate(0,u):t.y+t.height-N.y<I&&O.translate(0,-u)),k.x=O.tx()-k.x,k.y=O.ty()-k.y,l&&(l.x+=k.x,l.y+=k.y),k},a.getTopRowOrderSelection=function(){var X=this.sm().getTopSelection(),O={},N=new bp;return X.each(function(i){O[i._id]=i}),this._rows.each(function(K){O[K._id]&&N.add(K)}),N},a.getRowOrderSelection=function(){var D=new bp;return this._rows.each(function(f){this.isSelected(f)&&D.add(f)},this),D},a.ivm=function(){this.invalidateModel()},a.invalidateModel=function(){var M=this;M._96I||(M._96I=1,M._32I=1,delete M._24I),M.iv()},a.redraw=function(){var u=this;u._32I||(u._32I=1,delete u._24I,u.iv())},a.invalidateData=function(w){var O=this;ah?O.redraw():O._32I||(O._24I||(O._24I={}),O._24I[w._id]=w,O.iv())},a.getFocusData=function(){return this._focusData},a.setFocusDataById=function(D){this.setFocusData(this.dm().getDataById(D))},a.setFocusData=function(m){var z=this,r=z._focusData;r!==m&&(z._focusData=m,z.fp("focusData",r,m),r&&z.invalidateData(r),m&&(z.invalidateData(m),z.isAutoMakeVisible()&&z.makeVisible(m)))},a.drawRowBackground=function(N,E,Q,R,s,h,O){var B=this,e=B.isCheckMode();(E===B._focusData&&e||Q&&!e)&&Tj(N,R,s,h,O,B.getSelectBackground(E))},a.drawData=function(S,z,_){var v=this,p=v._rowHeight,y=p*_,f=v._29I,M=f.x,O=f.width;S.save(),S.beginPath(),S.rect(M,y,O,p),S.clip(),v._87o(v.drawRow(S,z,v.isSelected(z),M,y,O,p),_,M,y,O,p),S.restore(),v._rowLineVisible&&Tj(S,M,y+p-1,O,1,v._rowLineColor)},a._12I=function(G){var K=this,H=K._31I,v=K._29I,_=v.x,A=v.y,y=v.width,N=v.height;for(G.beginPath(),G.rect(_,A,y,N),G.clip(),G.clearRect(_,A,y,N),K._76o(),K._93db(G);H<K._14I;H++)K.drawData(G,K._rows.get(H),H);K._92db(G)},a._13I=function(f){for(var i,e=this,s=e._rowHeight,r=e._29I,w=r.x,q=r.width,Q=e._31I,Y=e._30I;Q<e._14I;Q++)i=e._rows.get(Q),e._24I[i._id]&&Y.add({data:i,index:Q});Y.isEmpty()||(f.beginPath(),Y.each(function(I){f.rect(w,I.index*s,q,s)}),f.clip(),Y.each(function(e){f.clearRect(w,e.index*s,q,s)}),Y.each(function(N){e._77o(N.index)}),e._93db(f),Y.each(function(i){e.drawData(f,i.data,i.index)}),e._92db(f),Y.clear())},a.preValidateModel=function(){this.endEditing&&this.endEditing()},a.validateImpl=function(){var r=this,T=r._canvas,e=r.getWidth(),w=r.getHeight(),I=r._rowHeight,X=r._32I;(e!==T.clientWidth||w!==T.clientHeight)&&(qh(T,e,w),X=1),r._96I&&(r.preValidateModel(),r.validateModel());var b=r._29I,m={x:-r.tx(),y:-r.ty(),width:e,height:w},p=r._rows.size(),d=hb(T),J=r._23I;X||io(m,b)||(X=1),r._29I=m,r._59I=p*I,r._31I=c(m.y/I),r._14I=g((m.y+m.height)/I),r._31I<0&&(r._31I=0),r._14I>p&&(r._14I=p),r._99I&&X&&r._99I();var t=r.tx(),q=r.ty();(r._40o()||r._41o())&&(r._59I+=r.getScrollBarSize(),r._99I&&X&&(r._91I+=r.getScrollBarSize())),Dq&&!Kl&&(d.save(),pm(d,e/gi.length,w/gi.length,1)),pm(d,t,q,1),X?r._12I(d):r._24I&&r._13I(d),r._93I(),r._92I(),d.restore(),r._32I=r._24I=r._96I=h,J&&(r.scrollToIndex(r.getRowIndex(J)),delete r._23I),r.tx(r.tx()),r.ty(r.ty())},a.canHandleSelectMode=function(){return!0}},jl._48o=function(R){R._rootVisible=!0,R._rootData=h,R._35o=function(){this._expandMap={},this._levelMap={}},R.validateModel=function(){var b=this,d=b._rootData;b._rows.clear(),b._levelMap={},b._rowMap={},b._currentLevel=0,d?b._rootVisible?b.isVisible(d)&&b.buildData(d):b.buildChildren(d):b.buildChildren(),delete b._currentLevel},R.buildData=function(U){var F=this,e=U._id,k=F._rows;F._rowMap[e]=k.size(),k.add(U),F._levelMap[e]=F._currentLevel,F.isExpanded(U)&&(F._currentLevel++,F.buildChildren(U),F._currentLevel--)},R.buildChildren=function(Z){var U=this,k=Z?Z._children:U._dataModel._roots,L=U.getCurrentSortFunc();L&&U.isChildrenSortable(Z)?k.toList(U.isVisible,U).sort(L).each(U.buildData,U):k.each(function(M){U.isVisible(M)&&U.buildData(M)})},R.getLevel=function(U){return this._levelMap[U._id]},R.getToggleIcon=function(U){var $=this,P=$._loader,F=$._collapseIcon;return P&&!P.isLoaded(U)?F:U.hasChildren()?$.isExpanded(U)?$._expandIcon:F:h},R.isCheckMode=function(){return this._checkMode!=h},R.isChildrenSortable=function(){return!0},R.handleDataModelChange=function(h){var c=this;h.kind===Sb?delete c._expandMap[h.data._id]:h.kind===Oe&&(c._expandMap={}),c.ivm()},R.toggle=function(P){var t=this;t.isExpanded(P)?t.collapse(P):t.expand(P)},R.isExpanded=function(E){return 1===this._expandMap[E._id]},R.expand=function(U){var B=this,t=B._loader;B.isExpanded(U)||(t&&!t.isLoaded(U)&&t.load(U),B._expandMap[U._id]=1,B.ivm(),B.onExpanded(U))},R.onExpanded=function(){},R.collapse=function(k){var m=this;m.isExpanded(k)&&(delete m._expandMap[k._id],m.ivm(),m.onCollapsed(k))},R.onCollapsed=function(){},R.expandAll=function(z){if(z)this.expand(z),z.eachChild(function(O){this.expandAll(O)},this);else{var q=this;q._dataModel.each(function(p){p.hasChildren()&&(q._expandMap[p._id]=1)}),q.ivm()}},R.collapseAll=function(){this._expandMap={},this.ivm()},R.makeVisible=function(o){if(o){var M=this;if(!M._rootData||o.isDescendantOf(M._rootData)){for(var A=o._parent;A;)M.expand(A),A=A._parent;M._23I=o,M.iv()}}},R.checkData=function(g){var l,A=this,b=A._checkMode,M=A.sm(),V=M.co(g);if(!M.sg()||!V){if(A._32o=1,b===Gr)V?M.rs(g):M.as(g);else if(b===Ci)l=new bp(g),l.addAll(g._children);else if("descendant"===b)l=new bp,_s(g,l);else if("all"===b&&(l=new bp,_s(g,l),!V))for(var P=g._parent;P;)l.add(P),P=P._parent;l&&(V?M.rs(l):M.as(l)),delete A._32o}},R.drawTree=function(G,b,N,X,c,F,A){var y=this,D=y._indent,Z=y._levelMap[b._id],W=y.getIconWidth(b),$=vo(y.getToggleIcon(b));$?(X+=D*Z,Do(G,$,X+D/2,c+A/2,b,y),X+=D):X+=D*(Z+1),y._checkMode&&(Do(G,y.getCheckIcon(b),X+D/2,c+A/2,b,y),X+=D),y.drawIcon(G,b,X,c,W,A),y.drawLabel(G,b,X+W,c,A)}},jl._14Q=function(P){P.getIcon=function(h){return h.getIcon()},P.getIconWidth=function(O){return this.getIcon(O)?this._indent:0},P.drawIcon=function(z,L,k,S,F,O){if(F){var Y=this,x=Y.getBodyColor(L),m=vo(Y.getIcon(L),x);m&&(O-=Y.isRowLineVisible()?1:0,eq(z,m,vi,k,S,F,O,L,Y,x),ge(z,Y.getBorderColor(L),k,S,F,O))}},P.drawLabel=function(h,x,o,t,B){var n=this;dn(h,n.getLabel(x),n.getLabelFont(x),n.getLabelColor(x),o,t,0,B)}},jl._50o=function(y){y._98I=function(){var j=this,g=j._39o=new Ge;j._60I=new bp,g.mm(j._17o,j),g.md(j._18o,j),g.mh(j._19o,j)},y.setColumns=function(E){this._39o.clear(),this.addColumns(E)},y.addColumns=function(Q){var n=this._39o;Q.forEach(function(w){if(!(w instanceof gt)){var f=zq(w.className);w=ui(f?f:gt,w)}n.add(w)})},y.onColumnClicked=function(){},y.onCheckColumnClicked=function(){},y._3Q=function(V){for(var l,F=0,a=this._60I,r=a.size();r>F;F++)if(l=a.get(F),l.column===V)return l;return h},y.getColumnAt=function(e){var V=this._4Q(e);return V?V.column:h},y._4Q=function(S){for(var f=this,w=S.target?f.lp(S).x:S.x,U=f._60I,q=0;q<U.size();q++){var o=U.get(q),u=o.startX;if(w>=u&&w<u+o.column.getWidth())return o}return h},y.getToolTip=function(T){var b=this,p=b.getDataAt(T),e=b.getColumnAt(T);return p&&e?e.getToolTip(p,b):h},y.adjustTranslateX=function(l){var v=this.getWidth()-this._91I;return v>l&&(l=v),l>0?0:A(l)},y._99I=function(){var K=this,D=K._29I,t=K._60I;t.clear(),K._91I=0,K._39o._roots.each(function(s){if(s.isVisible()){var Q=K._91I+s.getWidth();K._91I<=D.x+D.width&&Q>=D.x&&t.add({column:s,startX:K._91I}),K._91I=Q}})},y.drawData=function(h,Y,D){var I=this,M=I._rowHeight,X=M*D,Q=I.isSelected(Y),$=I._29I,N=$.x,j=$.width;I.drawRowBackground(h,Y,Q,N,X,j,M),I._60I.each(function(y){var K=y.column,g=y.startX,t=K.getWidth();t>0&&!I.isEditing(Y,K)&&(h.save(),h.beginPath(),h.rect(g,X,t,M),h.clip(),I._87o(I.drawCell(h,Y,Q,K,g,X,t,M),D,g,X,t,M),I._columnLineVisible&&Tj(h,g+t-1,X,1,M,I._columnLineColor),h.restore())}),I._rowLineVisible&&Tj(h,N,X+M-1,j,1,I._rowLineColor)},y.drawCell=function(Q,n,h,i,R,I,Y,x){var c=this;if(i.drawCell)return i.drawCell(Q,n,h,i,R,I,Y,x,c);var m=c.getValue(n,i);at(Q,m,i,c.getLabelFont(n,i,m),c.getLabelColor(n,i,m),R,I,Y,x,n,c)},y.getColumnModel=function(){return this._39o},y._17o=function(){this.redraw()},y._18o=function(s){var k=this;s.data===k._sortColumn&&Xs[s.property]?k.ivm():(k._42o(),k.redraw())},y._19o=function(){this.redraw()},y.getCurrentSortFunc=function(){var u=this,n=u._sortColumn;if(n&&n.isSortable()){var g=n.getSortFunc(),w=jp===n.getSortOrder()?1:-1;return g||(g=zd),function(M,H){return g.call(u,u.getValue(M,n),u.getValue(H,n),M,H)*w}}return u._sortFunc},y.isCellEditable=function(R,P,_){return P.isEditable()&&this.isEditable()?P.isCellEditable?P.isCellEditable(R,P,_,this):!0:!1},y._37O=function(F,z){if(Pd(z))for(var x=this,v=x.lp(z),e=x._60I,u=x._rowHeight,l=x._29I,$=l.x,y=l.y,b=l.width,h=l.height,N=0;N<e.size();N++){var s=e.get(N),q=s.startX,c=s.column,I=c.getWidth();if(c!==x._31o&&c!==x._4o&&v.x>=q&&v.x<q+I&&x.isCellEditable(F,c,z)){var k={x:q,y:x.getRowIndex(F)*u,width:I,height:u},g={x:k.x+x.tx(),y:k.y+x.ty(),width:k.width,height:k.height},D=0,R=0;return k.x<$?D=k.x-$:k.x+k.width>$+b&&(D=k.x+k.width-$-b),D&&(x.tx(x.tx()-D),g.x-=D),k.y<y?R=k.y-y:k.y+u>y+h&&(R=k.y+u-y-h),R&&(x.ty(x.ty()-R),g.y-=R),x.beginEditing({data:F,column:c,value:x.getValue(F,c),event:z,rect:k,editorRect:g,view:x}),void 0}}}},dt.BaseItemEditor=function(o,f,H,b){this._data=o,this._column=f,this._master=H,this._editInfo=b},et("BaseItemEditor",w,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var ft=R.Tab=function(){_l(ft,this)};Dj("Tab",Dr,{ms_ac:["view","closable","disabled","visible"],_icon:h,_closable:!1,_disabled:!1,_visible:!0,setParent:zm});var gt=R.Column=function(){_l(gt,this)};Dj("Column",Dr,{_46o:1,ms_ac:["accessType","valueType",$r,Vg,Bh,wf,"align",xn,"sortOrder",Vm,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:jp,_sortFunc:h,_sortable:!0,_clickable:!0,setWidth:function(P){16>P&&(P=16);var n=this._width;this._width=P,this.fp(wf,n,P)},getToolTip:function(e,p){return this.formatValue(p.getValue(e,this))}});var ht=R.Property=function(){_l(ht,this)};Dj("Property",Dr,{_46o:1,ms_ac:["accessType","valueType",Vg,Bh,"categoryName",xn,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:h,getToolTip:function(f,e,Y){var b=this;return e?b.formatValue(Y.getValue(f,b)):Y.getPropertyName(b)}}),dt.AccordionView=function(){var R=this;R._20o={},R._21o=new bp,R._10o=h,R._9o=h,R._11o=h,R._view=fl(0,R),R.iv()},et("AccordionView",w,{ms_v:1,ms_fire:1,ms_ac:[_m,lb,"titleHeight",Cp,Zh,"titleBackground","selectWidth",Gp,"orientation","separatorColor"],_expandIcon:l.accordionViewExpandIcon,_collapseIcon:l.accordionViewCollapseIcon,_titleHeight:_c,_labelColor:l.accordionViewLabelColor,_labelFont:l.accordionViewLabelFont,_titleBackground:l.accordionViewTitleBackground,_selectBackground:l.accordionViewSelectBackground,_selectWidth:l.accordionViewSelectWidth,_orientation:"v",_separatorColor:l.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(K,D,E,x){var X=this,H=Xl(),$={content:D,div:H,canvas:Mb(H),icon:x};if(X._20o[K])throw K+" already exists";var W=$.downEventFunc=function($){jr($)},k=$.upEventFunc=function(k){jr(k),Pd(k)&&(X._10o===K?X.collapse():X.expand(K))};[bl,Sn].forEach(function(Q){e(H,Q,W)}),[jk,em].forEach(function(W){e(H,W,k)}),H.style.cursor=Oj,vk(X._view,H),X._20o[K]=$,X._21o.add(K),E&&X.expand(K),X.iv()},remove:function(s){var u=this,R=u._20o[s];if(R){var z=R.div;sn(z),[bl,Sn].forEach(function(_){J(z,_,R.downEventFunc)}),[jk,em].forEach(function(p){J(z,p,R.upEventFunc)}),delete u._20o[s],u._21o.remove(s),u.iv()}},clear:function(){var U=this;U._21o.toArray().forEach(U.remove,U),U._20o={},U._21o.clear(),U.iv()},isExpanded:function(j){return this._10o===j},expand:function(W){var N=this;N._20o[W]&&N._10o!==W&&(N._10o=W,N.onExpanded(W),N.iv())},onExpanded:function(){},collapse:function(){var J=this;J._10o&&(J.onCollapsed(J._10o),delete J._10o,J.iv())},onCollapsed:function(){},initCanvas:function(M,Q,o){qh(M,Q,o);var P=hb(M);return pm(P,0,0,1),P.clearRect(0,0,Q,o),P},drawTitle:function(F,D,b,i,m){var u=this,t=vo(m.icon),X=u.isExpanded(D),k=u._titleHeight,O=u._titleBackground,l=u._selectWidth,g=u._separatorColor,M=vo(X?u._expandIcon:u._collapseIcon),p=l+4;Tj(F,0,0,b,i,O),X&&l&&Tj(F,0,0,l,i,u._selectBackground),(X||u._21o.get(u._21o.size()-1)!==D)&&Tj(F,0,i-1,b,1,g?g:wp(O)),t&&(Do(F,t,p+sm(t)/2,k/2),p+=sm(t)+2),dn(F,D,u.getLabelFont(D),u.getLabelColor(D),p,0,0,k),M&&Do(F,M,b-sm(M)/2-4,k/2)},validateImpl:function(){var C=this,Q=C._view,u=0,K=0,O=C.getWidth(),F=C.getHeight(),b=C._titleHeight,S=C._21o.size()*b,l=C._11o,P=C._9o;delete C._11o,delete C._9o,C._21o.each(function(o){var V,A,H=C._20o[o],k=H.content,U=C._10o===o;Tm(C)?(cn(H.div,u,0,b,F),V=C.initCanvas(H.canvas,b,F),Df(V,0,F),Cs(V,-xr),C.drawTitle(V,o,F,b,H),V.restore(),U?(A=I(0,O-S),k&&(C._11o=k,C._9o=Sq(k),cn(k,u+b,0,A,F)),u+=b+A):u+=b):(cn(H.div,0,K,O,b),V=C.initCanvas(H.canvas,O,b),C.drawTitle(V,o,O,b,H),V.restore(),U?(A=I(0,F-S),k&&(C._11o=k,C._9o=Sq(k),cn(k,0,K+b,O,A)),K+=b+A):K+=b)});var U=C._9o;l&&l!==C._11o&&l.endEditing&&l.endEditing(),U&&U!==P&&vk(Q,U),P&&P!==U&&sn(P)}}),dt.SplitView=function(L,x,S,o){var R=this,F=R._dividerDiv=Xl(),$=R._60O=Mb(),n=R._61O=Mb(),U=$.style,T=n.style;R._view=fl(1,R),vk(R._view,F),U.msTouchAction=Cc,U.pointerEvents=Cc,U.cursor=Oj,T.msTouchAction=Cc,T.pointerEvents=Cc,T.cursor=Oj,L&&R.setLeftView(L),x&&R.setRightView(x),S&&R.setOrientation(S),o!=h&&R.setPosition(o),R.setStatus(Mr),new it(R)},et("SplitView",w,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:l.splitViewDividerSize,_dividerBackground:l.splitViewDividerBackground,_dragOpacity:l.splitViewDragOpacity,_toggleIcon:l.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(f,B){var Q=this,N=Q._position;isNaN(f)||(B||(Q._82O=0>f?-1:f>1?1:0),Q._position=f,Q.fp(tq,N,f))},getLeftView:function(){return this._leftView},setLeftView:function(y){var v=this,M=v._leftView,d=v._view;if(v._leftView!==y){if(M&&M!==v._rightView){var x=Sq(M);x.parentNode===d&&sn(x)}if(v._leftView=y,y){var u=Sq(y);u.parentNode!==d&&d.insertBefore(u,v._dividerDiv)}v.fp("leftView",M,y)}},getRightView:function(){return this._rightView},setRightView:function(n){var M=this,K=M._rightView,U=M._view;if(M._rightView!==n){if(K&&K!==M._leftView){var Y=Sq(K);Y.parentNode===U&&sn(Y)}if(M._rightView=n,n){var S=Sq(n);S.parentNode!==U&&U.insertBefore(S,M._dividerDiv)}M.fp("rightView",K,n)}},validateImpl:function(){var Z=this,l=Z._draggable,b=Z._position,a=Z.getWidth(),C=Z.getHeight(),K=Z._dividerSize,y=Z._dividerBackground,L=An?18:8,u=Z._dividerDiv,s=Z._82O,i=Z._60O,E=Z._61O,k=Z._toggleIcon,X=Z._status,q=u.style,z=null,N=An?20:4,o=k.comps[0];K>=L||0===K?Z._coverDiv&&(sn(Z._coverDiv),delete Z._coverDiv):Z._coverDiv||(Z._coverDiv=Xl(),Sj&&(Z._coverDiv.style.background=sr),vk(u,Z._coverDiv)),Z._togglable?i.parentNode||(vk(u,i),vk(u,E)):(sn(i),sn(E));var V=Z._coverDiv,W=Z._leftView,h=Z._rightView;if(Tm(Z)){if(K>a&&(K=a),X===Mr)if(1===s)var Y=v(b,a),w=I(0,a-K-Y);else-1===s?(w=v(-b,a),Y=I(0,a-K-w)):(Y=A((a-K)*b),w=I(0,a-K-Y));else"cl"===X?(Y=0,w=I(0,a-K)):"cr"===X&&(w=0,Y=I(0,a-K));W&&cn(W,0,0,Y,C),h&&cn(h,Y+K,0,w,C),cn(u,Y,0,K,C),Z._22o=Y,V&&(cn(V,K/2-L/2,0,L,C),V.style.cursor=l?yb:""),u.style.cursor=l?yb:"";var n=u.clientHeight/2,O=u.clientWidth;qh(i,O,O),cn(i,0,n-O-N,O,O),z=hb(i),pm(z,0,0,1),o.rotation=-xr,If(z,k,0,0,O,O),z.restore(),qh(E,O,O),cn(E,0,n+N,O,O),z=hb(E),pm(z,0,0,1),o.rotation=xr,If(z,k,0,0,O,O),z.restore()}else{if(K>C&&(K=C),X===Mr)if(1===s)var p=v(b,C),G=I(0,C-K-p);else-1===s?(G=v(-b,C),p=I(0,C-K-G)):(p=A((C-K)*b),G=I(0,C-K-p));else"cl"===X?(p=0,G=I(0,C-K)):"cr"===X&&(G=0,p=I(0,C-K));W&&cn(W,0,0,a,p),h&&cn(h,0,p+K,a,G),cn(u,0,p,a,K),Z._22o=p,V&&(cn(V,0,K/2-L/2,a,L),V.style.cursor=l?Lk:""),q.cursor=l?Lk:"";var e=u.clientWidth/2,O=u.clientHeight;qh(i,O,O),cn(i,e-O-N,0,O,O),z=hb(i),pm(z,0,0,1),o.rotation=0,If(z,k,0,0,O,O),z.restore(),qh(E,O,O),cn(E,e+N,0,O,O),z=hb(E),pm(z,0,0,1),o.rotation=S,If(z,k,0,0,O,O),z.restore()}q.background=y}});var it=function(N){this.sv=N,this.addListeners()};tr(it,w,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(S){var c=this,W=c.sv,X=W._dividerDiv,v=W._60O,o=W._61O,J=W._status,B=S.target;if(B===v)J===Mr?W.setStatus("cl"):"cr"===J&&W.setStatus(Mr);else if(B===o)J===Mr?W.setStatus("cr"):"cl"===J&&W.setStatus(Mr);else if(nj(S)&&(B===X||B===W._coverDiv)&&(jr(S),W.isDraggable())){W.getLeftView(),W.getRightView();var L=c.maskDiv=Xl();if(L.style.left=0,L.style.top=0,L.style.width=W.getWidth()+"px",L.style.height=W.getHeight()+"px",W.getView().appendChild(L),!W.isContinuousLayout()){var b=c.resizeDiv=Xl();b.style.left=X.style.left,b.style.top=X.style.top,b.style.width=X.style.width,b.style.height=X.style.height,b.style.opacity=W.getDragOpacity(),b.style.background=W.getDividerBackground(),vk(c.getView(),b)}c._lastAbsPosition=W._22o,c._86o=Tm(W)?Cd(S).x:Cd(S).y,Vc(c,S)}},handleWindowTouchMove:function(D){nj(D)&&this.update(D,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(e){var K=this;K.update(e,!0),K.sv.setStatus(Mr),K.maskDiv&&sn(K.maskDiv),K.resizeDiv&&sn(K.resizeDiv),K.maskDiv=K.resizeDiv=h},handle_mousedown:function(Y){Pd(Y)&&this.handle_touchstart(Y)},handleWindowMouseMove:function(d){this.handleWindowTouchMove(d)},handleWindowMouseUp:function(W){this.handleWindowTouchEnd(W)},update:function(m,z){var T=this,y=T.sv,k=Tm(y)?y.getWidth():y.getHeight(),C=y._dividerSize,A=T._lastAbsPosition-T._86o;Tm(y)?(A+=Cd(m).x,A>k-C&&(A=k-C),0>A&&(A=0),T.resizeDiv&&(T.resizeDiv.style.left=A+Ee)):(A+=Cd(m).y,A>k-C&&(A=k-C),0>A&&(A=0),T.resizeDiv&&(T.resizeDiv.style.top=A+Ee)),z&&k!==C&&(1===y._82O?y.setPosition(A,1):-1===y._82O?y.setPosition(A-k+C,1):y.setPosition(A/(k-C),1))}}),dt.TabView=function(){var S=this,x=S._view=fl(1,S),_=S._91O=Xl(1),n=S._tabModel=new Ge,s=n.sm(),H=S.invalidate;S._7o=new bp,S._canvas=Mb(_),vk(x,_),vk(x,S._92O=Xl(1)),s.setSelectionMode($o),s.ms(S.handleSelectionChange,S),n.mm(H,S),n.mh(H,S),n.md(H,S),S._interactor=new jt(S),S.iv()},et("TabView",w,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Cp,Zh,"tabHPadding","tabBackground","selectWidth",Gp,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:Pi,_tabHeight:_c,_tabGap:l.tabViewTabGap,_labelColor:l.tabViewLabelColor,_labelFont:l.tabViewLabelFont,_tabBackground:l.tabViewTabBackground,_selectWidth:l.tabViewSelectWidth,_selectBackground:l.tabViewSelectBackground,_moveBackground:l.tabViewMoveBackground,_insertColor:l.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(g,h,W){var j,J=this._tabModel;return g instanceof ft?(j=g,h&&j.setView(h)):(j=new ft,j.setName(g),j.setView(h)),J.add(j),W&&J.sm().ss(j),j},getLabel:function(m){return m.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(N){this._23o=N,this.iv()},get:function(X){var u=this,N=u._tabModel;if(ih(X))return N._roots.get(X);if(Ek(X)){var D;return N.each(function($){X===u.getLabel($)&&(D=$)}),D}return X instanceof ft?X:h},select:function(V){this._tabModel.sm().ss(this.get(V))},remove:function(q){var Y=this;if(q=Y.get(q)){var A=Y._tabModel,b=A._roots.indexOf(q);Y._tabModel.remove(q),Y.selectByIndex(--b)}},getCurrentTab:function(){return this._8o},hideTabView:function(n,v){v.parentNode===this._92O&&(_q(v)?(v.style.display=mb,v._tab_=n):sn(v),df())
},showTabView:function(e,g){_q(g)&&(g.style.display="block",g._tab_=e),g.parentNode!==this._92O&&(vk(this._92O,g),df())},_24o:function(){var K,J=this,W=J._8o,i=J._9o,U=J._tabModel.sm().ld();U&&(K=Sq(U.getView())),K!==i&&(i&&(W.getView()&&W.getView().endEditing&&W.getView().endEditing(),J.hideTabView(W,i)),K&&J.showTabView(U,K)),J._8o=U,J._9o=K,W!==U&&J.onTabChanged(W,U)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(L,Q){this.selectByIndex(--Q)},selectByIndex:function(s){var N=this,o=N._tabModel,X=o.size();if(X&&!o.sm().ld()){s==h&&(s=0),s>=X&&(s=X-1),0>s&&(s=0);for(var J=s;J>=0;J--){var I=N.get(J);if(!I.isDisabled())return N.select(I),I}for(J=s+1;X>J;J++)if(I=N.get(J),!I.isDisabled())return N.select(I),I}},getTabWidth:function(t){var Y=this.getTabHPadding(),b=4+2*Y,P=vo(t.getIcon());P&&(b+=sm(P,t)+4);var I=this.getLabel(t);return I&&(b+=Jm(this.getLabelFont(t),I).width+4),t.isClosable()&&(b+=10),b},drawTab:function(J,Q,E,w,Y,U,L){var N,A=this,v=A._tabPosition,u=this.getTabHPadding(),a=E+4+u,l=A._selectWidth,j=vo(Q.getIcon()),m=Q.isDisabled(),F=A.getLabelColor(Q),k=A.getLabelFont(Q),W=A.getLabel(Q),V=A._selectBackground,e=v===Se+"-vertical",s=v===_d+"-vertical";(e||s)&&(a=w+4+u),m&&(J.globalAlpha=Fq),Tj(J,E,w,Y,U,L),Q===A._8o&&l&&(v===Pi?Tj(J,E,w+U-l,Y,l,V):v===Se?Tj(J,E+Y-l,w,l,U,V):v===_d?Tj(J,E,w,l,U,V):e?Tj(J,E+Y-l,w,l,U,V):s?Tj(J,E,w,l,U,V):Tj(J,E,w,Y,l,V));var $=Y/2;if(e&&(Df(J,$,w+U/2),Cs(J,S),Df(J,-$,-w-U/2)),j){var H=wq(j,Q),n=sm(j,Q);if(e||s){var d=E+Y/2,z=a+H/2;Df(J,d,z),Cs(J,xr),Df(J,-d,-z),Do(J,j,E+Y/2,a+H/2,Q,A),Df(J,d,z),Cs(J,-xr),Df(J,-d,-z),a+=H+4}else Do(J,j,a+n/2,w+U/2,Q,A),a+=n+4}return e||s?(Df(J,Y/2,a+Y/2),Cs(J,xr),Df(J,-Y/2,-a-Y/2),dn(J,W,k,F,E,a,U,Y),Df(J,Y/2,a+Y/2),Cs(J,-xr),Df(J,-Y/2,-a-Y/2)):dn(J,W,k,F,a,w,Y,U),e&&(Df(J,$,w+U/2),Cs(J,-S),Df(J,-$,-w-U/2)),Q.isClosable()&&(N=s?{x:E+Y-12,y:w+U-12,width:12,height:12}:{x:E+Y-12,y:w+2,width:12,height:12},this.drawCloseIcon(Q,J,F,N)),m&&(J.globalAlpha=1),N},drawCloseIcon:function(l,R,g,h){var z=h.x,W=h.y;R.strokeStyle=g,R.lineWidth=1,R.beginPath(),R.moveTo(z+2,W+8),R.lineTo(z+8,W+2),R.moveTo(z+8,W+8),R.lineTo(z+2,W+2),R.stroke()},getTabAt:function(M){var F=this._interactor._8Q(M);return F?F.tab:null},validateImpl:function(){var s=this;s._24o();var q,C=s._canvas,y=s._tabPosition,d=s._91O,e=s._92O,Y=s._tabModel,M=s.getWidth(),S=s.getHeight(),W=s._tabHeight,o=s._7o,c=s._tabGap,h=y===Pi,P=y===Se,F=y===_d,w=y===Se+"-vertical",A=y===_d+"-vertical",p=s._23o,g=0;if((P||F)&&Y._roots.each(function(b){g=I(s.getTabWidth(b),g)}),h?(cn(d,0,0,M,W),q={x:0,y:W,width:M,height:I(0,S-W)}):P?(cn(d,0,0,g,S),q={x:g,y:0,width:I(0,M-g),height:S}):F?(cn(d,M-g,0,g,S),q={x:0,y:0,width:I(0,M-g),height:S}):w?(cn(d,0,0,W,S),q={x:W,y:0,width:I(0,M-W),height:S}):A?(cn(d,M-W,0,W,S),q={x:0,y:0,width:I(0,M-W),height:S}):(cn(d,0,S-W,M,W),q={x:0,y:0,width:M,height:I(0,S-W)}),cn(e,q),w||A){s._9o&&(q.x=0,cn(s._8o.getView(),q)),qh(C,W,S);var H=hb(C),b=0;if(pm(H,0,s.ty(),1),H.clearRect(0,0,W,S),o.clear(),Y._roots.each(function(F){if(F.isVisible()){var U,i=s.getTabWidth(F);if(!p||p.tab!==F){var V=s.getTabBackground(F);U=s.drawTab(H,F,0,b,W,i,V)}o.add({_75o:U,tab:F,startY:b,endY:b+i,height:i}),b+=i+c}}),s._23Q=I(0,b-c),p){var X=p.position;s.drawTab(H,p.tab,0,p.startY,W,p.height,s._moveBackground),Tj(H,0,X,W,1,s._insertColor)}if(H.restore(),s._selectionChanged){s._selectionChanged=!1;for(var l=s.ty(),U=0;U<o.size();U++){var G=o.get(U);if(G.tab===s._8o){if(G.endY+l<0){s.ty(-G.startY);break}if(G.startY+l>S){s.ty(S-G.endY);break}}}}s.ty(s.ty())}else if(P||F){s._9o&&(q.x=0,cn(s._8o.getView(),q)),qh(C,g,S);var H=hb(C),b=0;if(pm(H,0,s.ty(),1),H.clearRect(0,0,g,S),o.clear(),Y._roots.each(function(E){if(E.isVisible()){var l;if(!p||p.tab!==E){var q=s.getTabBackground(E);l=s.drawTab(H,E,0,b,g,W,q)}o.add({_75o:l,tab:E,startY:b,endY:b+W,height:W}),b+=W+c}}),s._23Q=I(0,b-c),p){var X=p.position;s.drawTab(H,p.tab,0,p.startY,g,p.height,s._moveBackground),Tj(H,0,X,g,1,s._insertColor)}if(H.restore(),s._selectionChanged){s._selectionChanged=!1;for(var l=s.ty(),U=0;U<o.size();U++){var G=o.get(U);if(G.tab===s._8o){if(G.endY+l<0){s.ty(-G.startY);break}if(G.startY+l>S){s.ty(S-G.endY);break}}}}s.ty(s.ty())}else{s._9o&&(q.y=0,cn(s._8o.getView(),q)),qh(C,M,W);var H=hb(C),$=0;if(pm(H,s.tx(),0,1),H.clearRect(0,0,M,W),o.clear(),Y._roots.each(function(e){if(e.isVisible()){var x,t=s.getTabWidth(e);if(!p||p.tab!==e){var R=s.getTabBackground(e);x=s.drawTab(H,e,$,0,t,W,R)}o.add({_75o:x,tab:e,startX:$,endX:$+t,width:t}),$+=t+c}}),s._64I=I(0,$-c),p){var X=p.position;s.drawTab(H,p.tab,p.startX,0,p.width,W,s._moveBackground),xh(H,s._insertColor,X,0,W)}if(H.restore(),s._selectionChanged){s._selectionChanged=!1;for(var k=s.tx(),U=0;U<o.size();U++){var G=o.get(U);if(G.tab===s._8o){if(G.endX+k<0){s.tx(-G.startX);break}if(G.startX+k>M){s.tx(M-G.endX);break}}}}s.tx(s.tx())}for(var v=[],Q=e.children,U=0;U<Q.length;U++){var D=Q[U],m=D._tab_;m&&!Y.contains(m)&&v.push(D)}v.forEach(function(M){e.removeChild(M)})}});var jt=function(j){this.tv=j,this.addListeners()};tr(jt,w,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(A){this.handleScroll(A,10*(A.wheelDelta/40))},handle_DOMMouseScroll:function(T){this.handleScroll(T,10*-T.detail)},handleScroll:function(R,E){jr(R);var u=this.tv,t=u._tabPosition;!u._40o()||t!==Pi&&t!==sp||u.tx(this.tv.tx()+E),!u._41o()||t!==Se&&t!==_d&&t!==Se+"-vertical"&&t!==_d+"-vertical"||u.ty(this.tv.ty()+E)},_8Q:function(V){var U,O,t=this.tv,u=t._tabPosition,s=t._7o;if(u===Pi||u===sp){var n=t.lp(V).x;for(U=0;U<s.size();U++)if(O=s.get(U),O.startX<=n&&n<=O.endX)return O}else if(u===Se||u===_d||u===Se+"-vertical"||u===_d+"-vertical"){var J=t.lp(V).y;for(U=0;U<s.size();U++)if(O=s.get(U),O.startY<=J&&J<=O.endY)return O}return h},isClickable:function(V){var $=this.tv,W=$._tabPosition,T=this._73o=this._8Q(V);return!$._40o()||W!==Pi&&W!==sp?!$._41o()||W!==Se&&W!==_d&&W!==Se+"-vertical"&&W!==_d+"-vertical"?T&&(!T.tab.isDisabled()||$.isMovable()):!0:!0},handle_mousemove:function(U){var b=this;dl?b._74o=b._8Q(U):b.getView().style.cursor=b.isClickable(U)?Oj:""},handle_mousedown:function(p){this.handle_mousemove(p),this.handle_touchstart(p)},handle_touchstart:function(l){var i=this,P=i.tv,K=P._tabPosition;jr(l),Pd(l)&&i.isClickable(l)&&(K===Pi||K===sp?(i.x=Cd(l).x,i.lp=P.lp(l),i.tx=P.tx()):(i.y=Cd(l).y,i.lp=P.lp(l),i.ty=P.ty()),Vc(i,l))},handleWindowMouseMove:function(z){this.handleWindowTouchMove(z)},handleWindowTouchMove:function(y){var q,w=this,D=w.tv,b=D._tabPosition,W=w._73o;if(b===Pi||b===sp){if(q=Cd(y).x-w.x,!w._25o&&!w.moving&&$(q)>2&&(D._40o()&&!Nq(y)?w._25o=1:W&&D.isMovable()&&(w.moving=1)),w._25o)D.tx(w.tx+q);else if(w.moving){var z=w.lp.x+q,f=D._tabGap/2;D._7o.each(function(u){var J=u.endX,e=z-u.startX<J-z;z>=u.startX&&J>=z&&D._7Q({tab:W.tab,startX:W.startX+q,width:W.width,front:e,insertTab:u.tab,position:e?I(0,u.startX-f):v(D._64I,J+f)})})}}else if(q=Cd(y).y-w.y,!w._25o&&!w.moving&&$(q)>2&&(D._41o()&&!Nq(y)?w._25o=1:W&&D.isMovable()&&(w.moving=1)),w._25o)D.ty(w.ty+q);else if(w.moving){var x=w.lp.y+q,f=D._tabGap/2;D._7o.each(function(M){var d=M.endY,u=x-M.startY<d-x;x>=M.startY&&d>=x&&D._7Q({tab:W.tab,startY:W.startY+q,height:W.height,front:u,insertTab:M.tab,position:u?I(0,M.startY-f):v(D._23Q,d+f)})})}},handleWindowMouseUp:function(C){this.handleWindowTouchEnd(C)},handleWindowTouchEnd:function(){var F=this,Z=F.tv,$=Z._tabPosition,Y=Z.getTabModel(),M=Y._roots,W=F._73o;if(F.moving){var B=Z._23o;if(B&&B.insertTab!==B.tab){var i=B.tab,J=M.remove(i),C=M.indexOf(B.insertTab);C>=0&&(B.front||C++,C<=M.size()&&(M.add(i,C),Y._38I(i,J,C)))}Z._7Q(h),delete F.moving}else if(!F._25o&&W){i=W.tab;var k=F._74o;if(!k||k.tab===i)if(!i.isDisabled()&&Ib(W._75o,F.lp)){var Q=function(){var V=M.indexOf(i);Y.remove(i),Z.onTabClosed(i,V)};Z.onTabClosing(i,Q)&&Q()}else i.isDisabled()||Z._8o===i||Y.sm().ss(i)}F._25o=F._73o=F._74o=$===Pi||$===sp?F.x=F.lp=F.tx=h:F.y=F.lp=F.ty=h}}),dt.PropertyView=function(r){var u=this;u._view=fl(1,u),u._canvas=Mb(u._view),vk(u._view,u._79O=Xl()),u._rows=new bp,u._28o=new bp,u._26o={},u._26Q={};var q=u._propertyModel=new Ge,Q=u.ivm;q.mm(Q,u),q.md(Q,u),q.mh(Q,u),u.dm(r?r:new Ge),new kt(u)},et("PropertyView",w,{ms_ac:[Cp,Vb,Zh,Vg,Bh,"categorizable",rm,Vm,nk,_m,lb,Cm,ue,cr,"selectRowIndex",Gp,"background",ae,is,Wj,ig,Go],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:zn,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:xs,_background:l.propertyViewBackground,_expandIcon:l.propertyViewExpandIcon,_collapseIcon:l.propertyViewCollapseIcon,_scrollBarColor:Wd,_scrollBarSize:ol,_autoHideScrollBar:Qg,_selectBackground:l.propertyViewSelectBackground,_rowHeight:Hb,_rowLineVisible:l.propertyViewRowLineVisible,_rowLineColor:l.propertyViewRowLineColor,_10I:.5,_columnLineVisible:l.propertyViewColumnLineVisible,_columnLineColor:l.propertyViewColumnLineColor,_labelColor:l.propertyViewLabelColor,_labelSelectColor:l.propertyViewLabelSelectColor,_labelFont:l.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(F){0>F&&(F=0),F>1&&(F=1);var k=this,c=k._10I;k._10I=F,k.fp("columnPosition",c,F)},getPropertyName:function(c){return c.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(a,X,K){return K===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(x,d){return d===this._selectRowIndex?this._labelSelectColor:x.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(g){var u=this.getHeight()-this._59I;return u>g&&(g=u),g>0?0:A(g)},isExpanded:function(j){if(!j)return!0;var x=this._26o[j];return x?x.isExpanded:!(this._26Q[j]===!1)},toggle:function(R){var P=this;P.isExpanded(R)?P.collapse(R):P.expand(R)},expandAll:function(){this.validate();for(var r in this._26o)this.expand(r)},expand:function(F){if(F&&F!==mb){var N=this,B=N._26o[F];B&&!B.isExpanded&&(B.isExpanded=!0,N.onExpanded(F),N.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var G in this._26o)this.collapse(G)},collapse:function(B){if(B&&B!==mb){var i=this,R=i._26o[B];R&&R.isExpanded&&(R.isExpanded=!1,i.onCollapsed(B),i.ivm())}},onCollapsed:function(){},getCategoryName:function(q){if(!this.isCategorizable())return mb;var Y=q.getCategoryName();return Y?Y:mb},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(C){var T=this,b=T._dataModel;b!==C&&(b&&(b.umd(T.handlePropertyChange,T),T._selectionModel||b.sm().ums(T.handleSelectionChange,T)),T._dataModel=C,C.md(T.handlePropertyChange,T),T._selectionModel?T._selectionModel._21I(C):C.sm().ms(T.handleSelectionChange,T),T.fp(br,b,C))},isVisible:function(P){return this._visibleFunc?this._visibleFunc(P):!0},onPropertyChanged:function(b){var V=this,r=b.property;$s[r]?V.ivm():V.iv(),r===Yf&&V._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:zs},handlePropertyChange:function(U){this._27o===U.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var k=this;k._96I||(k.setSelectRowIndex(-1),k._96I=1,k.iv())},redraw:function(){this.iv()},validateModel:function(){var I=this,A=I._rows,k=I._28o,N={},Y=new bp,W=I._27o;I.updateCurrentData(),W!==I._27o&&I.endEditing(),A.clear(),k.clear(),I.getRawProperties().each(function(b){if(I.isVisible(b)){Y.add(b);var H=I.getCategoryName(b);N[H]||(k.add(H,H===mb?0:B),N[H]={isExpanded:I.isExpanded(H),properties:new bp})}}),I._sortFunc&&Y.sort(I._sortFunc);for(var p in I._26o)I._26Q[p]=I.isExpanded(p);I._26o=N,k.each(function(E){E!==mb&&A.add(E);var v=N[E];v.isExpanded&&Y.each(function(l){I.getCategoryName(l)===E&&(v.properties.add(l),A.add({property:l,data:I._27o}))},I)})},validateImpl:function(){var m=this;m._76o(),m._96I&&(m.validateModel(),delete m._96I);var s=m._canvas,o=m.getWidth(),P=m.getHeight(),S=-m.ty(),d=m._rowHeight,V=m._indent,n=o-V,Z=m._rows,x=Z.size(),i=m._9I=V+n*m._10I,b=m._59I=x*d;qh(s,o,P),m._29I={x:0,y:S,width:o,height:P},m._31I=c(S/d),m._14I=g((S+P)/d),m._31I<0&&(m._31I=0),m._14I>x&&(m._14I=x);var W,v=hb(s),X=m._background;pm(v,0,-S,1),v.beginPath(),v.rect(0,S,o,P),v.clip(),v.clearRect(0,S,o,P),m._93db(v),X&&Tj(v,0,0,V,b,X);for(var N=m._31I;N<m._14I;N++){var B=Z.get(N),S=d*N;if(Ek(B))X&&Tj(v,V,S,n,d,X),W=vo(m.isExpanded(B)?m._expandIcon:m._collapseIcon),W&&eq(v,W,vi,0,S,V,d),v.save(),v.beginPath(),v.rect(V,S,n,d),v.clip(),m.drawCategoryName(v,B,N,V,S,n,d),v.restore();else{var w=B.property,k=B.data,W=vo(w.getIcon()),j=m._selectRowIndex===N?m.getSelectBackground():h;if(W&&eq(v,W,vi,0,S,V,d),j&&Tj(v,V,S,n,d,j),v.save(),v.beginPath(),v.rect(V,S,i-V,d),v.clip(),m.drawPropertyName(v,w,N,V,S,i-V,d),v.restore(),!m.isEditing(k,w)){var r=i+1,J=o-i-1;v.save(),v.beginPath(),v.rect(r,S,J,d),v.clip(),m._87o(m.drawPropertyValue(v,w,m.getValue(k,w),N,r,S,J,d,k),N,r,S,J,d),v.restore()}}m._rowLineVisible&&Tj(v,V,S+d-1,n,1,m._rowLineColor)}m._columnLineVisible&&(Tj(v,i,0,1,b,m._columnLineColor),Tj(v,o-1,0,1,b)),m._92db(v),m._93I(),v.restore(),m.ty(m.ty())},drawCategoryName:function(D,K,B,g,r,h,s){dn(D,K,this.getCategoryFont(K),this.getCategoryColor(K),g,r,h,s)},drawPropertyName:function(d,E,N,l,K,b,m){return E.drawPropertyName?(E.drawPropertyName(d,E,N,l,K,b,m,this),void 0):(dn(d,this.getPropertyName(E),this.getPropertyFont(E,N),this.getPropertyColor(E,N),l,K,b,m),void 0)},drawPropertyValue:function(q,t,P,L,C,H,M,D,d){return t.drawPropertyValue?t.drawPropertyValue(q,t,P,L,C,H,M,D,d,this):(at(q,P,t,this.getLabelFont(t,P,L),this.getLabelColor(t,P,L),C,H,M,D,d,this),void 0)},isPropertyEditable:function(m){return m.isEditable()&&this.isEditable()},setProperties:function(i){this._propertyModel.clear(),this.addProperties(i)},addProperties:function(f){if(f){var w=this._propertyModel;f.forEach(function(D){if(!(D instanceof ht)){var J=zq(D.className);D=ui(J?J:ht,D)}w.add(D)})}},getRowIndexAt:function(v){var T=this,n=c(T.lp(v).y/T._rowHeight);return n>=0&&n<T._rows.size()?n:-1},getPropertyAt:function(U){var K=this,b=K.getRowIndexAt(U);return b>=0?K._rows.get(b).property:h},getToolTip:function(Z){var C=this,m=C.getPropertyAt(Z),w=C._27o;return m&&w?m.getToolTip(w,C._9I<C.lp(Z).x,C):h}});var kt=function(l){this.pv=l,this.addListeners()};tr(kt,w,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(f){this.getView().style.cursor=f},clear:function(){var M=this;M._62O=M.cp=M.ty=M.p=h,M.setCursor(Gr)},handle_mousedown:function(Q){this.handle_touchstart(Q)},handle_touchstart:function(I){var G=this,S=G.pv;jr(I),S.setFocus(I)&&(Pd(I)?(G.cp=Cd(I),G.ty=S.ty(),G.p=S.getColumnPosition(),G.handle_touchmove(I)):S.setSelectRowIndex(S.getRowIndexAt(I)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(L){this.handle_touchend(L)},handle_touchend:function(F){var M=this;if(M.cp&&!M._62O){var R=M.pv,k=R.lp(F),$=k.x,v=k.y,Y=R._indent,h=R.getRowIndexAt(F),D=R._9I;if(h>=0){var H=R._rowHeight,P=H*h,Q=R._rows.get(h),x=Q.property;if(Ek(Q))vo(R.isExpanded(Q)?R._expandIcon:R._collapseIcon)&&$>=0&&Y>=$&&v>=P&&P+H>=v?R.toggle(Q):xi(F)&&R.toggle(Q);else if($>D&&R.isPropertyEditable(x,F)){var O={x:D+1,y:P,width:R.getWidth()-D-1,height:H},J={x:O.x+R.tx(),y:O.y+R.ty(),width:O.width,height:O.height},L=0,l=R._29I;O.y<l.y?L=O.y-l.y:O.y+H>l.y+l.height&&(L=O.y+H-l.y-l.height),L&&(R.ty(R.ty()-L),J.y-=L),R.beginEditing({data:Q.data,property:x,value:R.getValue(Q.data,x),event:F,rect:O,editorRect:J,view:R})}}R.setSelectRowIndex(h)}M.clear()},handleWindowMouseMove:function(L){this.handleWindowTouchMove(L)},handleWindowTouchMove:function(K){var Z=this,y=Z.pv,X=Z.ty,Q=Z.cp,$=Cd(K),o=Z._62O;if("p"===o)y.setTranslateY(X+$.y-Q.y);else if("c"===o){var G=y.getWidth()-y._indent;if(G>16){var x=Z.p-(Q.x-$.x)/G,d=16/G;d>x&&(x=d),x>1-d&&(x=1-d),y.setColumnPosition(x)}}else"s"===o&&y.setTranslateY(X+(Q.y-$.y)*y._59I/y._29I.height)},handle_mousemove:function(g){this.handle_touchmove(g)},handle_touchmove:function(m){if(!dl&&Pd(m)){var H=this,k=H.pv,N=$(k.lp(m).x-k._9I)<=(An?8:3);H.cp?H._62O||(N?(H._62O="c",Vc(H,m)):$(Cd(m).y-H.cp.y)>=2&&(H._62O=H.isV(m)?"s":"p",Vc(H,m))):(N?H.setCursor(yb):H.setCursor(Gr),H.isV(m)&&k._43o())}},isV:function(C){var w=this.pv,Y=w._29I;return w._41o()&&Y.x+Y.width-w.lp(C).x<yq},handle_mousewheel:function(n){this.handleScroll(n,n.wheelDelta/40)},handle_DOMMouseScroll:function(W){2===W.axis&&this.handleScroll(W,-W.detail)},handleScroll:function(U,I){var O=this.pv;jr(U),O.endEditing(),O.translate(0,I*O.getRowHeight())},handle_keydown:function(H){var J=this.pv,D=J._rows.size(),j=J._selectRowIndex+(Gh(H)?-1:1);(Gh(H)||di(H))&&(0>j&&(j=0),j>=D&&(j=D-1),J.setSelectRowIndex(j))}}),dt.ListView=function(L){this._5o(L),new lt(this)},et("ListView",w,{ms_ac:[Cp,Vb,Zh,ae,rm,is,Wj,Vm,nk,Cm,ue,cr,_i,Gp],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:xs,_rowHeight:Hb,_rowLineVisible:l.listViewRowLineVisible,_rowLineColor:l.listViewRowLineColor,_scrollBarColor:Wd,_scrollBarSize:ol,_autoMakeVisible:ws,_autoHideScrollBar:Qg,_selectBackground:l.listViewSelectBackground,_labelColor:l.listViewLabelColor,_labelSelectColor:l.listViewLabelSelectColor,_labelFont:l.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(F){var g=this,P=g._checkMode;g._checkMode=F,g.fp(yf,P,F)},drawRow:function(k,x,m,f,o,I,V){var L=this,T=0,l=L._indent,B=L.getIconWidth(x);L.drawRowBackground(k,x,m,f,o,I,V),L._checkMode&&(Do(k,vo(L.getCheckIcon(x)),T+l/2,o+V/2,x,L),T+=l),L.drawIcon(k,x,T,o,B,V),L.drawLabel(k,x,T+B,o,V)}});var lt=function(A){this.list=A,this.addListeners()};tr(lt,w,{ms_listener:1,getView:function(){return this.list._view},clear:function(b){var E=this,y=E.list;b&&"d"===E._62O&&!E.dragCancel&&y.handleDragAndDrop(b,"end"),y.draggingData&&(y.draggingData=null,y.redraw()),E.dragCancel=E._62O=E._isV=E._isH=E.cp=E.tx=E.ty=h},handle_mousedown:function(b){this.handle_touchstart(b)},handle_touchstart:function(G){var Q=this,k=Q.list;if(jr(G),k.setFocus(G)){var _=k.getDataAt(G);Q.cp=Cd(G),Q.tx=k.tx(),Q.ty=k.ty(),Pd(G)?_&&k.handleDragAndDrop&&!Q.isV(G)&&!Q.isH(G)&&(k.draggingData=_,k.redraw(),k.handleDragAndDrop(G,"prepare")):(_?Q._33o(G,_):this._cancelDataDoubleSelect(),Q.clear(G))}},handleWindowMouseUp:function(b){this.clear(b)},handleWindowTouchEnd:function(s){this.clear(s)},handle_mouseup:function(o){this.handle_touchend(o)},handle_touchend:function(f){var H=this,$=H.list;if(!H._isV&&!H._isH&&H.cp&&!H._62O){var P=$.getDataAt(f);P?($.isCheckMode()?H._34o(f,P):H._33o(f,P),xi(f)?$.onDataDoubleClicked(P,f):$.onDataClicked(P,f)):(H._cancelDataDoubleSelect(),$.handleBackgroundClick(f))}H.clear(f)},handleWindowMouseMove:function(q){this.handleWindowTouchMove(q)},handleWindowTouchMove:function(M){var s=this,K=s.list,k=s._62O,r=s.tx,Z=s.ty,A=s.cp,z=Cd(M),I=K._29I;"p"===k?K.setTranslate(r+z.x-A.x,Z+z.y-A.y):"v"===k?K.ty(Z+(A.y-z.y)*K._59I/I.height):"h"===k?K.tx(r+(A.x-z.x)*K._91I/I.width):"d"===k&&(s.dragCancel||K.handleDragAndDrop(M,"between"))},handle_mousemove:function(W){this.handle_touchmove(W)},handle_touchmove:function(C){if(!dl&&Pd(C)){var H=this,Y=H.list;if(H._isV=H.isV(C),H._isH=H.isH(C),H.cp){if(!H._62O){if(Jf(Cd(C),H.cp)<2)return;H._isV?H._62O="v":H._isH?H._62O="h":Y.draggingData&&!this.dragCancel?(H._62O="d",Y.handleDragAndDrop(C,"begin")):H._62O="p",H._62O&&"d"!==H._62O&&Y.draggingData&&(Y.draggingData=null,Y.redraw()),Vc(H,C)}}else H._isV&&Y._43o(),H._isH&&Y._42o()}},isV:function(G){var D=this.list,V=D._29I;return D._41o()&&V.x+V.width-D.lp(G).x<yq},isH:function(_){var x=this.list,o=x._29I;return x._40o()&&o.y+o.height-x.lp(_).y<yq},handle_mousewheel:function(I){this.handleScroll(I,I.wheelDelta/40,I.wheelDelta!==I.wheelDeltaX)},handle_DOMMouseScroll:function(f){this.handleScroll(f,-f.detail,1)},handleScroll:function(c,U,Z){var p=this.list;jr(c),p.endEditing&&p.endEditing(),Z&&p._41o()?p.translate(0,U*p.getRowHeight()):p._40o()&&p.translate(10*U,0)},handle_keydown:function(Q){if(!l.isInput(Q.target)){var E,S=this.list,I=S.sm(),e=S._rows,n=e.size();if(id(Q))S.selectAll();else if(Ej(Q))S.handleDelete&&S.handleDelete(Q);else if(oo(Q))"d"!==this._62O||this.dragCancel||(S.handleDragAndDrop(Q,"cancel"),this.dragCancel=!0);else if(fr(Q))S.isCheckMode()&&(E=S.getFocusData(),E&&S.checkData(E));else if(Gh(Q)||di(Q)){var H=S.isCheckMode();if(E=H?S.getFocusData():I.ld()){var w=S.getRowIndex(E);w>=0&&(Gh(Q)?0!==w&&(E=e.get(w-1),H?S.setFocusData(E):I.ss(E)):w!==n-1&&(E=e.get(w+1),H?S.setFocusData(E):I.ss(E)))}else n>0&&(E=e.get(0),H?S.setFocusData(E):I.ss(E))}}},_34o:function(n,a){var E=this.list,B=E.lp(n).x;return B>=0&&B<=E._indent?(E.checkData(a),void 0):(E.setFocusData(a),void 0)},_33o:function(f,j){var g=this.list,U=g.sm(),R=U.ld();if(!g.canHandleSelectMode(f,j))return this._cancelDataDoubleSelect(),void 0;if(Nq(f))g.isSelected(j)?U.rs(j):U.as(j);else if(sh(f))if(R)for(var P=g.getRowIndex(R),C=g.getRowIndex(j);P!==C;)P+=C>P?1:-1,U.as(g._rows.get(P));else U.ss(j);else Pd(f)?(U.contains(j)?g.handleDataDoubleSelect&&(this._handleDataDoubleSelect(f,j),xi(f)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),U.ss(j)):U.contains(j)||U.ss(j)},_handleDataDoubleSelect:function(b,y){this._cancelDataDoubleSelect(),this._doubleSelectTimer=kl(function(){this.list.handleDataDoubleSelect(b,y),this._doubleSelectTimer=B}.bind(this),l.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(vc(this._doubleSelectTimer),this._doubleSelectTimer=B)}}),dt.TreeView=function(G){var j=this;j._35o(),j._5o(G),new mt(j)},et("TreeView",w,{ms_ac:[Cp,Vb,Zh,"rootVisible",yf,"rootData",Vm,nk,Cm,ue,cr,rm,ae,is,Wj,_m,lb,_i,Gp,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:h,_indent:xs,_rowHeight:Hb,_rowLineVisible:l.treeViewRowLineVisible,_rowLineColor:l.treeViewRowLineColor,_scrollBarColor:Wd,_scrollBarSize:ol,_autoHideScrollBar:Qg,_expandIcon:l.treeViewExpandIcon,_collapseIcon:l.treeViewCollapseIcon,_autoMakeVisible:ws,_selectBackground:l.treeViewSelectBackground,_labelColor:l.treeViewLabelColor,_labelSelectColor:l.treeViewLabelSelectColor,_labelFont:l.treeViewLabelFont,_doubleClickToToggle:l.treeViewDoubleClickToToggle,drawRow:function(J,f,k,x,c,B,_){var p=this;p.drawRowBackground(J,f,k,x,c,B,_),p.drawTree(J,f,k,0,c,B,_)},isOnToggleIcon:function(j){var z=this.getDataAt(j);if(z){var b=this.getIndent(),R=this.lp(j).x;if(vo(this.getToggleIcon(z))){var x=b*this.getLevel(z);if(R>=x&&x+b>=R)return!0}}return!1}});var mt=function(c){_l(mt,this,[c])};tr(mt,lt,{toggle:function(g,f,j,Y){var p=this.list,o=p.lp(g).x;if(vo(p.getToggleIcon(f))){var v=j*Y;if(o>=v&&v+j>=o)return p.toggle(f),!0}return p.isDoubleClickToToggle()&&xi(g)?(p.toggle(f),!0):!1},_34o:function(N,P){var s=this.list,x=s.lp(N).x,v=s._levelMap[P._id],I=s._indent,r=I*(v+1);return x>=r&&r+I>=x?(s.checkData(P),void 0):(this.toggle(N,P,I,v)||s.setFocusData(P),void 0)},_33o:function(Z,h){var z=this,l=z.list;if(!z.toggle(Z,h,l._indent,l.getLevel(h)))if(sh(Z)){var r=l.sm();if(r.size()>0){for(var P=l._rows,I=null,V=0,k=P.size();k>V;V++)if(l.isSelected(P.get(V))){I=V;break}for(var x=null,V=P.size()-1;V>=0;V--)if(l.isSelected(P.get(V))){x=V;break}var Q,u,K=l.getRowIndex(h);for(I>K?(Q=K-1,u=I):K>x?(Q=x,u=K):(Q=I,u=x);Q!==u;)Q++,r.as(l._rows.get(Q))}else r.ss(h)}else mt.superClass._33o.call(z,Z,h)},handle_keydown:function(q){if(bq(q)||jh(q)){var y=this.list,e=y._rows,w=y.isCheckMode(),Z=y.sm(),o=w?y.getFocusData():Z.ld();o?o.hasChildren()&&(bq(q)?y.collapse(o):y.expand(o)):e.size()>0&&(o=e.get(0),w?y.setFocusData(o):Z.ss(o))}else mt.superClass.handle_keydown.call(this,q)}});var nt=dt.TableView=function(g){this._98I(),this._5o(g),new ot(this)};et("TableView",w,{ms_ac:[Cp,Vb,Zh,"sortMode",Vg,Bh,ae,is,Wj,ig,Go,"sortColumn",Vm,nk,Cm,ue,cr,_i,Gp],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:ci,_editable:!0,_batchEditable:!1,_rowHeight:Hb,_rowLineVisible:l.tableViewRowLineVisible,_rowLineColor:l.tableViewRowLineColor,_columnLineVisible:l.tableViewColumnLineVisible,_columnLineColor:l.tableViewColumnLineColor,_scrollBarColor:Wd,_scrollBarSize:ol,_autoHideScrollBar:Qg,_autoMakeVisible:ws,_selectBackground:l.tableViewSelectBackground,_labelColor:l.tableViewLabelColor,_labelSelectColor:l.tableViewLabelSelectColor,_labelFont:l.tableViewLabelFont,getCheckColumn:function(){var w=this;if(!w._31o){var l=w._31o=new gt;l.setEditable(!0),l.setWidth(40),l.getValue=w.getCheckColumValue,l.drawCell=w.drawCheckColumnCell}return w._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(X){var N=this,U=N._39o,A=N.getCheckColumn();X!==N.isCheckMode()&&(X?U.add(A,0):U.remove(A),N.fp(yf,!X,X))},getCheckColumValue:function(U,c,t){return t.isSelected(U)},drawCheckColumnCell:function(B,_,t,L,b,T,o,k,H){Do(B,H.getCheckIcon(_),b+o/2,T+k/2,_,H)}});var ot=function(M){_l(ot,this,[M])};tr(ot,lt,{_34o:function(l,H){var g=this.list,P=g._31o;if(g.isCellEditable(H,P,l)){var _=g._3Q(P),b=g.lp(l).x;if(_&&b>=_.startX&&b<_.startX+P.getWidth())return g.checkData(H),void 0}g._37O(H,l),g.setFocusData(H)},_33o:function(Y,I){this.list._37O(I,Y),ot.superClass._33o.apply(this,arguments)}});var pt=dt.TreeTableView=function(T){var O=this,m=O._4o=new gt;O._35o(),O._98I(),O._5o(T),m.setDisplayName("Name"),m.setEditable(!0),m.setWidth(180),m.drawCell=qt,m.getValue=rt,O._39o.add(m),new st(O)},qt=function(X,C,Z,N,c,D,Y,z,v){v.drawTree(X,C,Z,c,D,Y,z)},rt=function(O,G,s){return s.getLabel(O)};et("TreeTableView",w,{ms_ac:[Cp,Vb,Zh,"sortMode",Vg,Bh,rm,yf,"rootData","rootVisible",Vm,nk,"sortColumn",_m,lb,Cm,ue,cr,_i,Wj,ae,is,ig,Go,Gp,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:ci,_checkMode:h,_editable:!0,_batchEditable:!1,_indent:xs,_rowHeight:Hb,_rowLineVisible:l.treeTableViewRowLineVisible,_rowLineColor:l.treeTableViewRowLineColor,_columnLineVisible:l.treeTableViewColumnLineVisible,_columnLineColor:l.treeTableViewColumnLineColor,_expandIcon:l.treeTableViewExpandIcon,_collapseIcon:l.treeTableViewCollapseIcon,_scrollBarColor:Wd,_scrollBarSize:ol,_autoHideScrollBar:Qg,_autoMakeVisible:ws,_selectBackground:l.treeTableViewSelectBackground,_labelColor:l.treeTableViewLabelColor,_labelSelectColor:l.treeTableViewLabelSelectColor,_labelFont:l.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var st=function(i){_l(st,this,[i])};tr(st,lt,{_34o:function(B,r){var s=this.list,e=s._4o,g=s._3Q(e),$=s.lp(B).x;if(g){var t=s._indent,Y=g.startX+t*s.getLevel(r);if(vo(s.getToggleIcon(r))&&$>=Y&&Y+t>=$)return s.toggle(r),void 0;if(s.isCellEditable(r,e)&&(Y+=t,$>=Y&&Y+t>=$))return s.checkData(r),void 0}s._37O(r,B),s.setFocusData(r)},_33o:function(O,H){var R=this.list,K=R.lp(O).x;if(vo(R.getToggleIcon(H))){var e=R._3Q(R._4o);if(e){var b=R._indent,W=e.startX+b*R.getLevel(H);if(K>=W&&W+b>=K)return R.toggle(H),void 0}}R._37O(H,O),st.superClass._33o.apply(this,arguments)}});var tt=dt.TableHeader=function(Y){var d=this,Z=d._view=fl(1,d),e=d._39o=Y.getColumnModel(),v=d.iv;d.tv=d._tableView=Y,d._60I=new bp,d._canvas=Mb(Z),Z.style.background=l.tableHeaderBackground||"",Z.style.height=yi+Ee,e.mm(v,d),e.md(v,d),e.mh(v,d),Y.mp(function(W){Ws[W.property]&&d.iv()},d),new ut(d),d.iv()};et("TableHeader",w,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Cp,Zh,rm,"moveBackground","insertColor",ig,Go,"resizable","movable"],_checkIcon:hn,_movable:!0,_resizable:!0,_labelColor:l.tableHeaderLabelColor,_labelFont:l.tableHeaderLabelFont,_columnLineColor:l.tableHeaderColumnLineColor,_columnLineVisible:l.tableHeaderColumnLineVisible,_sortDescIcon:l.tableHeaderSortDescIcon,_sortAscIcon:l.tableHeaderSortAscIcon,_moveBackground:l.tableHeaderMoveBackground,_insertColor:l.tableHeaderInsertColor,_indent:xs,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(U){return U.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(z){return z.getColor()||this._labelColor},getLabelAlign:function(q){return q._align},onPropertyChanged:function(){this.iv()},_5Q:function(v){this._61I=v,this.iv()},getLogicalPoint:function(U){return ug(U,this._canvas,this.tv.tx())},validateImpl:function(){var p=this,c=p._canvas,G=p.getWidth(),X=p.getHeight(),r=p.tv,D=p._60I,t=p._61I,S=-r.tx(),b=0;(G!==c.clientWidth||X!==c.clientHeight)&&qh(c,G,X),D.clear(),p._39o._roots.each(function(n){if(n.isVisible()){var g=b+n.getWidth();S+G>=b&&g>=S&&D.add({column:n,startX:b}),b=g}});var M=hb(c);if(pm(M,-S,0,1),M.beginPath(),M.rect(S,0,G,X),M.clip(),M.clearRect(S,0,G,X),D.each(function(l){var m=l.column,T=l.startX,V=m.getWidth();V>0&&(M.save(),M.beginPath(),M.rect(T,0,V,X),M.clip(),t&&t.column===m||p.drawColumn(M,m,T,0,V,X),p._columnLineVisible&&Tj(M,T+V-1,0,1,X,p._columnLineColor),M.restore())}),t){var y=t.column,b=t.startX,R=t.position,$=y.getWidth();M.save(),M.beginPath(),M.rect(b,0,$,X),M.clip(),M.fillStyle=p._moveBackground,M.fill(),p.drawColumn(M,y,b,0,$,X),M.restore(),xh(M,p._insertColor,R,0,X)}M.restore()},_6Q:function(K){var R=this.tv;return R._31o===K&&R.sm().getSelectionMode()===Me},drawColumn:function(s,l,z,c,L,X){var B=this,J=B.tv,K=vo(l.getIcon()),F=B.getLabelAlign(l);if(B._6Q(l)){var $=vo(B._checkIcon);Do(s,$,z+L/2,c+X/2,l,B)}else{var q=B.getLabel(l),a=B.getLabelFont(l),Y=B.getLabelColor(l),y=Jm(a,q).width,k=K?B._indent:0;F===Se?(K&&eq(s,K,vi,z,c,k,X),dn(s,q,a,Y,z+k,c,L,X,Se)):F===_d?(K&&eq(s,K,vi,z+L-y-k,c,k,X),dn(s,q,a,Y,z,c,L,X,_d)):(K&&eq(s,K,vi,z+(L-y-k)/2,c,k,X),dn(s,q,a,Y,z+(L-y+k)/2,c,0,X,Se))}if(l.isSortable()&&J.getSortColumn()===l&&(K=vo(l.getSortOrder()===jp?B._sortAscIcon:B._sortDescIcon))){var w=sm(K,l)/2+2;Do(s,K,F===_d?z+w:z+L-w,c+X/2,l,J)}}});var ut=function(F){var Y=this;Y.th=F,Y.tv=F._tableView,Y.addListeners()};tr(ut,w,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(m){this.getView().style.cursor=m},handle_mousemove:function(n){if(!dl){var N=this;delete N._29o,N.setCursor(Gr);for(var q=N.th,t=q._60I,R=q.lp(n).x,L=t.size()-1;L>=0;L--){var _=t.get(L),Q=_.column,c=_.startX+Q.getWidth();if(q.isResizable()&&$(c-R)<=(An?10:3))return N._29o=_,N.setCursor(yb),void 0;R>_.startX&&c>R&&(N._29o=_),(Q.isClickable()||Q.isSortable()||q.isMovable()||N.tv.getCheckColumn&&Q===N.tv.getCheckColumn())&&R>_.startX&&c>R&&N.setCursor(Oj)}}},handle_mousedown:function(Z){this.handle_touchstart(Z)},handle_touchstart:function(L){var H=this;jr(L),H.tv.endEditing(),H.handle_mousemove(L),H._29o&&(H.x=Cd(L).x,H.lx=H.th.lp(L).x,H.w=H._29o.column.getWidth(),Vc(H,L))},handleWindowMouseMove:function(x){this.handleWindowTouchMove(x)},handleWindowTouchMove:function(E){var g=this,i=g.th,q=g.getView().style.cursor,l=g._29o,Q=Cd(E).x-g.x;if(g.resizing||g.moving||(q===yb?g.resizing=1:i.isMovable()&&q===Oj&&$(Q)>2&&(g.moving=1)),g.resizing)l.column.setWidth(g.w+Q);else if(g.moving){var H=g.lx+Q;i._60I.each(function(v){var h=v.startX,z=h+v.column.getWidth();if(H>=h&&z>=H){var Y={column:l.column,startX:l.startX+Q,front:z-H>H-h,insertColumn:v.column};Y.position=Y.front?h:z,i._5Q(Y)}})}},_16Q:function(e,v){var O=this,i=O.tv,L=O.th,k=L._checkIcon;if(L._6Q(e)){var G=vo(k),E=O.lx,g=e.getWidth(),Y=sm(G,e);if(E>=v+g/2-Y&&v+g/2+Y>=E){L.setCheckIcon(k===Hq?hn:Hq);var D=i.sm(),H=i._rows;return k===Hq?D.rs(H):D.ss(H),i.onCheckColumnClicked(e),!0}}return!1},handleWindowMouseUp:function(U){this.handleWindowTouchEnd(U)
},handleWindowTouchEnd:function(k){var a=this,n=a.tv,G=a.th,W=a._29o;if(a.moving){var L=G._61I;if(L&&L.insertColumn!==L.column){var S=L.column,t=n.getColumnModel()._roots,V=t.remove(S),K=t.indexOf(L.insertColumn);K>=0&&(L.front||K++,K<=t.size()&&(t.add(S,K),n.getColumnModel()._38I(S,V,K)))}G._5Q(h),delete a.moving}else if(!a.resizing&&W){S=W.column;var x=G.lp(k).x,y=W.startX,g=!0;if(G.onColumnClicked){var o=G.onColumnClicked(S,k,y);o===!1&&(g=!1)}if(g&&x>=y&&x<=y+S.getWidth()&&!a._16Q(S,y)){if(S.isSortable()){var E=n.getSortMode(),X=S.getSortOrder();E===ci?n.getSortColumn()===S?(X===Vn&&n.setSortColumn(h),S.setSortOrder(X===jp?Vn:jp)):n.setSortColumn(S):"bistate"===E&&(n.getSortColumn()===S?S.setSortOrder(X===jp?Vn:jp):n.setSortColumn(S))}n.onColumnClicked(S,k,y)}}a._29o=a.resizing=a.x=a.lx=a.w=h}}),dt.TablePane=function(H){this.init(new nt(H))},et("TablePane",w,{ms_v:1,_44o:1}),dt.TreeTablePane=function(E){this.init(new pt(E))},et("TreeTablePane",w,{ms_v:1,_44o:1}),dt.Toolbar=function(o){var O=this,I=O._view=fl(1,O),i=I.style;i.background=l.toolbarBackground||"",i.height=_c+Ee,O._canvas=Mb(I),O._30o=new bp,O._90I=new bp,O.setItems(o||[]),I.handleGroupSelectedChanged=function(m){if(m.isSelected()){var M=m.getGroupId();null!=M&&O._items.forEach(function(f){var a=f.element;a&&a!==m&&a.setSelected&&a.getGroupId&&a.getGroupId()===M&&a.setSelected(!1)})}},new vt(O)},et("Toolbar",w,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[ec,Cp,Zh,Vb,Gp,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:l.toolbarLabelColor,_labelSelectColor:l.toolbarLabelSelectColor,_labelFont:l.toolbarLabelFont,_selectBackground:l.toolbarSelectBackground,_itemGap:l.toolbarItemGap,_separatorColor:l.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(x){var v=this.getItemInfoAt(x);return v?v.item.toolTip:h},getLabelColor:function(y){return y&&y.selected&&y.type!==Hq&&y.type!==Ll?this._labelSelectColor:this._labelColor},onPropertyChanged:function(z){this.iv(),z.property===ec&&this._items.forEach(function(L){Op(L)})},redraw:function(){this.iv()},addItem:function(G,K){var b=this._items;K==h?b.push(G):b.splice(K,0,G),this.fp(ec,h,b)},removeItem:function(o){if(o)for(var q=this._items,N=0;N<q.length;N++)o===q[N]&&(q.splice(N,1),this.fp(ec,h,q))},removeItemById:function(k){if(k!=h)for(var D=this._items,B=0;B<D.length;B++)if(k===D[B].id){var Q=D.splice(B,1)[0];return this.fp(ec,h,D),Q}},getItemById:function(t){if(t!=h)for(var $=this._items,f=0;f<$.length;f++){var l=$[f];if(t===l.id)return l}},setItemVisible:function(o,Y){var c=this.getItemById(o);c&&(c.visible=Y)},getItemInfos:function(){return this._30o},getItemInfoAt:function(N){var l=this,$=0,L=l._30o,k=l.lp(N),i=k.x,R=k.y;if(R>=0&&R<=l.getHeight())for(;$<L.size();$++){var A=L.get($);if(A.startX<=i&&i<=A.endX)return A}return h},drawItem:function(S,t,X,w,l){if(t.visible===!1)return 0;if(bo(t.visible)&&!t.visible())return 0;var v=this,Z=t.disabled;Z&&(S.globalAlpha=Fq);var g=v.drawItemImpl(S,t,X,w,l),q=v._itemGap;return Z&&(S.globalAlpha=1),this._currentItem!==t||"separator"===t||t.separator===!0||t.unfocusable||ge(S,v._separatorColor,X-q/2,0,g+q,w),g},drawItemImpl:function(I,N,G,q,l){var t=this,i=t._view,y=t._itemGap,n=q/2,d=N.type,o=N.element,r=N.label;Ek(o)&&(r=o,o=h);var X,T=t.getLabelFont(N),L=t.getLabelColor(N),Q=N.selected,b=vo(N.icon),H=sm(b,N),p=0,v=H+(r?Jm(T,r).width:0);if("separator"===N||N.separator===!0)return xh(I,t._separatorColor,G,q/4,n),1;if(o){b&&Do(I,b,G+H/2,n,N,t),dn(I,r,T,L,G+H,0,0,q);var x=Sq(o);l||t._90I.add(x),x.parentNode!==i&&vk(i,x),o.iv&&o.iv(),o.validate&&o.validate();var C=x.getBoundingClientRect(),M=C.width,c=x.style;return Sh(x),c.left=t.tx()+G+v+Ee,c.top=(q-C.height)/2+Ee,v+M}return d===Ll?X=vo(Q?Ub:Ap):d===Hq&&(X=vo(Q?Hq:hn)),X?(p=sm(X,N),Do(I,X,G+p/2,n,N,t),G+=p,v+=p):Q&&Tj(I,G-y/2,0,v+y,q,t.getSelectBackground(N)),b&&Do(I,b,G+H/2,n,N,t),dn(I,r,T,L,G+H,0,0,q),v},validateImpl:function(){var e=this,F=e._canvas,y=e.getWidth(),Y=e.getHeight(),T=e._30o,Z=e._items;qh(F,y,Y);var g=hb(F),C=e._itemGap,p=C/2;pm(g,e.tx(),0,1),g.clearRect(0,0,y,Y);var d=e._90I;e._90I=new bp,T.clear(),Z.forEach(function(y){var F=e.drawItem(g,y,p,Y);T.add({item:y,startX:p,endX:p+F,width:F}),F&&(p+=F+C)}),d.each(function(P){e._90I.contains(P)||sn(P)});var R=e._64I;e._64I=I(0,p),g.restore(),e._stickToRight?(e._65O=0,g=hb(F),p=y-e._64I+C,pm(g,0,0,1),g.clearRect(0,0,y,Y),T.clear(),Z.forEach(function(U){var Q=e.drawItem(g,U,p,Y,!0);T.add({item:U,startX:p,endX:p+Q,width:Q}),Q&&(p+=Q+C)}),g.restore()):e.tx(e.tx()),R!==e._64I&&e.onSumWidthChanged(R,e._64I)},onSumWidthChanged:function(){},handleClick:function(v,A){var S=this,l=v.type,s=v.action,g=v.groupId,F=v.selected;v.disabled||(g!=h?F||(v.selected=!0,this._items.forEach(function(Y){Y.groupId===g&&v!==Y&&(Y.selected=!1)}),s&&v.action(v,S,A)):l===Hq||"toggle"===l?(v.selected=!F,s&&v.action(v,S,A)):s&&v.action(v,S,A)),df(),S.iv()}});var vt=function($){this.tb=$,this.addListeners()};tr(vt,w,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(U){this.handleScroll(U,10*(U.wheelDelta/40))},handle_DOMMouseScroll:function(m){this.handleScroll(m,10*-m.detail)},handleScroll:function(x,i){jr(x);var O=this.tb;O.isScrollable()&&!O._stickToRight&&(O.tx(O.tx()+i),ib())},handle_mousemove:function(T){var n=this;dl||n.setItem(T)},handle_mouseout:function(Y){var c=this;Y.target===c.getView()?c.tb.setCurrentItem(h):c.handle_mousemove(Y)},handle_mousedown:function($){this.handle_mousemove($),this.handle_touchstart($)},handle_touchstart:function(G){var e=this,T=e.tb,q=G.target;Pd(G)&&(q===e.getView()||q===T._canvas)&&(jr(G),T.setFocus(G)&&(this.setItem(G,!0),(T.isScrollable()||e.info&&!e.info.item.disabled)&&(e.x=Cd(G).x,e.tx=T.tx(),Vc(e,G))))},handleWindowMouseMove:function($){this.handleWindowTouchMove($)},handleWindowTouchMove:function(A){var w=this,B=w.tb;if(!B._stickToRight){var O=Cd(A).x-w.x;!w._25o&&$(O)>2&&B.isScrollable()&&(w._25o=1),w._25o&&B.tx(w.tx+O)}},handleWindowMouseUp:function(L){this.handleWindowTouchEnd(L)},handleWindowTouchEnd:function(s){var k=this,K=k.tb,M=k.info,p=k.tb.getItemInfoAt(s);if(!k._25o&&M){var f=M.item;p&&p.item===f&&K.handleClick(f,s)}k._25o=k.x=k.tx=h,k.setItem()},setItem:function(D,j){var M=this,n=M.tb,o=M.info=D?n.getItemInfoAt(D):h,x=o?o.item:h;n.setCurrentItem(x),j&&x&&bo(x.onDown)&&x.onDown(D)}}),dt.BorderPane=function(){this._view=fl(1,this),this.iv()},et("BorderPane",w,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(r,A){this._12o("leftView",r),A!=h&&this.setLeftWidth(A)},getRightView:function(){return this._rightView},setRightView:function(x,l){this._12o("rightView",x),l!=h&&this.setRightWidth(l)},getTopView:function(){return this._topView},setTopView:function(G,g){this._12o("topView",G),g!=h&&this.setTopHeight(g)},getBottomView:function(){return this._bottomView},setBottomView:function(W,G){this._12o("bottomView",W),G!=h&&this.setBottomHeight(G)},getCenterView:function(){return this._centerView},setCenterView:function(H){this._12o("centerView",H)},_12o:function(o,a){var B=this,S="_"+o,A=B._view,v=B[S];v!==a&&(v&&(v.getView?sn(v.getView()):sn(v)),B[S]=a,a&&(a.getView?vk(A,a.getView(),1):vk(A,a,1)),B.fp(o,v,a))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var E=this,V=E._topView,a=E._bottomView,k=E._leftView,W=E._rightView,T=E._centerView,A=E.getWidth(),R=E.getHeight(),n=0,l=0,O=A,H=R,m=0,Z=0,v=0,K=0;V&&(m=E._topHeight==h?Rm(V):E._topHeight,l=m),a&&(Z=E._bottomHeight==h?Rm(a):E._bottomHeight,H=R-Z),k&&(v=E._leftWidth==h?lo(k):E._leftWidth,n=v),W&&(K=E._rightWidth==h?lo(W):E._rightWidth,O=A-K);var w=I(0,O-n),p=I(0,H-l);V&&cn(V,0,0,A,m),a&&cn(a,0,H,A,Z),k&&cn(k,0,l,v,p),W&&cn(W,O,l,K,p),T&&cn(T,n,l,w,p)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);